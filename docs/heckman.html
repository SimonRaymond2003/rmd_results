<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Heckman Selection Model Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">4th Downs in the NFL</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="heckman.html">Heckman Selection</a>
</li>
<li>
  <a href="xgboost.html">XGBoost Prediction</a>
</li>
<li>
  <a href="attendance_binary.html">Attendance Impact Binary</a>
</li>
<li>
  <a href="thirddown.html">Third Down Analysis</a>
</li>
<li>
  <a href="attempt_ols.html">Attempts OLS</a>
</li>
<li>
  <a href="robustness_checks.html">Robustness Checks</a>
</li>
<li>
  <a href="Writing.html">Writing</a>
</li>
<li>
  <a href="kicker_exogenous.html">Proof of Exogeniety</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Heckman Selection Model Analysis</h1>

</div>


<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>outcome_data <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">&quot;predict_outcome.csv.gz&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>select_data <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">&quot;predict_select.csv.gz&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>select_data[, score_diff <span class="sc">:=</span> <span class="fu">as.integer</span>(score_diff <span class="sc">&gt;</span> <span class="dv">0</span>)]</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>select_data[, attempt <span class="sc">:=</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(attempt))]</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co"># Prepare the XGBoost matrices</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> . <span class="sc">-</span> <span class="dv">1</span> <span class="sc">-</span> attempt <span class="sc">-</span> my_id, <span class="at">data =</span> select_data)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(select_data<span class="sc">$</span>attempt))</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co"># Create parameter grid</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co"># Create parameter grid</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  <span class="at">eta =</span> <span class="fu">seq</span>(<span class="fl">0.001</span>, <span class="fl">0.03</span>, <span class="at">by =</span> <span class="fl">0.01</span>),</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>  <span class="at">max_depth =</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>  <span class="at">min_child_weight =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="dv">1</span>),        </span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>  <span class="at">subsample =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.2</span>),</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>  <span class="at">colsample_bytree =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.2</span>),</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="dv">1</span>),                </span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">by =</span> <span class="dv">1</span>),                  </span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>  <span class="at">gamma =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">by =</span> <span class="fl">0.1</span>),               </span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>  <span class="at">nrounds =</span> <span class="fu">seq</span>(<span class="dv">100</span>, <span class="dv">250</span>, <span class="at">by =</span> <span class="dv">50</span>)</span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>)</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co"># Sample grid points</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>conf_lev <span class="ot">&lt;-</span> .<span class="dv">95</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a>num_max <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>conf_lev)<span class="sc">/</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>num_max<span class="sc">/</span><span class="fu">nrow</span>(grid)))</span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(grid), n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a>rgrid <span class="ot">&lt;-</span> grid[ind, ]</span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a><span class="co"># Set up parallel processing</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a>nc <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a></span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a><span class="co"># Calculate scale_pos_weight for imbalanced dataset</span></span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a>scale_pos_weight <span class="ot">&lt;-</span> <span class="fu">sum</span>(y <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">/</span> <span class="fu">sum</span>(y <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a></span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a><span class="co"># Validation phase</span></span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a><span class="co">#cat(&quot;\nPhase 1: Validation Phase\n&quot;)</span></span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a>n_validations <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a>validation_results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">nrow</span>(rgrid), <span class="at">ncol =</span> n_validations)</span>
<span id="cb4-44"><a href="#cb4-44" tabindex="-1"></a></span>
<span id="cb4-45"><a href="#cb4-45" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(rgrid)) {</span>
<span id="cb4-46"><a href="#cb4-46" tabindex="-1"></a>  <span class="co">#cat(&quot;\nTesting parameter set&quot;, j, &quot;of&quot;, nrow(rgrid), &quot;\n&quot;)</span></span>
<span id="cb4-47"><a href="#cb4-47" tabindex="-1"></a>  </span>
<span id="cb4-48"><a href="#cb4-48" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_validations) {</span>
<span id="cb4-49"><a href="#cb4-49" tabindex="-1"></a>    <span class="co">#cat(&quot;\nValidation iteration&quot;, i, &quot;of&quot;, n_validations, &quot;\n&quot;)             </span></span>
<span id="cb4-50"><a href="#cb4-50" tabindex="-1"></a>    <span class="co"># Create validation split</span></span>
<span id="cb4-51"><a href="#cb4-51" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(xs), <span class="fu">nrow</span>(xs), <span class="cn">TRUE</span>))</span>
<span id="cb4-52"><a href="#cb4-52" tabindex="-1"></a>    train_x <span class="ot">&lt;-</span> xs[idx, ]</span>
<span id="cb4-53"><a href="#cb4-53" tabindex="-1"></a>    train_y <span class="ot">&lt;-</span> y[idx]</span>
<span id="cb4-54"><a href="#cb4-54" tabindex="-1"></a>    val_x <span class="ot">&lt;-</span> xs[<span class="sc">-</span>idx, ]</span>
<span id="cb4-55"><a href="#cb4-55" tabindex="-1"></a>    val_y <span class="ot">&lt;-</span> y[<span class="sc">-</span>idx]</span>
<span id="cb4-56"><a href="#cb4-56" tabindex="-1"></a>    </span>
<span id="cb4-57"><a href="#cb4-57" tabindex="-1"></a>    prm <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb4-58"><a href="#cb4-58" tabindex="-1"></a>      <span class="at">booster =</span> <span class="st">&quot;gbtree&quot;</span>,</span>
<span id="cb4-59"><a href="#cb4-59" tabindex="-1"></a>      <span class="at">objective =</span> <span class="st">&quot;binary:logistic&quot;</span>,</span>
<span id="cb4-60"><a href="#cb4-60" tabindex="-1"></a>      <span class="at">max_depth =</span> rgrid[j, <span class="st">&quot;max_depth&quot;</span>],</span>
<span id="cb4-61"><a href="#cb4-61" tabindex="-1"></a>      <span class="at">eta =</span> rgrid[j, <span class="st">&quot;eta&quot;</span>],</span>
<span id="cb4-62"><a href="#cb4-62" tabindex="-1"></a>      <span class="at">subsample =</span> rgrid[j, <span class="st">&quot;subsample&quot;</span>],</span>
<span id="cb4-63"><a href="#cb4-63" tabindex="-1"></a>      <span class="at">colsample_bytree =</span> rgrid[j, <span class="st">&quot;colsample_bytree&quot;</span>],</span>
<span id="cb4-64"><a href="#cb4-64" tabindex="-1"></a>      <span class="at">gamma =</span> rgrid[j, <span class="st">&quot;gamma&quot;</span>],</span>
<span id="cb4-65"><a href="#cb4-65" tabindex="-1"></a>      <span class="at">min_child_weight =</span> rgrid[j, <span class="st">&quot;min_child_weight&quot;</span>],</span>
<span id="cb4-66"><a href="#cb4-66" tabindex="-1"></a>      <span class="at">alpha =</span> rgrid[j, <span class="st">&quot;alpha&quot;</span>],</span>
<span id="cb4-67"><a href="#cb4-67" tabindex="-1"></a>      <span class="at">lambda =</span> rgrid[j, <span class="st">&quot;lambda&quot;</span>],</span>
<span id="cb4-68"><a href="#cb4-68" tabindex="-1"></a>      <span class="at">scale_pos_weight =</span> scale_pos_weight,</span>
<span id="cb4-69"><a href="#cb4-69" tabindex="-1"></a>      <span class="at">nthread =</span> nc</span>
<span id="cb4-70"><a href="#cb4-70" tabindex="-1"></a>    )</span>
<span id="cb4-71"><a href="#cb4-71" tabindex="-1"></a>    </span>
<span id="cb4-72"><a href="#cb4-72" tabindex="-1"></a>    dm_train <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> train_x, <span class="at">label =</span> train_y)</span>
<span id="cb4-73"><a href="#cb4-73" tabindex="-1"></a>    mdl <span class="ot">&lt;-</span> <span class="fu">xgb.train</span>(</span>
<span id="cb4-74"><a href="#cb4-74" tabindex="-1"></a>      <span class="at">params =</span> prm,</span>
<span id="cb4-75"><a href="#cb4-75" tabindex="-1"></a>      <span class="at">data =</span> dm_train,</span>
<span id="cb4-76"><a href="#cb4-76" tabindex="-1"></a>      <span class="at">nrounds =</span> rgrid[j, <span class="st">&quot;nrounds&quot;</span>],</span>
<span id="cb4-77"><a href="#cb4-77" tabindex="-1"></a>      <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb4-78"><a href="#cb4-78" tabindex="-1"></a>    )</span>
<span id="cb4-79"><a href="#cb4-79" tabindex="-1"></a>    </span>
<span id="cb4-80"><a href="#cb4-80" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">predict</span>(mdl, <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> val_x))</span>
<span id="cb4-81"><a href="#cb4-81" tabindex="-1"></a>    pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(p, val_y)</span>
<span id="cb4-82"><a href="#cb4-82" tabindex="-1"></a>    validation_results[j, i] <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="st">&quot;auc&quot;</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb4-83"><a href="#cb4-83" tabindex="-1"></a>  }</span>
<span id="cb4-84"><a href="#cb4-84" tabindex="-1"></a>}</span>
<span id="cb4-85"><a href="#cb4-85" tabindex="-1"></a></span>
<span id="cb4-86"><a href="#cb4-86" tabindex="-1"></a><span class="co"># Run 100 tests with best parameters</span></span>
<span id="cb4-87"><a href="#cb4-87" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Running X test iterations with best parameters...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Running X test iterations with best parameters...</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>test_aucs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>best_params_idx <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">rowMeans</span>(validation_results))</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>best_params <span class="ot">&lt;-</span> rgrid[best_params_idx,]</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co"># Train final model with best parameters</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>best_params_list <span class="ot">&lt;-</span> <span class="fu">as.list</span>(best_params[<span class="sc">-</span><span class="fu">which</span>(<span class="fu">names</span>(best_params) <span class="sc">==</span> <span class="st">&quot;nrounds&quot;</span>)])</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>best_params_list<span class="sc">$</span>booster <span class="ot">&lt;-</span> <span class="st">&quot;gbtree&quot;</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>best_params_list<span class="sc">$</span>objective <span class="ot">&lt;-</span> <span class="st">&quot;binary:logistic&quot;</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>best_params_list<span class="sc">$</span>scale_pos_weight <span class="ot">&lt;-</span> scale_pos_weight</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>best_params_list<span class="sc">$</span>nthread <span class="ot">&lt;-</span> nc</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  <span class="co"># Create test split</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(xs), <span class="fu">nrow</span>(xs), T))</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>  train_x <span class="ot">&lt;-</span> xs[idx, ]</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>  train_y <span class="ot">&lt;-</span> y[idx]</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>  test_x <span class="ot">&lt;-</span> xs[<span class="sc">-</span>idx, ]</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>  test_y <span class="ot">&lt;-</span> y[<span class="sc">-</span>idx]</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>  </span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>  <span class="co"># Train model on full unbalanced dataset</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>  dm_train <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> train_x, <span class="at">label =</span> train_y)</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>  mdl <span class="ot">&lt;-</span> <span class="fu">xgb.train</span>(</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>    <span class="at">params =</span> best_params_list,</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>    <span class="at">data =</span> dm_train,</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>    <span class="at">nrounds =</span> best_params[[<span class="st">&quot;nrounds&quot;</span>]],</span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>  )</span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a>  </span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a>  <span class="co"># Test on unbalanced test set</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">predict</span>(mdl, <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> test_x))</span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(p, test_y)</span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a>  test_aucs[i] <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="st">&quot;auc&quot;</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a>}</span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Test Results over 100 iterations:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Test Results over 100 iterations:</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean AUC:&quot;</span>, <span class="fu">mean</span>(test_aucs), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Mean AUC: 0.8870486</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;SD AUC:&quot;</span>, <span class="fu">sd</span>(test_aucs), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## SD AUC: 0.00454176</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;95% CI:&quot;</span>, <span class="fu">mean</span>(test_aucs) <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(test_aucs), </span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>    <span class="st">&quot;to&quot;</span>, <span class="fu">mean</span>(test_aucs) <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(test_aucs), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 95% CI: 0.8781467 to 0.8959504</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Plotting AUC distribution</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">plot</span>(test_aucs, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">pch=</span><span class="dv">20</span>,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;AUC Test Distribution&quot;</span>,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Iteration&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;AUC&quot;</span>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">mean</span>(test_aucs), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>)  <span class="co"># Add this line to show mean</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">mean</span>(test_aucs) <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(test_aucs), <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">mean</span>(test_aucs) <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(test_aucs), <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, </span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;AUC Values&quot;</span>, <span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;95% CI Bounds&quot;</span>),</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>),</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>       <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">20</span>, <span class="cn">NA</span>, <span class="cn">NA</span>))</span></code></pre></div>
<p><img src="heckman_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Now train final model on full data for z scores</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>dm_full <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> xs, <span class="at">label =</span> y)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> <span class="fu">xgb.train</span>(</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="at">params =</span> best_params_list,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="at">data =</span> dm_full,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  <span class="at">nrounds =</span> best_params[[<span class="st">&quot;nrounds&quot;</span>]],</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>)</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co"># Get probability predictions (z) for ALL data</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model, <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> xs))</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Calculate residuals for XGBoost predictions</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(select_data<span class="sc">$</span>attempt))</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> y <span class="sc">-</span> z</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co"># Histogram of residuals</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="fu">hist</span>(residuals, <span class="at">main=</span><span class="st">&quot;Distribution of XGBoost Model Residuals&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Residual&quot;</span>, <span class="at">breaks=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="heckman_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># plot out the z values\</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(z), </span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Density of Z Predictions&quot;</span>,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Predicted Probability of Attempt&quot;</span>,</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>)</span></code></pre></div>
<p><img src="heckman_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Calculate GIMR (lambda) This is Generalized inverse mills ratio</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>GIMR <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(<span class="fu">qnorm</span>(z)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">qnorm</span>(z)))</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co"># Add GIMR to the data</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>select_data[, GIMR <span class="sc">:=</span> GIMR]</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co"># Print variable importa</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Create a data.table with just my_id and GIMR from select_data</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>GIMR_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">my_id =</span> select_data<span class="sc">$</span>my_id, <span class="at">GIMR =</span> GIMR)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co"># Add GIMR to outcome_data by matching on my_id</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>outcome_data[GIMR_dt, GIMR <span class="sc">:=</span> i.GIMR, on <span class="ot">=</span> <span class="st">&quot;my_id&quot;</span>]</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># # Existing code</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="co"># outcome_data &lt;- outcome_data[, my_id := NULL]</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co"># outcome_data[, yardline_31_40 := NULL]</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co"># outcome_data[, year2022_team_CLE := NULL] # tied for most attempts with 31</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co"># Remove all columns with &quot;_present&quot; in the name</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>present_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;_present&quot;</span>, <span class="fu">names</span>(outcome_data), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> present_cols) {</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  outcome_data[, (col) <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># Create copies of outcome_data for different models</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>outcome_data_player <span class="ot">&lt;-</span> <span class="fu">copy</span>(outcome_data)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>outcome_data_starter <span class="ot">&lt;-</span> <span class="fu">copy</span>(outcome_data)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co"># Remove specific columns as in original code</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="cf">for</span> (dt <span class="cf">in</span> <span class="fu">list</span>(outcome_data_player, outcome_data_starter)) {</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>  dt[, my_id <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  dt[, yardline_31_40 <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>  dt[, year2022_team_CLE <span class="sc">:=</span> <span class="cn">NULL</span>] <span class="co"># tied for most attempts with 31</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>  </span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>  <span class="co"># Remove attendance variables</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>  dt[, attendance_pct <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>  dt[, attendance_raw <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>  dt[, vegas_wp_posteam <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Warning in `[.data.table`(dt, , `:=`(vegas_wp_posteam, NULL)): Column
## &#39;vegas_wp_posteam&#39; does not exist to remove

## Warning in `[.data.table`(dt, , `:=`(vegas_wp_posteam, NULL)): Column
## &#39;vegas_wp_posteam&#39; does not exist to remove</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># For player models, remove starter columns</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>player_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;^starter_&quot;</span>, <span class="fu">names</span>(outcome_data_player), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> player_cols) {</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  outcome_data_player[, (col) <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>}</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co"># For starter models, remove player columns</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>starter_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;^(offense|defense)_player_&quot;</span>, <span class="fu">names</span>(outcome_data_starter), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> starter_cols) {</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>  outcome_data_starter[, (col) <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>}</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co"># Ensure conversion is numeric</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="cf">for</span> (dt <span class="cf">in</span> <span class="fu">list</span>(outcome_data_player, outcome_data_starter)) {</span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>  dt[, conversion <span class="sc">:=</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(conversion))]</span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>}</span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="co"># MODEL 1: Player model with GIMR</span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a>ols_model_player <span class="ot">&lt;-</span> <span class="fu">lm</span>(conversion <span class="sc">~</span> ., <span class="at">data =</span> outcome_data_player)</span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="co"># MODEL 2: Starter model with GIMR</span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a>ols_model_starter <span class="ot">&lt;-</span> <span class="fu">lm</span>(conversion <span class="sc">~</span> ., <span class="at">data =</span> outcome_data_starter)</span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a><span class="co"># Function to analyze and print model results</span></span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a>analyze_model <span class="ot">&lt;-</span> <span class="cf">function</span>(model, model_name) {</span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a>  <span class="fu">library</span>(sandwich)</span>
<span id="cb23-27"><a href="#cb23-27" tabindex="-1"></a>  <span class="fu">library</span>(lmtest)</span>
<span id="cb23-28"><a href="#cb23-28" tabindex="-1"></a>  </span>
<span id="cb23-29"><a href="#cb23-29" tabindex="-1"></a>  <span class="co"># Get HC0-adjusted t-values and p-values</span></span>
<span id="cb23-30"><a href="#cb23-30" tabindex="-1"></a>  robust_test <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model, <span class="at">vcov =</span> <span class="fu">vcovHC</span>(model, <span class="at">type =</span> <span class="st">&quot;HC0&quot;</span>))</span>
<span id="cb23-31"><a href="#cb23-31" tabindex="-1"></a>  t_stats <span class="ot">&lt;-</span> robust_test[, <span class="st">&quot;t value&quot;</span>]</span>
<span id="cb23-32"><a href="#cb23-32" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> robust_test[, <span class="st">&quot;Pr(&gt;|t|)&quot;</span>]</span>
<span id="cb23-33"><a href="#cb23-33" tabindex="-1"></a>  </span>
<span id="cb23-34"><a href="#cb23-34" tabindex="-1"></a>  <span class="co"># Function to add significance stars</span></span>
<span id="cb23-35"><a href="#cb23-35" tabindex="-1"></a>  get_stars <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {</span>
<span id="cb23-36"><a href="#cb23-36" tabindex="-1"></a>    <span class="cf">if</span> (p <span class="sc">&lt;=</span> <span class="fl">0.01</span>) <span class="fu">return</span>(<span class="st">&quot;***&quot;</span>)</span>
<span id="cb23-37"><a href="#cb23-37" tabindex="-1"></a>    <span class="cf">if</span> (p <span class="sc">&lt;=</span> <span class="fl">0.05</span>) <span class="fu">return</span>(<span class="st">&quot;**&quot;</span>)</span>
<span id="cb23-38"><a href="#cb23-38" tabindex="-1"></a>    <span class="cf">if</span> (p <span class="sc">&lt;=</span> <span class="fl">0.1</span>) <span class="fu">return</span>(<span class="st">&quot;*&quot;</span>)</span>
<span id="cb23-39"><a href="#cb23-39" tabindex="-1"></a>    <span class="cf">if</span> (p <span class="sc">&lt;=</span> <span class="fl">0.15</span>) <span class="fu">return</span>(<span class="st">&quot;.&quot;</span>)</span>
<span id="cb23-40"><a href="#cb23-40" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb23-41"><a href="#cb23-41" tabindex="-1"></a>  }</span>
<span id="cb23-42"><a href="#cb23-42" tabindex="-1"></a>  </span>
<span id="cb23-43"><a href="#cb23-43" tabindex="-1"></a>  <span class="co"># Maximum width for variable names</span></span>
<span id="cb23-44"><a href="#cb23-44" tabindex="-1"></a>  name_width <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb23-45"><a href="#cb23-45" tabindex="-1"></a>  </span>
<span id="cb23-46"><a href="#cb23-46" tabindex="-1"></a>  <span class="co"># Print model name and header</span></span>
<span id="cb23-47"><a href="#cb23-47" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>, <span class="fu">paste</span>(<span class="fu">rep</span>(<span class="st">&quot;=&quot;</span>, <span class="dv">80</span>), <span class="at">collapse=</span><span class="st">&quot;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-48"><a href="#cb23-48" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;MODEL:&quot;</span>, model_name, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-49"><a href="#cb23-49" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="fu">rep</span>(<span class="st">&quot;=&quot;</span>, <span class="dv">80</span>), <span class="at">collapse=</span><span class="st">&quot;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-50"><a href="#cb23-50" tabindex="-1"></a>  </span>
<span id="cb23-51"><a href="#cb23-51" tabindex="-1"></a>  <span class="co"># Print header with alignment</span></span>
<span id="cb23-52"><a href="#cb23-52" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10s  %10s  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, name_width, <span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;t-value&quot;</span>, <span class="st">&quot;p-value&quot;</span>, <span class="st">&quot;sig&quot;</span>))</span>
<span id="cb23-53"><a href="#cb23-53" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10s  %10s  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, name_width, <span class="st">&quot;---------&quot;</span>, <span class="st">&quot;-------&quot;</span>, <span class="st">&quot;-------&quot;</span>, <span class="st">&quot;----&quot;</span>))</span>
<span id="cb23-54"><a href="#cb23-54" tabindex="-1"></a>  </span>
<span id="cb23-55"><a href="#cb23-55" tabindex="-1"></a>  <span class="co"># Loop through and print values</span></span>
<span id="cb23-56"><a href="#cb23-56" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(t_stats)) {</span>
<span id="cb23-57"><a href="#cb23-57" tabindex="-1"></a>    var_name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(robust_test)[i]</span>
<span id="cb23-58"><a href="#cb23-58" tabindex="-1"></a>    <span class="co"># Truncate name if too long</span></span>
<span id="cb23-59"><a href="#cb23-59" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nchar</span>(var_name) <span class="sc">&gt;</span> name_width) {</span>
<span id="cb23-60"><a href="#cb23-60" tabindex="-1"></a>      var_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">substr</span>(var_name, <span class="dv">1</span>, name_width<span class="dv">-3</span>), <span class="st">&quot;...&quot;</span>)</span>
<span id="cb23-61"><a href="#cb23-61" tabindex="-1"></a>    }</span>
<span id="cb23-62"><a href="#cb23-62" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10.4f  %10.4f  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, </span>
<span id="cb23-63"><a href="#cb23-63" tabindex="-1"></a>                name_width, var_name, </span>
<span id="cb23-64"><a href="#cb23-64" tabindex="-1"></a>                t_stats[i], p_values[i],</span>
<span id="cb23-65"><a href="#cb23-65" tabindex="-1"></a>                <span class="fu">get_stars</span>(p_values[i])))</span>
<span id="cb23-66"><a href="#cb23-66" tabindex="-1"></a>  }</span>
<span id="cb23-67"><a href="#cb23-67" tabindex="-1"></a>  </span>
<span id="cb23-68"><a href="#cb23-68" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-69"><a href="#cb23-69" tabindex="-1"></a>  </span>
<span id="cb23-70"><a href="#cb23-70" tabindex="-1"></a>  <span class="co"># Print R-squared</span></span>
<span id="cb23-71"><a href="#cb23-71" tabindex="-1"></a>  r_squared <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>adj.r.squared</span>
<span id="cb23-72"><a href="#cb23-72" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Adjusted R-squared:&quot;</span>, r_squared, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-73"><a href="#cb23-73" tabindex="-1"></a>  </span>
<span id="cb23-74"><a href="#cb23-74" tabindex="-1"></a>  <span class="co"># Calculate VIFs</span></span>
<span id="cb23-75"><a href="#cb23-75" tabindex="-1"></a>  <span class="fu">library</span>(car)</span>
<span id="cb23-76"><a href="#cb23-76" tabindex="-1"></a>  vifs <span class="ot">&lt;-</span> <span class="fu">vif</span>(model)</span>
<span id="cb23-77"><a href="#cb23-77" tabindex="-1"></a>  </span>
<span id="cb23-78"><a href="#cb23-78" tabindex="-1"></a>  <span class="co"># Filter to show only VIFs over 5</span></span>
<span id="cb23-79"><a href="#cb23-79" tabindex="-1"></a>  high_vifs <span class="ot">&lt;-</span> vifs[vifs <span class="sc">&gt;</span> <span class="dv">5</span>]</span>
<span id="cb23-80"><a href="#cb23-80" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(high_vifs) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb23-81"><a href="#cb23-81" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Variables with VIF &gt; 5:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-82"><a href="#cb23-82" tabindex="-1"></a>    <span class="fu">print</span>(high_vifs)</span>
<span id="cb23-83"><a href="#cb23-83" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb23-84"><a href="#cb23-84" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">No variables with VIF &gt; 5 found in this model</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-85"><a href="#cb23-85" tabindex="-1"></a>  }</span>
<span id="cb23-86"><a href="#cb23-86" tabindex="-1"></a>  </span>
<span id="cb23-87"><a href="#cb23-87" tabindex="-1"></a>  <span class="fu">return</span>(r_squared)</span>
<span id="cb23-88"><a href="#cb23-88" tabindex="-1"></a>}</span>
<span id="cb23-89"><a href="#cb23-89" tabindex="-1"></a></span>
<span id="cb23-90"><a href="#cb23-90" tabindex="-1"></a><span class="co"># Analyze models with GIMR only</span></span>
<span id="cb23-91"><a href="#cb23-91" tabindex="-1"></a>r2_player <span class="ot">&lt;-</span> <span class="fu">analyze_model</span>(ols_model_player, <span class="st">&quot;Player Model with GIMR&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 
##  ================================================================================ 
## MODEL: Player Model with GIMR 
## ================================================================================ 
## 
## Variable                                                         t-value     p-value   sig
## ---------                                                        -------     -------  ----
## (Intercept)                                                       3.6637      0.0003   ***
## ydstogo                                                         -12.7550      0.0000   ***
## posteam_timeouts_remaining                                        1.0122      0.3115      
## defteam_timeouts_remaining                                        0.9798      0.3272      
## rush_attempt                                                      7.2807      0.0000   ***
## week                                                              0.4160      0.6774      
## temp                                                             -1.1069      0.2684      
## wind                                                              1.0379      0.2994      
## vegas_wp                                                          0.8948      0.3710      
## spread_line                                                      -0.2674      0.7891      
## total_line                                                        1.6574      0.0975     *
## prep_days                                                         1.0978      0.2724      
## overall_win_pct                                                   0.0560      0.9553      
## team_win_pct                                                      1.7416      0.0817     *
## prev_win_pct                                                     -2.5353      0.0113    **
## prev_shotgun_rate                                                 0.2828      0.7773      
## prev_singleback_rate                                              0.4382      0.6612      
## prev_empty_rate                                                   0.8100      0.4180      
## prev_iform_rate                                                   0.2984      0.7654      
## prev_shotgun_success                                              0.3462      0.7292      
## prev_singleback_success                                           0.3188      0.7499      
## prev_empty_success                                               -0.1310      0.8958      
## prev_iform_success                                                2.6988      0.0070   ***
## prev_stop_rate_run                                               -0.2619      0.7934      
## prev_stop_rate_pass                                              -3.6322      0.0003   ***
## shotgun_rate                                                      1.2456      0.2130      
## singleback_rate                                                   0.6608      0.5088      
## empty_rate                                                        0.0746      0.9405      
## iform_rate                                                       -1.7423      0.0815     *
## shotgun_success                                                  -2.1030      0.0355    **
## singleback_success                                               -0.6908      0.4897      
## empty_success                                                    -0.7177      0.4730      
## iform_success                                                    -1.5711      0.1162     .
## def_stop_rate_run                                                 1.8440      0.0653     *
## def_stop_rate_pass                                               -1.2857      0.1986      
## avg_pass_rushers                                                 -0.9644      0.3349      
## avg_box_defenders                                                -0.3839      0.7011      
## cover0_rate                                                      -0.2908      0.7712      
## cover1_rate                                                      -0.4813      0.6303      
## cover2_rate                                                      -0.5194      0.6035      
## cover3_rate                                                       1.1727      0.2410      
## cover4_rate                                                       0.8493      0.3958      
## cover6_rate                                                      -0.7135      0.4756      
## two_man_rate                                                      1.6072      0.1081     .
## prevent_rate                                                      2.5191      0.0118    **
## roof_outdoors                                                    -0.5243      0.6001      
## posteam_type_home                                                -1.3927      0.1638      
## offense_formation_EMPTY                                           0.3204      0.7487      
## offense_formation_SHOTGUN                                        -0.1961      0.8445      
## offense_formation_SINGLEBACK                                     -0.5856      0.5582      
## offense_formation_I_FORM                                         -0.5737      0.5662      
## offense_player_1_passing_depth_short_grades_pass_12w              2.0790      0.0377    **
## offense_player_1_passing_depth_medium_grades_pass_12w            -0.1453      0.8845      
## offense_player_1_passing_depth_deep_grades_pass_12w              -1.2195      0.2227      
## offense_player_1_rushing_grades_grades_run_12w                   -0.0374      0.9702      
## offense_player_4_rushing_grades_first_downs_12w                   1.4472      0.1479     .
## offense_player_4_pass_blocking_true_pass_set_grades_pass_...      0.5291      0.5968      
## offense_player_8_receiving_depth_medium_yprr_12w                 -1.3783      0.1682      
## offense_player_8_blocking_grades_block_percent_12w               -1.0213      0.3072      
## offense_player_8_receiving_grades_first_downs_12w                 0.6131      0.5398      
## offense_player_9_receiving_depth_medium_yprr_12w                 -1.8685      0.0618     *
## offense_player_9_blocking_grades_block_percent_12w               -0.0894      0.9288      
## offense_player_9_receiving_grades_first_downs_12w                 0.3398      0.7340      
## offense_player_10_receiving_depth_medium_yprr_12w                -0.4871      0.6262      
## offense_player_10_blocking_grades_block_percent_12w               0.1273      0.8987      
## offense_player_10_receiving_grades_first_downs_12w                2.3821      0.0173    **
## offense_player_14_receiving_grades_first_downs_12w                0.6314      0.5278      
## offense_player_14_blocking_grades_pass_block_percent_12w          0.9740      0.3301      
## offense_player_17_blocking_grades_grades_offense_12w             -0.3007      0.7636      
## offense_player_18_blocking_grades_grades_offense_12w             -1.0119      0.3116      
## offense_player_19_blocking_grades_grades_offense_12w              0.7689      0.4420      
## offense_player_20_blocking_grades_grades_offense_12w             -0.3541      0.7233      
## offense_player_21_blocking_grades_grades_offense_12w              0.0087      0.9930      
## defense_player_1_pass_rushing_productivity_hurries_12w           -1.6798      0.0931     *
## defense_player_1_run_defense_grades_stops_12w                    -0.7211      0.4709      
## defense_player_2_pass_rushing_productivity_hurries_12w           -0.8922      0.3723      
## defense_player_2_run_defense_grades_stops_12w                     1.1231      0.2615      
## defense_player_3_pass_rushing_productivity_hurries_12w           -1.1249      0.2607      
## defense_player_3_run_defense_grades_stops_12w                     1.1812      0.2376      
## defense_player_4_pass_rushing_productivity_hurries_12w            0.2660      0.7903      
## defense_player_4_run_defense_grades_stops_12w                    -1.6622      0.0966     *
## defense_player_9_pass_rushing_productivity_hurries_12w           -0.9695      0.3324      
## defense_player_9_run_defense_grades_stops_12w                    -0.4607      0.6451      
## defense_player_9_coverage_schemes_zone_stops_12w                 -0.2713      0.7862      
## defense_player_10_pass_rushing_productivity_hurries_12w          -0.0693      0.9448      
## defense_player_10_run_defense_grades_stops_12w                   -2.4017      0.0164    **
## defense_player_10_coverage_schemes_zone_stops_12w                 0.9037      0.3662      
## defense_player_11_pass_rushing_productivity_hurries_12w           0.7239      0.4692      
## defense_player_11_run_defense_grades_stops_12w                   -1.3625      0.1731      
## defense_player_11_coverage_schemes_zone_stops_12w                 0.7034      0.4818      
## defense_player_12_pass_rushing_productivity_hurries_12w           1.5378      0.1242     .
## defense_player_12_run_defense_grades_stops_12w                   -0.5516      0.5813      
## defense_player_12_coverage_schemes_zone_stops_12w                -0.5320      0.5947      
## defense_player_15_defensive_grades_receptions_12w                 0.4958      0.6201      
## defense_player_15_coverage_grades_stops_12w                       1.2230      0.2214      
## defense_player_16_defensive_grades_receptions_12w                 0.1056      0.9159      
## defense_player_16_coverage_grades_stops_12w                      -0.0572      0.9544      
## defense_player_17_defensive_grades_receptions_12w                -0.1504      0.8805      
## defense_player_17_coverage_grades_stops_12w                       0.4826      0.6294      
## defense_player_20_defensive_grades_receptions_12w                -1.3688      0.1712      
## defense_player_20_coverage_grades_stops_12w                       1.0682      0.2855      
## defense_player_21_defensive_grades_receptions_12w                 0.2291      0.8188      
## defense_player_21_coverage_grades_stops_12w                      -0.4950      0.6207      
## defense_player_22_defensive_grades_receptions_12w                -1.7441      0.0812     *
## defense_player_22_coverage_grades_stops_12w                       1.9428      0.0521     *
## yardline_1_10                                                    -2.2469      0.0247    **
## yardline_11_20                                                    0.2831      0.7771      
## yardline_21_30                                                    0.1671      0.8673      
## yardline_41_50                                                    1.9582      0.0503     *
## yardline_51_60                                                    0.6792      0.4971      
## yardline_61_70                                                    1.1821      0.2372      
## yardline_71_80                                                    1.6940      0.0904     *
## yardline_81_90                                                    2.2953      0.0218    **
## yardline_91_100                                                   1.3835      0.1666      
## year2017_team_ARI                                                 0.1273      0.8987      
## year2017_team_BUF                                                -0.6337      0.5263      
## year2017_team_CHI                                                -0.3336      0.7387      
## year2017_team_CLE                                                 0.4806      0.6308      
## year2017_team_DAL                                                -1.0144      0.3104      
## year2017_team_DET                                                -0.7972      0.4254      
## year2017_team_GB                                                  1.9106      0.0561     *
## year2017_team_HOU                                                 1.5038      0.1327     .
## year2017_team_MIA                                                -1.2426      0.2141      
## year2017_team_MIN                                                -0.5415      0.5882      
## year2017_team_NE                                                 -0.0287      0.9771      
## year2017_team_SF                                                  1.7749      0.0760     *
## year2017_team_BAL                                                 0.0006      0.9996      
## year2017_team_DEN                                                 0.0776      0.9381      
## year2017_team_LA                                                  0.2590      0.7957      
## year2017_team_NYG                                                -0.4640      0.6427      
## year2017_team_OAK                                                -0.5552      0.5788      
## year2017_team_SEA                                                 0.3710      0.7107      
## year2017_team_CAR                                                 0.2562      0.7978      
## year2017_team_CIN                                                 0.5255      0.5993      
## year2017_team_IND                                                 0.6716      0.5019      
## year2017_team_NO                                                  0.3750      0.7077      
## year2017_team_PHI                                                 0.2848      0.7758      
## year2017_team_PIT                                                -1.1532      0.2489      
## year2017_team_TEN                                                 0.0421      0.9664      
## year2017_team_WAS                                                 0.2120      0.8321      
## year2017_team_KC                                                  1.4889      0.1366     .
## year2017_team_LAC                                                -0.0665      0.9470      
## year2017_team_NYJ                                                 0.7304      0.4652      
## year2017_team_TB                                                  0.0776      0.9381      
## year2017_team_ATL                                                -0.3251      0.7451      
## year2017_team_JAX                                                 0.3594      0.7194      
## year2018_team_ARI                                                 0.4387      0.6609      
## year2018_team_BAL                                                 0.4581      0.6469      
## year2018_team_CAR                                                 0.2899      0.7719      
## year2018_team_CLE                                                -0.2887      0.7728      
## year2018_team_DET                                                 0.3648      0.7153      
## year2018_team_HOU                                                 1.2032      0.2290      
## year2018_team_IND                                                -0.7147      0.4749      
## year2018_team_KC                                                  0.9254      0.3548      
## year2018_team_NYG                                                 0.3924      0.6948      
## year2018_team_OAK                                                -0.5798      0.5621      
## year2018_team_PHI                                                 0.5380      0.5906      
## year2018_team_SEA                                                -0.4244      0.6713      
## year2018_team_BUF                                                -0.6239      0.5327      
## year2018_team_CHI                                                -0.3671      0.7136      
## year2018_team_CIN                                                -0.2909      0.7712      
## year2018_team_DAL                                                -0.3782      0.7053      
## year2018_team_DEN                                                -0.0332      0.9735      
## year2018_team_GB                                                 -0.1900      0.8493      
## year2018_team_LAC                                                 0.3302      0.7413      
## year2018_team_NE                                                 -0.5944      0.5523      
## year2018_team_NO                                                  0.7683      0.4424      
## year2018_team_PIT                                                 0.5076      0.6117      
## year2018_team_SF                                                  0.6656      0.5057      
## year2018_team_MIA                                                 0.5445      0.5862      
## year2018_team_MIN                                                 0.1487      0.8818      
## year2018_team_NYJ                                                 0.7413      0.4586      
## year2018_team_TB                                                  0.2734      0.7846      
## year2018_team_ATL                                                 0.6794      0.4969      
## year2018_team_JAX                                                 0.1507      0.8802      
## year2018_team_LA                                                 -0.8604      0.3896      
## year2018_team_TEN                                                 0.5888      0.5560      
## year2018_team_WAS                                                -0.1525      0.8788      
## year2019_team_ARI                                                -0.7560      0.4497      
## year2019_team_BUF                                                -1.0157      0.3098      
## year2019_team_CHI                                                 0.4216      0.6734      
## year2019_team_CLE                                                 0.6832      0.4945      
## year2019_team_DAL                                                -0.4464      0.6553      
## year2019_team_IND                                                -0.6826      0.4949      
## year2019_team_JAX                                                 0.5007      0.6166      
## year2019_team_KC                                                 -0.1286      0.8977      
## year2019_team_LAC                                                -0.8681      0.3854      
## year2019_team_MIN                                                -0.4988      0.6180      
## year2019_team_NE                                                 -0.4983      0.6183      
## year2019_team_NO                                                 -1.0275      0.3043      
## year2019_team_PHI                                                 0.4326      0.6653      
## year2019_team_SEA                                                 0.2056      0.8371      
## year2019_team_SF                                                 -0.6082      0.5431      
## year2019_team_TB                                                 -1.2220      0.2218      
## year2019_team_BAL                                                -0.1190      0.9053      
## year2019_team_CAR                                                -0.5110      0.6094      
## year2019_team_DEN                                                 0.8717      0.3834      
## year2019_team_DET                                                -0.6254      0.5318      
## year2019_team_HOU                                                -0.2847      0.7759      
## year2019_team_LA                                                 -0.7671      0.4430      
## year2019_team_MIA                                                -2.0788      0.0377    **
## year2019_team_NYG                                                -1.1982      0.2309      
## year2019_team_NYJ                                                -1.9477      0.0515     *
## year2019_team_OAK                                                -0.2718      0.7858      
## year2019_team_PIT                                                -3.0036      0.0027   ***
## year2019_team_TEN                                                -1.4833      0.1381     .
## year2019_team_CIN                                                 0.4200      0.6745      
## year2019_team_WAS                                                -0.4921      0.6227      
## year2019_team_ATL                                                -0.0941      0.9250      
## year2019_team_GB                                                 -0.3500      0.7264      
## year2020_team_ATL                                                 0.0031      0.9976      
## year2020_team_BAL                                                 0.4295      0.6676      
## year2020_team_BUF                                                -0.0195      0.9844      
## year2020_team_CAR                                                 0.5390      0.5899      
## year2020_team_CIN                                                 0.3110      0.7558      
## year2020_team_DEN                                                -0.5081      0.6114      
## year2020_team_DET                                                -1.0304      0.3029      
## year2020_team_JAX                                                -0.8070      0.4197      
## year2020_team_KC                                                  0.3289      0.7423      
## year2020_team_LA                                                 -1.0368      0.2999      
## year2020_team_MIN                                                 0.8427      0.3995      
## year2020_team_NE                                                 -0.2689      0.7880      
## year2020_team_NO                                                  0.3183      0.7502      
## year2020_team_NYG                                                 0.0242      0.9807      
## year2020_team_SF                                                  0.2558      0.7981      
## year2020_team_WAS                                                 0.1145      0.9088      
## year2020_team_CHI                                                 0.2369      0.8128      
## year2020_team_DAL                                                -0.2944      0.7685      
## year2020_team_GB                                                 -0.0518      0.9587      
## year2020_team_HOU                                                -0.4094      0.6823      
## year2020_team_MIA                                                -0.9760      0.3291      
## year2020_team_NYJ                                                -0.1576      0.8748      
## year2020_team_TB                                                  0.3025      0.7623      
## year2020_team_TEN                                                -0.7247      0.4687      
## year2020_team_ARI                                                 0.2150      0.8298      
## year2020_team_CLE                                                -1.3700      0.1708      
## year2020_team_IND                                                -0.9237      0.3557      
## year2020_team_LAC                                                 0.2973      0.7663      
## year2020_team_PHI                                                 0.6829      0.4947      
## year2020_team_SEA                                                -0.3248      0.7454      
## year2020_team_LV                                                  0.7206      0.4712      
## year2020_team_PIT                                                -0.8393      0.4013      
## year2021_team_ATL                                                -1.8921      0.0586     *
## year2021_team_BUF                                                 0.0046      0.9963      
## year2021_team_CIN                                                -2.2506      0.0245    **
## year2021_team_DAL                                                -0.6471      0.5176      
## year2021_team_DEN                                                 0.4079      0.6834      
## year2021_team_DET                                                -0.8071      0.4196      
## year2021_team_KC                                                  0.1692      0.8656      
## year2021_team_LA                                                  0.0641      0.9489      
## year2021_team_LV                                                  0.4440      0.6571      
## year2021_team_MIN                                                -0.4188      0.6754      
## year2021_team_NE                                                  0.2422      0.8086      
## year2021_team_NO                                                 -0.0728      0.9420      
## year2021_team_NYG                                                 0.0310      0.9753      
## year2021_team_SF                                                 -0.1725      0.8631      
## year2021_team_TEN                                                -0.5491      0.5830      
## year2021_team_ARI                                                 0.6491      0.5163      
## year2021_team_BAL                                                 0.3938      0.6938      
## year2021_team_CAR                                                -0.6240      0.5327      
## year2021_team_CHI                                                -1.8577      0.0633     *
## year2021_team_GB                                                  0.6891      0.4908      
## year2021_team_IND                                                -0.4994      0.6175      
## year2021_team_LAC                                                 0.2225      0.8239      
## year2021_team_MIA                                                -0.1802      0.8570      
## year2021_team_NYJ                                                -0.3285      0.7425      
## year2021_team_PHI                                                -1.5801      0.1142     .
## year2021_team_SEA                                                -1.2580      0.2085      
## year2021_team_TB                                                  0.1492      0.8814      
## year2021_team_WAS                                                -0.9008      0.3677      
## year2021_team_CLE                                                -0.9498      0.3423      
## year2021_team_HOU                                                -0.4586      0.6466      
## year2021_team_JAX                                                -0.3564      0.7216      
## year2021_team_PIT                                                 0.2190      0.8266      
## year2022_team_ARI                                                -1.0579      0.2902      
## year2022_team_ATL                                                -1.9258      0.0542     *
## year2022_team_CAR                                                 0.9683      0.3330      
## year2022_team_CHI                                                -0.5078      0.6116      
## year2022_team_CIN                                                -1.0317      0.3023      
## year2022_team_HOU                                                -0.1219      0.9030      
## year2022_team_IND                                                -0.8728      0.3828      
## year2022_team_LAC                                                -0.9192      0.3581      
## year2022_team_MIA                                                -1.6202      0.1053     .
## year2022_team_SEA                                                -0.1255      0.9001      
## year2022_team_TB                                                  0.1026      0.9183      
## year2022_team_TEN                                                 1.2485      0.2119      
## year2022_team_WAS                                                -0.1685      0.8662      
## year2022_team_BAL                                                -1.4884      0.1367     .
## year2022_team_BUF                                                 0.1082      0.9139      
## year2022_team_DAL                                                -0.0348      0.9722      
## year2022_team_DET                                                -0.9906      0.3220      
## year2022_team_GB                                                 -0.9703      0.3320      
## year2022_team_JAX                                                -1.2773      0.2016      
## year2022_team_KC                                                 -0.7110      0.4771      
## year2022_team_LA                                                  1.2050      0.2283      
## year2022_team_LV                                                  1.0794      0.2805      
## year2022_team_NO                                                 -0.3219      0.7476      
## year2022_team_PHI                                                 0.3946      0.6932      
## year2022_team_PIT                                                 1.1657      0.2438      
## year2022_team_DEN                                                 0.4205      0.6741      
## year2022_team_MIN                                                -1.0259      0.3050      
## year2022_team_NE                                                  0.2926      0.7698      
## year2022_team_NYJ                                                -0.9425      0.3460      
## year2022_team_NYG                                                -0.5375      0.5909      
## year2022_team_SF                                                 -1.0360      0.3003      
## year2023_team_BAL                                                -0.7031      0.4820      
## year2023_team_CHI                                                -1.0825      0.2791      
## year2023_team_CLE                                                -0.9340      0.3504      
## year2023_team_GB                                                 -0.1825      0.8552      
## year2023_team_IND                                                 0.5534      0.5800      
## year2023_team_KC                                                 -0.0969      0.9228      
## year2023_team_LAC                                                 0.2806      0.7791      
## year2023_team_LV                                                 -0.0188      0.9850      
## year2023_team_MIA                                                 0.0559      0.9554      
## year2023_team_MIN                                                 1.0805      0.2800      
## year2023_team_NO                                                 -0.4626      0.6437      
## year2023_team_NYG                                                 0.1697      0.8653      
## year2023_team_SEA                                                -1.9761      0.0482    **
## year2023_team_SF                                                  0.0194      0.9845      
## year2023_team_WAS                                                 1.4442      0.1488     .
## year2023_team_ATL                                                -0.8646      0.3873      
## year2023_team_BUF                                                -0.6655      0.5058      
## year2023_team_CAR                                                 0.3519      0.7249      
## year2023_team_DAL                                                 0.5274      0.5979      
## year2023_team_DEN                                                 0.0092      0.9927      
## year2023_team_HOU                                                 0.0448      0.9643      
## year2023_team_LA                                                 -0.0424      0.9662      
## year2023_team_NE                                                  0.1826      0.8551      
## year2023_team_PHI                                                -0.2086      0.8347      
## year2023_team_PIT                                                -0.0678      0.9459      
## year2023_team_TEN                                                 0.0035      0.9972      
## year2023_team_ARI                                                -1.2461      0.2128      
## year2023_team_CIN                                                -1.0841      0.2784      
## year2023_team_DET                                                 0.2804      0.7792      
## year2023_team_TB                                                  0.3608      0.7183      
## year2023_team_JAX                                                -0.4413      0.6590      
## year2023_team_NYJ                                                 1.3663      0.1719      
## is_first_half                                                    -0.9335      0.3506      
## time_in_half                                                      1.4241      0.1545      
## home_attendance                                                  -0.3967      0.6916      
## GIMR                                                              1.3642      0.1726      
## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15
## 
## Adjusted R-squared: 0.1081876 
## 
## Variables with VIF &gt; 5:
##                                 prev_shotgun_rate 
##                                          9.511388 
##                              prev_singleback_rate 
##                                          5.518744 
##                                       cover1_rate 
##                                          6.431726 
##                                       cover3_rate 
##                                          7.116048 
##                         offense_formation_SHOTGUN 
##                                          6.736058 
## defense_player_22_defensive_grades_receptions_12w 
##                                          5.321338 
##       defense_player_22_coverage_grades_stops_12w 
##                                          5.199728 
##                                   home_attendance 
##                                         14.005435</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>r2_starter <span class="ot">&lt;-</span> <span class="fu">analyze_model</span>(ols_model_starter, <span class="st">&quot;Starter Model with GIMR&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 
##  ================================================================================ 
## MODEL: Starter Model with GIMR 
## ================================================================================ 
## 
## Variable                                                         t-value     p-value   sig
## ---------                                                        -------     -------  ----
## (Intercept)                                                       3.2999      0.0010   ***
## ydstogo                                                         -12.8481      0.0000   ***
## posteam_timeouts_remaining                                        0.9955      0.3196      
## defteam_timeouts_remaining                                        1.1720      0.2413      
## rush_attempt                                                      7.2093      0.0000   ***
## week                                                              0.3253      0.7450      
## temp                                                             -0.9414      0.3466      
## wind                                                              0.6060      0.5445      
## vegas_wp                                                          0.8311      0.4060      
## spread_line                                                      -0.8043      0.4213      
## total_line                                                        2.4533      0.0142    **
## prep_days                                                         0.8495      0.3957      
## overall_win_pct                                                   0.7563      0.4495      
## team_win_pct                                                      1.6297      0.1032     .
## prev_win_pct                                                     -2.2474      0.0247    **
## prev_shotgun_rate                                                 0.6894      0.4906      
## prev_singleback_rate                                              0.8252      0.4093      
## prev_empty_rate                                                   0.8674      0.3858      
## prev_iform_rate                                                   0.3659      0.7144      
## prev_shotgun_success                                              0.4072      0.6839      
## prev_singleback_success                                           0.6040      0.5459      
## prev_empty_success                                                0.3382      0.7352      
## prev_iform_success                                                3.0582      0.0022   ***
## prev_stop_rate_run                                               -0.1453      0.8845      
## prev_stop_rate_pass                                              -3.4681      0.0005   ***
## shotgun_rate                                                      1.1712      0.2416      
## singleback_rate                                                   0.6747      0.4999      
## empty_rate                                                       -0.3042      0.7610      
## iform_rate                                                       -1.5644      0.1178     .
## shotgun_success                                                  -2.4610      0.0139    **
## singleback_success                                               -1.2953      0.1953      
## empty_success                                                    -0.6918      0.4891      
## iform_success                                                    -1.5096      0.1312     .
## def_stop_rate_run                                                 1.5092      0.1313     .
## def_stop_rate_pass                                               -1.1086      0.2677      
## avg_pass_rushers                                                 -0.8609      0.3893      
## avg_box_defenders                                                -0.3760      0.7069      
## cover0_rate                                                      -0.3917      0.6953      
## cover1_rate                                                      -0.0287      0.9771      
## cover2_rate                                                      -0.1411      0.8878      
## cover3_rate                                                       1.1226      0.2617      
## cover4_rate                                                       1.0906      0.2755      
## cover6_rate                                                      -0.2920      0.7703      
## two_man_rate                                                      1.5285      0.1265     .
## prevent_rate                                                      2.3464      0.0190    **
## roof_outdoors                                                    -0.2116      0.8324      
## posteam_type_home                                                -1.3202      0.1868      
## offense_formation_EMPTY                                           0.2755      0.7830      
## offense_formation_SHOTGUN                                        -0.3017      0.7629      
## offense_formation_SINGLEBACK                                     -0.7907      0.4292      
## offense_formation_I_FORM                                         -0.7336      0.4632      
## starter_offense_player_1_passing_depth_short_grades_pass_12w      2.1095      0.0350    **
## starter_offense_player_1_passing_depth_medium_grades_pass...     -0.2034      0.8388      
## starter_offense_player_1_passing_depth_deep_grades_pass_12w      -0.8759      0.3811      
## starter_offense_player_1_rushing_grades_grades_run_12w           -0.6618      0.5082      
## starter_offense_player_4_rushing_grades_first_downs_12w          -0.0324      0.9741      
## starter_offense_player_4_pass_blocking_true_pass_set_grad...     -0.8294      0.4069      
## starter_offense_player_8_receiving_depth_medium_yprr_12w         -0.2218      0.8245      
## starter_offense_player_8_blocking_grades_block_percent_12w        0.3974      0.6911      
## starter_offense_player_8_receiving_grades_first_downs_12w         1.3689      0.1711      
## starter_offense_player_9_receiving_depth_medium_yprr_12w         -1.6389      0.1013     .
## starter_offense_player_9_blocking_grades_block_percent_12w       -1.3938      0.1635      
## starter_offense_player_9_receiving_grades_first_downs_12w        -0.1420      0.8871      
## starter_offense_player_10_receiving_depth_medium_yprr_12w        -0.8401      0.4009      
## starter_offense_player_10_blocking_grades_block_percent_12w       0.3466      0.7289      
## starter_offense_player_10_receiving_grades_first_downs_12w       -1.0726      0.2835      
## starter_offense_player_14_receiving_grades_first_downs_12w       -1.1959      0.2318      
## starter_offense_player_14_blocking_grades_pass_block_perc...     -1.2225      0.2216      
## starter_offense_player_17_blocking_grades_grades_offense_12w      1.5811      0.1139     .
## starter_offense_player_18_blocking_grades_grades_offense_12w     -0.9193      0.3580      
## starter_offense_player_19_blocking_grades_grades_offense_12w      0.1193      0.9051      
## starter_offense_player_20_blocking_grades_grades_offense_12w      1.6600      0.0970     *
## starter_offense_player_21_blocking_grades_grades_offense_12w     -0.0810      0.9355      
## starter_defense_player_1_pass_rushing_productivity_hurrie...     -0.6474      0.5174      
## starter_defense_player_1_run_defense_grades_stops_12w             0.6616      0.5083      
## starter_defense_player_2_pass_rushing_productivity_hurrie...     -1.1219      0.2620      
## starter_defense_player_2_run_defense_grades_stops_12w             1.1256      0.2604      
## starter_defense_player_3_pass_rushing_productivity_hurrie...     -0.0903      0.9281      
## starter_defense_player_3_run_defense_grades_stops_12w            -0.4760      0.6341      
## starter_defense_player_4_pass_rushing_productivity_hurrie...     -1.5140      0.1301     .
## starter_defense_player_4_run_defense_grades_stops_12w             0.3791      0.7046      
## starter_defense_player_9_pass_rushing_productivity_hurrie...      0.5592      0.5760      
## starter_defense_player_9_run_defense_grades_stops_12w             4.1687      0.0000   ***
## starter_defense_player_9_coverage_schemes_zone_stops_12w         -1.2903      0.1970      
## starter_defense_player_10_pass_rushing_productivity_hurri...      0.4331      0.6650      
## starter_defense_player_10_run_defense_grades_stops_12w            1.7766      0.0757     *
## starter_defense_player_10_coverage_schemes_zone_stops_12w        -0.8231      0.4105      
## starter_defense_player_11_pass_rushing_productivity_hurri...      0.2595      0.7953      
## starter_defense_player_11_run_defense_grades_stops_12w            1.4035      0.1605      
## starter_defense_player_11_coverage_schemes_zone_stops_12w        -0.1117      0.9111      
## starter_defense_player_12_pass_rushing_productivity_hurri...     -1.0522      0.2928      
## starter_defense_player_12_run_defense_grades_stops_12w            0.2711      0.7863      
## starter_defense_player_12_coverage_schemes_zone_stops_12w        -1.1734      0.2407      
## starter_defense_player_15_defensive_grades_receptions_12w        -0.4268      0.6696      
## starter_defense_player_15_coverage_grades_stops_12w              -1.0972      0.2726      
## starter_defense_player_16_defensive_grades_receptions_12w        -1.2496      0.2115      
## starter_defense_player_16_coverage_grades_stops_12w               0.3814      0.7029      
## starter_defense_player_17_defensive_grades_receptions_12w        -0.1402      0.8885      
## starter_defense_player_17_coverage_grades_stops_12w              -0.8640      0.3877      
## starter_defense_player_20_defensive_grades_receptions_12w         0.3551      0.7226      
## starter_defense_player_20_coverage_grades_stops_12w              -0.4918      0.6229      
## starter_defense_player_21_defensive_grades_receptions_12w        -0.4460      0.6557      
## starter_defense_player_21_coverage_grades_stops_12w               0.8038      0.4216      
## starter_defense_player_22_defensive_grades_receptions_12w        -0.2470      0.8049      
## starter_defense_player_22_coverage_grades_stops_12w              -0.2432      0.8079      
## yardline_1_10                                                    -2.3245      0.0202    **
## yardline_11_20                                                    0.0710      0.9434      
## yardline_21_30                                                    0.0324      0.9742      
## yardline_41_50                                                    1.9242      0.0544     *
## yardline_51_60                                                    0.5494      0.5828      
## yardline_61_70                                                    1.4792      0.1392     .
## yardline_71_80                                                    1.6298      0.1032     .
## yardline_81_90                                                    2.5883      0.0097   ***
## yardline_91_100                                                   1.0630      0.2879      
## year2017_team_ARI                                                 0.4331      0.6650      
## year2017_team_BUF                                                -0.5575      0.5772      
## year2017_team_CHI                                                -0.0162      0.9871      
## year2017_team_CLE                                                 0.7002      0.4838      
## year2017_team_DAL                                                -0.7624      0.4459      
## year2017_team_DET                                                -0.5358      0.5921      
## year2017_team_GB                                                  1.6987      0.0895     *
## year2017_team_HOU                                                 1.9519      0.0510     *
## year2017_team_MIA                                                -0.5783      0.5631      
## year2017_team_MIN                                                -0.6487      0.5166      
## year2017_team_NE                                                  0.0526      0.9580      
## year2017_team_SF                                                  2.2221      0.0263    **
## year2017_team_BAL                                                -0.1291      0.8973      
## year2017_team_DEN                                                -0.1019      0.9188      
## year2017_team_LA                                                  0.4017      0.6879      
## year2017_team_NYG                                                 0.0206      0.9836      
## year2017_team_OAK                                                 0.1163      0.9074      
## year2017_team_SEA                                                 0.6652      0.5060      
## year2017_team_CAR                                                 0.4859      0.6270      
## year2017_team_CIN                                                 0.8338      0.4045      
## year2017_team_IND                                                 0.6727      0.5012      
## year2017_team_NO                                                  0.4463      0.6554      
## year2017_team_PHI                                                 0.5984      0.5496      
## year2017_team_PIT                                                -1.1018      0.2706      
## year2017_team_TEN                                                 0.3633      0.7164      
## year2017_team_WAS                                                 0.0112      0.9911      
## year2017_team_KC                                                  1.3986      0.1620      
## year2017_team_LAC                                                 0.1830      0.8548      
## year2017_team_NYJ                                                 0.8458      0.3977      
## year2017_team_TB                                                  0.3442      0.7307      
## year2017_team_ATL                                                -0.1224      0.9026      
## year2017_team_JAX                                                 0.7556      0.4499      
## year2018_team_ARI                                                 1.0146      0.3104      
## year2018_team_BAL                                                 0.6800      0.4965      
## year2018_team_CAR                                                 0.4329      0.6651      
## year2018_team_CLE                                                -0.3541      0.7233      
## year2018_team_DET                                                 0.3249      0.7453      
## year2018_team_HOU                                                 1.0633      0.2877      
## year2018_team_IND                                                -0.4980      0.6185      
## year2018_team_KC                                                  0.3551      0.7226      
## year2018_team_NYG                                                 0.5385      0.5902      
## year2018_team_OAK                                                -0.1443      0.8853      
## year2018_team_PHI                                                 0.6937      0.4879      
## year2018_team_SEA                                                -0.3294      0.7419      
## year2018_team_BUF                                                -0.2769      0.7819      
## year2018_team_CHI                                                -0.1474      0.8828      
## year2018_team_CIN                                                -0.2752      0.7832      
## year2018_team_DAL                                                 0.0051      0.9959      
## year2018_team_DEN                                                 0.2327      0.8160      
## year2018_team_GB                                                 -0.0651      0.9481      
## year2018_team_LAC                                                 0.6548      0.5126      
## year2018_team_NE                                                 -1.0036      0.3157      
## year2018_team_NO                                                  0.8750      0.3816      
## year2018_team_PIT                                                 0.3461      0.7293      
## year2018_team_SF                                                  0.3438      0.7310      
## year2018_team_MIA                                                 0.5802      0.5618      
## year2018_team_MIN                                                 0.2183      0.8272      
## year2018_team_NYJ                                                 0.8383      0.4019      
## year2018_team_TB                                                  0.4025      0.6874      
## year2018_team_ATL                                                 0.6194      0.5357      
## year2018_team_JAX                                                 0.6639      0.5068      
## year2018_team_LA                                                 -1.1023      0.2704      
## year2018_team_TEN                                                 0.8385      0.4018      
## year2018_team_WAS                                                 0.2384      0.8116      
## year2019_team_ARI                                                -0.3602      0.7187      
## year2019_team_BUF                                                -1.1006      0.2711      
## year2019_team_CHI                                                 0.4803      0.6310      
## year2019_team_CLE                                                 0.8566      0.3917      
## year2019_team_DAL                                                -0.1482      0.8822      
## year2019_team_IND                                                -0.5032      0.6149      
## year2019_team_JAX                                                 0.9726      0.3308      
## year2019_team_KC                                                 -0.2492      0.8032      
## year2019_team_LAC                                                -0.5762      0.5645      
## year2019_team_MIN                                                -0.6163      0.5377      
## year2019_team_NE                                                 -0.1498      0.8810      
## year2019_team_NO                                                 -1.1793      0.2384      
## year2019_team_PHI                                                 0.4960      0.6199      
## year2019_team_SEA                                                 0.3307      0.7409      
## year2019_team_SF                                                  0.0709      0.9435      
## year2019_team_TB                                                 -0.9334      0.3507      
## year2019_team_BAL                                                 0.1147      0.9087      
## year2019_team_CAR                                                -0.2356      0.8138      
## year2019_team_DEN                                                 0.6202      0.5352      
## year2019_team_DET                                                -0.6087      0.5428      
## year2019_team_HOU                                                -0.0521      0.9585      
## year2019_team_LA                                                 -0.6343      0.5259      
## year2019_team_MIA                                                -2.4163      0.0157    **
## year2019_team_NYG                                                -0.8016      0.4228      
## year2019_team_NYJ                                                -1.2251      0.2206      
## year2019_team_OAK                                                 0.1821      0.8555      
## year2019_team_PIT                                                -2.2928      0.0219    **
## year2019_team_TEN                                                -1.0512      0.2932      
## year2019_team_CIN                                                 0.5504      0.5821      
## year2019_team_WAS                                                -0.3717      0.7101      
## year2019_team_ATL                                                 0.3721      0.7098      
## year2019_team_GB                                                 -0.4011      0.6884      
## year2020_team_ATL                                                 0.4436      0.6574      
## year2020_team_BAL                                                 0.8202      0.4121      
## year2020_team_BUF                                                 0.3396      0.7342      
## year2020_team_CAR                                                 0.9676      0.3333      
## year2020_team_CIN                                                 0.4600      0.6456      
## year2020_team_DEN                                                -0.4489      0.6535      
## year2020_team_DET                                                -0.6894      0.4906      
## year2020_team_JAX                                                -0.7233      0.4696      
## year2020_team_KC                                                  0.0885      0.9295      
## year2020_team_LA                                                 -0.7767      0.4374      
## year2020_team_MIN                                                 1.3630      0.1730      
## year2020_team_NE                                                  0.2593      0.7955      
## year2020_team_NO                                                  0.4405      0.6596      
## year2020_team_NYG                                                 0.4712      0.6375      
## year2020_team_SF                                                  0.7284      0.4664      
## year2020_team_WAS                                                 0.2762      0.7824      
## year2020_team_CHI                                                 0.3695      0.7118      
## year2020_team_DAL                                                 0.1407      0.8881      
## year2020_team_GB                                                  0.0951      0.9243      
## year2020_team_HOU                                                -0.9569      0.3387      
## year2020_team_MIA                                                -0.8331      0.4049      
## year2020_team_NYJ                                                 0.4741      0.6354      
## year2020_team_TB                                                  0.5817      0.5608      
## year2020_team_TEN                                                -0.5085      0.6111      
## year2020_team_ARI                                                 0.6950      0.4871      
## year2020_team_CLE                                                -1.0940      0.2740      
## year2020_team_IND                                                -0.6417      0.5211      
## year2020_team_LAC                                                 0.4345      0.6639      
## year2020_team_PHI                                                 1.2782      0.2013      
## year2020_team_SEA                                                -0.1939      0.8462      
## year2020_team_LV                                                  1.0626      0.2880      
## year2020_team_PIT                                                -0.7133      0.4757      
## year2021_team_ATL                                                -1.6057      0.1084     .
## year2021_team_BUF                                                -0.1030      0.9180      
## year2021_team_CIN                                                -1.4031      0.1607      
## year2021_team_DAL                                                -0.5751      0.5653      
## year2021_team_DEN                                                 0.8183      0.4132      
## year2021_team_DET                                                -0.8024      0.4224      
## year2021_team_KC                                                  0.1748      0.8612      
## year2021_team_LA                                                  0.2550      0.7987      
## year2021_team_LV                                                  0.7601      0.4472      
## year2021_team_MIN                                                -0.3943      0.6934      
## year2021_team_NE                                                  0.0541      0.9568      
## year2021_team_NO                                                  0.0565      0.9549      
## year2021_team_NYG                                                 0.3906      0.6961      
## year2021_team_SF                                                  0.0023      0.9981      
## year2021_team_TEN                                                 0.1431      0.8863      
## year2021_team_ARI                                                 1.0016      0.3166      
## year2021_team_BAL                                                 1.0054      0.3148      
## year2021_team_CAR                                                -0.7017      0.4829      
## year2021_team_CHI                                                -1.6161      0.1062     .
## year2021_team_GB                                                  0.8266      0.4085      
## year2021_team_IND                                                -0.4505      0.6524      
## year2021_team_LAC                                                 0.2186      0.8270      
## year2021_team_MIA                                                 0.3258      0.7446      
## year2021_team_NYJ                                                -0.2608      0.7943      
## year2021_team_PHI                                                -1.2844      0.1991      
## year2021_team_SEA                                                -1.1575      0.2471      
## year2021_team_TB                                                  0.0733      0.9415      
## year2021_team_WAS                                                -0.3680      0.7129      
## year2021_team_CLE                                                -0.4779      0.6327      
## year2021_team_HOU                                                -0.6113      0.5411      
## year2021_team_JAX                                                -0.0661      0.9473      
## year2021_team_PIT                                                 0.2931      0.7694      
## year2022_team_ARI                                                -0.8134      0.4160      
## year2022_team_ATL                                                -1.7295      0.0838     *
## year2022_team_CAR                                                 0.7117      0.4767      
## year2022_team_CHI                                                -0.2353      0.8140      
## year2022_team_CIN                                                -0.8436      0.3989      
## year2022_team_HOU                                                -0.0494      0.9606      
## year2022_team_IND                                                -0.6984      0.4850      
## year2022_team_LAC                                                -0.9396      0.3475      
## year2022_team_MIA                                                -1.4041      0.1604      
## year2022_team_SEA                                                -0.2174      0.8279      
## year2022_team_TB                                                  0.0823      0.9344      
## year2022_team_TEN                                                 1.9331      0.0533     *
## year2022_team_WAS                                                 0.5222      0.6016      
## year2022_team_BAL                                                -1.1423      0.2534      
## year2022_team_BUF                                                 0.5872      0.5571      
## year2022_team_DAL                                                 0.3111      0.7558      
## year2022_team_DET                                                -0.1097      0.9126      
## year2022_team_GB                                                 -0.5444      0.5862      
## year2022_team_JAX                                                -0.8448      0.3983      
## year2022_team_KC                                                 -0.8539      0.3932      
## year2022_team_LA                                                  1.2961      0.1950      
## year2022_team_LV                                                  1.1208      0.2625      
## year2022_team_NO                                                  0.0612      0.9512      
## year2022_team_PHI                                                 0.6679      0.5043      
## year2022_team_PIT                                                 1.0264      0.3048      
## year2022_team_DEN                                                 0.6533      0.5136      
## year2022_team_MIN                                                -0.8086      0.4188      
## year2022_team_NE                                                  0.6175      0.5369      
## year2022_team_NYJ                                                -0.9152      0.3601      
## year2022_team_NYG                                                -0.3460      0.7293      
## year2022_team_SF                                                 -1.0791      0.2806      
## year2023_team_BAL                                                -0.1490      0.8816      
## year2023_team_CHI                                                -0.8852      0.3761      
## year2023_team_CLE                                                -0.9296      0.3527      
## year2023_team_GB                                                  0.2151      0.8297      
## year2023_team_IND                                                 0.6457      0.5185      
## year2023_team_KC                                                  0.1448      0.8849      
## year2023_team_LAC                                                 0.3673      0.7134      
## year2023_team_LV                                                  0.4851      0.6277      
## year2023_team_MIA                                                 0.0936      0.9254      
## year2023_team_MIN                                                 1.6910      0.0909     *
## year2023_team_NO                                                 -0.2075      0.8356      
## year2023_team_NYG                                                 0.3898      0.6967      
## year2023_team_SEA                                                -2.2262      0.0261    **
## year2023_team_SF                                                  0.5909      0.5546      
## year2023_team_WAS                                                 1.6905      0.0910     *
## year2023_team_ATL                                                -0.5790      0.5626      
## year2023_team_BUF                                                -0.5680      0.5700      
## year2023_team_CAR                                                 1.0405      0.2982      
## year2023_team_DAL                                                 0.9658      0.3342      
## year2023_team_DEN                                                 0.0228      0.9818      
## year2023_team_HOU                                                 0.2684      0.7884      
## year2023_team_LA                                                  0.2604      0.7945      
## year2023_team_NE                                                  0.6050      0.5452      
## year2023_team_PHI                                                -0.2467      0.8051      
## year2023_team_PIT                                                -0.1640      0.8697      
## year2023_team_TEN                                                 0.1689      0.8659      
## year2023_team_ARI                                                -0.3760      0.7069      
## year2023_team_CIN                                                -0.4701      0.6383      
## year2023_team_DET                                                 0.4766      0.6336      
## year2023_team_TB                                                  1.2157      0.2242      
## year2023_team_JAX                                                -0.3406      0.7335      
## year2023_team_NYJ                                                 1.3900      0.1646      
## is_first_half                                                    -0.7833      0.4335      
## time_in_half                                                      1.6289      0.1034     .
## home_attendance                                                  -0.1982      0.8429      
## GIMR                                                              1.5079      0.1317     .
## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15
## 
## Adjusted R-squared: 0.1097566 
## 
## Variables with VIF &gt; 5:
##         prev_shotgun_rate      prev_singleback_rate           prev_iform_rate 
##                 10.203998                  5.948495                  5.055627 
##               cover1_rate               cover3_rate offense_formation_SHOTGUN 
##                  6.238061                  6.565899                  5.638981 
##           home_attendance 
##                 13.846742</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co"># Compare R-squared values</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>, <span class="fu">paste</span>(<span class="fu">rep</span>(<span class="st">&quot;=&quot;</span>, <span class="dv">80</span>), <span class="at">collapse=</span><span class="st">&quot;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 
##  ================================================================================</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MODEL COMPARISON - Adjusted R-squared values</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## MODEL COMPARISON - Adjusted R-squared values</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="fu">rep</span>(<span class="st">&quot;=&quot;</span>, <span class="dv">80</span>), <span class="at">collapse=</span><span class="st">&quot;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## ================================================================================</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Player Model with GIMR:&quot;</span>, r2_player, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Player Model with GIMR: 0.1081876</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Starter Model with GIMR:&quot;</span>, r2_starter, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Starter Model with GIMR: 0.1097566</code></pre>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIkhlY2ttYW4gU2VsZWN0aW9uIE1vZGVsIEFuYWx5c2lzIg0Kb3V0cHV0OiBodG1sX2RvY3VtZW50DQotLS0NCg0KYGBge3Igb3B0aW9ucywgaW5jbHVkZT1GQUxTRX0NCm9wdGlvbnMobWF4LnByaW50PTEwMDAwKQ0KYGBgDQoNCmBgYHtyfQ0KbGlicmFyeShkYXRhLnRhYmxlKQ0Kb3V0Y29tZV9kYXRhIDwtIGZyZWFkKCJwcmVkaWN0X291dGNvbWUuY3N2Lmd6IikNCnNlbGVjdF9kYXRhIDwtIGZyZWFkKCJwcmVkaWN0X3NlbGVjdC5jc3YuZ3oiKQ0KYGBgDQoNCmBgYHtyfQ0Kc2VsZWN0X2RhdGFbLCBzY29yZV9kaWZmIDo9IGFzLmludGVnZXIoc2NvcmVfZGlmZiA+IDApXQ0KYGBgDQoNCg0KYGBge3J9DQpzZWxlY3RfZGF0YVssIGF0dGVtcHQgOj0gYXMubnVtZXJpYyhhcy5jaGFyYWN0ZXIoYXR0ZW1wdCkpXQ0KYGBgDQoNCmBgYHtyfQ0KbGlicmFyeShkYXRhLnRhYmxlKQ0KbGlicmFyeSh4Z2Jvb3N0KQ0KbGlicmFyeShST0NSKQ0KbGlicmFyeShwYXJhbGxlbCkNCg0KIyBQcmVwYXJlIHRoZSBYR0Jvb3N0IG1hdHJpY2VzDQp4cyA8LSBtb2RlbC5tYXRyaXgofiAuIC0gMSAtIGF0dGVtcHQgLSBteV9pZCwgZGF0YSA9IHNlbGVjdF9kYXRhKQ0KeSA8LSBhcy5udW1lcmljKGFzLmNoYXJhY3RlcihzZWxlY3RfZGF0YSRhdHRlbXB0KSkNCg0KDQojIENyZWF0ZSBwYXJhbWV0ZXIgZ3JpZA0KDQojIENyZWF0ZSBwYXJhbWV0ZXIgZ3JpZA0KZ3JpZCA8LSBleHBhbmQuZ3JpZCgNCiAgZXRhID0gc2VxKDAuMDAxLCAwLjAzLCBieSA9IDAuMDEpLA0KICBtYXhfZGVwdGggPSBzZXEoNSwgNSwgYnkgPSAyKSwNCiAgbWluX2NoaWxkX3dlaWdodCA9IHNlcSgxLCAxLCBieSA9IDEpLCAgICAgICAgDQogIHN1YnNhbXBsZSA9IHNlcSgxLCAxLCBieSA9IDAuMiksDQogIGNvbHNhbXBsZV9ieXRyZWUgPSBzZXEoMSwgMSwgYnkgPSAwLjIpLA0KICBsYW1iZGEgPSBzZXEoMSwgMSwgYnkgPSAxKSwgICAgICAgICAgICAgICAgDQogIGFscGhhID0gc2VxKDAsIDAsIGJ5ID0gMSksICAgICAgICAgICAgICAgICAgDQogIGdhbW1hID0gc2VxKDAsIDAsIGJ5ID0gMC4xKSwgICAgICAgICAgICAgICANCiAgbnJvdW5kcyA9IHNlcSgxMDAsIDI1MCwgYnkgPSA1MCkNCikNCg0KDQojIFNhbXBsZSBncmlkIHBvaW50cw0KY29uZl9sZXYgPC0gLjk1DQpudW1fbWF4IDwtIDUNCm4gPC0gY2VpbGluZyhsb2coMS1jb25mX2xldikvbG9nKDEtbnVtX21heC9ucm93KGdyaWQpKSkNCmluZCA8LSBzYW1wbGUobnJvdyhncmlkKSwgbiwgcmVwbGFjZSA9IEZBTFNFKQ0KcmdyaWQgPC0gZ3JpZFtpbmQsIF0NCg0KIyBTZXQgdXAgcGFyYWxsZWwgcHJvY2Vzc2luZw0KbmMgPC0gZGV0ZWN0Q29yZXMoKSAtIDENCg0KIyBDYWxjdWxhdGUgc2NhbGVfcG9zX3dlaWdodCBmb3IgaW1iYWxhbmNlZCBkYXRhc2V0DQpzY2FsZV9wb3Nfd2VpZ2h0IDwtIHN1bSh5ID09IDApIC8gc3VtKHkgPT0gMSkNCg0KIyBWYWxpZGF0aW9uIHBoYXNlDQojY2F0KCJcblBoYXNlIDE6IFZhbGlkYXRpb24gUGhhc2VcbiIpDQpuX3ZhbGlkYXRpb25zIDwtIDMNCnZhbGlkYXRpb25fcmVzdWx0cyA8LSBtYXRyaXgobnJvdyA9IG5yb3cocmdyaWQpLCBuY29sID0gbl92YWxpZGF0aW9ucykNCg0KZm9yIChqIGluIDE6bnJvdyhyZ3JpZCkpIHsNCiAgI2NhdCgiXG5UZXN0aW5nIHBhcmFtZXRlciBzZXQiLCBqLCAib2YiLCBucm93KHJncmlkKSwgIlxuIikNCiAgDQogIGZvciAoaSBpbiAxOm5fdmFsaWRhdGlvbnMpIHsNCiAgICAjY2F0KCJcblZhbGlkYXRpb24gaXRlcmF0aW9uIiwgaSwgIm9mIiwgbl92YWxpZGF0aW9ucywgIlxuIikgICAgICAgICAgICAgDQogICAgIyBDcmVhdGUgdmFsaWRhdGlvbiBzcGxpdA0KICAgIGlkeCA8LSB1bmlxdWUoc2FtcGxlKG5yb3coeHMpLCBucm93KHhzKSwgVFJVRSkpDQogICAgdHJhaW5feCA8LSB4c1tpZHgsIF0NCiAgICB0cmFpbl95IDwtIHlbaWR4XQ0KICAgIHZhbF94IDwtIHhzWy1pZHgsIF0NCiAgICB2YWxfeSA8LSB5Wy1pZHhdDQogICAgDQogICAgcHJtIDwtIGxpc3QoDQogICAgICBib29zdGVyID0gImdidHJlZSIsDQogICAgICBvYmplY3RpdmUgPSAiYmluYXJ5OmxvZ2lzdGljIiwNCiAgICAgIG1heF9kZXB0aCA9IHJncmlkW2osICJtYXhfZGVwdGgiXSwNCiAgICAgIGV0YSA9IHJncmlkW2osICJldGEiXSwNCiAgICAgIHN1YnNhbXBsZSA9IHJncmlkW2osICJzdWJzYW1wbGUiXSwNCiAgICAgIGNvbHNhbXBsZV9ieXRyZWUgPSByZ3JpZFtqLCAiY29sc2FtcGxlX2J5dHJlZSJdLA0KICAgICAgZ2FtbWEgPSByZ3JpZFtqLCAiZ2FtbWEiXSwNCiAgICAgIG1pbl9jaGlsZF93ZWlnaHQgPSByZ3JpZFtqLCAibWluX2NoaWxkX3dlaWdodCJdLA0KICAgICAgYWxwaGEgPSByZ3JpZFtqLCAiYWxwaGEiXSwNCiAgICAgIGxhbWJkYSA9IHJncmlkW2osICJsYW1iZGEiXSwNCiAgICAgIHNjYWxlX3Bvc193ZWlnaHQgPSBzY2FsZV9wb3Nfd2VpZ2h0LA0KICAgICAgbnRocmVhZCA9IG5jDQogICAgKQ0KICAgIA0KICAgIGRtX3RyYWluIDwtIHhnYi5ETWF0cml4KGRhdGEgPSB0cmFpbl94LCBsYWJlbCA9IHRyYWluX3kpDQogICAgbWRsIDwtIHhnYi50cmFpbigNCiAgICAgIHBhcmFtcyA9IHBybSwNCiAgICAgIGRhdGEgPSBkbV90cmFpbiwNCiAgICAgIG5yb3VuZHMgPSByZ3JpZFtqLCAibnJvdW5kcyJdLA0KICAgICAgdmVyYm9zZSA9IEZBTFNFDQogICAgKQ0KICAgIA0KICAgIHAgPC0gcHJlZGljdChtZGwsIHhnYi5ETWF0cml4KGRhdGEgPSB2YWxfeCkpDQogICAgcHJlZCA8LSBwcmVkaWN0aW9uKHAsIHZhbF95KQ0KICAgIHZhbGlkYXRpb25fcmVzdWx0c1tqLCBpXSA8LSBwZXJmb3JtYW5jZShwcmVkLCAiYXVjIilAeS52YWx1ZXNbWzFdXQ0KICB9DQp9DQoNCiMgUnVuIDEwMCB0ZXN0cyB3aXRoIGJlc3QgcGFyYW1ldGVycw0KY2F0KCJcblJ1bm5pbmcgWCB0ZXN0IGl0ZXJhdGlvbnMgd2l0aCBiZXN0IHBhcmFtZXRlcnMuLi5cbiIpDQp0ZXN0X2F1Y3MgPC0gYygpDQoNCmJlc3RfcGFyYW1zX2lkeCA8LSB3aGljaC5tYXgocm93TWVhbnModmFsaWRhdGlvbl9yZXN1bHRzKSkNCmJlc3RfcGFyYW1zIDwtIHJncmlkW2Jlc3RfcGFyYW1zX2lkeCxdDQoNCiMgVHJhaW4gZmluYWwgbW9kZWwgd2l0aCBiZXN0IHBhcmFtZXRlcnMNCmJlc3RfcGFyYW1zX2xpc3QgPC0gYXMubGlzdChiZXN0X3BhcmFtc1std2hpY2gobmFtZXMoYmVzdF9wYXJhbXMpID09ICJucm91bmRzIildKQ0KYmVzdF9wYXJhbXNfbGlzdCRib29zdGVyIDwtICJnYnRyZWUiDQpiZXN0X3BhcmFtc19saXN0JG9iamVjdGl2ZSA8LSAiYmluYXJ5OmxvZ2lzdGljIg0KYmVzdF9wYXJhbXNfbGlzdCRzY2FsZV9wb3Nfd2VpZ2h0IDwtIHNjYWxlX3Bvc193ZWlnaHQNCmJlc3RfcGFyYW1zX2xpc3QkbnRocmVhZCA8LSBuYw0KDQpmb3IoaSBpbiAxOjIwKSB7DQogICMgQ3JlYXRlIHRlc3Qgc3BsaXQNCiAgaWR4IDwtIHVuaXF1ZShzYW1wbGUobnJvdyh4cyksIG5yb3coeHMpLCBUKSkNCiAgdHJhaW5feCA8LSB4c1tpZHgsIF0NCiAgdHJhaW5feSA8LSB5W2lkeF0NCiAgdGVzdF94IDwtIHhzWy1pZHgsIF0NCiAgdGVzdF95IDwtIHlbLWlkeF0NCiAgDQogICMgVHJhaW4gbW9kZWwgb24gZnVsbCB1bmJhbGFuY2VkIGRhdGFzZXQNCiAgZG1fdHJhaW4gPC0geGdiLkRNYXRyaXgoZGF0YSA9IHRyYWluX3gsIGxhYmVsID0gdHJhaW5feSkNCiAgbWRsIDwtIHhnYi50cmFpbigNCiAgICBwYXJhbXMgPSBiZXN0X3BhcmFtc19saXN0LA0KICAgIGRhdGEgPSBkbV90cmFpbiwNCiAgICBucm91bmRzID0gYmVzdF9wYXJhbXNbWyJucm91bmRzIl1dLA0KICAgIHZlcmJvc2UgPSBGQUxTRQ0KICApDQogIA0KICAjIFRlc3Qgb24gdW5iYWxhbmNlZCB0ZXN0IHNldA0KICBwIDwtIHByZWRpY3QobWRsLCB4Z2IuRE1hdHJpeChkYXRhID0gdGVzdF94KSkNCiAgcHJlZCA8LSBwcmVkaWN0aW9uKHAsIHRlc3RfeSkNCiAgdGVzdF9hdWNzW2ldIDwtIHBlcmZvcm1hbmNlKHByZWQsICJhdWMiKUB5LnZhbHVlc1tbMV1dDQp9DQojIFByaW50IHJlc3VsdHMNCmNhdCgiXG5UZXN0IFJlc3VsdHMgb3ZlciAxMDAgaXRlcmF0aW9uczpcbiIpDQpjYXQoIk1lYW4gQVVDOiIsIG1lYW4odGVzdF9hdWNzKSwgIlxuIikNCmNhdCgiU0QgQVVDOiIsIHNkKHRlc3RfYXVjcyksICJcbiIpDQpjYXQoIjk1JSBDSToiLCBtZWFuKHRlc3RfYXVjcykgLSAxLjk2ICogc2QodGVzdF9hdWNzKSwgDQogICAgInRvIiwgbWVhbih0ZXN0X2F1Y3MpICsgMS45NiAqIHNkKHRlc3RfYXVjcyksICJcbiIpDQoNCiMgUGxvdHRpbmcgQVVDIGRpc3RyaWJ1dGlvbg0KcGxvdCh0ZXN0X2F1Y3MsIGNvbD0icmVkIiwgcGNoPTIwLA0KICAgICBtYWluPSJBVUMgVGVzdCBEaXN0cmlidXRpb24iLA0KICAgICB4bGFiPSJJdGVyYXRpb24iLCB5bGFiPSJBVUMiKQ0KYWJsaW5lKGg9bWVhbih0ZXN0X2F1Y3MpLCBjb2w9ImJsdWUiLCBsd2Q9MiwgbHR5PTIpICAjIEFkZCB0aGlzIGxpbmUgdG8gc2hvdyBtZWFuDQphYmxpbmUoaD1tZWFuKHRlc3RfYXVjcykgLSAxLjk2ICogc2QodGVzdF9hdWNzKSwgY29sPSJncmVlbiIsIGx3ZD0yLCBsdHk9MykNCmFibGluZShoPW1lYW4odGVzdF9hdWNzKSArIDEuOTYgKiBzZCh0ZXN0X2F1Y3MpLCBjb2w9ImdyZWVuIiwgbHdkPTIsIGx0eT0zKQ0KbGVnZW5kKCJib3R0b21yaWdodCIsIA0KICAgICAgIGxlZ2VuZD1jKCJBVUMgVmFsdWVzIiwgIk1lYW4iLCAiOTUlIENJIEJvdW5kcyIpLA0KICAgICAgIGNvbD1jKCJyZWQiLCAiYmx1ZSIsICJncmVlbiIpLA0KICAgICAgIGx0eT1jKE5BLCAyLCAzKSwNCiAgICAgICBwY2g9YygyMCwgTkEsIE5BKSkNCg0KIyBOb3cgdHJhaW4gZmluYWwgbW9kZWwgb24gZnVsbCBkYXRhIGZvciB6IHNjb3Jlcw0KZG1fZnVsbCA8LSB4Z2IuRE1hdHJpeChkYXRhID0geHMsIGxhYmVsID0geSkNCmZpbmFsX21vZGVsIDwtIHhnYi50cmFpbigNCiAgcGFyYW1zID0gYmVzdF9wYXJhbXNfbGlzdCwNCiAgZGF0YSA9IGRtX2Z1bGwsDQogIG5yb3VuZHMgPSBiZXN0X3BhcmFtc1tbIm5yb3VuZHMiXV0sDQogIHZlcmJvc2UgPSBGQUxTRQ0KKQ0KDQojIEdldCBwcm9iYWJpbGl0eSBwcmVkaWN0aW9ucyAoeikgZm9yIEFMTCBkYXRhDQp6IDwtIHByZWRpY3QoZmluYWxfbW9kZWwsIHhnYi5ETWF0cml4KGRhdGEgPSB4cykpDQpgYGANCg0KDQpgYGB7cn0NCiMgQ2FsY3VsYXRlIHJlc2lkdWFscyBmb3IgWEdCb29zdCBwcmVkaWN0aW9ucw0KeSA8LSBhcy5udW1lcmljKGFzLmNoYXJhY3RlcihzZWxlY3RfZGF0YSRhdHRlbXB0KSkNCnJlc2lkdWFscyA8LSB5IC0geg0KDQojIEhpc3RvZ3JhbSBvZiByZXNpZHVhbHMNCmhpc3QocmVzaWR1YWxzLCBtYWluPSJEaXN0cmlidXRpb24gb2YgWEdCb29zdCBNb2RlbCBSZXNpZHVhbHMiLCB4bGFiPSJSZXNpZHVhbCIsIGJyZWFrcz0xMDApDQpgYGANCg0KYGBge3J9DQojIHBsb3Qgb3V0IHRoZSB6IHZhbHVlc1wNCnBsb3QoZGVuc2l0eSh6KSwgDQogICAgIG1haW4gPSAiRGVuc2l0eSBvZiBaIFByZWRpY3Rpb25zIiwNCiAgICAgeGxhYiA9ICJQcmVkaWN0ZWQgUHJvYmFiaWxpdHkgb2YgQXR0ZW1wdCIsDQogICAgIHlsYWIgPSAiRGVuc2l0eSIpDQpgYGANCg0KYGBge3J9DQojIENhbGN1bGF0ZSBHSU1SIChsYW1iZGEpIFRoaXMgaXMgR2VuZXJhbGl6ZWQgaW52ZXJzZSBtaWxscyByYXRpbw0KR0lNUiA8LSBkbm9ybShxbm9ybSh6KSkgLyAoMSAtIHBub3JtKHFub3JtKHopKSkNCg0KIyBBZGQgR0lNUiB0byB0aGUgZGF0YQ0Kc2VsZWN0X2RhdGFbLCBHSU1SIDo9IEdJTVJdDQoNCiMgUHJpbnQgdmFyaWFibGUgaW1wb3J0YQ0KYGBgDQoNCmBgYHtyfQ0KIyBDcmVhdGUgYSBkYXRhLnRhYmxlIHdpdGgganVzdCBteV9pZCBhbmQgR0lNUiBmcm9tIHNlbGVjdF9kYXRhDQpHSU1SX2R0IDwtIGRhdGEudGFibGUobXlfaWQgPSBzZWxlY3RfZGF0YSRteV9pZCwgR0lNUiA9IEdJTVIpDQoNCiMgQWRkIEdJTVIgdG8gb3V0Y29tZV9kYXRhIGJ5IG1hdGNoaW5nIG9uIG15X2lkDQpvdXRjb21lX2RhdGFbR0lNUl9kdCwgR0lNUiA6PSBpLkdJTVIsIG9uID0gIm15X2lkIl0NCmBgYA0KDQpgYGB7cn0NCiMgIyBFeGlzdGluZyBjb2RlDQojIG91dGNvbWVfZGF0YSA8LSBvdXRjb21lX2RhdGFbLCBteV9pZCA6PSBOVUxMXQ0KIyBvdXRjb21lX2RhdGFbLCB5YXJkbGluZV8zMV80MCA6PSBOVUxMXQ0KIyBvdXRjb21lX2RhdGFbLCB5ZWFyMjAyMl90ZWFtX0NMRSA6PSBOVUxMXSAjIHRpZWQgZm9yIG1vc3QgYXR0ZW1wdHMgd2l0aCAzMQ0KDQojIFJlbW92ZSBhbGwgY29sdW1ucyB3aXRoICJfcHJlc2VudCIgaW4gdGhlIG5hbWUNCnByZXNlbnRfY29scyA8LSBncmVwKCJfcHJlc2VudCIsIG5hbWVzKG91dGNvbWVfZGF0YSksIHZhbHVlID0gVFJVRSkNCmZvciAoY29sIGluIHByZXNlbnRfY29scykgew0KICBvdXRjb21lX2RhdGFbLCAoY29sKSA6PSBOVUxMXQ0KfQ0KYGBgDQoNCg0KYGBge3J9DQoNCiMgQ3JlYXRlIGNvcGllcyBvZiBvdXRjb21lX2RhdGEgZm9yIGRpZmZlcmVudCBtb2RlbHMNCm91dGNvbWVfZGF0YV9wbGF5ZXIgPC0gY29weShvdXRjb21lX2RhdGEpDQpvdXRjb21lX2RhdGFfc3RhcnRlciA8LSBjb3B5KG91dGNvbWVfZGF0YSkNCg0KIyBSZW1vdmUgc3BlY2lmaWMgY29sdW1ucyBhcyBpbiBvcmlnaW5hbCBjb2RlDQpmb3IgKGR0IGluIGxpc3Qob3V0Y29tZV9kYXRhX3BsYXllciwgb3V0Y29tZV9kYXRhX3N0YXJ0ZXIpKSB7DQogIGR0WywgbXlfaWQgOj0gTlVMTF0NCiAgZHRbLCB5YXJkbGluZV8zMV80MCA6PSBOVUxMXQ0KICBkdFssIHllYXIyMDIyX3RlYW1fQ0xFIDo9IE5VTExdICMgdGllZCBmb3IgbW9zdCBhdHRlbXB0cyB3aXRoIDMxDQogIA0KICAjIFJlbW92ZSBhdHRlbmRhbmNlIHZhcmlhYmxlcw0KICBkdFssIGF0dGVuZGFuY2VfcGN0IDo9IE5VTExdDQogIGR0WywgYXR0ZW5kYW5jZV9yYXcgOj0gTlVMTF0NCiAgZHRbLCB2ZWdhc193cF9wb3N0ZWFtIDo9IE5VTExdDQp9DQoNCiMgRm9yIHBsYXllciBtb2RlbHMsIHJlbW92ZSBzdGFydGVyIGNvbHVtbnMNCnBsYXllcl9jb2xzIDwtIGdyZXAoIl5zdGFydGVyXyIsIG5hbWVzKG91dGNvbWVfZGF0YV9wbGF5ZXIpLCB2YWx1ZSA9IFRSVUUpDQpmb3IgKGNvbCBpbiBwbGF5ZXJfY29scykgew0KICBvdXRjb21lX2RhdGFfcGxheWVyWywgKGNvbCkgOj0gTlVMTF0NCn0NCg0KIyBGb3Igc3RhcnRlciBtb2RlbHMsIHJlbW92ZSBwbGF5ZXIgY29sdW1ucw0Kc3RhcnRlcl9jb2xzIDwtIGdyZXAoIl4ob2ZmZW5zZXxkZWZlbnNlKV9wbGF5ZXJfIiwgbmFtZXMob3V0Y29tZV9kYXRhX3N0YXJ0ZXIpLCB2YWx1ZSA9IFRSVUUpDQpmb3IgKGNvbCBpbiBzdGFydGVyX2NvbHMpIHsNCiAgb3V0Y29tZV9kYXRhX3N0YXJ0ZXJbLCAoY29sKSA6PSBOVUxMXQ0KfQ0KDQojIEVuc3VyZSBjb252ZXJzaW9uIGlzIG51bWVyaWMNCmZvciAoZHQgaW4gbGlzdChvdXRjb21lX2RhdGFfcGxheWVyLCBvdXRjb21lX2RhdGFfc3RhcnRlcikpIHsNCiAgZHRbLCBjb252ZXJzaW9uIDo9IGFzLm51bWVyaWMoYXMuY2hhcmFjdGVyKGNvbnZlcnNpb24pKV0NCn0NCg0KIyBNT0RFTCAxOiBQbGF5ZXIgbW9kZWwgd2l0aCBHSU1SDQpvbHNfbW9kZWxfcGxheWVyIDwtIGxtKGNvbnZlcnNpb24gfiAuLCBkYXRhID0gb3V0Y29tZV9kYXRhX3BsYXllcikNCg0KIyBNT0RFTCAyOiBTdGFydGVyIG1vZGVsIHdpdGggR0lNUg0Kb2xzX21vZGVsX3N0YXJ0ZXIgPC0gbG0oY29udmVyc2lvbiB+IC4sIGRhdGEgPSBvdXRjb21lX2RhdGFfc3RhcnRlcikNCg0KIyBGdW5jdGlvbiB0byBhbmFseXplIGFuZCBwcmludCBtb2RlbCByZXN1bHRzDQphbmFseXplX21vZGVsIDwtIGZ1bmN0aW9uKG1vZGVsLCBtb2RlbF9uYW1lKSB7DQogIGxpYnJhcnkoc2FuZHdpY2gpDQogIGxpYnJhcnkobG10ZXN0KQ0KICANCiAgIyBHZXQgSEMwLWFkanVzdGVkIHQtdmFsdWVzIGFuZCBwLXZhbHVlcw0KICByb2J1c3RfdGVzdCA8LSBjb2VmdGVzdChtb2RlbCwgdmNvdiA9IHZjb3ZIQyhtb2RlbCwgdHlwZSA9ICJIQzAiKSkNCiAgdF9zdGF0cyA8LSByb2J1c3RfdGVzdFssICJ0IHZhbHVlIl0NCiAgcF92YWx1ZXMgPC0gcm9idXN0X3Rlc3RbLCAiUHIoPnx0fCkiXQ0KICANCiAgIyBGdW5jdGlvbiB0byBhZGQgc2lnbmlmaWNhbmNlIHN0YXJzDQogIGdldF9zdGFycyA8LSBmdW5jdGlvbihwKSB7DQogICAgaWYgKHAgPD0gMC4wMSkgcmV0dXJuKCIqKioiKQ0KICAgIGlmIChwIDw9IDAuMDUpIHJldHVybigiKioiKQ0KICAgIGlmIChwIDw9IDAuMSkgcmV0dXJuKCIqIikNCiAgICBpZiAocCA8PSAwLjE1KSByZXR1cm4oIi4iKQ0KICAgIHJldHVybigiIikNCiAgfQ0KICANCiAgIyBNYXhpbXVtIHdpZHRoIGZvciB2YXJpYWJsZSBuYW1lcw0KICBuYW1lX3dpZHRoIDwtIDYwDQogIA0KICAjIFByaW50IG1vZGVsIG5hbWUgYW5kIGhlYWRlcg0KICBjYXQoIlxuXG4iLCBwYXN0ZShyZXAoIj0iLCA4MCksIGNvbGxhcHNlPSIiKSwgIlxuIikNCiAgY2F0KCJNT0RFTDoiLCBtb2RlbF9uYW1lLCAiXG4iKQ0KICBjYXQocGFzdGUocmVwKCI9IiwgODApLCBjb2xsYXBzZT0iIiksICJcblxuIikNCiAgDQogICMgUHJpbnQgaGVhZGVyIHdpdGggYWxpZ25tZW50DQogIGNhdChzcHJpbnRmKCIlLSpzICAlMTBzICAlMTBzICAlNHNcbiIsIG5hbWVfd2lkdGgsICJWYXJpYWJsZSIsICJ0LXZhbHVlIiwgInAtdmFsdWUiLCAic2lnIikpDQogIGNhdChzcHJpbnRmKCIlLSpzICAlMTBzICAlMTBzICAlNHNcbiIsIG5hbWVfd2lkdGgsICItLS0tLS0tLS0iLCAiLS0tLS0tLSIsICItLS0tLS0tIiwgIi0tLS0iKSkNCiAgDQogICMgTG9vcCB0aHJvdWdoIGFuZCBwcmludCB2YWx1ZXMNCiAgZm9yIChpIGluIDE6bGVuZ3RoKHRfc3RhdHMpKSB7DQogICAgdmFyX25hbWUgPC0gcm93bmFtZXMocm9idXN0X3Rlc3QpW2ldDQogICAgIyBUcnVuY2F0ZSBuYW1lIGlmIHRvbyBsb25nDQogICAgaWYgKG5jaGFyKHZhcl9uYW1lKSA+IG5hbWVfd2lkdGgpIHsNCiAgICAgIHZhcl9uYW1lIDwtIHBhc3RlMChzdWJzdHIodmFyX25hbWUsIDEsIG5hbWVfd2lkdGgtMyksICIuLi4iKQ0KICAgIH0NCiAgICBjYXQoc3ByaW50ZigiJS0qcyAgJTEwLjRmICAlMTAuNGYgICU0c1xuIiwgDQogICAgICAgICAgICAgICAgbmFtZV93aWR0aCwgdmFyX25hbWUsIA0KICAgICAgICAgICAgICAgIHRfc3RhdHNbaV0sIHBfdmFsdWVzW2ldLA0KICAgICAgICAgICAgICAgIGdldF9zdGFycyhwX3ZhbHVlc1tpXSkpKQ0KICB9DQogIA0KICBjYXQoIlxuU2lnbmlmaWNhbmNlIGNvZGVzOiAwICcqKionIDAuMDEgJyoqJyAwLjA1ICcqJyAwLjEgJy4nIDAuMTVcbiIpDQogIA0KICAjIFByaW50IFItc3F1YXJlZA0KICByX3NxdWFyZWQgPC0gc3VtbWFyeShtb2RlbCkkYWRqLnIuc3F1YXJlZA0KICBjYXQoIlxuQWRqdXN0ZWQgUi1zcXVhcmVkOiIsIHJfc3F1YXJlZCwgIlxuIikNCiAgDQogICMgQ2FsY3VsYXRlIFZJRnMNCiAgbGlicmFyeShjYXIpDQogIHZpZnMgPC0gdmlmKG1vZGVsKQ0KICANCiAgIyBGaWx0ZXIgdG8gc2hvdyBvbmx5IFZJRnMgb3ZlciA1DQogIGhpZ2hfdmlmcyA8LSB2aWZzW3ZpZnMgPiA1XQ0KICBpZihsZW5ndGgoaGlnaF92aWZzKSA+IDApIHsNCiAgICBjYXQoIlxuVmFyaWFibGVzIHdpdGggVklGID4gNTpcbiIpDQogICAgcHJpbnQoaGlnaF92aWZzKQ0KICB9IGVsc2Ugew0KICAgIGNhdCgiXG5ObyB2YXJpYWJsZXMgd2l0aCBWSUYgPiA1IGZvdW5kIGluIHRoaXMgbW9kZWxcbiIpDQogIH0NCiAgDQogIHJldHVybihyX3NxdWFyZWQpDQp9DQoNCiMgQW5hbHl6ZSBtb2RlbHMgd2l0aCBHSU1SIG9ubHkNCnIyX3BsYXllciA8LSBhbmFseXplX21vZGVsKG9sc19tb2RlbF9wbGF5ZXIsICJQbGF5ZXIgTW9kZWwgd2l0aCBHSU1SIikNCnIyX3N0YXJ0ZXIgPC0gYW5hbHl6ZV9tb2RlbChvbHNfbW9kZWxfc3RhcnRlciwgIlN0YXJ0ZXIgTW9kZWwgd2l0aCBHSU1SIikNCg0KIyBDb21wYXJlIFItc3F1YXJlZCB2YWx1ZXMNCmNhdCgiXG5cbiIsIHBhc3RlKHJlcCgiPSIsIDgwKSwgY29sbGFwc2U9IiIpLCAiXG4iKQ0KY2F0KCJNT0RFTCBDT01QQVJJU09OIC0gQWRqdXN0ZWQgUi1zcXVhcmVkIHZhbHVlc1xuIikNCmNhdChwYXN0ZShyZXAoIj0iLCA4MCksIGNvbGxhcHNlPSIiKSwgIlxuXG4iKQ0KY2F0KCJQbGF5ZXIgTW9kZWwgd2l0aCBHSU1SOiIsIHIyX3BsYXllciwgIlxuIikNCmNhdCgiU3RhcnRlciBNb2RlbCB3aXRoIEdJTVI6IiwgcjJfc3RhcnRlciwgIlxuIikNCg0KYGBgDQoNCg==</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("heckman.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
