<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Heckman Selection Model Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">4th Downs in the NFL</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="heckman.html">Heckman Selection</a>
</li>
<li>
  <a href="xgboost.html">XGBoost Prediction</a>
</li>
<li>
  <a href="attendance_binary.html">Attendance Impact Binary</a>
</li>
<li>
  <a href="thirddown.html">Third Down Analysis</a>
</li>
<li>
  <a href="attempt_ols.html">Attempts OLS</a>
</li>
<li>
  <a href="robustness_checks.html">Robustness Checks</a>
</li>
<li>
  <a href="Writing.html">Writing</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Heckman Selection Model Analysis</h1>

</div>


<pre class="r"><code>library(data.table)
outcome_data &lt;- fread(&quot;predict_outcome.csv.gz&quot;)
select_data &lt;- fread(&quot;predict_select.csv.gz&quot;)</code></pre>
<pre class="r"><code>select_data[, score_diff := as.integer(score_diff &gt; 0)]</code></pre>
<pre class="r"><code>#&#39; Filter for specific player data (offense or defense)
# filter_specific_player &lt;- function(data, side = &quot;offense&quot;, player = 1) {
#   # Create a copy to avoid modifying the original
#   dt &lt;- copy(data)
#   
#   # Build patterns for columns to keep
#   # We want to keep 3 types of columns:
#   # 1. Regular player column: side_player_number_*
#   # 2. Player present column: side_player_number_present
#   # 3. Starter player column: starter_side_player_number_*
#   
#   # Identify all player-related columns (both normal and starter)
#   all_player_cols &lt;- grep(&quot;player_&quot;, names(dt), value = TRUE)
#   
#   # Create patterns for the 3 types of columns we want to keep
#   player_pattern &lt;- paste0(&quot;^&quot;, side, &quot;_player_&quot;, player, &quot;_&quot;)
#   present_pattern &lt;- paste0(&quot;^&quot;, side, &quot;_player_&quot;, player, &quot;_present$&quot;)
#   starter_pattern &lt;- paste0(&quot;^starter_&quot;, side, &quot;_player_&quot;, player, &quot;_&quot;)
#   
#   # Combine patterns
#   keep_pattern &lt;- paste(player_pattern, present_pattern, starter_pattern, sep = &quot;|&quot;)
#   
#   # Find columns to keep
#   cols_to_keep &lt;- grep(keep_pattern, all_player_cols, value = TRUE)
#   
#   # Find all player columns to remove (all player columns except those to keep)
#   cols_to_remove &lt;- setdiff(all_player_cols, cols_to_keep)
#   
#   # Remove unwanted player columns
#   for (col in cols_to_remove) {
#     dt[, (col) := NULL]
#   }
#   
#   # Return filtered data
#   return(dt)
# }
# 
# # Filter to keep only offense player 1 columns
# outcome_data &lt;- filter_specific_player(outcome_data, side = &quot;offense&quot;, player = 1)
# 
# # Show remaining player columns
# remaining_player_cols &lt;- grep(&quot;player_&quot;, names(outcome_data), value = TRUE)
# print(&quot;Remaining player columns:&quot;)
# print(remaining_player_cols)</code></pre>
<pre class="r"><code>select_data[, attempt := as.numeric(as.character(attempt))]</code></pre>
<pre class="r"><code>library(data.table)
library(xgboost)
library(ROCR)
library(parallel)

# Prepare the XGBoost matrices
xs &lt;- model.matrix(~ . - 1 - attempt - my_id, data = select_data)
y &lt;- as.numeric(as.character(select_data$attempt))


# Create parameter grid
grid &lt;- expand.grid(
  eta = seq(0.001, 0.03, by = 0.01),
  max_depth = seq(5, 5, by = 2),
  min_child_weight = seq(1, 1, by = 1),        
  subsample = seq(1, 1, by = 0.2),
  colsample_bytree = seq(1, 1, by = 0.2),
  lambda = seq(1, 1, by = 1),                
  alpha = seq(0, 0, by = 1),                  
  gamma = seq(0, 0, by = 0.1),               
  nrounds = seq(100, 250, by = 50)
)


# Sample grid points
conf_lev &lt;- .95
num_max &lt;- 5
n &lt;- ceiling(log(1-conf_lev)/log(1-num_max/nrow(grid)))
ind &lt;- sample(nrow(grid), n, replace = FALSE)
rgrid &lt;- grid[ind, ]

# Set up parallel processing
nc &lt;- detectCores() - 1

# Calculate scale_pos_weight for imbalanced dataset
scale_pos_weight &lt;- sum(y == 0) / sum(y == 1)

# Validation phase
#cat(&quot;\nPhase 1: Validation Phase\n&quot;)
n_validations &lt;- 3
validation_results &lt;- matrix(nrow = nrow(rgrid), ncol = n_validations)

for (j in 1:nrow(rgrid)) {
  #cat(&quot;\nTesting parameter set&quot;, j, &quot;of&quot;, nrow(rgrid), &quot;\n&quot;)
  
  for (i in 1:n_validations) {
    #cat(&quot;\nValidation iteration&quot;, i, &quot;of&quot;, n_validations, &quot;\n&quot;)             
    # Create validation split
    idx &lt;- unique(sample(nrow(xs), nrow(xs), TRUE))
    train_x &lt;- xs[idx, ]
    train_y &lt;- y[idx]
    val_x &lt;- xs[-idx, ]
    val_y &lt;- y[-idx]
    
    prm &lt;- list(
      booster = &quot;gbtree&quot;,
      objective = &quot;binary:logistic&quot;,
      max_depth = rgrid[j, &quot;max_depth&quot;],
      eta = rgrid[j, &quot;eta&quot;],
      subsample = rgrid[j, &quot;subsample&quot;],
      colsample_bytree = rgrid[j, &quot;colsample_bytree&quot;],
      gamma = rgrid[j, &quot;gamma&quot;],
      min_child_weight = rgrid[j, &quot;min_child_weight&quot;],
      alpha = rgrid[j, &quot;alpha&quot;],
      lambda = rgrid[j, &quot;lambda&quot;],
      scale_pos_weight = scale_pos_weight,
      nthread = nc
    )
    
    dm_train &lt;- xgb.DMatrix(data = train_x, label = train_y)
    mdl &lt;- xgb.train(
      params = prm,
      data = dm_train,
      nrounds = rgrid[j, &quot;nrounds&quot;],
      verbose = FALSE
    )
    
    p &lt;- predict(mdl, xgb.DMatrix(data = val_x))
    pred &lt;- prediction(p, val_y)
    validation_results[j, i] &lt;- performance(pred, &quot;auc&quot;)@y.values[[1]]
  }
}

# Run 100 tests with best parameters
cat(&quot;\nRunning X test iterations with best parameters...\n&quot;)</code></pre>
<pre><code>## 
## Running X test iterations with best parameters...</code></pre>
<pre class="r"><code>test_aucs &lt;- c()

best_params_idx &lt;- which.max(rowMeans(validation_results))
best_params &lt;- rgrid[best_params_idx,]

# Train final model with best parameters
best_params_list &lt;- as.list(best_params[-which(names(best_params) == &quot;nrounds&quot;)])
best_params_list$booster &lt;- &quot;gbtree&quot;
best_params_list$objective &lt;- &quot;binary:logistic&quot;
best_params_list$scale_pos_weight &lt;- scale_pos_weight
best_params_list$nthread &lt;- nc

for(i in 1:20) {
  # Create test split
  idx &lt;- unique(sample(nrow(xs), nrow(xs), T))
  train_x &lt;- xs[idx, ]
  train_y &lt;- y[idx]
  test_x &lt;- xs[-idx, ]
  test_y &lt;- y[-idx]
  
  # Train model on full unbalanced dataset
  dm_train &lt;- xgb.DMatrix(data = train_x, label = train_y)
  mdl &lt;- xgb.train(
    params = best_params_list,
    data = dm_train,
    nrounds = best_params[[&quot;nrounds&quot;]],
    verbose = FALSE
  )
  
  # Test on unbalanced test set
  p &lt;- predict(mdl, xgb.DMatrix(data = test_x))
  pred &lt;- prediction(p, test_y)
  test_aucs[i] &lt;- performance(pred, &quot;auc&quot;)@y.values[[1]]
}
# Print results
cat(&quot;\nTest Results over 100 iterations:\n&quot;)</code></pre>
<pre><code>## 
## Test Results over 100 iterations:</code></pre>
<pre class="r"><code>cat(&quot;Mean AUC:&quot;, mean(test_aucs), &quot;\n&quot;)</code></pre>
<pre><code>## Mean AUC: 0.8816642</code></pre>
<pre class="r"><code>cat(&quot;SD AUC:&quot;, sd(test_aucs), &quot;\n&quot;)</code></pre>
<pre><code>## SD AUC: 0.004693412</code></pre>
<pre class="r"><code>cat(&quot;95% CI:&quot;, mean(test_aucs) - 1.96 * sd(test_aucs), 
    &quot;to&quot;, mean(test_aucs) + 1.96 * sd(test_aucs), &quot;\n&quot;)</code></pre>
<pre><code>## 95% CI: 0.8724651 to 0.8908633</code></pre>
<pre class="r"><code># Plotting AUC distribution
plot(test_aucs, col=&quot;red&quot;, pch=20,
     main=&quot;AUC Test Distribution&quot;,
     xlab=&quot;Iteration&quot;, ylab=&quot;AUC&quot;)
abline(h=mean(test_aucs), col=&quot;blue&quot;, lwd=2, lty=2)  # Add this line to show mean
abline(h=mean(test_aucs) - 1.96 * sd(test_aucs), col=&quot;green&quot;, lwd=2, lty=3)
abline(h=mean(test_aucs) + 1.96 * sd(test_aucs), col=&quot;green&quot;, lwd=2, lty=3)
legend(&quot;bottomright&quot;, 
       legend=c(&quot;AUC Values&quot;, &quot;Mean&quot;, &quot;95% CI Bounds&quot;),
       col=c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;),
       lty=c(NA, 2, 3),
       pch=c(20, NA, NA))</code></pre>
<p><img src="heckman_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code># Now train final model on full data for z scores
dm_full &lt;- xgb.DMatrix(data = xs, label = y)
final_model &lt;- xgb.train(
  params = best_params_list,
  data = dm_full,
  nrounds = best_params[[&quot;nrounds&quot;]],
  verbose = FALSE
)

# Get probability predictions (z) for ALL data
z &lt;- predict(final_model, xgb.DMatrix(data = xs))</code></pre>
<pre class="r"><code># Calculate residuals for XGBoost predictions
y &lt;- as.numeric(as.character(select_data$attempt))
residuals &lt;- y - z

# Histogram of residuals
hist(residuals, main=&quot;Distribution of XGBoost Model Residuals&quot;, xlab=&quot;Residual&quot;, breaks=100)</code></pre>
<p><img src="heckman_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code># plot out the z values\
plot(density(z), 
     main = &quot;Density of Z Predictions&quot;,
     xlab = &quot;Predicted Probability of Attempt&quot;,
     ylab = &quot;Density&quot;)</code></pre>
<p><img src="heckman_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code># Calculate GIMR (lambda) This is Generalized inverse mills ratio
GIMR &lt;- dnorm(qnorm(z)) / (1 - pnorm(qnorm(z)))

# Add GIMR to the data
select_data[, GIMR := GIMR]

# Print variable importa</code></pre>
<pre class="r"><code># Create a data.table with just my_id and GIMR from select_data
GIMR_dt &lt;- data.table(my_id = select_data$my_id, GIMR = GIMR)

# Add GIMR to outcome_data by matching on my_id
outcome_data[GIMR_dt, GIMR := i.GIMR, on = &quot;my_id&quot;]</code></pre>
<pre class="r"><code># # Existing code
# outcome_data &lt;- outcome_data[, my_id := NULL]
# outcome_data[, yardline_31_40 := NULL]
# outcome_data[, year2022_team_CLE := NULL] # tied for most attempts with 31

# Remove all columns with &quot;_present&quot; in the name
present_cols &lt;- grep(&quot;_present&quot;, names(outcome_data), value = TRUE)
for (col in present_cols) {
  outcome_data[, (col) := NULL]
}</code></pre>
<pre class="r"><code># Create copies of outcome_data for different models
outcome_data_player &lt;- copy(outcome_data)
outcome_data_starter &lt;- copy(outcome_data)

# Remove specific columns as in original code
for (dt in list(outcome_data_player, outcome_data_starter)) {
  dt[, my_id := NULL]
  dt[, yardline_31_40 := NULL]
  dt[, year2022_team_CLE := NULL] # tied for most attempts with 31
  
  # Remove attendance variables
  dt[, attendance_pct := NULL]
  dt[, attendance_raw := NULL]
  dt[, vegas_wp_posteam := NULL]
}</code></pre>
<pre><code>## Warning in `[.data.table`(dt, , `:=`(vegas_wp_posteam, NULL)): Column
## &#39;vegas_wp_posteam&#39; does not exist to remove

## Warning in `[.data.table`(dt, , `:=`(vegas_wp_posteam, NULL)): Column
## &#39;vegas_wp_posteam&#39; does not exist to remove</code></pre>
<pre class="r"><code># For player models, remove starter columns
player_cols &lt;- grep(&quot;^starter_&quot;, names(outcome_data_player), value = TRUE)
for (col in player_cols) {
  outcome_data_player[, (col) := NULL]
}

# For starter models, remove player columns
starter_cols &lt;- grep(&quot;^(offense|defense)_player_&quot;, names(outcome_data_starter), value = TRUE)
for (col in starter_cols) {
  outcome_data_starter[, (col) := NULL]
}

# Ensure conversion is numeric
for (dt in list(outcome_data_player, outcome_data_starter)) {
  dt[, conversion := as.numeric(as.character(conversion))]
}

# MODEL 1: Player model with GIMR
ols_model_player &lt;- lm(conversion ~ ., data = outcome_data_player)

# MODEL 2: Starter model with GIMR
ols_model_starter &lt;- lm(conversion ~ ., data = outcome_data_starter)

# Function to analyze and print model results
analyze_model &lt;- function(model, model_name) {
  library(sandwich)
  library(lmtest)
  
  # Get HC0-adjusted t-values and p-values
  robust_test &lt;- coeftest(model, vcov = vcovHC(model, type = &quot;HC0&quot;))
  t_stats &lt;- robust_test[, &quot;t value&quot;]
  p_values &lt;- robust_test[, &quot;Pr(&gt;|t|)&quot;]
  
  # Function to add significance stars
  get_stars &lt;- function(p) {
    if (p &lt;= 0.01) return(&quot;***&quot;)
    if (p &lt;= 0.05) return(&quot;**&quot;)
    if (p &lt;= 0.1) return(&quot;*&quot;)
    if (p &lt;= 0.15) return(&quot;.&quot;)
    return(&quot;&quot;)
  }
  
  # Maximum width for variable names
  name_width &lt;- 60
  
  # Print model name and header
  cat(&quot;\n\n&quot;, paste(rep(&quot;=&quot;, 80), collapse=&quot;&quot;), &quot;\n&quot;)
  cat(&quot;MODEL:&quot;, model_name, &quot;\n&quot;)
  cat(paste(rep(&quot;=&quot;, 80), collapse=&quot;&quot;), &quot;\n\n&quot;)
  
  # Print header with alignment
  cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;Variable&quot;, &quot;t-value&quot;, &quot;p-value&quot;, &quot;sig&quot;))
  cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;---------&quot;, &quot;-------&quot;, &quot;-------&quot;, &quot;----&quot;))
  
  # Loop through and print values
  for (i in 1:length(t_stats)) {
    var_name &lt;- rownames(robust_test)[i]
    # Truncate name if too long
    if (nchar(var_name) &gt; name_width) {
      var_name &lt;- paste0(substr(var_name, 1, name_width-3), &quot;...&quot;)
    }
    cat(sprintf(&quot;%-*s  %10.4f  %10.4f  %4s\n&quot;, 
                name_width, var_name, 
                t_stats[i], p_values[i],
                get_stars(p_values[i])))
  }
  
  cat(&quot;\nSignificance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15\n&quot;)
  
  # Print R-squared
  r_squared &lt;- summary(model)$adj.r.squared
  cat(&quot;\nAdjusted R-squared:&quot;, r_squared, &quot;\n&quot;)
  
  # Calculate VIFs
  library(car)
  vifs &lt;- vif(model)
  
  # Filter to show only VIFs over 5
  high_vifs &lt;- vifs[vifs &gt; 5]
  if(length(high_vifs) &gt; 0) {
    cat(&quot;\nVariables with VIF &gt; 5:\n&quot;)
    print(high_vifs)
  } else {
    cat(&quot;\nNo variables with VIF &gt; 5 found in this model\n&quot;)
  }
  
  return(r_squared)
}

# Analyze models with GIMR only
r2_player &lt;- analyze_model(ols_model_player, &quot;Player Model with GIMR&quot;)</code></pre>
<pre><code>## 
## 
##  ================================================================================ 
## MODEL: Player Model with GIMR 
## ================================================================================ 
## 
## Variable                                                         t-value     p-value   sig
## ---------                                                        -------     -------  ----
## (Intercept)                                                       3.1628      0.0016   ***
## ydstogo                                                         -12.5961      0.0000   ***
## posteam_timeouts_remaining                                        1.0793      0.2805      
## defteam_timeouts_remaining                                        0.9135      0.3610      
## rush_attempt                                                      7.2211      0.0000   ***
## week                                                              1.0358      0.3004      
## temp                                                             -1.0512      0.2932      
## wind                                                              0.7947      0.4268      
## vegas_wp                                                          1.0750      0.2825      
## spread_line                                                       0.1934      0.8467      
## total_line                                                        1.5551      0.1200     .
## prep_days                                                         1.1346      0.2566      
## overall_win_pct                                                   0.3542      0.7232      
## team_win_pct                                                      1.5601      0.1188     .
## prev_win_pct                                                     -2.8829      0.0040   ***
## prev_shotgun_rate                                                 0.4618      0.6443      
## prev_singleback_rate                                              0.7360      0.4618      
## prev_empty_rate                                                   0.8347      0.4039      
## prev_iform_rate                                                   0.4448      0.6565      
## prev_shotgun_success                                              0.2376      0.8122      
## prev_singleback_success                                           0.7963      0.4259      
## prev_empty_success                                                0.3073      0.7586      
## prev_iform_success                                                2.3682      0.0179    **
## prev_stop_rate_run                                                0.4263      0.6699      
## prev_stop_rate_pass                                              -3.9999      0.0001   ***
## shotgun_rate                                                      0.8600      0.3898      
## singleback_rate                                                   0.3577      0.7206      
## empty_rate                                                       -0.2419      0.8089      
## iform_rate                                                       -1.7270      0.0842     *
## shotgun_success                                                  -2.0544      0.0400    **
## singleback_success                                               -0.6694      0.5033      
## empty_success                                                    -0.4496      0.6530      
## iform_success                                                    -1.3563      0.1751      
## def_stop_rate_run                                                 2.2833      0.0225    **
## def_stop_rate_pass                                               -0.9024      0.3669      
## avg_pass_rushers                                                 -0.3856      0.6998      
## avg_box_defenders                                                -0.8172      0.4139      
## cover0_rate                                                      -0.6454      0.5187      
## cover1_rate                                                      -0.3059      0.7597      
## cover2_rate                                                      -0.3520      0.7248      
## cover3_rate                                                       1.6344      0.1023     .
## cover4_rate                                                       0.9055      0.3653      
## cover6_rate                                                      -0.3292      0.7420      
## two_man_rate                                                      1.5383      0.1241     .
## prevent_rate                                                      2.2509      0.0245    **
## roof_outdoors                                                    -0.5121      0.6086      
## posteam_type_home                                                -1.2999      0.1937      
## offense_formation_EMPTY                                           0.6352      0.5253      
## offense_formation_SHOTGUN                                         0.0948      0.9245      
## offense_formation_SINGLEBACK                                     -0.0363      0.9710      
## offense_formation_I_FORM                                         -0.1427      0.8866      
## offense_player_1_passing_depth_short_grades_pass_12w              2.2069      0.0274    **
## offense_player_1_passing_depth_medium_grades_pass_12w            -0.4580      0.6470      
## offense_player_1_passing_depth_deep_grades_pass_12w              -1.1367      0.2557      
## offense_player_1_rushing_grades_grades_run_12w                   -0.0569      0.9547      
## offense_player_4_rushing_grades_first_downs_12w                   1.2085      0.2269      
## offense_player_4_receiving_vs_scheme_zone_grades_pass_rou...      0.4329      0.6651      
## offense_player_4_pass_blocking_true_pass_set_grades_pass_...      0.1147      0.9087      
## offense_player_4_rushing_grades_yards_after_contact_2w           -0.2917      0.7705      
## offense_player_8_receiving_depth_short_avg_depth_of_targe...     -1.0224      0.3066      
## offense_player_8_blocking_grades_block_percent_12w               -0.7075      0.4793      
## offense_player_8_receiving_grades_targets_12w                     1.1308      0.2582      
## offense_player_8_receiving_grades_yards_per_reception_12w        -0.2329      0.8158      
## offense_player_9_receiving_depth_short_avg_depth_of_targe...      1.1308      0.2582      
## offense_player_9_blocking_grades_block_percent_12w               -0.7911      0.4289      
## offense_player_9_receiving_grades_targets_12w                    -0.9140      0.3608      
## offense_player_9_receiving_grades_yards_per_reception_12w        -0.9982      0.3182      
## offense_player_10_receiving_depth_short_avg_depth_of_targ...      1.2186      0.2231      
## offense_player_10_blocking_grades_block_percent_12w              -0.2374      0.8124      
## offense_player_10_receiving_grades_targets_12w                    0.6105      0.5416      
## offense_player_10_receiving_grades_yards_per_reception_12w        0.3558      0.7220      
## offense_player_14_blocking_grades_snap_counts_block_2w            2.2319      0.0257    **
## offense_player_14_receiving_vs_scheme_zone_caught_percent...      0.6930      0.4884      
## offense_player_14_receiving_depth_center_short_pass_plays...     -1.6096      0.1076     .
## offense_player_14_receiving_concept_slot_targets_12w              1.0655      0.2867      
## offense_player_17_run_blocking_snap_counts_run_block_12w          1.2795      0.2008      
## offense_player_17_blocking_grades_grades_offense_12w              0.9532      0.3406      
## offense_player_17_blocking_grades_pbe_2w                         -0.1852      0.8531      
## offense_player_18_run_blocking_snap_counts_run_block_12w         -2.3406      0.0193    **
## offense_player_18_blocking_grades_grades_offense_12w             -0.6065      0.5442      
## offense_player_18_blocking_grades_pbe_2w                          1.8348      0.0666     *
## offense_player_19_run_blocking_snap_counts_run_block_12w         -0.8096      0.4182      
## offense_player_19_blocking_grades_grades_offense_12w             -0.2599      0.7949      
## offense_player_19_blocking_grades_pbe_2w                          0.9553      0.3395      
## offense_player_20_run_blocking_snap_counts_run_block_12w         -0.2964      0.7669      
## offense_player_20_blocking_grades_grades_offense_12w              0.1727      0.8629      
## offense_player_20_blocking_grades_pbe_2w                          0.4640      0.6427      
## offense_player_21_run_blocking_snap_counts_run_block_12w         -1.3032      0.1926      
## offense_player_21_blocking_grades_grades_offense_12w             -0.1657      0.8684      
## offense_player_21_blocking_grades_pbe_2w                          1.4384      0.1504      
## defense_player_1_pass_rushing_productivity_prp_12w               -0.3661      0.7143      
## defense_player_1_pass_rushing_productivity_hurries_12w           -0.3036      0.7614      
## defense_player_1_defensive_grades_grades_defense_penalty_12w     -1.0341      0.3011      
## defense_player_1_run_defense_grades_stops_12w                    -0.8934      0.3717      
## defense_player_1_run_defense_grades_tackles_12w                   0.7505      0.4530      
## defense_player_2_pass_rushing_productivity_prp_12w               -0.4586      0.6466      
## defense_player_2_pass_rushing_productivity_hurries_12w           -0.0901      0.9282      
## defense_player_2_defensive_grades_grades_defense_penalty_12w      0.6855      0.4931      
## defense_player_2_run_defense_grades_stops_12w                     0.5590      0.5762      
## defense_player_2_run_defense_grades_tackles_12w                  -0.3801      0.7039      
## defense_player_3_pass_rushing_productivity_prp_12w               -0.5956      0.5515      
## defense_player_3_pass_rushing_productivity_hurries_12w           -0.7298      0.4655      
## defense_player_3_defensive_grades_grades_defense_penalty_12w      1.5741      0.1156     .
## defense_player_3_run_defense_grades_stops_12w                    -0.8883      0.3744      
## defense_player_3_run_defense_grades_tackles_12w                   1.0588      0.2898      
## defense_player_4_pass_rushing_productivity_prp_12w               -1.5961      0.1106     .
## defense_player_4_pass_rushing_productivity_hurries_12w           -0.3023      0.7625      
## defense_player_4_defensive_grades_grades_defense_penalty_12w     -0.5723      0.5671      
## defense_player_4_run_defense_grades_stops_12w                    -3.2729      0.0011   ***
## defense_player_4_run_defense_grades_tackles_12w                   3.1487      0.0017   ***
## defense_player_9_pass_rushing_productivity_prp_12w               -0.5579      0.5770      
## defense_player_9_pass_rushing_productivity_hurries_12w           -0.4805      0.6309      
## defense_player_9_defensive_grades_grades_defense_penalty_12w      0.6250      0.5320      
## defense_player_9_run_defense_grades_stops_12w                    -1.6209      0.1051     .
## defense_player_9_run_defense_grades_tackles_12w                   1.0533      0.2923      
## defense_player_9_defensive_grades_snap_counts_coverage_12w        0.2497      0.8028      
## defense_player_9_coverage_schemes_zone_stops_12w                 -0.1424      0.8868      
## defense_player_10_pass_rushing_productivity_prp_12w               0.0698      0.9444      
## defense_player_10_pass_rushing_productivity_hurries_12w          -2.2117      0.0270    **
## defense_player_10_defensive_grades_grades_defense_penalty...      1.3285      0.1841      
## defense_player_10_run_defense_grades_stops_12w                   -0.1561      0.8760      
## defense_player_10_run_defense_grades_tackles_12w                 -0.2773      0.7816      
## defense_player_10_defensive_grades_snap_counts_coverage_12w      -0.5430      0.5872      
## defense_player_10_coverage_schemes_zone_stops_12w                 0.8897      0.3737      
## defense_player_11_pass_rushing_productivity_prp_12w              -1.2071      0.2275      
## defense_player_11_pass_rushing_productivity_hurries_12w           2.0902      0.0367    **
## defense_player_11_defensive_grades_grades_defense_penalty...     -0.7038      0.4816      
## defense_player_11_run_defense_grades_stops_12w                   -0.0068      0.9946      
## defense_player_11_run_defense_grades_tackles_12w                 -0.6080      0.5432      
## defense_player_11_defensive_grades_snap_counts_coverage_12w       1.9151      0.0556     *
## defense_player_11_coverage_schemes_zone_stops_12w                -0.4893      0.6246      
## defense_player_12_pass_rushing_productivity_prp_12w              -0.5418      0.5880      
## defense_player_12_pass_rushing_productivity_hurries_12w           1.9535      0.0508     *
## defense_player_12_defensive_grades_grades_defense_penalty...     -1.0756      0.2822      
## defense_player_12_run_defense_grades_stops_12w                    0.8132      0.4162      
## defense_player_12_run_defense_grades_tackles_12w                 -1.3000      0.1937      
## defense_player_12_defensive_grades_snap_counts_coverage_12w       2.5632      0.0104    **
## defense_player_12_coverage_schemes_zone_stops_12w                -0.8888      0.3741      
## defense_player_15_defensive_grades_grades_defense_penalty...     -1.2206      0.2223      
## defense_player_15_run_defense_grades_tackles_12w                  0.4682      0.6397      
## defense_player_15_coverage_schemes_man_coverage_snaps_per...      1.4637      0.1434     .
## defense_player_15_coverage_grades_stops_12w                       0.3988      0.6901      
## defense_player_15_slot_coverage_targets_12w                       0.9750      0.3296      
## defense_player_15_defensive_grades_missed_tackle_rate_2w         -0.8215      0.4114      
## defense_player_16_defensive_grades_grades_defense_penalty...     -1.6488      0.0993     *
## defense_player_16_run_defense_grades_tackles_12w                  1.5042      0.1326     .
## defense_player_16_coverage_schemes_man_coverage_snaps_per...      1.0468      0.2952      
## defense_player_16_coverage_grades_stops_12w                      -0.3104      0.7562      
## defense_player_16_slot_coverage_targets_12w                       1.4011      0.1613      
## defense_player_16_defensive_grades_missed_tackle_rate_2w         -0.8553      0.3925      
## defense_player_17_defensive_grades_grades_defense_penalty...      1.9802      0.0478    **
## defense_player_17_run_defense_grades_tackles_12w                 -1.6401      0.1011     .
## defense_player_17_coverage_schemes_man_coverage_snaps_per...     -1.5007      0.1335     .
## defense_player_17_coverage_grades_stops_12w                       0.4572      0.6475      
## defense_player_17_slot_coverage_targets_12w                      -0.2926      0.7699      
## defense_player_17_defensive_grades_missed_tackle_rate_2w         -0.7762      0.4377      
## defense_player_20_defensive_grades_grades_defense_penalty...      0.1527      0.8786      
## defense_player_20_run_defense_grades_tackles_12w                  0.2725      0.7853      
## defense_player_20_coverage_grades_stops_12w                      -0.4410      0.6592      
## defense_player_20_slot_coverage_targets_12w                       1.4695      0.1418     .
## defense_player_20_defensive_grades_missed_tackle_rate_2w         -0.2460      0.8057      
## defense_player_21_defensive_grades_grades_defense_penalty...     -1.6861      0.0919     *
## defense_player_21_run_defense_grades_tackles_12w                  2.0180      0.0437    **
## defense_player_21_coverage_grades_stops_12w                      -1.1142      0.2653      
## defense_player_21_slot_coverage_targets_12w                       1.5703      0.1164     .
## defense_player_21_defensive_grades_missed_tackle_rate_2w          1.4542      0.1460     .
## defense_player_22_defensive_grades_grades_defense_penalty...      1.6045      0.1087     .
## defense_player_22_run_defense_grades_tackles_12w                  0.0898      0.9284      
## defense_player_22_coverage_grades_stops_12w                       0.0799      0.9364      
## defense_player_22_slot_coverage_targets_12w                      -1.5293      0.1263     .
## defense_player_22_defensive_grades_missed_tackle_rate_2w         -0.4349      0.6637      
## yardline_1_10                                                    -2.2990      0.0216    **
## yardline_11_20                                                    0.1702      0.8649      
## yardline_21_30                                                    0.0002      0.9999      
## yardline_41_50                                                    1.8567      0.0634     *
## yardline_51_60                                                    0.3814      0.7029      
## yardline_61_70                                                    1.3404      0.1802      
## yardline_71_80                                                    1.7820      0.0748     *
## yardline_81_90                                                    2.1703      0.0300    **
## yardline_91_100                                                   1.1431      0.2531      
## year2017_team_ARI                                                 0.5530      0.5803      
## year2017_team_BUF                                                -0.5789      0.5627      
## year2017_team_CHI                                                 0.1506      0.8803      
## year2017_team_CLE                                                 0.7146      0.4749      
## year2017_team_DAL                                                -0.6378      0.5237      
## year2017_team_DET                                                -0.0653      0.9479      
## year2017_team_GB                                                  1.9852      0.0472    **
## year2017_team_HOU                                                 1.8532      0.0639     *
## year2017_team_MIA                                                -0.8730      0.3827      
## year2017_team_MIN                                                -0.1154      0.9081      
## year2017_team_NE                                                  0.1277      0.8984      
## year2017_team_SF                                                  1.9635      0.0497    **
## year2017_team_BAL                                                -0.0905      0.9279      
## year2017_team_DEN                                                 0.2520      0.8010      
## year2017_team_LA                                                  0.6530      0.5138      
## year2017_team_NYG                                                -0.0093      0.9926      
## year2017_team_OAK                                                -0.2151      0.8297      
## year2017_team_SEA                                                 0.8400      0.4010      
## year2017_team_CAR                                                 0.7081      0.4789      
## year2017_team_CIN                                                 0.5379      0.5907      
## year2017_team_IND                                                 1.0019      0.3164      
## year2017_team_NO                                                  0.6941      0.4877      
## year2017_team_PHI                                                 0.6299      0.5288      
## year2017_team_PIT                                                -0.2835      0.7768      
## year2017_team_TEN                                                 0.4483      0.6539      
## year2017_team_WAS                                                 0.6416      0.5211      
## year2017_team_KC                                                  1.9142      0.0557     *
## year2017_team_LAC                                                 0.2721      0.7855      
## year2017_team_NYJ                                                 0.9475      0.3434      
## year2017_team_TB                                                  0.0835      0.9335      
## year2017_team_ATL                                                -0.0231      0.9816      
## year2017_team_JAX                                                 1.0306      0.3028      
## year2018_team_ARI                                                 0.5874      0.5570      
## year2018_team_BAL                                                 0.4162      0.6773      
## year2018_team_CAR                                                 0.5757      0.5649      
## year2018_team_CLE                                                -0.4575      0.6473      
## year2018_team_DET                                                 0.9614      0.3364      
## year2018_team_HOU                                                 1.3570      0.1749      
## year2018_team_IND                                                -0.5225      0.6014      
## year2018_team_KC                                                  1.0237      0.3060      
## year2018_team_NYG                                                 0.3610      0.7181      
## year2018_team_OAK                                                -0.5946      0.5521      
## year2018_team_PHI                                                 1.0985      0.2720      
## year2018_team_SEA                                                 0.0564      0.9550      
## year2018_team_BUF                                                -0.4273      0.6692      
## year2018_team_CHI                                                 0.0259      0.9794      
## year2018_team_CIN                                                -0.3659      0.7145      
## year2018_team_DAL                                                -0.1947      0.8457      
## year2018_team_DEN                                                 0.3071      0.7588      
## year2018_team_GB                                                  0.3506      0.7259      
## year2018_team_LAC                                                 0.3214      0.7479      
## year2018_team_NE                                                 -0.2620      0.7934      
## year2018_team_NO                                                  0.9993      0.3177      
## year2018_team_PIT                                                 1.0462      0.2955      
## year2018_team_SF                                                  0.7568      0.4492      
## year2018_team_MIA                                                 0.6541      0.5131      
## year2018_team_MIN                                                 0.5767      0.5642      
## year2018_team_NYJ                                                 1.1230      0.2615      
## year2018_team_TB                                                  0.3373      0.7359      
## year2018_team_ATL                                                 0.8527      0.3939      
## year2018_team_JAX                                                 0.5825      0.5603      
## year2018_team_LA                                                 -0.7219      0.4704      
## year2018_team_TEN                                                 0.6623      0.5078      
## year2018_team_WAS                                                -0.0694      0.9447      
## year2019_team_ARI                                                -0.6304      0.5285      
## year2019_team_BUF                                                -0.6298      0.5288      
## year2019_team_CHI                                                 0.5109      0.6095      
## year2019_team_CLE                                                 0.8165      0.4143      
## year2019_team_DAL                                                 0.1838      0.8542      
## year2019_team_IND                                                -0.0279      0.9777      
## year2019_team_JAX                                                 0.5647      0.5723      
## year2019_team_KC                                                 -0.2074      0.8357      
## year2019_team_LAC                                                -0.5476      0.5840      
## year2019_team_MIN                                                -0.0565      0.9549      
## year2019_team_NE                                                  0.1644      0.8694      
## year2019_team_NO                                                 -0.8142      0.4156      
## year2019_team_PHI                                                 0.6310      0.5281      
## year2019_team_SEA                                                 0.5042      0.6141      
## year2019_team_SF                                                  0.1685      0.8662      
## year2019_team_TB                                                 -0.6328      0.5269      
## year2019_team_BAL                                                 0.4260      0.6701      
## year2019_team_CAR                                                -0.2288      0.8190      
## year2019_team_DEN                                                 1.0561      0.2910      
## year2019_team_DET                                                -0.7291      0.4660      
## year2019_team_HOU                                                 0.1556      0.8763      
## year2019_team_LA                                                 -0.2027      0.8394      
## year2019_team_MIA                                                -1.8282      0.0676     *
## year2019_team_NYG                                                -0.8549      0.3926      
## year2019_team_NYJ                                                -1.8337      0.0668     *
## year2019_team_OAK                                                 0.1109      0.9117      
## year2019_team_PIT                                                -1.8062      0.0710     *
## year2019_team_TEN                                                -1.0787      0.2808      
## year2019_team_CIN                                                 0.6488      0.5165      
## year2019_team_WAS                                                -0.0601      0.9521      
## year2019_team_ATL                                                -0.0278      0.9778      
## year2019_team_GB                                                 -0.1576      0.8748      
## year2020_team_ATL                                                 0.3514      0.7253      
## year2020_team_BAL                                                 0.8766      0.3808      
## year2020_team_BUF                                                 0.1497      0.8810      
## year2020_team_CAR                                                 0.9303      0.3523      
## year2020_team_CIN                                                 0.8465      0.3973      
## year2020_team_DEN                                                -0.3945      0.6932      
## year2020_team_DET                                                -0.8822      0.3777      
## year2020_team_JAX                                                -0.7081      0.4789      
## year2020_team_KC                                                  0.6690      0.5035      
## year2020_team_LA                                                 -0.7211      0.4709      
## year2020_team_MIN                                                 0.8104      0.4178      
## year2020_team_NE                                                  0.1104      0.9121      
## year2020_team_NO                                                  0.3991      0.6898      
## year2020_team_NYG                                                 0.1910      0.8485      
## year2020_team_SF                                                  0.5690      0.5694      
## year2020_team_WAS                                                 0.2464      0.8054      
## year2020_team_CHI                                                 0.5786      0.5629      
## year2020_team_DAL                                                 0.0632      0.9496      
## year2020_team_GB                                                  0.3639      0.7160      
## year2020_team_HOU                                                -0.2778      0.7812      
## year2020_team_MIA                                                -0.4496      0.6530      
## year2020_team_NYJ                                                 0.2615      0.7937      
## year2020_team_TB                                                  0.4655      0.6416      
## year2020_team_TEN                                                -0.7830      0.4337      
## year2020_team_ARI                                                 0.6212      0.5345      
## year2020_team_CLE                                                -1.0215      0.3071      
## year2020_team_IND                                                -0.6170      0.5373      
## year2020_team_LAC                                                 0.4858      0.6271      
## year2020_team_PHI                                                 1.0116      0.3118      
## year2020_team_SEA                                                 0.1054      0.9160      
## year2020_team_LV                                                  0.9681      0.3331      
## year2020_team_PIT                                                -0.4608      0.6449      
## year2021_team_ATL                                                -1.3826      0.1669      
## year2021_team_BUF                                                 0.7869      0.4314      
## year2021_team_CIN                                                -1.5541      0.1202     .
## year2021_team_DAL                                                -0.1978      0.8432      
## year2021_team_DEN                                                 0.4349      0.6637      
## year2021_team_DET                                                -0.6645      0.5064      
## year2021_team_KC                                                  0.2718      0.7858      
## year2021_team_LA                                                  0.0760      0.9394      
## year2021_team_LV                                                  0.9054      0.3653      
## year2021_team_MIN                                                -0.2788      0.7804      
## year2021_team_NE                                                  0.7212      0.4708      
## year2021_team_NO                                                  0.2559      0.7980      
## year2021_team_NYG                                                 0.4469      0.6549      
## year2021_team_SF                                                 -0.0584      0.9534      
## year2021_team_TEN                                                -0.3724      0.7096      
## year2021_team_ARI                                                 1.2804      0.2005      
## year2021_team_BAL                                                 0.7624      0.4459      
## year2021_team_CAR                                                -0.0383      0.9695      
## year2021_team_CHI                                                -1.1420      0.2535      
## year2021_team_GB                                                  1.0530      0.2924      
## year2021_team_IND                                                 0.0396      0.9684      
## year2021_team_LAC                                                 0.7297      0.4656      
## year2021_team_MIA                                                 0.5469      0.5845      
## year2021_team_NYJ                                                 0.1739      0.8620      
## year2021_team_PHI                                                -1.0867      0.2773      
## year2021_team_SEA                                                -1.1202      0.2627      
## year2021_team_TB                                                  0.7116      0.4768      
## year2021_team_WAS                                                -0.6652      0.5060      
## year2021_team_CLE                                                -0.6438      0.5197      
## year2021_team_HOU                                                -0.2858      0.7750      
## year2021_team_JAX                                                 0.0478      0.9619      
## year2021_team_PIT                                                 0.3958      0.6923      
## year2022_team_ARI                                                -0.8671      0.3859      
## year2022_team_ATL                                                -1.7927      0.0731     *
## year2022_team_CAR                                                 0.9909      0.3218      
## year2022_team_CHI                                                -0.4186      0.6756      
## year2022_team_CIN                                                -0.3939      0.6937      
## year2022_team_HOU                                                -0.1772      0.8594      
## year2022_team_IND                                                -0.3749      0.7077      
## year2022_team_LAC                                                -0.4262      0.6700      
## year2022_team_MIA                                                -1.3290      0.1839      
## year2022_team_SEA                                                 0.3089      0.7574      
## year2022_team_TB                                                  0.4593      0.6460      
## year2022_team_TEN                                                 1.5074      0.1318     .
## year2022_team_WAS                                                 0.1508      0.8801      
## year2022_team_BAL                                                -1.2083      0.2270      
## year2022_team_BUF                                                 0.5559      0.5783      
## year2022_team_DAL                                                 0.5410      0.5885      
## year2022_team_DET                                                -0.7984      0.4247      
## year2022_team_GB                                                 -0.5544      0.5794      
## year2022_team_JAX                                                -0.7583      0.4483      
## year2022_team_KC                                                 -0.9530      0.3407      
## year2022_team_LA                                                  1.2721      0.2034      
## year2022_team_LV                                                  0.9050      0.3655      
## year2022_team_NO                                                 -0.1743      0.8617      
## year2022_team_PHI                                                 0.9544      0.3399      
## year2022_team_PIT                                                 1.4437      0.1489     .
## year2022_team_DEN                                                 0.3523      0.7247      
## year2022_team_MIN                                                -0.6347      0.5257      
## year2022_team_NE                                                  0.3564      0.7216      
## year2022_team_NYJ                                                -0.7368      0.4613      
## year2022_team_NYG                                                 0.0885      0.9295      
## year2022_team_SF                                                 -1.0880      0.2767      
## year2023_team_BAL                                                -0.3103      0.7564      
## year2023_team_CHI                                                -0.8488      0.3960      
## year2023_team_CLE                                                -0.9673      0.3335      
## year2023_team_GB                                                  0.4419      0.6586      
## year2023_team_IND                                                 0.4823      0.6296      
## year2023_team_KC                                                  0.1799      0.8572      
## year2023_team_LAC                                                 0.7813      0.4347      
## year2023_team_LV                                                 -0.1157      0.9079      
## year2023_team_MIA                                                 0.4157      0.6776      
## year2023_team_MIN                                                 1.6241      0.1044     .
## year2023_team_NO                                                 -0.5382      0.5905      
## year2023_team_NYG                                                 0.5812      0.5611      
## year2023_team_SEA                                                -1.5173      0.1293     .
## year2023_team_SF                                                  0.7551      0.4503      
## year2023_team_WAS                                                 1.7868      0.0740     *
## year2023_team_ATL                                                -0.6907      0.4898      
## year2023_team_BUF                                                -0.1122      0.9106      
## year2023_team_CAR                                                 0.6866      0.4924      
## year2023_team_DAL                                                 0.9257      0.3547      
## year2023_team_DEN                                                 0.0999      0.9204      
## year2023_team_HOU                                                 0.0745      0.9406      
## year2023_team_LA                                                  0.3564      0.7216      
## year2023_team_NE                                                  0.3149      0.7529      
## year2023_team_PHI                                                 0.4878      0.6257      
## year2023_team_PIT                                                 0.4918      0.6229      
## year2023_team_TEN                                                 0.4305      0.6668      
## year2023_team_ARI                                                -0.8452      0.3981      
## year2023_team_CIN                                                -0.8754      0.3814      
## year2023_team_DET                                                 0.7678      0.4426      
## year2023_team_TB                                                  0.8975      0.3695      
## year2023_team_JAX                                                -0.9702      0.3320      
## year2023_team_NYJ                                                 1.5299      0.1261     .
## is_first_half                                                    -1.0942      0.2739      
## time_in_half                                                      1.5708      0.1163     .
## home_attendance                                                  -0.2537      0.7997      
## GIMR                                                              1.4789      0.1392     .
## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15
## 
## Adjusted R-squared: 0.1113271 
## 
## Variables with VIF &gt; 5:
##                                           prev_shotgun_rate 
##                                                   10.268153 
##                                        prev_singleback_rate 
##                                                    5.996226 
##                                                 cover1_rate 
##                                                    7.290745 
##                                                 cover3_rate 
##                                                    8.061485 
##                                   offense_formation_SHOTGUN 
##                                                    7.257508 
##               defense_player_1_run_defense_grades_stops_12w 
##                                                   10.278985 
##             defense_player_1_run_defense_grades_tackles_12w 
##                                                   10.047424 
##               defense_player_2_run_defense_grades_stops_12w 
##                                                   11.797502 
##             defense_player_2_run_defense_grades_tackles_12w 
##                                                   12.345549 
##          defense_player_3_pass_rushing_productivity_prp_12w 
##                                                    5.050143 
##               defense_player_3_run_defense_grades_stops_12w 
##                                                   16.086009 
##             defense_player_3_run_defense_grades_tackles_12w 
##                                                   17.438274 
##               defense_player_4_run_defense_grades_stops_12w 
##                                                   16.261029 
##             defense_player_4_run_defense_grades_tackles_12w 
##                                                   18.010233 
##               defense_player_9_run_defense_grades_stops_12w 
##                                                    6.824470 
##             defense_player_9_run_defense_grades_tackles_12w 
##                                                    8.590215 
##              defense_player_10_run_defense_grades_stops_12w 
##                                                    9.540515 
##            defense_player_10_run_defense_grades_tackles_12w 
##                                                   12.341025 
## defense_player_10_defensive_grades_snap_counts_coverage_12w 
##                                                    5.624858 
##              defense_player_11_run_defense_grades_stops_12w 
##                                                   13.852140 
##            defense_player_11_run_defense_grades_tackles_12w 
##                                                   18.190378 
##              defense_player_12_run_defense_grades_stops_12w 
##                                                   16.565347 
##            defense_player_12_run_defense_grades_tackles_12w 
##                                                   20.054567 
##                                             home_attendance 
##                                                   14.448270</code></pre>
<pre class="r"><code>r2_starter &lt;- analyze_model(ols_model_starter, &quot;Starter Model with GIMR&quot;)</code></pre>
<pre><code>## 
## 
##  ================================================================================ 
## MODEL: Starter Model with GIMR 
## ================================================================================ 
## 
## Variable                                                         t-value     p-value   sig
## ---------                                                        -------     -------  ----
## (Intercept)                                                       3.0186      0.0026   ***
## ydstogo                                                         -13.1766      0.0000   ***
## posteam_timeouts_remaining                                        0.8490      0.3959      
## defteam_timeouts_remaining                                        0.9149      0.3603      
## rush_attempt                                                      7.1318      0.0000   ***
## week                                                             -0.0494      0.9606      
## temp                                                             -0.8388      0.4016      
## wind                                                              0.7265      0.4676      
## vegas_wp                                                          1.0828      0.2790      
## spread_line                                                      -0.1715      0.8638      
## total_line                                                        1.8015      0.0717     *
## prep_days                                                         1.1435      0.2529      
## overall_win_pct                                                   0.7026      0.4824      
## team_win_pct                                                      1.1903      0.2340      
## prev_win_pct                                                     -2.8689      0.0041   ***
## prev_shotgun_rate                                                 0.1812      0.8562      
## prev_singleback_rate                                              0.5318      0.5949      
## prev_empty_rate                                                   0.9659      0.3342      
## prev_iform_rate                                                  -0.0049      0.9961      
## prev_shotgun_success                                              0.9090      0.3634      
## prev_singleback_success                                           0.0493      0.9607      
## prev_empty_success                                               -0.0542      0.9568      
## prev_iform_success                                                2.7854      0.0054   ***
## prev_stop_rate_run                                               -0.4106      0.6814      
## prev_stop_rate_pass                                              -3.5478      0.0004   ***
## shotgun_rate                                                      1.1140      0.2653      
## singleback_rate                                                   0.2447      0.8067      
## empty_rate                                                       -0.1424      0.8868      
## iform_rate                                                       -1.5609      0.1186     .
## shotgun_success                                                  -2.3080      0.0211    **
## singleback_success                                               -1.6290      0.1034     .
## empty_success                                                    -1.0074      0.3138      
## iform_success                                                    -1.2810      0.2003      
## def_stop_rate_run                                                 1.5911      0.1117     .
## def_stop_rate_pass                                               -1.3648      0.1724      
## avg_pass_rushers                                                 -0.8608      0.3894      
## avg_box_defenders                                                -0.6200      0.5353      
## cover0_rate                                                      -0.2137      0.8308      
## cover1_rate                                                      -0.5737      0.5662      
## cover2_rate                                                      -0.5916      0.5542      
## cover3_rate                                                       0.9827      0.3258      
## cover4_rate                                                       0.4352      0.6635      
## cover6_rate                                                      -0.7043      0.4813      
## two_man_rate                                                      1.5177      0.1292     .
## prevent_rate                                                      2.8135      0.0049   ***
## roof_outdoors                                                    -0.0839      0.9332      
## posteam_type_home                                                -1.4877      0.1369     .
## offense_formation_EMPTY                                           0.0962      0.9233      
## offense_formation_SHOTGUN                                        -0.3578      0.7205      
## offense_formation_SINGLEBACK                                     -0.9783      0.3280      
## offense_formation_I_FORM                                         -0.8423      0.3997      
## starter_offense_player_1_passing_depth_short_grades_pass_12w      2.0366      0.0418    **
## starter_offense_player_1_passing_depth_medium_grades_pass...     -1.1881      0.2349      
## starter_offense_player_1_passing_depth_deep_grades_pass_12w      -0.5693      0.5692      
## starter_offense_player_1_rushing_grades_grades_run_12w           -1.4098      0.1587      
## starter_offense_player_4_rushing_grades_first_downs_12w           0.4258      0.6703      
## starter_offense_player_4_receiving_vs_scheme_zone_grades_...     -1.4365      0.1510      
## starter_offense_player_4_pass_blocking_true_pass_set_grad...     -0.6531      0.5137      
## starter_offense_player_4_rushing_grades_yards_after_conta...      0.4849      0.6278      
## starter_offense_player_8_receiving_depth_short_avg_depth_...     -0.1015      0.9192      
## starter_offense_player_8_blocking_grades_block_percent_12w        0.0839      0.9331      
## starter_offense_player_8_receiving_grades_targets_12w             1.5939      0.1111     .
## starter_offense_player_8_receiving_grades_yards_per_recep...      0.7606      0.4469      
## starter_offense_player_9_receiving_depth_short_avg_depth_...     -0.2699      0.7873      
## starter_offense_player_9_blocking_grades_block_percent_12w       -0.3542      0.7232      
## starter_offense_player_9_receiving_grades_targets_12w             0.0159      0.9873      
## starter_offense_player_9_receiving_grades_yards_per_recep...      2.3805      0.0173    **
## starter_offense_player_10_receiving_depth_short_avg_depth...      1.5514      0.1209     .
## starter_offense_player_10_blocking_grades_block_percent_12w      -0.4052      0.6853      
## starter_offense_player_10_receiving_grades_targets_12w           -0.7711      0.4407      
## starter_offense_player_10_receiving_grades_yards_per_rece...      0.0638      0.9491      
## starter_offense_player_14_blocking_grades_snap_counts_blo...      0.2916      0.7706      
## starter_offense_player_14_receiving_vs_scheme_zone_caught...     -0.9236      0.3557      
## starter_offense_player_14_receiving_depth_center_short_pa...     -2.1877      0.0288    **
## starter_offense_player_14_receiving_concept_slot_targets_12w      1.1895      0.2343      
## starter_offense_player_17_run_blocking_snap_counts_run_bl...     -1.4665      0.1426     .
## starter_offense_player_17_blocking_grades_grades_offense_12w      2.1598      0.0309    **
## starter_offense_player_17_blocking_grades_pbe_2w                  0.8985      0.3690      
## starter_offense_player_18_run_blocking_snap_counts_run_bl...      1.1929      0.2330      
## starter_offense_player_18_blocking_grades_grades_offense_12w     -1.5672      0.1172     .
## starter_offense_player_18_blocking_grades_pbe_2w                  1.2633      0.2066      
## starter_offense_player_19_run_blocking_snap_counts_run_bl...     -1.3216      0.1864      
## starter_offense_player_19_blocking_grades_grades_offense_12w      0.2041      0.8383      
## starter_offense_player_19_blocking_grades_pbe_2w                 -0.4748      0.6350      
## starter_offense_player_20_run_blocking_snap_counts_run_bl...     -0.1082      0.9138      
## starter_offense_player_20_blocking_grades_grades_offense_12w      1.1955      0.2320      
## starter_offense_player_20_blocking_grades_pbe_2w                 -1.0873      0.2770      
## starter_offense_player_21_run_blocking_snap_counts_run_bl...      1.3217      0.1863      
## starter_offense_player_21_blocking_grades_grades_offense_12w     -1.6909      0.0910     *
## starter_offense_player_21_blocking_grades_pbe_2w                  0.2658      0.7904      
## starter_defense_player_1_pass_rushing_productivity_prp_12w        0.9183      0.3585      
## starter_defense_player_1_pass_rushing_productivity_hurrie...     -2.0616      0.0393    **
## starter_defense_player_1_defensive_grades_grades_defense_...      0.4095      0.6822      
## starter_defense_player_1_run_defense_grades_stops_12w             1.2717      0.2036      
## starter_defense_player_1_run_defense_grades_tackles_12w          -1.8997      0.0575     *
## starter_defense_player_2_pass_rushing_productivity_prp_12w        0.2948      0.7682      
## starter_defense_player_2_pass_rushing_productivity_hurrie...      0.1225      0.9025      
## starter_defense_player_2_defensive_grades_grades_defense_...     -2.3631      0.0182    **
## starter_defense_player_2_run_defense_grades_stops_12w            -0.4556      0.6487      
## starter_defense_player_2_run_defense_grades_tackles_12w           0.7181      0.4728      
## starter_defense_player_3_pass_rushing_productivity_prp_12w        1.8608      0.0629     *
## starter_defense_player_3_pass_rushing_productivity_hurrie...     -1.5831      0.1135     .
## starter_defense_player_3_defensive_grades_grades_defense_...     -0.2558      0.7981      
## starter_defense_player_3_run_defense_grades_stops_12w             0.3437      0.7311      
## starter_defense_player_3_run_defense_grades_tackles_12w          -0.2013      0.8405      
## starter_defense_player_4_pass_rushing_productivity_prp_12w       -0.3679      0.7129      
## starter_defense_player_4_pass_rushing_productivity_hurrie...     -0.3252      0.7451      
## starter_defense_player_4_defensive_grades_grades_defense_...     -0.1387      0.8897      
## starter_defense_player_4_run_defense_grades_stops_12w            -0.8817      0.3780      
## starter_defense_player_4_run_defense_grades_tackles_12w           0.9352      0.3498      
## starter_defense_player_9_pass_rushing_productivity_prp_12w       -0.2049      0.8376      
## starter_defense_player_9_pass_rushing_productivity_hurrie...      0.2581      0.7963      
## starter_defense_player_9_defensive_grades_grades_defense_...      0.3602      0.7187      
## starter_defense_player_9_run_defense_grades_stops_12w             0.7447      0.4565      
## starter_defense_player_9_run_defense_grades_tackles_12w          -1.6878      0.0915     *
## starter_defense_player_9_defensive_grades_snap_counts_cov...     -1.1141      0.2653      
## starter_defense_player_9_coverage_schemes_zone_stops_12w          0.0963      0.9233      
## starter_defense_player_10_pass_rushing_productivity_prp_12w      -0.0056      0.9955      
## starter_defense_player_10_pass_rushing_productivity_hurri...      0.4956      0.6202      
## starter_defense_player_10_defensive_grades_grades_defense...      1.2680      0.2049      
## starter_defense_player_10_run_defense_grades_stops_12w            0.3868      0.6990      
## starter_defense_player_10_run_defense_grades_tackles_12w         -0.9467      0.3439      
## starter_defense_player_10_defensive_grades_snap_counts_co...      0.7662      0.4436      
## starter_defense_player_10_coverage_schemes_zone_stops_12w        -0.0907      0.9277      
## starter_defense_player_11_pass_rushing_productivity_prp_12w       0.5151      0.6065      
## starter_defense_player_11_pass_rushing_productivity_hurri...      1.3487      0.1775      
## starter_defense_player_11_defensive_grades_grades_defense...     -1.2061      0.2278      
## starter_defense_player_11_run_defense_grades_stops_12w            0.1753      0.8609      
## starter_defense_player_11_run_defense_grades_tackles_12w         -0.7162      0.4739      
## starter_defense_player_11_defensive_grades_snap_counts_co...      0.5410      0.5885      
## starter_defense_player_11_coverage_schemes_zone_stops_12w        -1.1147      0.2651      
## starter_defense_player_12_pass_rushing_productivity_prp_12w       1.0673      0.2859      
## starter_defense_player_12_pass_rushing_productivity_hurri...     -0.3377      0.7356      
## starter_defense_player_12_defensive_grades_grades_defense...      1.0290      0.3035      
## starter_defense_player_12_run_defense_grades_stops_12w           -0.0983      0.9217      
## starter_defense_player_12_run_defense_grades_tackles_12w          0.0023      0.9981      
## starter_defense_player_12_defensive_grades_snap_counts_co...      1.0352      0.3007      
## starter_defense_player_12_coverage_schemes_zone_stops_12w        -0.8385      0.4018      
## starter_defense_player_15_defensive_grades_grades_defense...     -0.3687      0.7124      
## starter_defense_player_15_run_defense_grades_tackles_12w         -0.1584      0.8742      
## starter_defense_player_15_coverage_schemes_man_coverage_s...     -1.2602      0.2077      
## starter_defense_player_15_coverage_grades_stops_12w               0.1049      0.9165      
## starter_defense_player_15_slot_coverage_targets_12w               2.2442      0.0249    **
## starter_defense_player_15_defensive_grades_missed_tackle_...     -0.5038      0.6144      
## starter_defense_player_16_defensive_grades_grades_defense...     -0.2801      0.7794      
## starter_defense_player_16_run_defense_grades_tackles_12w         -1.8474      0.0648     *
## starter_defense_player_16_coverage_schemes_man_coverage_s...      1.3007      0.1934      
## starter_defense_player_16_coverage_grades_stops_12w              -1.0751      0.2824      
## starter_defense_player_16_slot_coverage_targets_12w              -1.5857      0.1129     .
## starter_defense_player_16_defensive_grades_missed_tackle_...      1.3713      0.1704      
## starter_defense_player_17_defensive_grades_grades_defense...     -0.2736      0.7844      
## starter_defense_player_17_run_defense_grades_tackles_12w          0.5475      0.5841      
## starter_defense_player_17_coverage_schemes_man_coverage_s...     -1.4565      0.1453     .
## starter_defense_player_17_coverage_grades_stops_12w              -0.0591      0.9529      
## starter_defense_player_17_slot_coverage_targets_12w               0.1437      0.8857      
## starter_defense_player_17_defensive_grades_missed_tackle_...     -0.6573      0.5111      
## starter_defense_player_20_defensive_grades_grades_defense...     -1.6249      0.1043     .
## starter_defense_player_20_run_defense_grades_tackles_12w          0.6094      0.5423      
## starter_defense_player_20_coverage_grades_stops_12w              -0.1299      0.8966      
## starter_defense_player_20_slot_coverage_targets_12w               1.0678      0.2857      
## starter_defense_player_20_defensive_grades_missed_tackle_...     -1.4712      0.1413     .
## starter_defense_player_21_defensive_grades_grades_defense...      3.2593      0.0011   ***
## starter_defense_player_21_run_defense_grades_tackles_12w         -1.3787      0.1681      
## starter_defense_player_21_coverage_grades_stops_12w               0.4257      0.6704      
## starter_defense_player_21_slot_coverage_targets_12w              -1.6999      0.0892     *
## starter_defense_player_21_defensive_grades_missed_tackle_...     -0.1061      0.9155      
## starter_defense_player_22_defensive_grades_grades_defense...     -0.1474      0.8828      
## starter_defense_player_22_run_defense_grades_tackles_12w          0.0912      0.9274      
## starter_defense_player_22_coverage_grades_stops_12w              -1.5101      0.1311     .
## starter_defense_player_22_slot_coverage_targets_12w               0.8314      0.4058      
## starter_defense_player_22_defensive_grades_missed_tackle_...     -0.0568      0.9547      
## yardline_1_10                                                    -2.7796      0.0055   ***
## yardline_11_20                                                   -0.0893      0.9289      
## yardline_21_30                                                    0.0867      0.9309      
## yardline_41_50                                                    1.7990      0.0721     *
## yardline_51_60                                                    0.5193      0.6036      
## yardline_61_70                                                    1.2948      0.1955      
## yardline_71_80                                                    1.5938      0.1111     .
## yardline_81_90                                                    1.9198      0.0550     *
## yardline_91_100                                                   1.0297      0.3032      
## year2017_team_ARI                                                 0.5871      0.5572      
## year2017_team_BUF                                                -0.6226      0.5336      
## year2017_team_CHI                                                -0.0448      0.9642      
## year2017_team_CLE                                                 0.6466      0.5179      
## year2017_team_DAL                                                -0.8382      0.4020      
## year2017_team_DET                                                -0.4218      0.6732      
## year2017_team_GB                                                  2.1713      0.0300    **
## year2017_team_HOU                                                 1.6112      0.1072     .
## year2017_team_MIA                                                -0.9083      0.3638      
## year2017_team_MIN                                                -0.4651      0.6419      
## year2017_team_NE                                                 -0.2193      0.8264      
## year2017_team_SF                                                  1.6487      0.0993     *
## year2017_team_BAL                                                 0.1006      0.9199      
## year2017_team_DEN                                                -0.0442      0.9647      
## year2017_team_LA                                                  0.5029      0.6151      
## year2017_team_NYG                                                -0.2151      0.8297      
## year2017_team_OAK                                                -0.7244      0.4689      
## year2017_team_SEA                                                 0.5379      0.5906      
## year2017_team_CAR                                                 0.3898      0.6967      
## year2017_team_CIN                                                 0.8388      0.4017      
## year2017_team_IND                                                 0.9314      0.3517      
## year2017_team_NO                                                  0.5516      0.5812      
## year2017_team_PHI                                                 0.1465      0.8836      
## year2017_team_PIT                                                -0.6845      0.4937      
## year2017_team_TEN                                                 0.4007      0.6887      
## year2017_team_WAS                                                 0.2987      0.7652      
## year2017_team_KC                                                  1.5601      0.1188     .
## year2017_team_LAC                                                -0.0076      0.9939      
## year2017_team_NYJ                                                 0.6015      0.5475      
## year2017_team_TB                                                 -0.1029      0.9181      
## year2017_team_ATL                                                -0.2980      0.7658      
## year2017_team_JAX                                                 0.3603      0.7187      
## year2018_team_ARI                                                 0.7192      0.4721      
## year2018_team_BAL                                                 0.6587      0.5101      
## year2018_team_CAR                                                 0.8730      0.3827      
## year2018_team_CLE                                                -0.1627      0.8708      
## year2018_team_DET                                                 0.8305      0.4063      
## year2018_team_HOU                                                 0.8539      0.3932      
## year2018_team_IND                                                -0.3740      0.7084      
## year2018_team_KC                                                  1.0203      0.3077      
## year2018_team_NYG                                                 0.6091      0.5425      
## year2018_team_OAK                                                -0.3102      0.7564      
## year2018_team_PHI                                                 0.3342      0.7382      
## year2018_team_SEA                                                 0.0879      0.9300      
## year2018_team_BUF                                                -0.3044      0.7608      
## year2018_team_CHI                                                 0.1746      0.8614      
## year2018_team_CIN                                                -0.2969      0.7666      
## year2018_team_DAL                                                 0.4923      0.6225      
## year2018_team_DEN                                                 0.0932      0.9257      
## year2018_team_GB                                                  0.2620      0.7933      
## year2018_team_LAC                                                 0.6836      0.4943      
## year2018_team_NE                                                 -0.6427      0.5204      
## year2018_team_NO                                                  0.9624      0.3359      
## year2018_team_PIT                                                 0.6937      0.4879      
## year2018_team_SF                                                  0.3434      0.7313      
## year2018_team_MIA                                                 1.1508      0.2499      
## year2018_team_MIN                                                 0.8560      0.3920      
## year2018_team_NYJ                                                 0.4578      0.6471      
## year2018_team_TB                                                 -0.2851      0.7756      
## year2018_team_ATL                                                 0.6203      0.5351      
## year2018_team_JAX                                                 0.5613      0.5746      
## year2018_team_LA                                                 -0.4795      0.6316      
## year2018_team_TEN                                                 1.3031      0.1926      
## year2018_team_WAS                                                 0.4424      0.6582      
## year2019_team_ARI                                                -0.4360      0.6629      
## year2019_team_BUF                                                -0.4342      0.6642      
## year2019_team_CHI                                                 0.6098      0.5421      
## year2019_team_CLE                                                 0.6541      0.5131      
## year2019_team_DAL                                                 0.0922      0.9265      
## year2019_team_IND                                                -0.4778      0.6328      
## year2019_team_JAX                                                 0.8042      0.4213      
## year2019_team_KC                                                  0.2066      0.8363      
## year2019_team_LAC                                                -0.5803      0.5618      
## year2019_team_MIN                                                -0.5224      0.6014      
## year2019_team_NE                                                 -0.0819      0.9347      
## year2019_team_NO                                                 -0.9011      0.3676      
## year2019_team_PHI                                                 0.4007      0.6887      
## year2019_team_SEA                                                 0.2844      0.7761      
## year2019_team_SF                                                  0.2039      0.8384      
## year2019_team_TB                                                 -0.9909      0.3218      
## year2019_team_BAL                                                 0.0213      0.9830      
## year2019_team_CAR                                                -0.7913      0.4288      
## year2019_team_DEN                                                 1.0278      0.3041      
## year2019_team_DET                                                -0.6054      0.5450      
## year2019_team_HOU                                                -0.1315      0.8954      
## year2019_team_LA                                                 -0.9274      0.3538      
## year2019_team_MIA                                                -1.4529      0.1463     .
## year2019_team_NYG                                                -0.6425      0.5206      
## year2019_team_NYJ                                                -1.2167      0.2238      
## year2019_team_OAK                                                 0.1259      0.8998      
## year2019_team_PIT                                                -2.5359      0.0113    **
## year2019_team_TEN                                                -0.9614      0.3364      
## year2019_team_CIN                                                -0.0968      0.9229      
## year2019_team_WAS                                                 0.2359      0.8136      
## year2019_team_ATL                                                 0.2677      0.7889      
## year2019_team_GB                                                 -0.4218      0.6732      
## year2020_team_ATL                                                 0.6037      0.5461      
## year2020_team_BAL                                                 0.9952      0.3197      
## year2020_team_BUF                                                 0.2169      0.8283      
## year2020_team_CAR                                                 1.0494      0.2941      
## year2020_team_CIN                                                 0.5634      0.5732      
## year2020_team_DEN                                                 0.3066      0.7592      
## year2020_team_DET                                                -0.3077      0.7583      
## year2020_team_JAX                                                -0.0803      0.9360      
## year2020_team_KC                                                  0.0334      0.9733      
## year2020_team_LA                                                 -0.7677      0.4427      
## year2020_team_MIN                                                 1.2790      0.2010      
## year2020_team_NE                                                  0.2495      0.8030      
## year2020_team_NO                                                  0.5289      0.5969      
## year2020_team_NYG                                                 0.3301      0.7413      
## year2020_team_SF                                                  0.6795      0.4969      
## year2020_team_WAS                                                 0.4281      0.6686      
## year2020_team_CHI                                                 0.7127      0.4761      
## year2020_team_DAL                                                 0.3338      0.7385      
## year2020_team_GB                                                  0.4937      0.6216      
## year2020_team_HOU                                                -0.7667      0.4433      
## year2020_team_MIA                                                -0.7308      0.4649      
## year2020_team_NYJ                                                 0.1736      0.8622      
## year2020_team_TB                                                  0.6238      0.5328      
## year2020_team_TEN                                                 0.0106      0.9916      
## year2020_team_ARI                                                 0.7566      0.4494      
## year2020_team_CLE                                                -1.0637      0.2875      
## year2020_team_IND                                                -0.4210      0.6738      
## year2020_team_LAC                                                 0.0639      0.9490      
## year2020_team_PHI                                                 1.2537      0.2100      
## year2020_team_SEA                                                -0.1494      0.8813      
## year2020_team_LV                                                  0.7451      0.4563      
## year2020_team_PIT                                                -0.1430      0.8863      
## year2021_team_ATL                                                -1.6462      0.0998     *
## year2021_team_BUF                                                 0.4214      0.6735      
## year2021_team_CIN                                                -1.3095      0.1904      
## year2021_team_DAL                                                -0.4047      0.6858      
## year2021_team_DEN                                                 1.4923      0.1357     .
## year2021_team_DET                                                -0.3790      0.7047      
## year2021_team_KC                                                  0.7463      0.4555      
## year2021_team_LA                                                  0.0416      0.9668      
## year2021_team_LV                                                  0.4969      0.6193      
## year2021_team_MIN                                                -0.3644      0.7156      
## year2021_team_NE                                                  0.6850      0.4934      
## year2021_team_NO                                                  0.3402      0.7337      
## year2021_team_NYG                                                -0.2426      0.8083      
## year2021_team_SF                                                  0.5815      0.5609      
## year2021_team_TEN                                                -0.3947      0.6931      
## year2021_team_ARI                                                 0.9664      0.3339      
## year2021_team_BAL                                                 0.9657      0.3343      
## year2021_team_CAR                                                -0.2473      0.8047      
## year2021_team_CHI                                                -1.4418      0.1494     .
## year2021_team_GB                                                  1.3767      0.1687      
## year2021_team_IND                                                 0.1424      0.8868      
## year2021_team_LAC                                                 0.0807      0.9357      
## year2021_team_MIA                                                 0.1705      0.8646      
## year2021_team_NYJ                                                -0.1606      0.8724      
## year2021_team_PHI                                                -1.5897      0.1120     .
## year2021_team_SEA                                                -0.8251      0.4094      
## year2021_team_TB                                                  0.1766      0.8598      
## year2021_team_WAS                                                -0.4446      0.6566      
## year2021_team_CLE                                                -0.7375      0.4609      
## year2021_team_HOU                                                -0.9914      0.3216      
## year2021_team_JAX                                                 0.2953      0.7678      
## year2021_team_PIT                                                 0.5338      0.5935      
## year2022_team_ARI                                                -0.7815      0.4346      
## year2022_team_ATL                                                -1.9191      0.0550     *
## year2022_team_CAR                                                 1.2698      0.2042      
## year2022_team_CHI                                                 0.1360      0.8918      
## year2022_team_CIN                                                -0.4433      0.6576      
## year2022_team_HOU                                                -0.3090      0.7574      
## year2022_team_IND                                                -0.4674      0.6402      
## year2022_team_LAC                                                -0.6101      0.5418      
## year2022_team_MIA                                                -1.0172      0.3091      
## year2022_team_SEA                                                -0.1341      0.8934      
## year2022_team_TB                                                  0.4524      0.6510      
## year2022_team_TEN                                                 1.5894      0.1121     .
## year2022_team_WAS                                                 0.2494      0.8031      
## year2022_team_BAL                                                -1.0839      0.2785      
## year2022_team_BUF                                                 1.1354      0.2563      
## year2022_team_DAL                                                 0.1147      0.9087      
## year2022_team_DET                                                 0.1172      0.9067      
## year2022_team_GB                                                 -0.5659      0.5715      
## year2022_team_JAX                                                -0.7244      0.4689      
## year2022_team_KC                                                 -0.2496      0.8029      
## year2022_team_LA                                                  1.5623      0.1183     .
## year2022_team_LV                                                  1.2871      0.1981      
## year2022_team_NO                                                 -0.2997      0.7645      
## year2022_team_PHI                                                 0.7583      0.4483      
## year2022_team_PIT                                                 2.4676      0.0136    **
## year2022_team_DEN                                                 0.6597      0.5095      
## year2022_team_MIN                                                -0.8429      0.3993      
## year2022_team_NE                                                  0.3879      0.6981      
## year2022_team_NYJ                                                -0.9831      0.3256      
## year2022_team_NYG                                                -0.7464      0.4555      
## year2022_team_SF                                                 -0.9257      0.3546      
## year2023_team_BAL                                                 0.2768      0.7819      
## year2023_team_CHI                                                -0.6601      0.5092      
## year2023_team_CLE                                                -0.7304      0.4652      
## year2023_team_GB                                                  0.8478      0.3966      
## year2023_team_IND                                                 1.3954      0.1630      
## year2023_team_KC                                                  0.7210      0.4710      
## year2023_team_LAC                                                 0.6765      0.4988      
## year2023_team_LV                                                  0.5830      0.5599      
## year2023_team_MIA                                                 0.3187      0.7499      
## year2023_team_MIN                                                 2.1632      0.0306    **
## year2023_team_NO                                                 -0.5514      0.5814      
## year2023_team_NYG                                                 0.8631      0.3881      
## year2023_team_SEA                                                -1.6594      0.0971     *
## year2023_team_SF                                                  0.6901      0.4902      
## year2023_team_WAS                                                 1.5177      0.1292     .
## year2023_team_ATL                                                -0.5382      0.5905      
## year2023_team_BUF                                                -0.0485      0.9613      
## year2023_team_CAR                                                 1.1794      0.2383      
## year2023_team_DAL                                                 0.7814      0.4346      
## year2023_team_DEN                                                 0.1022      0.9186      
## year2023_team_HOU                                                 0.1433      0.8860      
## year2023_team_LA                                                  0.2806      0.7790      
## year2023_team_NE                                                  0.2969      0.7666      
## year2023_team_PHI                                                 0.0633      0.9495      
## year2023_team_PIT                                                 0.0863      0.9312      
## year2023_team_TEN                                                 0.3152      0.7526      
## year2023_team_ARI                                                -1.1002      0.2713      
## year2023_team_CIN                                                -1.1169      0.2641      
## year2023_team_DET                                                 0.7227      0.4699      
## year2023_team_TB                                                  1.2791      0.2010      
## year2023_team_JAX                                                -0.4832      0.6290      
## year2023_team_NYJ                                                 2.1131      0.0347    **
## is_first_half                                                    -0.3951      0.6928      
## time_in_half                                                      1.9068      0.0566     *
## home_attendance                                                  -0.1336      0.8937      
## GIMR                                                              2.2668      0.0235    **
## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15
## 
## Adjusted R-squared: 0.1143391 
## 
## Variables with VIF &gt; 5:
##                                                      prev_shotgun_rate 
##                                                              10.496521 
##                                                   prev_singleback_rate 
##                                                               6.051029 
##                                                        prev_iform_rate 
##                                                               5.330309 
##                                                            cover1_rate 
##                                                               6.456600 
##                                                            cover3_rate 
##                                                               6.767717 
##                                              offense_formation_SHOTGUN 
##                                                               5.705618 
##           starter_offense_player_1_passing_depth_short_grades_pass_12w 
##                                                              19.141854 
##          starter_offense_player_1_passing_depth_medium_grades_pass_12w 
##                                                               9.067063 
##            starter_offense_player_1_passing_depth_deep_grades_pass_12w 
##                                                               7.960209 
##                 starter_offense_player_1_rushing_grades_grades_run_12w 
##                                                              10.129384 
## starter_offense_player_8_receiving_depth_short_avg_depth_of_target_12w 
##                                                               6.162659 
##             starter_offense_player_8_blocking_grades_block_percent_12w 
##                                                               8.230531 
##             starter_offense_player_9_blocking_grades_block_percent_12w 
##                                                               5.933606 
##       starter_offense_player_17_run_blocking_snap_counts_run_block_12w 
##                                                               5.607566 
##           starter_offense_player_17_blocking_grades_grades_offense_12w 
##                                                              15.970339 
##                       starter_offense_player_17_blocking_grades_pbe_2w 
##                                                             209.495479 
##       starter_offense_player_18_run_blocking_snap_counts_run_block_12w 
##                                                               6.800924 
##           starter_offense_player_18_blocking_grades_grades_offense_12w 
##                                                              15.576527 
##                       starter_offense_player_18_blocking_grades_pbe_2w 
##                                                             204.729752 
##       starter_offense_player_19_run_blocking_snap_counts_run_block_12w 
##                                                               5.876089 
##           starter_offense_player_19_blocking_grades_grades_offense_12w 
##                                                              13.616567 
##                       starter_offense_player_19_blocking_grades_pbe_2w 
##                                                             220.697500 
##       starter_offense_player_20_run_blocking_snap_counts_run_block_12w 
##                                                               5.942488 
##           starter_offense_player_20_blocking_grades_grades_offense_12w 
##                                                              14.663826 
##                       starter_offense_player_20_blocking_grades_pbe_2w 
##                                                             209.708437 
##           starter_offense_player_21_blocking_grades_grades_offense_12w 
##                                                              13.334215 
##                       starter_offense_player_21_blocking_grades_pbe_2w 
##                                                             147.044572 
##             starter_defense_player_1_pass_rushing_productivity_prp_12w 
##                                                               5.450429 
##                  starter_defense_player_1_run_defense_grades_stops_12w 
##                                                              13.082004 
##                starter_defense_player_1_run_defense_grades_tackles_12w 
##                                                              13.914144 
##             starter_defense_player_2_pass_rushing_productivity_prp_12w 
##                                                               5.635771 
##         starter_defense_player_2_pass_rushing_productivity_hurries_12w 
##                                                               5.101776 
##   starter_defense_player_2_defensive_grades_grades_defense_penalty_12w 
##                                                               6.423636 
##                  starter_defense_player_2_run_defense_grades_stops_12w 
##                                                              13.346581 
##                starter_defense_player_2_run_defense_grades_tackles_12w 
##                                                              14.236091 
##   starter_defense_player_3_defensive_grades_grades_defense_penalty_12w 
##                                                               6.722270 
##                  starter_defense_player_3_run_defense_grades_stops_12w 
##                                                              11.399905 
##                starter_defense_player_3_run_defense_grades_tackles_12w 
##                                                              11.473551 
##   starter_defense_player_4_defensive_grades_grades_defense_penalty_12w 
##                                                               6.637496 
##                  starter_defense_player_4_run_defense_grades_stops_12w 
##                                                              12.429268 
##                starter_defense_player_4_run_defense_grades_tackles_12w 
##                                                              13.031403 
##   starter_defense_player_9_defensive_grades_grades_defense_penalty_12w 
##                                                               9.177728 
##                  starter_defense_player_9_run_defense_grades_stops_12w 
##                                                               8.315920 
##                starter_defense_player_9_run_defense_grades_tackles_12w 
##                                                              10.090503 
##  starter_defense_player_10_defensive_grades_grades_defense_penalty_12w 
##                                                               8.017525 
##                 starter_defense_player_10_run_defense_grades_stops_12w 
##                                                               9.781978 
##               starter_defense_player_10_run_defense_grades_tackles_12w 
##                                                              12.601662 
##    starter_defense_player_10_defensive_grades_snap_counts_coverage_12w 
##                                                               5.518138 
##  starter_defense_player_11_defensive_grades_grades_defense_penalty_12w 
##                                                               7.614757 
##                 starter_defense_player_11_run_defense_grades_stops_12w 
##                                                               9.089872 
##               starter_defense_player_11_run_defense_grades_tackles_12w 
##                                                              11.232564 
##                 starter_defense_player_12_run_defense_grades_stops_12w 
##                                                               9.213585 
##               starter_defense_player_12_run_defense_grades_tackles_12w 
##                                                              11.524755 
##  starter_defense_player_15_defensive_grades_grades_defense_penalty_12w 
##                                                              15.543746 
##  starter_defense_player_16_defensive_grades_grades_defense_penalty_12w 
##                                                               8.385633 
##  starter_defense_player_17_defensive_grades_grades_defense_penalty_12w 
##                                                               5.425720 
##  starter_defense_player_20_defensive_grades_grades_defense_penalty_12w 
##                                                              12.148486 
##  starter_defense_player_21_defensive_grades_grades_defense_penalty_12w 
##                                                               7.784310 
##                                                        home_attendance 
##                                                              14.600958</code></pre>
<pre class="r"><code># Compare R-squared values
cat(&quot;\n\n&quot;, paste(rep(&quot;=&quot;, 80), collapse=&quot;&quot;), &quot;\n&quot;)</code></pre>
<pre><code>## 
## 
##  ================================================================================</code></pre>
<pre class="r"><code>cat(&quot;MODEL COMPARISON - Adjusted R-squared values\n&quot;)</code></pre>
<pre><code>## MODEL COMPARISON - Adjusted R-squared values</code></pre>
<pre class="r"><code>cat(paste(rep(&quot;=&quot;, 80), collapse=&quot;&quot;), &quot;\n\n&quot;)</code></pre>
<pre><code>## ================================================================================</code></pre>
<pre class="r"><code>cat(&quot;Player Model with GIMR:&quot;, r2_player, &quot;\n&quot;)</code></pre>
<pre><code>## Player Model with GIMR: 0.1113271</code></pre>
<pre class="r"><code>cat(&quot;Starter Model with GIMR:&quot;, r2_starter, &quot;\n&quot;)</code></pre>
<pre><code>## Starter Model with GIMR: 0.1143391</code></pre>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIkhlY2ttYW4gU2VsZWN0aW9uIE1vZGVsIEFuYWx5c2lzIg0Kb3V0cHV0OiBodG1sX2RvY3VtZW50DQotLS0NCg0KYGBge3Igb3B0aW9ucywgaW5jbHVkZT1GQUxTRX0NCm9wdGlvbnMobWF4LnByaW50PTEwMDAwKQ0KYGBgDQoNCmBgYHtyfQ0KbGlicmFyeShkYXRhLnRhYmxlKQ0Kb3V0Y29tZV9kYXRhIDwtIGZyZWFkKCJwcmVkaWN0X291dGNvbWUuY3N2Lmd6IikNCnNlbGVjdF9kYXRhIDwtIGZyZWFkKCJwcmVkaWN0X3NlbGVjdC5jc3YuZ3oiKQ0KYGBgDQoNCmBgYHtyfQ0Kc2VsZWN0X2RhdGFbLCBzY29yZV9kaWZmIDo9IGFzLmludGVnZXIoc2NvcmVfZGlmZiA+IDApXQ0KYGBgDQoNCg0KDQpgYGB7cn0NCiMnIEZpbHRlciBmb3Igc3BlY2lmaWMgcGxheWVyIGRhdGEgKG9mZmVuc2Ugb3IgZGVmZW5zZSkNCiMgZmlsdGVyX3NwZWNpZmljX3BsYXllciA8LSBmdW5jdGlvbihkYXRhLCBzaWRlID0gIm9mZmVuc2UiLCBwbGF5ZXIgPSAxKSB7DQojICAgIyBDcmVhdGUgYSBjb3B5IHRvIGF2b2lkIG1vZGlmeWluZyB0aGUgb3JpZ2luYWwNCiMgICBkdCA8LSBjb3B5KGRhdGEpDQojICAgDQojICAgIyBCdWlsZCBwYXR0ZXJucyBmb3IgY29sdW1ucyB0byBrZWVwDQojICAgIyBXZSB3YW50IHRvIGtlZXAgMyB0eXBlcyBvZiBjb2x1bW5zOg0KIyAgICMgMS4gUmVndWxhciBwbGF5ZXIgY29sdW1uOiBzaWRlX3BsYXllcl9udW1iZXJfKg0KIyAgICMgMi4gUGxheWVyIHByZXNlbnQgY29sdW1uOiBzaWRlX3BsYXllcl9udW1iZXJfcHJlc2VudA0KIyAgICMgMy4gU3RhcnRlciBwbGF5ZXIgY29sdW1uOiBzdGFydGVyX3NpZGVfcGxheWVyX251bWJlcl8qDQojICAgDQojICAgIyBJZGVudGlmeSBhbGwgcGxheWVyLXJlbGF0ZWQgY29sdW1ucyAoYm90aCBub3JtYWwgYW5kIHN0YXJ0ZXIpDQojICAgYWxsX3BsYXllcl9jb2xzIDwtIGdyZXAoInBsYXllcl8iLCBuYW1lcyhkdCksIHZhbHVlID0gVFJVRSkNCiMgICANCiMgICAjIENyZWF0ZSBwYXR0ZXJucyBmb3IgdGhlIDMgdHlwZXMgb2YgY29sdW1ucyB3ZSB3YW50IHRvIGtlZXANCiMgICBwbGF5ZXJfcGF0dGVybiA8LSBwYXN0ZTAoIl4iLCBzaWRlLCAiX3BsYXllcl8iLCBwbGF5ZXIsICJfIikNCiMgICBwcmVzZW50X3BhdHRlcm4gPC0gcGFzdGUwKCJeIiwgc2lkZSwgIl9wbGF5ZXJfIiwgcGxheWVyLCAiX3ByZXNlbnQkIikNCiMgICBzdGFydGVyX3BhdHRlcm4gPC0gcGFzdGUwKCJec3RhcnRlcl8iLCBzaWRlLCAiX3BsYXllcl8iLCBwbGF5ZXIsICJfIikNCiMgICANCiMgICAjIENvbWJpbmUgcGF0dGVybnMNCiMgICBrZWVwX3BhdHRlcm4gPC0gcGFzdGUocGxheWVyX3BhdHRlcm4sIHByZXNlbnRfcGF0dGVybiwgc3RhcnRlcl9wYXR0ZXJuLCBzZXAgPSAifCIpDQojICAgDQojICAgIyBGaW5kIGNvbHVtbnMgdG8ga2VlcA0KIyAgIGNvbHNfdG9fa2VlcCA8LSBncmVwKGtlZXBfcGF0dGVybiwgYWxsX3BsYXllcl9jb2xzLCB2YWx1ZSA9IFRSVUUpDQojICAgDQojICAgIyBGaW5kIGFsbCBwbGF5ZXIgY29sdW1ucyB0byByZW1vdmUgKGFsbCBwbGF5ZXIgY29sdW1ucyBleGNlcHQgdGhvc2UgdG8ga2VlcCkNCiMgICBjb2xzX3RvX3JlbW92ZSA8LSBzZXRkaWZmKGFsbF9wbGF5ZXJfY29scywgY29sc190b19rZWVwKQ0KIyAgIA0KIyAgICMgUmVtb3ZlIHVud2FudGVkIHBsYXllciBjb2x1bW5zDQojICAgZm9yIChjb2wgaW4gY29sc190b19yZW1vdmUpIHsNCiMgICAgIGR0WywgKGNvbCkgOj0gTlVMTF0NCiMgICB9DQojICAgDQojICAgIyBSZXR1cm4gZmlsdGVyZWQgZGF0YQ0KIyAgIHJldHVybihkdCkNCiMgfQ0KIyANCiMgIyBGaWx0ZXIgdG8ga2VlcCBvbmx5IG9mZmVuc2UgcGxheWVyIDEgY29sdW1ucw0KIyBvdXRjb21lX2RhdGEgPC0gZmlsdGVyX3NwZWNpZmljX3BsYXllcihvdXRjb21lX2RhdGEsIHNpZGUgPSAib2ZmZW5zZSIsIHBsYXllciA9IDEpDQojIA0KIyAjIFNob3cgcmVtYWluaW5nIHBsYXllciBjb2x1bW5zDQojIHJlbWFpbmluZ19wbGF5ZXJfY29scyA8LSBncmVwKCJwbGF5ZXJfIiwgbmFtZXMob3V0Y29tZV9kYXRhKSwgdmFsdWUgPSBUUlVFKQ0KIyBwcmludCgiUmVtYWluaW5nIHBsYXllciBjb2x1bW5zOiIpDQojIHByaW50KHJlbWFpbmluZ19wbGF5ZXJfY29scykNCmBgYA0KDQoNCmBgYHtyfQ0Kc2VsZWN0X2RhdGFbLCBhdHRlbXB0IDo9IGFzLm51bWVyaWMoYXMuY2hhcmFjdGVyKGF0dGVtcHQpKV0NCmBgYA0KDQpgYGB7cn0NCmxpYnJhcnkoZGF0YS50YWJsZSkNCmxpYnJhcnkoeGdib29zdCkNCmxpYnJhcnkoUk9DUikNCmxpYnJhcnkocGFyYWxsZWwpDQoNCiMgUHJlcGFyZSB0aGUgWEdCb29zdCBtYXRyaWNlcw0KeHMgPC0gbW9kZWwubWF0cml4KH4gLiAtIDEgLSBhdHRlbXB0IC0gbXlfaWQsIGRhdGEgPSBzZWxlY3RfZGF0YSkNCnkgPC0gYXMubnVtZXJpYyhhcy5jaGFyYWN0ZXIoc2VsZWN0X2RhdGEkYXR0ZW1wdCkpDQoNCg0KIyBDcmVhdGUgcGFyYW1ldGVyIGdyaWQNCmdyaWQgPC0gZXhwYW5kLmdyaWQoDQogIGV0YSA9IHNlcSgwLjAwMSwgMC4wMywgYnkgPSAwLjAxKSwNCiAgbWF4X2RlcHRoID0gc2VxKDUsIDUsIGJ5ID0gMiksDQogIG1pbl9jaGlsZF93ZWlnaHQgPSBzZXEoMSwgMSwgYnkgPSAxKSwgICAgICAgIA0KICBzdWJzYW1wbGUgPSBzZXEoMSwgMSwgYnkgPSAwLjIpLA0KICBjb2xzYW1wbGVfYnl0cmVlID0gc2VxKDEsIDEsIGJ5ID0gMC4yKSwNCiAgbGFtYmRhID0gc2VxKDEsIDEsIGJ5ID0gMSksICAgICAgICAgICAgICAgIA0KICBhbHBoYSA9IHNlcSgwLCAwLCBieSA9IDEpLCAgICAgICAgICAgICAgICAgIA0KICBnYW1tYSA9IHNlcSgwLCAwLCBieSA9IDAuMSksICAgICAgICAgICAgICAgDQogIG5yb3VuZHMgPSBzZXEoMTAwLCAyNTAsIGJ5ID0gNTApDQopDQoNCg0KIyBTYW1wbGUgZ3JpZCBwb2ludHMNCmNvbmZfbGV2IDwtIC45NQ0KbnVtX21heCA8LSA1DQpuIDwtIGNlaWxpbmcobG9nKDEtY29uZl9sZXYpL2xvZygxLW51bV9tYXgvbnJvdyhncmlkKSkpDQppbmQgPC0gc2FtcGxlKG5yb3coZ3JpZCksIG4sIHJlcGxhY2UgPSBGQUxTRSkNCnJncmlkIDwtIGdyaWRbaW5kLCBdDQoNCiMgU2V0IHVwIHBhcmFsbGVsIHByb2Nlc3NpbmcNCm5jIDwtIGRldGVjdENvcmVzKCkgLSAxDQoNCiMgQ2FsY3VsYXRlIHNjYWxlX3Bvc193ZWlnaHQgZm9yIGltYmFsYW5jZWQgZGF0YXNldA0Kc2NhbGVfcG9zX3dlaWdodCA8LSBzdW0oeSA9PSAwKSAvIHN1bSh5ID09IDEpDQoNCiMgVmFsaWRhdGlvbiBwaGFzZQ0KI2NhdCgiXG5QaGFzZSAxOiBWYWxpZGF0aW9uIFBoYXNlXG4iKQ0Kbl92YWxpZGF0aW9ucyA8LSAzDQp2YWxpZGF0aW9uX3Jlc3VsdHMgPC0gbWF0cml4KG5yb3cgPSBucm93KHJncmlkKSwgbmNvbCA9IG5fdmFsaWRhdGlvbnMpDQoNCmZvciAoaiBpbiAxOm5yb3cocmdyaWQpKSB7DQogICNjYXQoIlxuVGVzdGluZyBwYXJhbWV0ZXIgc2V0IiwgaiwgIm9mIiwgbnJvdyhyZ3JpZCksICJcbiIpDQogIA0KICBmb3IgKGkgaW4gMTpuX3ZhbGlkYXRpb25zKSB7DQogICAgI2NhdCgiXG5WYWxpZGF0aW9uIGl0ZXJhdGlvbiIsIGksICJvZiIsIG5fdmFsaWRhdGlvbnMsICJcbiIpICAgICAgICAgICAgIA0KICAgICMgQ3JlYXRlIHZhbGlkYXRpb24gc3BsaXQNCiAgICBpZHggPC0gdW5pcXVlKHNhbXBsZShucm93KHhzKSwgbnJvdyh4cyksIFRSVUUpKQ0KICAgIHRyYWluX3ggPC0geHNbaWR4LCBdDQogICAgdHJhaW5feSA8LSB5W2lkeF0NCiAgICB2YWxfeCA8LSB4c1staWR4LCBdDQogICAgdmFsX3kgPC0geVstaWR4XQ0KICAgIA0KICAgIHBybSA8LSBsaXN0KA0KICAgICAgYm9vc3RlciA9ICJnYnRyZWUiLA0KICAgICAgb2JqZWN0aXZlID0gImJpbmFyeTpsb2dpc3RpYyIsDQogICAgICBtYXhfZGVwdGggPSByZ3JpZFtqLCAibWF4X2RlcHRoIl0sDQogICAgICBldGEgPSByZ3JpZFtqLCAiZXRhIl0sDQogICAgICBzdWJzYW1wbGUgPSByZ3JpZFtqLCAic3Vic2FtcGxlIl0sDQogICAgICBjb2xzYW1wbGVfYnl0cmVlID0gcmdyaWRbaiwgImNvbHNhbXBsZV9ieXRyZWUiXSwNCiAgICAgIGdhbW1hID0gcmdyaWRbaiwgImdhbW1hIl0sDQogICAgICBtaW5fY2hpbGRfd2VpZ2h0ID0gcmdyaWRbaiwgIm1pbl9jaGlsZF93ZWlnaHQiXSwNCiAgICAgIGFscGhhID0gcmdyaWRbaiwgImFscGhhIl0sDQogICAgICBsYW1iZGEgPSByZ3JpZFtqLCAibGFtYmRhIl0sDQogICAgICBzY2FsZV9wb3Nfd2VpZ2h0ID0gc2NhbGVfcG9zX3dlaWdodCwNCiAgICAgIG50aHJlYWQgPSBuYw0KICAgICkNCiAgICANCiAgICBkbV90cmFpbiA8LSB4Z2IuRE1hdHJpeChkYXRhID0gdHJhaW5feCwgbGFiZWwgPSB0cmFpbl95KQ0KICAgIG1kbCA8LSB4Z2IudHJhaW4oDQogICAgICBwYXJhbXMgPSBwcm0sDQogICAgICBkYXRhID0gZG1fdHJhaW4sDQogICAgICBucm91bmRzID0gcmdyaWRbaiwgIm5yb3VuZHMiXSwNCiAgICAgIHZlcmJvc2UgPSBGQUxTRQ0KICAgICkNCiAgICANCiAgICBwIDwtIHByZWRpY3QobWRsLCB4Z2IuRE1hdHJpeChkYXRhID0gdmFsX3gpKQ0KICAgIHByZWQgPC0gcHJlZGljdGlvbihwLCB2YWxfeSkNCiAgICB2YWxpZGF0aW9uX3Jlc3VsdHNbaiwgaV0gPC0gcGVyZm9ybWFuY2UocHJlZCwgImF1YyIpQHkudmFsdWVzW1sxXV0NCiAgfQ0KfQ0KDQojIFJ1biAxMDAgdGVzdHMgd2l0aCBiZXN0IHBhcmFtZXRlcnMNCmNhdCgiXG5SdW5uaW5nIFggdGVzdCBpdGVyYXRpb25zIHdpdGggYmVzdCBwYXJhbWV0ZXJzLi4uXG4iKQ0KdGVzdF9hdWNzIDwtIGMoKQ0KDQpiZXN0X3BhcmFtc19pZHggPC0gd2hpY2gubWF4KHJvd01lYW5zKHZhbGlkYXRpb25fcmVzdWx0cykpDQpiZXN0X3BhcmFtcyA8LSByZ3JpZFtiZXN0X3BhcmFtc19pZHgsXQ0KDQojIFRyYWluIGZpbmFsIG1vZGVsIHdpdGggYmVzdCBwYXJhbWV0ZXJzDQpiZXN0X3BhcmFtc19saXN0IDwtIGFzLmxpc3QoYmVzdF9wYXJhbXNbLXdoaWNoKG5hbWVzKGJlc3RfcGFyYW1zKSA9PSAibnJvdW5kcyIpXSkNCmJlc3RfcGFyYW1zX2xpc3QkYm9vc3RlciA8LSAiZ2J0cmVlIg0KYmVzdF9wYXJhbXNfbGlzdCRvYmplY3RpdmUgPC0gImJpbmFyeTpsb2dpc3RpYyINCmJlc3RfcGFyYW1zX2xpc3Qkc2NhbGVfcG9zX3dlaWdodCA8LSBzY2FsZV9wb3Nfd2VpZ2h0DQpiZXN0X3BhcmFtc19saXN0JG50aHJlYWQgPC0gbmMNCg0KZm9yKGkgaW4gMToyMCkgew0KICAjIENyZWF0ZSB0ZXN0IHNwbGl0DQogIGlkeCA8LSB1bmlxdWUoc2FtcGxlKG5yb3coeHMpLCBucm93KHhzKSwgVCkpDQogIHRyYWluX3ggPC0geHNbaWR4LCBdDQogIHRyYWluX3kgPC0geVtpZHhdDQogIHRlc3RfeCA8LSB4c1staWR4LCBdDQogIHRlc3RfeSA8LSB5Wy1pZHhdDQogIA0KICAjIFRyYWluIG1vZGVsIG9uIGZ1bGwgdW5iYWxhbmNlZCBkYXRhc2V0DQogIGRtX3RyYWluIDwtIHhnYi5ETWF0cml4KGRhdGEgPSB0cmFpbl94LCBsYWJlbCA9IHRyYWluX3kpDQogIG1kbCA8LSB4Z2IudHJhaW4oDQogICAgcGFyYW1zID0gYmVzdF9wYXJhbXNfbGlzdCwNCiAgICBkYXRhID0gZG1fdHJhaW4sDQogICAgbnJvdW5kcyA9IGJlc3RfcGFyYW1zW1sibnJvdW5kcyJdXSwNCiAgICB2ZXJib3NlID0gRkFMU0UNCiAgKQ0KICANCiAgIyBUZXN0IG9uIHVuYmFsYW5jZWQgdGVzdCBzZXQNCiAgcCA8LSBwcmVkaWN0KG1kbCwgeGdiLkRNYXRyaXgoZGF0YSA9IHRlc3RfeCkpDQogIHByZWQgPC0gcHJlZGljdGlvbihwLCB0ZXN0X3kpDQogIHRlc3RfYXVjc1tpXSA8LSBwZXJmb3JtYW5jZShwcmVkLCAiYXVjIilAeS52YWx1ZXNbWzFdXQ0KfQ0KIyBQcmludCByZXN1bHRzDQpjYXQoIlxuVGVzdCBSZXN1bHRzIG92ZXIgMTAwIGl0ZXJhdGlvbnM6XG4iKQ0KY2F0KCJNZWFuIEFVQzoiLCBtZWFuKHRlc3RfYXVjcyksICJcbiIpDQpjYXQoIlNEIEFVQzoiLCBzZCh0ZXN0X2F1Y3MpLCAiXG4iKQ0KY2F0KCI5NSUgQ0k6IiwgbWVhbih0ZXN0X2F1Y3MpIC0gMS45NiAqIHNkKHRlc3RfYXVjcyksIA0KICAgICJ0byIsIG1lYW4odGVzdF9hdWNzKSArIDEuOTYgKiBzZCh0ZXN0X2F1Y3MpLCAiXG4iKQ0KDQojIFBsb3R0aW5nIEFVQyBkaXN0cmlidXRpb24NCnBsb3QodGVzdF9hdWNzLCBjb2w9InJlZCIsIHBjaD0yMCwNCiAgICAgbWFpbj0iQVVDIFRlc3QgRGlzdHJpYnV0aW9uIiwNCiAgICAgeGxhYj0iSXRlcmF0aW9uIiwgeWxhYj0iQVVDIikNCmFibGluZShoPW1lYW4odGVzdF9hdWNzKSwgY29sPSJibHVlIiwgbHdkPTIsIGx0eT0yKSAgIyBBZGQgdGhpcyBsaW5lIHRvIHNob3cgbWVhbg0KYWJsaW5lKGg9bWVhbih0ZXN0X2F1Y3MpIC0gMS45NiAqIHNkKHRlc3RfYXVjcyksIGNvbD0iZ3JlZW4iLCBsd2Q9MiwgbHR5PTMpDQphYmxpbmUoaD1tZWFuKHRlc3RfYXVjcykgKyAxLjk2ICogc2QodGVzdF9hdWNzKSwgY29sPSJncmVlbiIsIGx3ZD0yLCBsdHk9MykNCmxlZ2VuZCgiYm90dG9tcmlnaHQiLCANCiAgICAgICBsZWdlbmQ9YygiQVVDIFZhbHVlcyIsICJNZWFuIiwgIjk1JSBDSSBCb3VuZHMiKSwNCiAgICAgICBjb2w9YygicmVkIiwgImJsdWUiLCAiZ3JlZW4iKSwNCiAgICAgICBsdHk9YyhOQSwgMiwgMyksDQogICAgICAgcGNoPWMoMjAsIE5BLCBOQSkpDQoNCiMgTm93IHRyYWluIGZpbmFsIG1vZGVsIG9uIGZ1bGwgZGF0YSBmb3IgeiBzY29yZXMNCmRtX2Z1bGwgPC0geGdiLkRNYXRyaXgoZGF0YSA9IHhzLCBsYWJlbCA9IHkpDQpmaW5hbF9tb2RlbCA8LSB4Z2IudHJhaW4oDQogIHBhcmFtcyA9IGJlc3RfcGFyYW1zX2xpc3QsDQogIGRhdGEgPSBkbV9mdWxsLA0KICBucm91bmRzID0gYmVzdF9wYXJhbXNbWyJucm91bmRzIl1dLA0KICB2ZXJib3NlID0gRkFMU0UNCikNCg0KIyBHZXQgcHJvYmFiaWxpdHkgcHJlZGljdGlvbnMgKHopIGZvciBBTEwgZGF0YQ0KeiA8LSBwcmVkaWN0KGZpbmFsX21vZGVsLCB4Z2IuRE1hdHJpeChkYXRhID0geHMpKQ0KYGBgDQoNCg0KYGBge3J9DQojIENhbGN1bGF0ZSByZXNpZHVhbHMgZm9yIFhHQm9vc3QgcHJlZGljdGlvbnMNCnkgPC0gYXMubnVtZXJpYyhhcy5jaGFyYWN0ZXIoc2VsZWN0X2RhdGEkYXR0ZW1wdCkpDQpyZXNpZHVhbHMgPC0geSAtIHoNCg0KIyBIaXN0b2dyYW0gb2YgcmVzaWR1YWxzDQpoaXN0KHJlc2lkdWFscywgbWFpbj0iRGlzdHJpYnV0aW9uIG9mIFhHQm9vc3QgTW9kZWwgUmVzaWR1YWxzIiwgeGxhYj0iUmVzaWR1YWwiLCBicmVha3M9MTAwKQ0KYGBgDQoNCmBgYHtyfQ0KIyBwbG90IG91dCB0aGUgeiB2YWx1ZXNcDQpwbG90KGRlbnNpdHkoeiksIA0KICAgICBtYWluID0gIkRlbnNpdHkgb2YgWiBQcmVkaWN0aW9ucyIsDQogICAgIHhsYWIgPSAiUHJlZGljdGVkIFByb2JhYmlsaXR5IG9mIEF0dGVtcHQiLA0KICAgICB5bGFiID0gIkRlbnNpdHkiKQ0KYGBgDQoNCmBgYHtyfQ0KIyBDYWxjdWxhdGUgR0lNUiAobGFtYmRhKSBUaGlzIGlzIEdlbmVyYWxpemVkIGludmVyc2UgbWlsbHMgcmF0aW8NCkdJTVIgPC0gZG5vcm0ocW5vcm0oeikpIC8gKDEgLSBwbm9ybShxbm9ybSh6KSkpDQoNCiMgQWRkIEdJTVIgdG8gdGhlIGRhdGENCnNlbGVjdF9kYXRhWywgR0lNUiA6PSBHSU1SXQ0KDQojIFByaW50IHZhcmlhYmxlIGltcG9ydGENCmBgYA0KDQpgYGB7cn0NCiMgQ3JlYXRlIGEgZGF0YS50YWJsZSB3aXRoIGp1c3QgbXlfaWQgYW5kIEdJTVIgZnJvbSBzZWxlY3RfZGF0YQ0KR0lNUl9kdCA8LSBkYXRhLnRhYmxlKG15X2lkID0gc2VsZWN0X2RhdGEkbXlfaWQsIEdJTVIgPSBHSU1SKQ0KDQojIEFkZCBHSU1SIHRvIG91dGNvbWVfZGF0YSBieSBtYXRjaGluZyBvbiBteV9pZA0Kb3V0Y29tZV9kYXRhW0dJTVJfZHQsIEdJTVIgOj0gaS5HSU1SLCBvbiA9ICJteV9pZCJdDQpgYGANCg0KYGBge3J9DQojICMgRXhpc3RpbmcgY29kZQ0KIyBvdXRjb21lX2RhdGEgPC0gb3V0Y29tZV9kYXRhWywgbXlfaWQgOj0gTlVMTF0NCiMgb3V0Y29tZV9kYXRhWywgeWFyZGxpbmVfMzFfNDAgOj0gTlVMTF0NCiMgb3V0Y29tZV9kYXRhWywgeWVhcjIwMjJfdGVhbV9DTEUgOj0gTlVMTF0gIyB0aWVkIGZvciBtb3N0IGF0dGVtcHRzIHdpdGggMzENCg0KIyBSZW1vdmUgYWxsIGNvbHVtbnMgd2l0aCAiX3ByZXNlbnQiIGluIHRoZSBuYW1lDQpwcmVzZW50X2NvbHMgPC0gZ3JlcCgiX3ByZXNlbnQiLCBuYW1lcyhvdXRjb21lX2RhdGEpLCB2YWx1ZSA9IFRSVUUpDQpmb3IgKGNvbCBpbiBwcmVzZW50X2NvbHMpIHsNCiAgb3V0Y29tZV9kYXRhWywgKGNvbCkgOj0gTlVMTF0NCn0NCmBgYA0KDQoNCmBgYHtyfQ0KDQojIENyZWF0ZSBjb3BpZXMgb2Ygb3V0Y29tZV9kYXRhIGZvciBkaWZmZXJlbnQgbW9kZWxzDQpvdXRjb21lX2RhdGFfcGxheWVyIDwtIGNvcHkob3V0Y29tZV9kYXRhKQ0Kb3V0Y29tZV9kYXRhX3N0YXJ0ZXIgPC0gY29weShvdXRjb21lX2RhdGEpDQoNCiMgUmVtb3ZlIHNwZWNpZmljIGNvbHVtbnMgYXMgaW4gb3JpZ2luYWwgY29kZQ0KZm9yIChkdCBpbiBsaXN0KG91dGNvbWVfZGF0YV9wbGF5ZXIsIG91dGNvbWVfZGF0YV9zdGFydGVyKSkgew0KICBkdFssIG15X2lkIDo9IE5VTExdDQogIGR0WywgeWFyZGxpbmVfMzFfNDAgOj0gTlVMTF0NCiAgZHRbLCB5ZWFyMjAyMl90ZWFtX0NMRSA6PSBOVUxMXSAjIHRpZWQgZm9yIG1vc3QgYXR0ZW1wdHMgd2l0aCAzMQ0KICANCiAgIyBSZW1vdmUgYXR0ZW5kYW5jZSB2YXJpYWJsZXMNCiAgZHRbLCBhdHRlbmRhbmNlX3BjdCA6PSBOVUxMXQ0KICBkdFssIGF0dGVuZGFuY2VfcmF3IDo9IE5VTExdDQogIGR0WywgdmVnYXNfd3BfcG9zdGVhbSA6PSBOVUxMXQ0KfQ0KDQojIEZvciBwbGF5ZXIgbW9kZWxzLCByZW1vdmUgc3RhcnRlciBjb2x1bW5zDQpwbGF5ZXJfY29scyA8LSBncmVwKCJec3RhcnRlcl8iLCBuYW1lcyhvdXRjb21lX2RhdGFfcGxheWVyKSwgdmFsdWUgPSBUUlVFKQ0KZm9yIChjb2wgaW4gcGxheWVyX2NvbHMpIHsNCiAgb3V0Y29tZV9kYXRhX3BsYXllclssIChjb2wpIDo9IE5VTExdDQp9DQoNCiMgRm9yIHN0YXJ0ZXIgbW9kZWxzLCByZW1vdmUgcGxheWVyIGNvbHVtbnMNCnN0YXJ0ZXJfY29scyA8LSBncmVwKCJeKG9mZmVuc2V8ZGVmZW5zZSlfcGxheWVyXyIsIG5hbWVzKG91dGNvbWVfZGF0YV9zdGFydGVyKSwgdmFsdWUgPSBUUlVFKQ0KZm9yIChjb2wgaW4gc3RhcnRlcl9jb2xzKSB7DQogIG91dGNvbWVfZGF0YV9zdGFydGVyWywgKGNvbCkgOj0gTlVMTF0NCn0NCg0KIyBFbnN1cmUgY29udmVyc2lvbiBpcyBudW1lcmljDQpmb3IgKGR0IGluIGxpc3Qob3V0Y29tZV9kYXRhX3BsYXllciwgb3V0Y29tZV9kYXRhX3N0YXJ0ZXIpKSB7DQogIGR0WywgY29udmVyc2lvbiA6PSBhcy5udW1lcmljKGFzLmNoYXJhY3Rlcihjb252ZXJzaW9uKSldDQp9DQoNCiMgTU9ERUwgMTogUGxheWVyIG1vZGVsIHdpdGggR0lNUg0Kb2xzX21vZGVsX3BsYXllciA8LSBsbShjb252ZXJzaW9uIH4gLiwgZGF0YSA9IG91dGNvbWVfZGF0YV9wbGF5ZXIpDQoNCiMgTU9ERUwgMjogU3RhcnRlciBtb2RlbCB3aXRoIEdJTVINCm9sc19tb2RlbF9zdGFydGVyIDwtIGxtKGNvbnZlcnNpb24gfiAuLCBkYXRhID0gb3V0Y29tZV9kYXRhX3N0YXJ0ZXIpDQoNCiMgRnVuY3Rpb24gdG8gYW5hbHl6ZSBhbmQgcHJpbnQgbW9kZWwgcmVzdWx0cw0KYW5hbHl6ZV9tb2RlbCA8LSBmdW5jdGlvbihtb2RlbCwgbW9kZWxfbmFtZSkgew0KICBsaWJyYXJ5KHNhbmR3aWNoKQ0KICBsaWJyYXJ5KGxtdGVzdCkNCiAgDQogICMgR2V0IEhDMC1hZGp1c3RlZCB0LXZhbHVlcyBhbmQgcC12YWx1ZXMNCiAgcm9idXN0X3Rlc3QgPC0gY29lZnRlc3QobW9kZWwsIHZjb3YgPSB2Y292SEMobW9kZWwsIHR5cGUgPSAiSEMwIikpDQogIHRfc3RhdHMgPC0gcm9idXN0X3Rlc3RbLCAidCB2YWx1ZSJdDQogIHBfdmFsdWVzIDwtIHJvYnVzdF90ZXN0WywgIlByKD58dHwpIl0NCiAgDQogICMgRnVuY3Rpb24gdG8gYWRkIHNpZ25pZmljYW5jZSBzdGFycw0KICBnZXRfc3RhcnMgPC0gZnVuY3Rpb24ocCkgew0KICAgIGlmIChwIDw9IDAuMDEpIHJldHVybigiKioqIikNCiAgICBpZiAocCA8PSAwLjA1KSByZXR1cm4oIioqIikNCiAgICBpZiAocCA8PSAwLjEpIHJldHVybigiKiIpDQogICAgaWYgKHAgPD0gMC4xNSkgcmV0dXJuKCIuIikNCiAgICByZXR1cm4oIiIpDQogIH0NCiAgDQogICMgTWF4aW11bSB3aWR0aCBmb3IgdmFyaWFibGUgbmFtZXMNCiAgbmFtZV93aWR0aCA8LSA2MA0KICANCiAgIyBQcmludCBtb2RlbCBuYW1lIGFuZCBoZWFkZXINCiAgY2F0KCJcblxuIiwgcGFzdGUocmVwKCI9IiwgODApLCBjb2xsYXBzZT0iIiksICJcbiIpDQogIGNhdCgiTU9ERUw6IiwgbW9kZWxfbmFtZSwgIlxuIikNCiAgY2F0KHBhc3RlKHJlcCgiPSIsIDgwKSwgY29sbGFwc2U9IiIpLCAiXG5cbiIpDQogIA0KICAjIFByaW50IGhlYWRlciB3aXRoIGFsaWdubWVudA0KICBjYXQoc3ByaW50ZigiJS0qcyAgJTEwcyAgJTEwcyAgJTRzXG4iLCBuYW1lX3dpZHRoLCAiVmFyaWFibGUiLCAidC12YWx1ZSIsICJwLXZhbHVlIiwgInNpZyIpKQ0KICBjYXQoc3ByaW50ZigiJS0qcyAgJTEwcyAgJTEwcyAgJTRzXG4iLCBuYW1lX3dpZHRoLCAiLS0tLS0tLS0tIiwgIi0tLS0tLS0iLCAiLS0tLS0tLSIsICItLS0tIikpDQogIA0KICAjIExvb3AgdGhyb3VnaCBhbmQgcHJpbnQgdmFsdWVzDQogIGZvciAoaSBpbiAxOmxlbmd0aCh0X3N0YXRzKSkgew0KICAgIHZhcl9uYW1lIDwtIHJvd25hbWVzKHJvYnVzdF90ZXN0KVtpXQ0KICAgICMgVHJ1bmNhdGUgbmFtZSBpZiB0b28gbG9uZw0KICAgIGlmIChuY2hhcih2YXJfbmFtZSkgPiBuYW1lX3dpZHRoKSB7DQogICAgICB2YXJfbmFtZSA8LSBwYXN0ZTAoc3Vic3RyKHZhcl9uYW1lLCAxLCBuYW1lX3dpZHRoLTMpLCAiLi4uIikNCiAgICB9DQogICAgY2F0KHNwcmludGYoIiUtKnMgICUxMC40ZiAgJTEwLjRmICAlNHNcbiIsIA0KICAgICAgICAgICAgICAgIG5hbWVfd2lkdGgsIHZhcl9uYW1lLCANCiAgICAgICAgICAgICAgICB0X3N0YXRzW2ldLCBwX3ZhbHVlc1tpXSwNCiAgICAgICAgICAgICAgICBnZXRfc3RhcnMocF92YWx1ZXNbaV0pKSkNCiAgfQ0KICANCiAgY2F0KCJcblNpZ25pZmljYW5jZSBjb2RlczogMCAnKioqJyAwLjAxICcqKicgMC4wNSAnKicgMC4xICcuJyAwLjE1XG4iKQ0KICANCiAgIyBQcmludCBSLXNxdWFyZWQNCiAgcl9zcXVhcmVkIDwtIHN1bW1hcnkobW9kZWwpJGFkai5yLnNxdWFyZWQNCiAgY2F0KCJcbkFkanVzdGVkIFItc3F1YXJlZDoiLCByX3NxdWFyZWQsICJcbiIpDQogIA0KICAjIENhbGN1bGF0ZSBWSUZzDQogIGxpYnJhcnkoY2FyKQ0KICB2aWZzIDwtIHZpZihtb2RlbCkNCiAgDQogICMgRmlsdGVyIHRvIHNob3cgb25seSBWSUZzIG92ZXIgNQ0KICBoaWdoX3ZpZnMgPC0gdmlmc1t2aWZzID4gNV0NCiAgaWYobGVuZ3RoKGhpZ2hfdmlmcykgPiAwKSB7DQogICAgY2F0KCJcblZhcmlhYmxlcyB3aXRoIFZJRiA+IDU6XG4iKQ0KICAgIHByaW50KGhpZ2hfdmlmcykNCiAgfSBlbHNlIHsNCiAgICBjYXQoIlxuTm8gdmFyaWFibGVzIHdpdGggVklGID4gNSBmb3VuZCBpbiB0aGlzIG1vZGVsXG4iKQ0KICB9DQogIA0KICByZXR1cm4ocl9zcXVhcmVkKQ0KfQ0KDQojIEFuYWx5emUgbW9kZWxzIHdpdGggR0lNUiBvbmx5DQpyMl9wbGF5ZXIgPC0gYW5hbHl6ZV9tb2RlbChvbHNfbW9kZWxfcGxheWVyLCAiUGxheWVyIE1vZGVsIHdpdGggR0lNUiIpDQpyMl9zdGFydGVyIDwtIGFuYWx5emVfbW9kZWwob2xzX21vZGVsX3N0YXJ0ZXIsICJTdGFydGVyIE1vZGVsIHdpdGggR0lNUiIpDQoNCiMgQ29tcGFyZSBSLXNxdWFyZWQgdmFsdWVzDQpjYXQoIlxuXG4iLCBwYXN0ZShyZXAoIj0iLCA4MCksIGNvbGxhcHNlPSIiKSwgIlxuIikNCmNhdCgiTU9ERUwgQ09NUEFSSVNPTiAtIEFkanVzdGVkIFItc3F1YXJlZCB2YWx1ZXNcbiIpDQpjYXQocGFzdGUocmVwKCI9IiwgODApLCBjb2xsYXBzZT0iIiksICJcblxuIikNCmNhdCgiUGxheWVyIE1vZGVsIHdpdGggR0lNUjoiLCByMl9wbGF5ZXIsICJcbiIpDQpjYXQoIlN0YXJ0ZXIgTW9kZWwgd2l0aCBHSU1SOiIsIHIyX3N0YXJ0ZXIsICJcbiIpDQoNCmBgYA0KDQo=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("heckman.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
