<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Heckman Selection Model Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">4th Downs in the NFL</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="heckman.html">Heckman Selection</a>
</li>
<li>
  <a href="xgboost.html">XGBoost Prediction</a>
</li>
<li>
  <a href="attendance_binary.html">Attendance Impact Binary</a>
</li>
<li>
  <a href="attendance_pcts.html">Attendance Impact Percentages</a>
</li>
<li>
  <a href="attendance_totals.html">Attendance Impact Totals</a>
</li>
<li>
  <a href="thirddown.html">Third Down Analysis</a>
</li>
<li>
  <a href="attempt_ols.html">Attempts OLS</a>
</li>
<li>
  <a href="Introduction.html">Writing Introduction</a>
</li>
<li>
  <a href="Data.html">Writing Data</a>
</li>
<li>
  <a href="Methodology.html">Writing Methodology</a>
</li>
<li>
  <a href="Results.html">Writing Results</a>
</li>
<li>
  <a href="robustness_checks.html">Robustness Checks</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Heckman Selection Model Analysis</h1>

</div>


<pre class="r"><code>library(data.table)
outcome_data &lt;- fread(&quot;predict_outcome.csv.gz&quot;)
select_data &lt;- fread(&quot;predict_select.csv.gz&quot;)</code></pre>
<pre class="r"><code>select_data[, attempt := as.numeric(as.character(attempt))]</code></pre>
<pre class="r"><code># Commented out original version
# # Load required libraries
# library(data.table)
# library(xgboost)
# library(ROCR)
# library(parallel)
# 
# # Prepare the XGBoost matrices
# xs &lt;- model.matrix(~ . - 1 - attempt - my_id, data = select_data)
# y &lt;- as.numeric(as.character(select_data$attempt))
# 
# # Create parameter grid
# grid &lt;- expand.grid(
#   eta = seq(0.001, 0.1, by = 0.02),
#   max_depth = seq(5, 7, by = 2),
#   min_child_weight = seq(1, 1, by = 1),        
#   subsample = seq(0.8, 0.8, by = 0.2),
#   colsample_bytree = seq(0.8, 0.8, by = 0.2),
#   lambda = seq(1, 1, by = 1),                
#   alpha = seq(0, 0, by = 1),                  
#   gamma = seq(0, 0, by = 0.1),               
#   nrounds = seq(100, 500, by = 500)
# )
# 
# # Sample grid points
# conf_lev &lt;- .95
# num_max &lt;- 5
# n &lt;- ceiling(log(1-conf_lev)/log(1-num_max/nrow(grid)))
# ind &lt;- sample(nrow(grid), n, replace = FALSE)
# rgrid &lt;- grid[ind, ]
# 
# # Set up parallel processing
# nc &lt;- detectCores() - 1
# 
# # Validation phase
# cat(&quot;\nPhase 1: Validation Phase\n&quot;)
# n_validations &lt;- 2
# validation_results &lt;- matrix(nrow = nrow(rgrid), ncol = n_validations)
# 
# for (j in 1:nrow(rgrid)) {
#   cat(&quot;\nTesting parameter set&quot;, j, &quot;of&quot;, nrow(rgrid), &quot;\n&quot;)
#   
#   for (i in 1:n_validations) {
#     # Create validation split
#     idx &lt;- unique(sample(nrow(xs), nrow(xs), TRUE))
#     train_x &lt;- xs[idx, ]
#     train_y &lt;- y[idx]
#     val_x &lt;- xs[-idx, ]
#     val_y &lt;- y[-idx]
#     
#     # Undersample majority class in training data
#     train_idx_0 &lt;- which(train_y == 0)
#     train_idx_1 &lt;- which(train_y == 1)
#     
#     # Get number of minority class samples
#     n_minority &lt;- length(train_idx_1)
#     
#     # Randomly sample from majority class
#     train_idx_0_sampled &lt;- sample(train_idx_0, n_minority)
#     
#     # Combine indices for balanced dataset
#     balanced_idx &lt;- c(train_idx_0_sampled, train_idx_1)
#     
#     # Create balanced training dataset
#     train_x_balanced &lt;- train_x[balanced_idx, ]
#     train_y_balanced &lt;- train_y[balanced_idx]
#     
#     prm &lt;- list(
#       booster = &quot;gbtree&quot;,
#       objective = &quot;binary:logistic&quot;,
#       max_depth = rgrid[j, &quot;max_depth&quot;],
#       eta = rgrid[j, &quot;eta&quot;],
#       subsample = rgrid[j, &quot;subsample&quot;],
#       colsample_bytree = rgrid[j, &quot;colsample_bytree&quot;],
#       gamma = rgrid[j, &quot;gamma&quot;],
#       min_child_weight = rgrid[j, &quot;min_child_weight&quot;],
#       alpha = rgrid[j, &quot;alpha&quot;],
#       lambda = rgrid[j, &quot;lambda&quot;],
#       nthread = nc
#     )
#     
#     dm_train &lt;- xgb.DMatrix(data = train_x_balanced, label = train_y_balanced)
#     mdl &lt;- xgb.train(
#       params = prm,
#       data = dm_train,
#       nrounds = rgrid[j, &quot;nrounds&quot;],
#       verbose = FALSE
#     )
#     
#     p &lt;- predict(mdl, xgb.DMatrix(data = val_x))
#     pred &lt;- prediction(p, val_y)
#     validation_results[j, i] &lt;- performance(pred, &quot;auc&quot;)@y.values[[1]]
#   }
# }
# 
# # Run 100 tests with best parameters
# cat(&quot;\nRunning X test iterations with best parameters...\n&quot;)
# test_aucs &lt;- c()
# 
# best_params_idx &lt;- which.max(rowMeans(validation_results))
# best_params &lt;- rgrid[best_params_idx,]
# 
# # Train final model with best parameters
# best_params_list &lt;- as.list(best_params[-which(names(best_params) == &quot;nrounds&quot;)])
# best_params_list$booster &lt;- &quot;gbtree&quot;
# best_params_list$objective &lt;- &quot;binary:logistic&quot;
# best_params_list$nthread &lt;- nc
# 
# for(i in 1:100) {
#   # Create test split
#   idx &lt;- unique(sample(nrow(xs), nrow(xs), T))
#   train_x &lt;- xs[idx, ]
#   train_y &lt;- y[idx]
#   test_x &lt;- xs[-idx, ]
#   test_y &lt;- y[-idx]
#   
#   # Undersample training data
#   train_idx_0 &lt;- which(train_y == 0)
#   train_idx_1 &lt;- which(train_y == 1)
#   n_minority &lt;- length(train_idx_1)
#   train_idx_0_sampled &lt;- sample(train_idx_0, n_minority)
#   balanced_idx &lt;- c(train_idx_0_sampled, train_idx_1)
#   
#   # Create balanced training dataset
#   train_x_balanced &lt;- train_x[balanced_idx, ]
#   train_y_balanced &lt;- train_y[balanced_idx]
#   
#   # Train model
#   dm_train &lt;- xgb.DMatrix(data = train_x_balanced, label = train_y_balanced)
#   mdl &lt;- xgb.train(
#     params = best_params_list,
#     data = dm_train,
#     nrounds = best_params[[&quot;nrounds&quot;]],
#     verbose = FALSE
#   )
#   
#   # Test on unbalanced test set
#   p &lt;- predict(mdl, xgb.DMatrix(data = test_x))
#   pred &lt;- prediction(p, test_y)
#   test_aucs[i] &lt;- performance(pred, &quot;auc&quot;)@y.values[[1]]
# }
# 
# # Print results
# cat(&quot;\nTest Results over 100 iterations:\n&quot;)
# cat(&quot;Mean AUC:&quot;, mean(test_aucs), &quot;\n&quot;)
# cat(&quot;SD AUC:&quot;, sd(test_aucs), &quot;\n&quot;)
# cat(&quot;95% CI:&quot;, mean(test_aucs) - 1.96 * sd(test_aucs), 
#     &quot;to&quot;, mean(test_aucs) + 1.96 * sd(test_aucs), &quot;\n&quot;)
# 
# # Plotting AUC distribution
# plot(test_aucs, col=&quot;red&quot;, pch=20,
#      main=&quot;AUC Test Distribution&quot;,
#      xlab=&quot;Iteration&quot;, ylab=&quot;AUC&quot;)
# abline(h=mean(test_aucs), col=&quot;blue&quot;, lwd=2, lty=2)
# abline(h=mean(test_aucs) - 1.96 * sd(test_aucs), col=&quot;green&quot;, lwd=2, lty=3)
# abline(h=mean(test_aucs) + 1.96 * sd(test_aucs), col=&quot;green&quot;, lwd=2, lty=3)
# legend(&quot;bottomright&quot;, 
#        legend=c(&quot;AUC Values&quot;, &quot;Mean&quot;, &quot;95% CI Bounds&quot;),
#        col=c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;),
#        lty=c(NA, 2, 3),
#        pch=c(20, NA, NA))
# 
# # Now train final model on full data for z scores
# final_idx_0 &lt;- which(y == 0)
# final_idx_1 &lt;- which(y == 1)
# n_minority_final &lt;- length(final_idx_1)
# final_idx_0_sampled &lt;- sample(final_idx_0, n_minority_final)
# final_balanced_idx &lt;- c(final_idx_0_sampled, final_idx_1)
# 
# # Create balanced final dataset
# xs_balanced &lt;- xs[final_balanced_idx, ]
# y_balanced &lt;- y[final_balanced_idx]
# 
# dm_full &lt;- xgb.DMatrix(data = xs_balanced, label = y_balanced)
# final_model &lt;- xgb.train(
#   params = best_params_list,
#   data = dm_full,
#   nrounds = best_params[[&quot;nrounds&quot;]],
#   verbose = FALSE
# )
# 
# # Get probability predictions (z) for ALL data
# z &lt;- predict(final_model, xgb.DMatrix(data = xs))</code></pre>
<pre class="r"><code>library(data.table)
library(xgboost)
library(ROCR)
library(parallel)

# Prepare the XGBoost matrices
xs &lt;- model.matrix(~ . - 1 - attempt - my_id, data = select_data)
y &lt;- as.numeric(as.character(select_data$attempt))


# Create parameter grid
grid &lt;- expand.grid(
  eta = seq(0.001, 0.03, by = 0.01),
  max_depth = seq(5, 5, by = 2),
  min_child_weight = seq(1, 1, by = 1),        
  subsample = seq(1, 1, by = 0.2),
  colsample_bytree = seq(1, 1, by = 0.2),
  lambda = seq(1, 1, by = 1),                
  alpha = seq(0, 0, by = 1),                  
  gamma = seq(0, 0, by = 0.1),               
  nrounds = seq(100, 250, by = 50)
)


# Sample grid points
conf_lev &lt;- .95
num_max &lt;- 5
n &lt;- ceiling(log(1-conf_lev)/log(1-num_max/nrow(grid)))
ind &lt;- sample(nrow(grid), n, replace = FALSE)
rgrid &lt;- grid[ind, ]

# Set up parallel processing
nc &lt;- detectCores() - 1

# Calculate scale_pos_weight for imbalanced dataset
scale_pos_weight &lt;- sum(y == 0) / sum(y == 1)

# Validation phase
#cat(&quot;\nPhase 1: Validation Phase\n&quot;)
n_validations &lt;- 5
validation_results &lt;- matrix(nrow = nrow(rgrid), ncol = n_validations)

for (j in 1:nrow(rgrid)) {
  #cat(&quot;\nTesting parameter set&quot;, j, &quot;of&quot;, nrow(rgrid), &quot;\n&quot;)
  
  for (i in 1:n_validations) {
    #cat(&quot;\nValidation iteration&quot;, i, &quot;of&quot;, n_validations, &quot;\n&quot;)             
    # Create validation split
    idx &lt;- unique(sample(nrow(xs), nrow(xs), TRUE))
    train_x &lt;- xs[idx, ]
    train_y &lt;- y[idx]
    val_x &lt;- xs[-idx, ]
    val_y &lt;- y[-idx]
    
    prm &lt;- list(
      booster = &quot;gbtree&quot;,
      objective = &quot;binary:logistic&quot;,
      max_depth = rgrid[j, &quot;max_depth&quot;],
      eta = rgrid[j, &quot;eta&quot;],
      subsample = rgrid[j, &quot;subsample&quot;],
      colsample_bytree = rgrid[j, &quot;colsample_bytree&quot;],
      gamma = rgrid[j, &quot;gamma&quot;],
      min_child_weight = rgrid[j, &quot;min_child_weight&quot;],
      alpha = rgrid[j, &quot;alpha&quot;],
      lambda = rgrid[j, &quot;lambda&quot;],
      scale_pos_weight = scale_pos_weight,
      nthread = nc
    )
    
    dm_train &lt;- xgb.DMatrix(data = train_x, label = train_y)
    mdl &lt;- xgb.train(
      params = prm,
      data = dm_train,
      nrounds = rgrid[j, &quot;nrounds&quot;],
      verbose = FALSE
    )
    
    p &lt;- predict(mdl, xgb.DMatrix(data = val_x))
    pred &lt;- prediction(p, val_y)
    validation_results[j, i] &lt;- performance(pred, &quot;auc&quot;)@y.values[[1]]
  }
}

# Run 100 tests with best parameters
cat(&quot;\nRunning X test iterations with best parameters...\n&quot;)</code></pre>
<pre><code>## 
## Running X test iterations with best parameters...</code></pre>
<pre class="r"><code>test_aucs &lt;- c()

best_params_idx &lt;- which.max(rowMeans(validation_results))
best_params &lt;- rgrid[best_params_idx,]

# Train final model with best parameters
best_params_list &lt;- as.list(best_params[-which(names(best_params) == &quot;nrounds&quot;)])
best_params_list$booster &lt;- &quot;gbtree&quot;
best_params_list$objective &lt;- &quot;binary:logistic&quot;
best_params_list$scale_pos_weight &lt;- scale_pos_weight
best_params_list$nthread &lt;- nc

for(i in 1:20) {
  # Create test split
  idx &lt;- unique(sample(nrow(xs), nrow(xs), T))
  train_x &lt;- xs[idx, ]
  train_y &lt;- y[idx]
  test_x &lt;- xs[-idx, ]
  test_y &lt;- y[-idx]
  
  # Train model on full unbalanced dataset
  dm_train &lt;- xgb.DMatrix(data = train_x, label = train_y)
  mdl &lt;- xgb.train(
    params = best_params_list,
    data = dm_train,
    nrounds = best_params[[&quot;nrounds&quot;]],
    verbose = FALSE
  )
  
  # Test on unbalanced test set
  p &lt;- predict(mdl, xgb.DMatrix(data = test_x))
  pred &lt;- prediction(p, test_y)
  test_aucs[i] &lt;- performance(pred, &quot;auc&quot;)@y.values[[1]]
}
# Print results
cat(&quot;\nTest Results over 100 iterations:\n&quot;)</code></pre>
<pre><code>## 
## Test Results over 100 iterations:</code></pre>
<pre class="r"><code>cat(&quot;Mean AUC:&quot;, mean(test_aucs), &quot;\n&quot;)</code></pre>
<pre><code>## Mean AUC: 0.8866661</code></pre>
<pre class="r"><code>cat(&quot;SD AUC:&quot;, sd(test_aucs), &quot;\n&quot;)</code></pre>
<pre><code>## SD AUC: 0.003806819</code></pre>
<pre class="r"><code>cat(&quot;95% CI:&quot;, mean(test_aucs) - 1.96 * sd(test_aucs), 
    &quot;to&quot;, mean(test_aucs) + 1.96 * sd(test_aucs), &quot;\n&quot;)</code></pre>
<pre><code>## 95% CI: 0.8792048 to 0.8941275</code></pre>
<pre class="r"><code># Plotting AUC distribution
plot(test_aucs, col=&quot;red&quot;, pch=20,
     main=&quot;AUC Test Distribution&quot;,
     xlab=&quot;Iteration&quot;, ylab=&quot;AUC&quot;)
abline(h=mean(test_aucs), col=&quot;blue&quot;, lwd=2, lty=2)  # Add this line to show mean
abline(h=mean(test_aucs) - 1.96 * sd(test_aucs), col=&quot;green&quot;, lwd=2, lty=3)
abline(h=mean(test_aucs) + 1.96 * sd(test_aucs), col=&quot;green&quot;, lwd=2, lty=3)
legend(&quot;bottomright&quot;, 
       legend=c(&quot;AUC Values&quot;, &quot;Mean&quot;, &quot;95% CI Bounds&quot;),
       col=c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;),
       lty=c(NA, 2, 3),
       pch=c(20, NA, NA))</code></pre>
<p><img src="heckman_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code># Now train final model on full data for z scores
dm_full &lt;- xgb.DMatrix(data = xs, label = y)
final_model &lt;- xgb.train(
  params = best_params_list,
  data = dm_full,
  nrounds = best_params[[&quot;nrounds&quot;]],
  verbose = FALSE
)

# Get probability predictions (z) for ALL data
z &lt;- predict(final_model, xgb.DMatrix(data = xs))</code></pre>
<pre class="r"><code># Calculate residuals for XGBoost predictions
y &lt;- as.numeric(as.character(select_data$attempt))
residuals &lt;- y - z

# Histogram of residuals
hist(residuals, main=&quot;Distribution of XGBoost Model Residuals&quot;, xlab=&quot;Residual&quot;, breaks=100)</code></pre>
<p><img src="heckman_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code># plot out the z values\
plot(density(z), 
     main = &quot;Density of Z Predictions&quot;,
     xlab = &quot;Predicted Probability of Attempt&quot;,
     ylab = &quot;Density&quot;)</code></pre>
<p><img src="heckman_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code># Calculate GIMR (lambda) This is Generalized inverse mills ratio
GIMR &lt;- dnorm(qnorm(z)) / (1 - pnorm(qnorm(z)))

# Add GIMR to the data
select_data[, GIMR := GIMR]

# Print variable importa</code></pre>
<pre class="r"><code># Create a data.table with just my_id and GIMR from select_data
GIMR_dt &lt;- data.table(my_id = select_data$my_id, GIMR = GIMR)

# Add GIMR to outcome_data by matching on my_id
outcome_data[GIMR_dt, GIMR := i.GIMR, on = &quot;my_id&quot;]</code></pre>
<pre class="r"><code># Existing code
outcome_data &lt;- outcome_data[, my_id := NULL]
outcome_data[, yardline_31_40 := NULL]
outcome_data[, year2022_team_CLE := NULL] # tied for most attempts with 31

# Remove all columns with &quot;_present&quot; in the name
present_cols &lt;- grep(&quot;_present&quot;, names(outcome_data), value = TRUE)
for (col in present_cols) {
  outcome_data[, (col) := NULL]
}
#attendance_pct and total
outcome_data[, attendance_pct := NULL]
outcome_data[, attendance_raw := NULL]
#and toital_line
outcome_data[, vegas_wp_posteam := NULL]</code></pre>
<pre class="r"><code>outcome_data[, conversion := as.numeric(as.character(conversion))]
# Then run OLS with GIMR correction
ols_model &lt;- lm(conversion ~  ., data = outcome_data)</code></pre>
<pre class="r"><code>library(sandwich)
library(lmtest)

# Get HC0-adjusted t-values and p-values
robust_test &lt;- coeftest(ols_model, vcov = vcovHC(ols_model, type = &quot;HC0&quot;))
t_stats &lt;- robust_test[, &quot;t value&quot;]
p_values &lt;- robust_test[, &quot;Pr(&gt;|t|)&quot;]

# Function to add significance stars
get_stars &lt;- function(p) {
    if (p &lt;= 0.01) return(&quot;***&quot;)
    if (p &lt;= 0.05) return(&quot;**&quot;)
    if (p &lt;= 0.1) return(&quot;*&quot;)
    if (p &lt;= 0.15) return(&quot;.&quot;)
    return(&quot;&quot;)
}

# Maximum width for variable names
name_width &lt;- 60

# Print header with alignment
cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;Variable&quot;, &quot;t-value&quot;, &quot;p-value&quot;, &quot;sig&quot;))</code></pre>
<pre><code>## Variable                                                         t-value     p-value   sig</code></pre>
<pre class="r"><code>cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;---------&quot;, &quot;-------&quot;, &quot;-------&quot;, &quot;----&quot;))</code></pre>
<pre><code>## ---------                                                        -------     -------  ----</code></pre>
<pre class="r"><code># Loop through and print values
for (i in 1:length(t_stats)) {
    var_name &lt;- rownames(robust_test)[i]
    # Truncate name if too long
    if (nchar(var_name) &gt; name_width) {
        var_name &lt;- paste0(substr(var_name, 1, name_width-3), &quot;...&quot;)
    }
    cat(sprintf(&quot;%-*s  %10.4f  %10.4f  %4s\n&quot;, 
                name_width, var_name, 
                t_stats[i], p_values[i],
                get_stars(p_values[i])))
}</code></pre>
<pre><code>## (Intercept)                                                       3.4931      0.0005   ***
## ydstogo                                                         -12.8898      0.0000   ***
## posteam_timeouts_remaining                                        1.0113      0.3119      
## defteam_timeouts_remaining                                        0.7931      0.4277      
## rush_attempt                                                      6.9719      0.0000   ***
## week                                                              0.9262      0.3544      
## temp                                                             -0.8024      0.4224      
## wind                                                              0.7045      0.4812      
## vegas_wp                                                          1.5366      0.1245     .
## total_line                                                        1.9559      0.0506     *
## prep_days                                                         1.0924      0.2747      
## overall_win_pct                                                   0.3757      0.7071      
## team_win_pct                                                      1.2417      0.2144      
## prev_win_pct                                                     -2.6313      0.0085   ***
## prev_shotgun_rate                                                 0.5788      0.5628      
## prev_singleback_rate                                              0.9737      0.3303      
## prev_empty_rate                                                   0.9371      0.3488      
## prev_iform_rate                                                   0.3745      0.7080      
## prev_shotgun_success                                              0.1126      0.9104      
## prev_singleback_success                                           0.3596      0.7191      
## prev_empty_success                                                0.4327      0.6652      
## prev_iform_success                                                2.2735      0.0231    **
## prev_stop_rate_run                                                0.0648      0.9483      
## prev_stop_rate_pass                                              -3.3677      0.0008   ***
## shotgun_rate                                                      0.9540      0.3401      
## singleback_rate                                                   0.3497      0.7266      
## empty_rate                                                       -0.1127      0.9103      
## iform_rate                                                       -1.8283      0.0676     *
## shotgun_success                                                  -2.2091      0.0272    **
## singleback_success                                               -0.8969      0.3698      
## empty_success                                                    -0.8626      0.3884      
## iform_success                                                    -1.7321      0.0833     *
## def_stop_rate_run                                                 1.6646      0.0961     *
## def_stop_rate_pass                                               -1.3160      0.1883      
## avg_pass_rushers                                                 -0.7402      0.4592      
## avg_box_defenders                                                -0.7200      0.4715      
## cover0_rate                                                      -0.3777      0.7057      
## cover1_rate                                                      -0.5773      0.5637      
## cover2_rate                                                      -0.3604      0.7186      
## cover3_rate                                                       1.4309      0.1525      
## cover4_rate                                                       0.8172      0.4139      
## cover6_rate                                                      -0.6209      0.5347      
## two_man_rate                                                      1.2110      0.2260      
## prevent_rate                                                      2.4082      0.0161    **
## roof_outdoors                                                    -0.1929      0.8471      
## posteam_type_home                                                -1.5718      0.1161     .
## offense_formation_EMPTY                                           0.3036      0.7615      
## offense_formation_SHOTGUN                                        -0.0156      0.9876      
## offense_formation_SINGLEBACK                                     -0.0048      0.9962      
## offense_formation_I_FORM                                          0.2987      0.7652      
## offense_player_1_rushing_grades_grades_run_12w                    0.0493      0.9607      
## offense_player_1_passing_depth_short_grades_pass_12w              1.0981      0.2723      
## offense_player_4_rushing_grades_ypa_12w                           1.3855      0.1660      
## offense_player_8_receiving_depth_short_caught_percent_12w        -0.9884      0.3230      
## offense_player_8_run_blocking_gap_grades_run_block_12w           -0.7580      0.4485      
## offense_player_9_receiving_depth_short_caught_percent_12w        -0.5369      0.5914      
## offense_player_9_run_blocking_gap_grades_run_block_12w            0.1644      0.8695      
## offense_player_10_receiving_depth_short_caught_percent_12w       -0.1448      0.8849      
## offense_player_10_run_blocking_gap_grades_run_block_12w           1.4063      0.1597      
## offense_player_14_blocking_grades_grades_run_block_2w             1.9839      0.0473    **
## offense_player_15_blocking_grades_grades_run_block_2w             0.1505      0.8804      
## offense_player_17_blocking_grades_grades_offense_12w              1.0835      0.2787      
## offense_player_18_blocking_grades_grades_offense_12w             -0.7743      0.4388      
## offense_player_19_blocking_grades_grades_offense_12w             -0.5324      0.5945      
## offense_player_20_blocking_grades_grades_offense_12w             -0.4384      0.6612      
## offense_player_21_blocking_grades_grades_offense_12w             -0.3763      0.7067      
## defense_player_1_pass_rush_grades_grades_pass_rush_defens...      0.9055      0.3653      
## defense_player_1_run_defense_grades_run_stop_opp_12w             -2.4197      0.0156    **
## defense_player_2_pass_rush_grades_grades_pass_rush_defens...     -0.8519      0.3943      
## defense_player_2_run_defense_grades_run_stop_opp_12w              1.0447      0.2962      
## defense_player_3_pass_rush_grades_grades_pass_rush_defens...     -0.4136      0.6792      
## defense_player_3_run_defense_grades_run_stop_opp_12w              2.0275      0.0427    **
## defense_player_4_pass_rush_grades_grades_pass_rush_defens...     -2.3101      0.0209    **
## defense_player_4_run_defense_grades_run_stop_opp_12w              0.3995      0.6896      
## defense_player_9_pass_rush_grades_grades_pass_rush_defens...     -1.3663      0.1719      
## defense_player_9_run_defense_grades_run_stop_opp_12w             -0.1543      0.8774      
## defense_player_9_coverage_grades_grades_coverage_defense_12w      1.4328      0.1520      
## defense_player_10_pass_rush_grades_grades_pass_rush_defen...     -0.8695      0.3846      
## defense_player_10_run_defense_grades_run_stop_opp_12w             0.4262      0.6700      
## defense_player_10_coverage_grades_grades_coverage_defense...      0.5889      0.5559      
## defense_player_11_pass_rush_grades_grades_pass_rush_defen...      0.1024      0.9185      
## defense_player_11_run_defense_grades_run_stop_opp_12w             0.7321      0.4641      
## defense_player_11_coverage_grades_grades_coverage_defense...     -0.9645      0.3349      
## defense_player_12_pass_rush_grades_grades_pass_rush_defen...     -0.7114      0.4769      
## defense_player_12_run_defense_grades_run_stop_opp_12w            -0.4195      0.6749      
## defense_player_12_coverage_grades_grades_coverage_defense...      0.8758      0.3812      
## defense_player_15_coverage_grades_grades_defense_12w             -1.3151      0.1886      
## defense_player_15_defensive_grades_grades_defense_penalty...      0.7225      0.4701      
## defense_player_16_coverage_grades_grades_defense_12w             -0.9410      0.3467      
## defense_player_16_defensive_grades_grades_defense_penalty...      0.5543      0.5794      
## defense_player_17_coverage_grades_grades_defense_12w              0.2385      0.8115      
## defense_player_17_defensive_grades_grades_defense_penalty...      0.2985      0.7653      
## defense_player_20_coverage_schemes_zone_grades_coverage_d...      0.5755      0.5650      
## defense_player_20_coverage_grades_grades_defense_penalty_12w      0.3756      0.7072      
## defense_player_21_coverage_schemes_zone_grades_coverage_d...      1.0904      0.2756      
## defense_player_21_coverage_grades_grades_defense_penalty_12w     -1.0368      0.2999      
## defense_player_22_coverage_schemes_zone_grades_coverage_d...     -0.0422      0.9664      
## defense_player_22_coverage_grades_grades_defense_penalty_12w      0.1944      0.8459      
## starter_offense_player_1_rushing_grades_grades_run_12w           -1.0070      0.3140      
## starter_offense_player_1_passing_depth_short_grades_pass_12w      0.5936      0.5528      
## starter_offense_player_4_rushing_grades_ypa_12w                   0.6404      0.5220      
## starter_offense_player_8_receiving_depth_short_caught_per...      1.2061      0.2279      
## starter_offense_player_8_run_blocking_gap_grades_run_bloc...     -0.8823      0.3777      
## starter_offense_player_9_receiving_depth_short_caught_per...      1.0527      0.2925      
## starter_offense_player_9_run_blocking_gap_grades_run_bloc...     -0.2021      0.8398      
## starter_offense_player_10_receiving_depth_short_caught_pe...      0.0351      0.9720      
## starter_offense_player_10_run_blocking_gap_grades_run_blo...     -0.1148      0.9086      
## starter_offense_player_14_blocking_grades_grades_run_bloc...      0.4657      0.6414      
## starter_offense_player_15_blocking_grades_grades_run_bloc...      0.0734      0.9415      
## starter_offense_player_17_blocking_grades_grades_offense_12w      2.0345      0.0420    **
## starter_offense_player_18_blocking_grades_grades_offense_12w     -1.5593      0.1190     .
## starter_offense_player_19_blocking_grades_grades_offense_12w     -0.0692      0.9448      
## starter_offense_player_20_blocking_grades_grades_offense_12w      0.7947      0.4268      
## starter_offense_player_21_blocking_grades_grades_offense_12w     -1.3788      0.1680      
## starter_defense_player_1_pass_rush_grades_grades_pass_rus...     -1.0723      0.2837      
## starter_defense_player_1_run_defense_grades_run_stop_opp_12w     -0.1319      0.8951      
## starter_defense_player_2_pass_rush_grades_grades_pass_rus...      0.3829      0.7018      
## starter_defense_player_2_run_defense_grades_run_stop_opp_12w      1.8627      0.0626     *
## starter_defense_player_3_pass_rush_grades_grades_pass_rus...     -0.3766      0.7065      
## starter_defense_player_3_run_defense_grades_run_stop_opp_12w     -0.2066      0.8363      
## starter_defense_player_4_pass_rush_grades_grades_pass_rus...     -0.0530      0.9578      
## starter_defense_player_4_run_defense_grades_run_stop_opp_12w      0.6868      0.4922      
## starter_defense_player_9_pass_rush_grades_grades_pass_rus...     -0.9020      0.3671      
## starter_defense_player_9_run_defense_grades_run_stop_opp_12w     -1.8359      0.0665     *
## starter_defense_player_9_coverage_grades_grades_coverage_...     -0.5648      0.5722      
## starter_defense_player_10_pass_rush_grades_grades_pass_ru...      1.0893      0.2761      
## starter_defense_player_10_run_defense_grades_run_stop_opp...      0.2312      0.8172      
## starter_defense_player_10_coverage_grades_grades_coverage...      0.9467      0.3439      
## starter_defense_player_11_pass_rush_grades_grades_pass_ru...     -0.8752      0.3815      
## starter_defense_player_11_run_defense_grades_run_stop_opp...     -1.2729      0.2031      
## starter_defense_player_11_coverage_grades_grades_coverage...     -0.6505      0.5154      
## starter_defense_player_12_pass_rush_grades_grades_pass_ru...      0.2512      0.8017      
## starter_defense_player_12_run_defense_grades_run_stop_opp...      1.4401      0.1499     .
## starter_defense_player_12_coverage_grades_grades_coverage...      0.3455      0.7298      
## starter_defense_player_15_coverage_grades_grades_defense_12w      1.5587      0.1192     .
## starter_defense_player_15_defensive_grades_grades_defense...     -0.9854      0.3245      
## starter_defense_player_16_coverage_grades_grades_defense_12w      1.2331      0.2176      
## starter_defense_player_16_defensive_grades_grades_defense...     -1.2183      0.2232      
## starter_defense_player_17_coverage_grades_grades_defense_12w      1.5179      0.1291     .
## starter_defense_player_17_defensive_grades_grades_defense...     -1.8492      0.0645     *
## starter_defense_player_20_coverage_schemes_zone_grades_co...      1.5704      0.1164     .
## starter_defense_player_20_coverage_grades_grades_defense_...     -1.8703      0.0615     *
## starter_defense_player_21_coverage_schemes_zone_grades_co...      0.9098      0.3630      
## starter_defense_player_21_coverage_grades_grades_defense_...      1.8473      0.0648     *
## starter_defense_player_22_coverage_schemes_zone_grades_co...      1.0581      0.2901      
## starter_defense_player_22_coverage_grades_grades_defense_...     -1.7274      0.0842     *
## yardline_1_10                                                    -2.4014      0.0164    **
## yardline_11_20                                                    0.2501      0.8026      
## yardline_21_30                                                    0.0649      0.9482      
## yardline_41_50                                                    1.7887      0.0737     *
## yardline_51_60                                                    0.6706      0.5025      
## yardline_61_70                                                    1.5210      0.1284     .
## yardline_71_80                                                    1.6472      0.0996     *
## yardline_81_90                                                    2.4962      0.0126    **
## yardline_91_100                                                   0.7584      0.4483      
## year2017_team_ARI                                                 0.2582      0.7962      
## year2017_team_BUF                                                -0.7850      0.4325      
## year2017_team_CHI                                                -0.1643      0.8695      
## year2017_team_CLE                                                 0.4145      0.6785      
## year2017_team_DAL                                                -1.3545      0.1757      
## year2017_team_DET                                                -0.7146      0.4749      
## year2017_team_GB                                                  1.7904      0.0735     *
## year2017_team_HOU                                                 1.6323      0.1027     .
## year2017_team_MIA                                                -1.2451      0.2132      
## year2017_team_MIN                                                -0.7372      0.4611      
## year2017_team_NE                                                 -0.1075      0.9144      
## year2017_team_SF                                                  1.7122      0.0869     *
## year2017_team_BAL                                                -0.2709      0.7865      
## year2017_team_DEN                                                -0.2550      0.7987      
## year2017_team_LA                                                  0.0264      0.9790      
## year2017_team_NYG                                                -0.5689      0.5695      
## year2017_team_OAK                                                -0.9002      0.3681      
## year2017_team_SEA                                                 0.5641      0.5727      
## year2017_team_CAR                                                 0.1862      0.8523      
## year2017_team_CIN                                                 0.4649      0.6420      
## year2017_team_IND                                                 0.5579      0.5770      
## year2017_team_NO                                                  0.4589      0.6464      
## year2017_team_PHI                                                -0.0200      0.9841      
## year2017_team_PIT                                                -1.0208      0.3074      
## year2017_team_TEN                                                 0.3666      0.7139      
## year2017_team_WAS                                                -0.2414      0.8093      
## year2017_team_KC                                                  1.3897      0.1647      
## year2017_team_LAC                                                -0.3473      0.7284      
## year2017_team_NYJ                                                 0.4075      0.6837      
## year2017_team_TB                                                 -0.0826      0.9342      
## year2017_team_ATL                                                -0.3869      0.6988      
## year2017_team_JAX                                                 0.2030      0.8392      
## year2018_team_ARI                                                 0.4522      0.6512      
## year2018_team_BAL                                                 0.4049      0.6855      
## year2018_team_CAR                                                 0.0617      0.9508      
## year2018_team_CLE                                                -0.7583      0.4483      
## year2018_team_DET                                                 0.5143      0.6071      
## year2018_team_HOU                                                 1.0975      0.2725      
## year2018_team_IND                                                -1.0695      0.2849      
## year2018_team_KC                                                  0.4015      0.6881      
## year2018_team_NYG                                                 0.3527      0.7243      
## year2018_team_OAK                                                -0.9783      0.3280      
## year2018_team_PHI                                                 0.0158      0.9874      
## year2018_team_SEA                                                -0.6965      0.4862      
## year2018_team_BUF                                                -0.8851      0.3762      
## year2018_team_CHI                                                -0.5211      0.6023      
## year2018_team_CIN                                                -0.7497      0.4535      
## year2018_team_DAL                                                -0.3007      0.7637      
## year2018_team_DEN                                                -0.2958      0.7674      
## year2018_team_GB                                                 -0.3306      0.7409      
## year2018_team_LAC                                                -0.0721      0.9425      
## year2018_team_NE                                                 -0.4261      0.6700      
## year2018_team_NO                                                  0.3726      0.7095      
## year2018_team_PIT                                                 0.5234      0.6007      
## year2018_team_SF                                                 -0.2265      0.8208      
## year2018_team_MIA                                                 0.6699      0.5029      
## year2018_team_MIN                                                 0.0212      0.9831      
## year2018_team_NYJ                                                 0.3618      0.7175      
## year2018_team_TB                                                 -0.3431      0.7315      
## year2018_team_ATL                                                -0.0841      0.9330      
## year2018_team_JAX                                                 0.1813      0.8561      
## year2018_team_LA                                                 -0.7685      0.4422      
## year2018_team_TEN                                                 0.7296      0.4657      
## year2018_team_WAS                                                -0.2779      0.7811      
## year2019_team_ARI                                                -0.8641      0.3876      
## year2019_team_BUF                                                -1.0700      0.2847      
## year2019_team_CHI                                                 0.2757      0.7828      
## year2019_team_CLE                                                 0.4869      0.6263      
## year2019_team_DAL                                                -0.2777      0.7812      
## year2019_team_IND                                                -0.5530      0.5803      
## year2019_team_JAX                                                 0.3023      0.7624      
## year2019_team_KC                                                 -0.3055      0.7600      
## year2019_team_LAC                                                -1.0089      0.3131      
## year2019_team_MIN                                                -0.9055      0.3653      
## year2019_team_NE                                                 -0.3434      0.7313      
## year2019_team_NO                                                 -1.3135      0.1891      
## year2019_team_PHI                                                -0.3166      0.7516      
## year2019_team_SEA                                                -0.4147      0.6784      
## year2019_team_SF                                                 -0.4292      0.6678      
## year2019_team_TB                                                 -0.8672      0.3859      
## year2019_team_BAL                                                -0.2094      0.8342      
## year2019_team_CAR                                                -0.6191      0.5359      
## year2019_team_DEN                                                 0.3116      0.7553      
## year2019_team_DET                                                -1.2133      0.2251      
## year2019_team_HOU                                                -0.1135      0.9096      
## year2019_team_LA                                                 -0.9759      0.3292      
## year2019_team_MIA                                                -1.8121      0.0701     *
## year2019_team_NYG                                                -1.2297      0.2189      
## year2019_team_NYJ                                                -1.3610      0.1736      
## year2019_team_OAK                                                -0.7670      0.4431      
## year2019_team_PIT                                                -1.9360      0.0529     *
## year2019_team_TEN                                                -1.2965      0.1949      
## year2019_team_CIN                                                 0.3159      0.7521      
## year2019_team_WAS                                                -0.3736      0.7088      
## year2019_team_ATL                                                -0.1400      0.8886      
## year2019_team_GB                                                 -0.7815      0.4345      
## year2020_team_ATL                                                -0.1642      0.8696      
## year2020_team_BAL                                                 0.4993      0.6176      
## year2020_team_BUF                                                -0.3538      0.7235      
## year2020_team_CAR                                                 0.2919      0.7704      
## year2020_team_CIN                                                 0.2134      0.8310      
## year2020_team_DEN                                                -0.6969      0.4859      
## year2020_team_DET                                                -1.2875      0.1980      
## year2020_team_JAX                                                -0.9988      0.3180      
## year2020_team_KC                                                  0.1120      0.9109      
## year2020_team_LA                                                 -1.3681      0.1714      
## year2020_team_MIN                                                 0.7293      0.4659      
## year2020_team_NE                                                 -0.2928      0.7697      
## year2020_team_NO                                                  0.0056      0.9956      
## year2020_team_NYG                                                -0.2735      0.7845      
## year2020_team_SF                                                  0.2410      0.8096      
## year2020_team_WAS                                                -0.1256      0.9001      
## year2020_team_CHI                                                 0.2253      0.8217      
## year2020_team_DAL                                                -0.4096      0.6821      
## year2020_team_GB                                                 -0.1772      0.8594      
## year2020_team_HOU                                                -0.5312      0.5953      
## year2020_team_MIA                                                -1.4798      0.1390     .
## year2020_team_NYJ                                                -0.4287      0.6682      
## year2020_team_TB                                                  0.0971      0.9226      
## year2020_team_TEN                                                -0.8793      0.3793      
## year2020_team_ARI                                                 0.3939      0.6937      
## year2020_team_CLE                                                -1.6653      0.0959     *
## year2020_team_IND                                                -1.0300      0.3031      
## year2020_team_LAC                                                 0.2336      0.8153      
## year2020_team_PHI                                                 0.2716      0.7860      
## year2020_team_SEA                                                -0.5474      0.5841      
## year2020_team_LV                                                  0.4448      0.6565      
## year2020_team_PIT                                                -0.5990      0.5492      
## year2021_team_ATL                                                -1.8897      0.0589     *
## year2021_team_BUF                                                -0.1098      0.9126      
## year2021_team_CIN                                                -2.2105      0.0271    **
## year2021_team_DAL                                                -0.8718      0.3834      
## year2021_team_DEN                                                 0.0690      0.9450      
## year2021_team_DET                                                -0.5900      0.5552      
## year2021_team_KC                                                  0.1106      0.9120      
## year2021_team_LA                                                 -0.3083      0.7579      
## year2021_team_LV                                                  0.2074      0.8357      
## year2021_team_MIN                                                -0.4766      0.6337      
## year2021_team_NE                                                  0.2123      0.8319      
## year2021_team_NO                                                 -0.5151      0.6065      
## year2021_team_NYG                                                -0.4773      0.6332      
## year2021_team_SF                                                  0.2382      0.8117      
## year2021_team_TEN                                                -0.6848      0.4935      
## year2021_team_ARI                                                 0.6503      0.5156      
## year2021_team_BAL                                                 0.7892      0.4301      
## year2021_team_CAR                                                -0.9763      0.3290      
## year2021_team_CHI                                                -2.1440      0.0321    **
## year2021_team_GB                                                  0.7033      0.4819      
## year2021_team_IND                                                -0.3954      0.6926      
## year2021_team_LAC                                                -0.0157      0.9875      
## year2021_team_MIA                                                 0.1020      0.9188      
## year2021_team_NYJ                                                -0.3061      0.7595      
## year2021_team_PHI                                                -1.4715      0.1412     .
## year2021_team_SEA                                                -1.0852      0.2779      
## year2021_team_TB                                                  0.0620      0.9506      
## year2021_team_WAS                                                -1.0431      0.2970      
## year2021_team_CLE                                                -1.1871      0.2352      
## year2021_team_HOU                                                -0.7881      0.4307      
## year2021_team_JAX                                                -0.2889      0.7727      
## year2021_team_PIT                                                 0.2287      0.8191      
## year2022_team_ARI                                                -1.2238      0.2211      
## year2022_team_ATL                                                -2.1195      0.0341    **
## year2022_team_CAR                                                 0.7716      0.4404      
## year2022_team_CHI                                                -0.5774      0.5637      
## year2022_team_CIN                                                -0.8286      0.4074      
## year2022_team_HOU                                                -0.5018      0.6159      
## year2022_team_IND                                                -1.2579      0.2085      
## year2022_team_LAC                                                -0.5435      0.5868      
## year2022_team_MIA                                                -1.3492      0.1774      
## year2022_team_SEA                                                -0.5213      0.6022      
## year2022_team_TB                                                  0.1229      0.9022      
## year2022_team_TEN                                                 0.9241      0.3555      
## year2022_team_WAS                                                -0.1074      0.9145      
## year2022_team_BAL                                                -1.4564      0.1454     .
## year2022_team_BUF                                                 0.4989      0.6179      
## year2022_team_DAL                                                -0.0959      0.9236      
## year2022_team_DET                                                -0.6386      0.5231      
## year2022_team_GB                                                 -0.9028      0.3667      
## year2022_team_JAX                                                -1.2845      0.1990      
## year2022_team_KC                                                 -1.0532      0.2923      
## year2022_team_LA                                                  0.8844      0.3765      
## year2022_team_LV                                                  1.2075      0.2273      
## year2022_team_NO                                                 -0.5290      0.5968      
## year2022_team_PHI                                                 0.0040      0.9968      
## year2022_team_PIT                                                 1.4146      0.1573      
## year2022_team_DEN                                                 0.2870      0.7741      
## year2022_team_MIN                                                -1.3791      0.1680      
## year2022_team_NE                                                  0.0790      0.9370      
## year2022_team_NYJ                                                -0.8885      0.3743      
## year2022_team_NYG                                                -0.9516      0.3414      
## year2022_team_SF                                                 -0.9542      0.3400      
## year2023_team_BAL                                                -0.3955      0.6925      
## year2023_team_CHI                                                -1.2385      0.2156      
## year2023_team_CLE                                                -1.1988      0.2307      
## year2023_team_GB                                                  0.3482      0.7277      
## year2023_team_IND                                                 0.3742      0.7083      
## year2023_team_KC                                                  0.2604      0.7946      
## year2023_team_LAC                                                 0.3854      0.7000      
## year2023_team_LV                                                  0.1171      0.9068      
## year2023_team_MIA                                                 0.0165      0.9868      
## year2023_team_MIN                                                 0.9784      0.3279      
## year2023_team_NO                                                 -0.7142      0.4751      
## year2023_team_NYG                                                 0.6566      0.5115      
## year2023_team_SEA                                                -2.6630      0.0078   ***
## year2023_team_SF                                                 -0.2289      0.8190      
## year2023_team_WAS                                                 1.0163      0.3095      
## year2023_team_ATL                                                -0.6846      0.4936      
## year2023_team_BUF                                                -0.6046      0.5455      
## year2023_team_CAR                                                 0.3416      0.7327      
## year2023_team_DAL                                                 0.4486      0.6537      
## year2023_team_DEN                                                -0.0388      0.9691      
## year2023_team_HOU                                                -0.1600      0.8729      
## year2023_team_LA                                                 -0.2580      0.7964      
## year2023_team_NE                                                 -0.2350      0.8142      
## year2023_team_PHI                                                -0.5988      0.5493      
## year2023_team_PIT                                                -0.2043      0.8381      
## year2023_team_TEN                                                -0.1300      0.8966      
## year2023_team_ARI                                                -1.3457      0.1785      
## year2023_team_CIN                                                -1.2518      0.2107      
## year2023_team_DET                                                 0.1047      0.9166      
## year2023_team_TB                                                  0.5134      0.6077      
## year2023_team_JAX                                                -1.1184      0.2635      
## year2023_team_NYJ                                                 1.5292      0.1263     .
## is_first_half                                                    -0.7277      0.4668      
## time_in_half                                                      1.7760      0.0758     *
## home_attendance                                                  -0.4523      0.6511      
## GIMR                                                              2.2784      0.0228    **</code></pre>
<pre class="r"><code>cat(&quot;\nSignificance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15&quot;)</code></pre>
<pre><code>## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</code></pre>
<pre class="r"><code>r_squared &lt;- summary(ols_model)$adj.r.squared
r_squared</code></pre>
<pre><code>## [1] 0.1130398</code></pre>
<pre class="r"><code># Create a copy of outcome_data without GIMR
outcome_data_no_gimr &lt;- copy(outcome_data)
outcome_data_no_gimr[, GIMR := NULL]
outcome_data_no_gimr[, my_id := NULL]</code></pre>
<pre><code>## Warning in `[.data.table`(outcome_data_no_gimr, , `:=`(my_id, NULL)): Column
## &#39;my_id&#39; does not exist to remove</code></pre>
<pre class="r"><code># Run OLS without GIMR correction
ols_model_no_gimr &lt;- lm(conversion ~ ., data = outcome_data_no_gimr)

# Get HC0-adjusted t-values and p-values
robust_test_no_gimr &lt;- coeftest(ols_model_no_gimr, vcov = vcovHC(ols_model_no_gimr, type = &quot;HC0&quot;))
t_stats_no_gimr &lt;- robust_test_no_gimr[, &quot;t value&quot;]
p_values_no_gimr &lt;- robust_test_no_gimr[, &quot;Pr(&gt;|t|)&quot;]

# Print header with alignment
cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;Variable&quot;, &quot;t-value&quot;, &quot;p-value&quot;, &quot;sig&quot;))</code></pre>
<pre><code>## Variable                                                         t-value     p-value   sig</code></pre>
<pre class="r"><code>cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;---------&quot;, &quot;-------&quot;, &quot;-------&quot;, &quot;----&quot;))</code></pre>
<pre><code>## ---------                                                        -------     -------  ----</code></pre>
<pre class="r"><code># Loop through and print values
for (i in 1:length(t_stats_no_gimr)) {
    var_name &lt;- rownames(robust_test_no_gimr)[i]
    # Truncate name if too long
    if (nchar(var_name) &gt; name_width) {
        var_name &lt;- paste0(substr(var_name, 1, name_width-3), &quot;...&quot;)
    }
    cat(sprintf(&quot;%-*s  %10.4f  %10.4f  %4s\n&quot;, 
                name_width, var_name, 
                t_stats_no_gimr[i], p_values_no_gimr[i],
                get_stars(p_values_no_gimr[i])))
}</code></pre>
<pre><code>## (Intercept)                                                       4.4104      0.0000   ***
## ydstogo                                                         -13.8940      0.0000   ***
## posteam_timeouts_remaining                                        0.6281      0.5300      
## defteam_timeouts_remaining                                        0.8606      0.3895      
## rush_attempt                                                      7.4638      0.0000   ***
## week                                                              0.9405      0.3470      
## temp                                                             -0.7885      0.4305      
## wind                                                              0.6298      0.5289      
## vegas_wp                                                          0.6443      0.5194      
## total_line                                                        2.0178      0.0437    **
## prep_days                                                         1.1492      0.2505      
## overall_win_pct                                                   0.3609      0.7182      
## team_win_pct                                                      1.3847      0.1662      
## prev_win_pct                                                     -2.5150      0.0119    **
## prev_shotgun_rate                                                 0.6652      0.5060      
## prev_singleback_rate                                              1.0738      0.2830      
## prev_empty_rate                                                   1.0056      0.3147      
## prev_iform_rate                                                   0.4376      0.6617      
## prev_shotgun_success                                              0.0619      0.9507      
## prev_singleback_success                                           0.3787      0.7049      
## prev_empty_success                                                0.3952      0.6927      
## prev_iform_success                                                2.2961      0.0217    **
## prev_stop_rate_run                                                0.0153      0.9878      
## prev_stop_rate_pass                                              -3.3082      0.0009   ***
## shotgun_rate                                                      1.0064      0.3143      
## singleback_rate                                                   0.4463      0.6554      
## empty_rate                                                       -0.0689      0.9451      
## iform_rate                                                       -1.7996      0.0720     *
## shotgun_success                                                  -2.1739      0.0298    **
## singleback_success                                               -0.8584      0.3907      
## empty_success                                                    -0.8170      0.4140      
## iform_success                                                    -1.6603      0.0969     *
## def_stop_rate_run                                                 1.6135      0.1067     .
## def_stop_rate_pass                                               -1.3452      0.1786      
## avg_pass_rushers                                                 -0.7608      0.4468      
## avg_box_defenders                                                -0.7378      0.4607      
## cover0_rate                                                      -0.3747      0.7079      
## cover1_rate                                                      -0.5946      0.5522      
## cover2_rate                                                      -0.3859      0.6996      
## cover3_rate                                                       1.4072      0.1595      
## cover4_rate                                                       0.8122      0.4167      
## cover6_rate                                                      -0.5989      0.5493      
## two_man_rate                                                      1.2140      0.2248      
## prevent_rate                                                      2.4419      0.0147    **
## roof_outdoors                                                    -0.0915      0.9271      
## posteam_type_home                                                -1.5085      0.1315     .
## offense_formation_EMPTY                                           0.0926      0.9262      
## offense_formation_SHOTGUN                                        -0.2205      0.8255      
## offense_formation_SINGLEBACK                                      0.0356      0.9716      
## offense_formation_I_FORM                                          0.3385      0.7350      
## offense_player_1_rushing_grades_grades_run_12w                    0.0130      0.9896      
## offense_player_1_passing_depth_short_grades_pass_12w              1.1396      0.2545      
## offense_player_4_rushing_grades_ypa_12w                           1.3642      0.1726      
## offense_player_8_receiving_depth_short_caught_percent_12w        -0.9551      0.3396      
## offense_player_8_run_blocking_gap_grades_run_block_12w           -0.8128      0.4164      
## offense_player_9_receiving_depth_short_caught_percent_12w        -0.5387      0.5901      
## offense_player_9_run_blocking_gap_grades_run_block_12w            0.1755      0.8607      
## offense_player_10_receiving_depth_short_caught_percent_12w       -0.2093      0.8342      
## offense_player_10_run_blocking_gap_grades_run_block_12w           1.4542      0.1460     .
## offense_player_14_blocking_grades_grades_run_block_2w             1.9634      0.0497    **
## offense_player_15_blocking_grades_grades_run_block_2w             0.1733      0.8624      
## offense_player_17_blocking_grades_grades_offense_12w              1.0267      0.3046      
## offense_player_18_blocking_grades_grades_offense_12w             -0.8194      0.4126      
## offense_player_19_blocking_grades_grades_offense_12w             -0.5292      0.5967      
## offense_player_20_blocking_grades_grades_offense_12w             -0.4469      0.6550      
## offense_player_21_blocking_grades_grades_offense_12w             -0.4422      0.6584      
## defense_player_1_pass_rush_grades_grades_pass_rush_defens...      0.8639      0.3877      
## defense_player_1_run_defense_grades_run_stop_opp_12w             -2.4188      0.0156    **
## defense_player_2_pass_rush_grades_grades_pass_rush_defens...     -0.8678      0.3855      
## defense_player_2_run_defense_grades_run_stop_opp_12w              1.0800      0.2802      
## defense_player_3_pass_rush_grades_grades_pass_rush_defens...     -0.4247      0.6711      
## defense_player_3_run_defense_grades_run_stop_opp_12w              2.0860      0.0370    **
## defense_player_4_pass_rush_grades_grades_pass_rush_defens...     -2.3282      0.0200    **
## defense_player_4_run_defense_grades_run_stop_opp_12w              0.4368      0.6622      
## defense_player_9_pass_rush_grades_grades_pass_rush_defens...     -1.3928      0.1638      
## defense_player_9_run_defense_grades_run_stop_opp_12w             -0.2258      0.8214      
## defense_player_9_coverage_grades_grades_coverage_defense_12w      1.4615      0.1440     .
## defense_player_10_pass_rush_grades_grades_pass_rush_defen...     -0.8491      0.3959      
## defense_player_10_run_defense_grades_run_stop_opp_12w             0.4174      0.6764      
## defense_player_10_coverage_grades_grades_coverage_defense...      0.6247      0.5322      
## defense_player_11_pass_rush_grades_grades_pass_rush_defen...      0.0879      0.9300      
## defense_player_11_run_defense_grades_run_stop_opp_12w             0.7277      0.4668      
## defense_player_11_coverage_grades_grades_coverage_defense...     -0.9280      0.3534      
## defense_player_12_pass_rush_grades_grades_pass_rush_defen...     -0.6880      0.4915      
## defense_player_12_run_defense_grades_run_stop_opp_12w            -0.4329      0.6651      
## defense_player_12_coverage_grades_grades_coverage_defense...      0.8636      0.3879      
## defense_player_15_coverage_grades_grades_defense_12w             -1.3258      0.1850      
## defense_player_15_defensive_grades_grades_defense_penalty...      0.7407      0.4589      
## defense_player_16_coverage_grades_grades_defense_12w             -0.9243      0.3554      
## defense_player_16_defensive_grades_grades_defense_penalty...      0.5058      0.6130      
## defense_player_17_coverage_grades_grades_defense_12w              0.2388      0.8112      
## defense_player_17_defensive_grades_grades_defense_penalty...      0.2590      0.7956      
## defense_player_20_coverage_schemes_zone_grades_coverage_d...      0.5824      0.5603      
## defense_player_20_coverage_grades_grades_defense_penalty_12w      0.3910      0.6958      
## defense_player_21_coverage_schemes_zone_grades_coverage_d...      1.0899      0.2758      
## defense_player_21_coverage_grades_grades_defense_penalty_12w     -1.0673      0.2859      
## defense_player_22_coverage_schemes_zone_grades_coverage_d...     -0.0706      0.9437      
## defense_player_22_coverage_grades_grades_defense_penalty_12w      0.2146      0.8301      
## starter_offense_player_1_rushing_grades_grades_run_12w           -1.0081      0.3135      
## starter_offense_player_1_passing_depth_short_grades_pass_12w      0.6092      0.5425      
## starter_offense_player_4_rushing_grades_ypa_12w                   0.6958      0.4866      
## starter_offense_player_8_receiving_depth_short_caught_per...      1.1929      0.2330      
## starter_offense_player_8_run_blocking_gap_grades_run_bloc...     -0.9059      0.3650      
## starter_offense_player_9_receiving_depth_short_caught_per...      1.0065      0.3143      
## starter_offense_player_9_run_blocking_gap_grades_run_bloc...     -0.1865      0.8520      
## starter_offense_player_10_receiving_depth_short_caught_pe...     -0.0369      0.9706      
## starter_offense_player_10_run_blocking_gap_grades_run_blo...     -0.0741      0.9410      
## starter_offense_player_14_blocking_grades_grades_run_bloc...      0.4536      0.6501      
## starter_offense_player_15_blocking_grades_grades_run_bloc...      0.0486      0.9612      
## starter_offense_player_17_blocking_grades_grades_offense_12w      2.0232      0.0431    **
## starter_offense_player_18_blocking_grades_grades_offense_12w     -1.5056      0.1323     .
## starter_offense_player_19_blocking_grades_grades_offense_12w     -0.1074      0.9145      
## starter_offense_player_20_blocking_grades_grades_offense_12w      0.8048      0.4210      
## starter_offense_player_21_blocking_grades_grades_offense_12w     -1.4332      0.1519      
## starter_defense_player_1_pass_rush_grades_grades_pass_rus...     -1.1101      0.2670      
## starter_defense_player_1_run_defense_grades_run_stop_opp_12w     -0.0732      0.9417      
## starter_defense_player_2_pass_rush_grades_grades_pass_rus...      0.4095      0.6822      
## starter_defense_player_2_run_defense_grades_run_stop_opp_12w      1.8170      0.0693     *
## starter_defense_player_3_pass_rush_grades_grades_pass_rus...     -0.4259      0.6702      
## starter_defense_player_3_run_defense_grades_run_stop_opp_12w     -0.2284      0.8193      
## starter_defense_player_4_pass_rush_grades_grades_pass_rus...     -0.0390      0.9689      
## starter_defense_player_4_run_defense_grades_run_stop_opp_12w      0.7046      0.4811      
## starter_defense_player_9_pass_rush_grades_grades_pass_rus...     -0.8755      0.3814      
## starter_defense_player_9_run_defense_grades_run_stop_opp_12w     -1.8631      0.0625     *
## starter_defense_player_9_coverage_grades_grades_coverage_...     -0.5439      0.5866      
## starter_defense_player_10_pass_rush_grades_grades_pass_ru...      1.1334      0.2571      
## starter_defense_player_10_run_defense_grades_run_stop_opp...      0.2513      0.8016      
## starter_defense_player_10_coverage_grades_grades_coverage...      0.9503      0.3420      
## starter_defense_player_11_pass_rush_grades_grades_pass_ru...     -0.8866      0.3753      
## starter_defense_player_11_run_defense_grades_run_stop_opp...     -1.3116      0.1898      
## starter_defense_player_11_coverage_grades_grades_coverage...     -0.6016      0.5475      
## starter_defense_player_12_pass_rush_grades_grades_pass_ru...      0.1644      0.8694      
## starter_defense_player_12_run_defense_grades_run_stop_opp...      1.4501      0.1471     .
## starter_defense_player_12_coverage_grades_grades_coverage...      0.4334      0.6648      
## starter_defense_player_15_coverage_grades_grades_defense_12w      1.5413      0.1233     .
## starter_defense_player_15_defensive_grades_grades_defense...     -0.9884      0.3230      
## starter_defense_player_16_coverage_grades_grades_defense_12w      1.2056      0.2280      
## starter_defense_player_16_defensive_grades_grades_defense...     -1.2125      0.2254      
## starter_defense_player_17_coverage_grades_grades_defense_12w      1.5278      0.1266     .
## starter_defense_player_17_defensive_grades_grades_defense...     -1.8788      0.0604     *
## starter_defense_player_20_coverage_schemes_zone_grades_co...      1.5697      0.1166     .
## starter_defense_player_20_coverage_grades_grades_defense_...     -1.8248      0.0681     *
## starter_defense_player_21_coverage_schemes_zone_grades_co...      0.8637      0.3878      
## starter_defense_player_21_coverage_grades_grades_defense_...      1.8667      0.0620     *
## starter_defense_player_22_coverage_schemes_zone_grades_co...      1.0132      0.3110      
## starter_defense_player_22_coverage_grades_grades_defense_...     -1.6693      0.0951     *
## yardline_1_10                                                    -2.5001      0.0125    **
## yardline_11_20                                                   -0.1019      0.9189      
## yardline_21_30                                                   -0.3294      0.7419      
## yardline_41_50                                                    1.7725      0.0764     *
## yardline_51_60                                                    0.3073      0.7586      
## yardline_61_70                                                    0.9633      0.3355      
## yardline_71_80                                                    1.3259      0.1849      
## yardline_81_90                                                    2.2464      0.0247    **
## yardline_91_100                                                   0.8060      0.4203      
## year2017_team_ARI                                                 0.1661      0.8681      
## year2017_team_BUF                                                -0.8656      0.3868      
## year2017_team_CHI                                                -0.1739      0.8619      
## year2017_team_CLE                                                 0.4523      0.6511      
## year2017_team_DAL                                                -1.4298      0.1529      
## year2017_team_DET                                                -0.7390      0.4600      
## year2017_team_GB                                                  1.7925      0.0731     *
## year2017_team_HOU                                                 1.5886      0.1122     .
## year2017_team_MIA                                                -1.2801      0.2006      
## year2017_team_MIN                                                -0.7633      0.4454      
## year2017_team_NE                                                 -0.1237      0.9016      
## year2017_team_SF                                                  1.7013      0.0890     *
## year2017_team_BAL                                                -0.3068      0.7590      
## year2017_team_DEN                                                -0.2930      0.7696      
## year2017_team_LA                                                 -0.0097      0.9923      
## year2017_team_NYG                                                -0.6382      0.5234      
## year2017_team_OAK                                                -0.9221      0.3566      
## year2017_team_SEA                                                 0.5654      0.5718      
## year2017_team_CAR                                                 0.1395      0.8891      
## year2017_team_CIN                                                 0.4031      0.6869      
## year2017_team_IND                                                 0.4803      0.6310      
## year2017_team_NO                                                  0.4315      0.6661      
## year2017_team_PHI                                                -0.0843      0.9328      
## year2017_team_PIT                                                -1.0975      0.2725      
## year2017_team_TEN                                                 0.3507      0.7259      
## year2017_team_WAS                                                -0.2919      0.7704      
## year2017_team_KC                                                  1.3025      0.1928      
## year2017_team_LAC                                                -0.4152      0.6780      
## year2017_team_NYJ                                                 0.3908      0.6960      
## year2017_team_TB                                                 -0.1622      0.8712      
## year2017_team_ATL                                                -0.4689      0.6392      
## year2017_team_JAX                                                 0.2008      0.8409      
## year2018_team_ARI                                                 0.4474      0.6546      
## year2018_team_BAL                                                 0.3316      0.7402      
## year2018_team_CAR                                                 0.0345      0.9725      
## year2018_team_CLE                                                -0.7892      0.4301      
## year2018_team_DET                                                 0.4745      0.6352      
## year2018_team_HOU                                                 1.0299      0.3031      
## year2018_team_IND                                                -1.1088      0.2676      
## year2018_team_KC                                                  0.3937      0.6938      
## year2018_team_NYG                                                 0.3277      0.7431      
## year2018_team_OAK                                                -0.9729      0.3307      
## year2018_team_PHI                                                -0.0424      0.9662      
## year2018_team_SEA                                                -0.7455      0.4560      
## year2018_team_BUF                                                -0.9283      0.3533      
## year2018_team_CHI                                                -0.5797      0.5621      
## year2018_team_CIN                                                -0.8128      0.4164      
## year2018_team_DAL                                                -0.3239      0.7460      
## year2018_team_DEN                                                -0.3188      0.7499      
## year2018_team_GB                                                 -0.3286      0.7425      
## year2018_team_LAC                                                -0.0376      0.9700      
## year2018_team_NE                                                 -0.4329      0.6651      
## year2018_team_NO                                                  0.3549      0.7227      
## year2018_team_PIT                                                 0.4886      0.6251      
## year2018_team_SF                                                 -0.2815      0.7784      
## year2018_team_MIA                                                 0.6813      0.4957      
## year2018_team_MIN                                                -0.0055      0.9956      
## year2018_team_NYJ                                                 0.3678      0.7131      
## year2018_team_TB                                                 -0.3672      0.7135      
## year2018_team_ATL                                                -0.0580      0.9538      
## year2018_team_JAX                                                 0.1707      0.8645      
## year2018_team_LA                                                 -0.7948      0.4268      
## year2018_team_TEN                                                 0.7459      0.4558      
## year2018_team_WAS                                                -0.3037      0.7614      
## year2019_team_ARI                                                -0.9077      0.3641      
## year2019_team_BUF                                                -1.1155      0.2647      
## year2019_team_CHI                                                 0.2015      0.8403      
## year2019_team_CLE                                                 0.4438      0.6572      
## year2019_team_DAL                                                -0.3107      0.7561      
## year2019_team_IND                                                -0.6268      0.5308      
## year2019_team_JAX                                                 0.2716      0.7860      
## year2019_team_KC                                                 -0.4209      0.6738      
## year2019_team_LAC                                                -1.0244      0.3057      
## year2019_team_MIN                                                -1.0121      0.3116      
## year2019_team_NE                                                 -0.3835      0.7014      
## year2019_team_NO                                                 -1.3070      0.1913      
## year2019_team_PHI                                                -0.3465      0.7290      
## year2019_team_SEA                                                -0.4529      0.6506      
## year2019_team_SF                                                 -0.4412      0.6591      
## year2019_team_TB                                                 -0.8689      0.3849      
## year2019_team_BAL                                                -0.2459      0.8058      
## year2019_team_CAR                                                -0.6127      0.5401      
## year2019_team_DEN                                                 0.2852      0.7755      
## year2019_team_DET                                                -1.2189      0.2230      
## year2019_team_HOU                                                -0.1493      0.8813      
## year2019_team_LA                                                 -1.0817      0.2795      
## year2019_team_MIA                                                -1.8515      0.0642     *
## year2019_team_NYG                                                -1.2267      0.2200      
## year2019_team_NYJ                                                -1.3420      0.1797      
## year2019_team_OAK                                                -0.8194      0.4126      
## year2019_team_PIT                                                -1.9197      0.0550     *
## year2019_team_TEN                                                -1.3122      0.1895      
## year2019_team_CIN                                                 0.2821      0.7779      
## year2019_team_WAS                                                -0.4107      0.6813      
## year2019_team_ATL                                                -0.1617      0.8716      
## year2019_team_GB                                                 -0.7846      0.4327      
## year2020_team_ATL                                                -0.1523      0.8790      
## year2020_team_BAL                                                 0.5450      0.5858      
## year2020_team_BUF                                                -0.3012      0.7632      
## year2020_team_CAR                                                 0.3289      0.7422      
## year2020_team_CIN                                                 0.2099      0.8338      
## year2020_team_DEN                                                -0.6910      0.4896      
## year2020_team_DET                                                -1.2406      0.2148      
## year2020_team_JAX                                                -0.9924      0.3211      
## year2020_team_KC                                                  0.1344      0.8931      
## year2020_team_LA                                                 -1.3709      0.1705      
## year2020_team_MIN                                                 0.7413      0.4586      
## year2020_team_NE                                                 -0.2696      0.7875      
## year2020_team_NO                                                  0.0322      0.9743      
## year2020_team_NYG                                                -0.2092      0.8343      
## year2020_team_SF                                                  0.1937      0.8464      
## year2020_team_WAS                                                -0.1415      0.8875      
## year2020_team_CHI                                                 0.2143      0.8303      
## year2020_team_DAL                                                -0.3546      0.7229      
## year2020_team_GB                                                 -0.1398      0.8889      
## year2020_team_HOU                                                -0.4768      0.6335      
## year2020_team_MIA                                                -1.4622      0.1438     .
## year2020_team_NYJ                                                -0.3959      0.6922      
## year2020_team_TB                                                  0.1114      0.9113      
## year2020_team_TEN                                                -0.8968      0.3699      
## year2020_team_ARI                                                 0.4554      0.6489      
## year2020_team_CLE                                                -1.6256      0.1041     .
## year2020_team_IND                                                -0.9638      0.3352      
## year2020_team_LAC                                                 0.2444      0.8070      
## year2020_team_PHI                                                 0.2890      0.7726      
## year2020_team_SEA                                                -0.5612      0.5747      
## year2020_team_LV                                                  0.4344      0.6640      
## year2020_team_PIT                                                -0.6011      0.5478      
## year2021_team_ATL                                                -1.9090      0.0563     *
## year2021_team_BUF                                                -0.1628      0.8707      
## year2021_team_CIN                                                -2.2271      0.0260    **
## year2021_team_DAL                                                -0.8938      0.3715      
## year2021_team_DEN                                                 0.0030      0.9976      
## year2021_team_DET                                                -0.5894      0.5556      
## year2021_team_KC                                                  0.1169      0.9069      
## year2021_team_LA                                                 -0.3422      0.7322      
## year2021_team_LV                                                  0.1591      0.8736      
## year2021_team_MIN                                                -0.5731      0.5666      
## year2021_team_NE                                                  0.2392      0.8110      
## year2021_team_NO                                                 -0.5222      0.6016      
## year2021_team_NYG                                                -0.4639      0.6427      
## year2021_team_SF                                                  0.2394      0.8108      
## year2021_team_TEN                                                -0.7032      0.4819      
## year2021_team_ARI                                                 0.6322      0.5273      
## year2021_team_BAL                                                 0.7846      0.4327      
## year2021_team_CAR                                                -0.9547      0.3398      
## year2021_team_CHI                                                -2.1446      0.0320    **
## year2021_team_GB                                                  0.6406      0.5218      
## year2021_team_IND                                                -0.4626      0.6437      
## year2021_team_LAC                                                -0.1193      0.9050      
## year2021_team_MIA                                                 0.0462      0.9632      
## year2021_team_NYJ                                                -0.3080      0.7581      
## year2021_team_PHI                                                -1.4748      0.1404     .
## year2021_team_SEA                                                -1.1065      0.2686      
## year2021_team_TB                                                 -0.0176      0.9860      
## year2021_team_WAS                                                -1.0615      0.2885      
## year2021_team_CLE                                                -1.2589      0.2082      
## year2021_team_HOU                                                -0.8125      0.4166      
## year2021_team_JAX                                                -0.3231      0.7467      
## year2021_team_PIT                                                 0.1868      0.8519      
## year2022_team_ARI                                                -1.2528      0.2104      
## year2022_team_ATL                                                -2.1647      0.0305    **
## year2022_team_CAR                                                 0.7477      0.4547      
## year2022_team_CHI                                                -0.6073      0.5437      
## year2022_team_CIN                                                -0.8562      0.3920      
## year2022_team_HOU                                                -0.5147      0.6068      
## year2022_team_IND                                                -1.2916      0.1966      
## year2022_team_LAC                                                -0.5860      0.5579      
## year2022_team_MIA                                                -1.3754      0.1691      
## year2022_team_SEA                                                -0.5657      0.5716      
## year2022_team_TB                                                  0.0874      0.9304      
## year2022_team_TEN                                                 0.8629      0.3882      
## year2022_team_WAS                                                -0.1708      0.8644      
## year2022_team_BAL                                                -1.4846      0.1377     .
## year2022_team_BUF                                                 0.4071      0.6839      
## year2022_team_DAL                                                -0.1352      0.8925      
## year2022_team_DET                                                -0.6625      0.5077      
## year2022_team_GB                                                 -0.9298      0.3525      
## year2022_team_JAX                                                -1.3121      0.1896      
## year2022_team_KC                                                 -1.1150      0.2649      
## year2022_team_LA                                                  0.7571      0.4491      
## year2022_team_LV                                                  1.1856      0.2359      
## year2022_team_NO                                                 -0.5473      0.5842      
## year2022_team_PHI                                                -0.0418      0.9667      
## year2022_team_PIT                                                 1.3670      0.1717      
## year2022_team_DEN                                                 0.2964      0.7670      
## year2022_team_MIN                                                -1.4654      0.1429     .
## year2022_team_NE                                                  0.0957      0.9238      
## year2022_team_NYJ                                                -0.9677      0.3333      
## year2022_team_NYG                                                -0.9340      0.3504      
## year2022_team_SF                                                 -0.9386      0.3480      
## year2023_team_BAL                                                -0.4081      0.6832      
## year2023_team_CHI                                                -1.2688      0.2046      
## year2023_team_CLE                                                -1.2117      0.2257      
## year2023_team_GB                                                  0.2736      0.7844      
## year2023_team_IND                                                 0.3123      0.7548      
## year2023_team_KC                                                  0.1519      0.8792      
## year2023_team_LAC                                                 0.3079      0.7582      
## year2023_team_LV                                                  0.0680      0.9458      
## year2023_team_MIA                                                -0.0774      0.9383      
## year2023_team_MIN                                                 0.9675      0.3334      
## year2023_team_NO                                                 -0.7361      0.4617      
## year2023_team_NYG                                                 0.6696      0.5032      
## year2023_team_SEA                                                -2.6978      0.0070   ***
## year2023_team_SF                                                 -0.2808      0.7789      
## year2023_team_WAS                                                 1.0207      0.3074      
## year2023_team_ATL                                                -0.6647      0.5063      
## year2023_team_BUF                                                -0.6050      0.5452      
## year2023_team_CAR                                                 0.3475      0.7282      
## year2023_team_DAL                                                 0.4414      0.6589      
## year2023_team_DEN                                                -0.0983      0.9217      
## year2023_team_HOU                                                -0.2172      0.8281      
## year2023_team_LA                                                 -0.2749      0.7834      
## year2023_team_NE                                                 -0.2814      0.7784      
## year2023_team_PHI                                                -0.6616      0.5083      
## year2023_team_PIT                                                -0.1972      0.8437      
## year2023_team_TEN                                                -0.1729      0.8628      
## year2023_team_ARI                                                -1.3475      0.1779      
## year2023_team_CIN                                                -1.2640      0.2063      
## year2023_team_DET                                                 0.0590      0.9530      
## year2023_team_TB                                                  0.4974      0.6190      
## year2023_team_JAX                                                -1.1065      0.2686      
## year2023_team_NYJ                                                 1.4633      0.1435     .
## is_first_half                                                    -1.3328      0.1827      
## time_in_half                                                      1.4282      0.1533      
## home_attendance                                                  -0.3558      0.7220</code></pre>
<pre class="r"><code>cat(&quot;\nSignificance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15&quot;)</code></pre>
<pre><code>## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</code></pre>
<pre class="r"><code># the r squard value
r_squared_no_gimr &lt;- summary(ols_model_no_gimr)$adj.r.squared
r_squared_no_gimr</code></pre>
<pre><code>## [1] 0.1121128</code></pre>
<pre class="r"><code># Load the car package which has the vif function
library(car)

# Calculate VIFs for the model with GIMR
vifs &lt;- vif(ols_model)

# Filter to show only VIFs over 5
high_vifs &lt;- vifs[vifs &gt; 5]
if(length(high_vifs) &gt; 0) {
  cat(&quot;\nVariables with VIF &gt; 5 (with GIMR):\n&quot;)
  print(high_vifs)
} else {
  cat(&quot;\nNo variables with VIF &gt; 5 found in the model with GIMR\n&quot;)
}</code></pre>
<pre><code>## 
## Variables with VIF &gt; 5 (with GIMR):
##                                                           prev_shotgun_rate 
##                                                                    9.773183 
##                                                        prev_singleback_rate 
##                                                                    5.676690 
##                                                                 cover1_rate 
##                                                                    6.826372 
##                                                                 cover3_rate 
##                                                                    7.100780 
##                                                   offense_formation_SHOTGUN 
##                                                                    7.383905 
##                      offense_player_9_run_blocking_gap_grades_run_block_12w 
##                                                                    5.725704 
##                     offense_player_10_run_blocking_gap_grades_run_block_12w 
##                                                                    5.475527 
##              defense_player_3_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                    5.142480 
##              defense_player_4_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                    6.263471 
##             defense_player_10_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                    5.315696 
##             defense_player_11_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   14.093114 
##               defense_player_11_coverage_grades_grades_coverage_defense_12w 
##                                                                   13.126081 
##             defense_player_12_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   17.249652 
##               defense_player_12_coverage_grades_grades_coverage_defense_12w 
##                                                                   15.787008 
##                        defense_player_16_coverage_grades_grades_defense_12w 
##                                                                    7.284131 
##               defense_player_16_defensive_grades_grades_defense_penalty_12w 
##                                                                    7.284103 
##                        defense_player_17_coverage_grades_grades_defense_12w 
##                                                                   21.131522 
##               defense_player_17_defensive_grades_grades_defense_penalty_12w 
##                                                                   21.694026 
##         defense_player_21_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                                    9.546476 
##                defense_player_21_coverage_grades_grades_defense_penalty_12w 
##                                                                    9.728464 
##         defense_player_22_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                                   53.959309 
##                defense_player_22_coverage_grades_grades_defense_penalty_12w 
##                                                                   54.198583 
##                      starter_offense_player_1_rushing_grades_grades_run_12w 
##                                                                   10.886800 
##                starter_offense_player_1_passing_depth_short_grades_pass_12w 
##                                                                   20.207875 
##           starter_offense_player_8_receiving_depth_short_caught_percent_12w 
##                                                                    5.998404 
##              starter_offense_player_8_run_blocking_gap_grades_run_block_12w 
##                                                                   49.080659 
##              starter_offense_player_9_run_blocking_gap_grades_run_block_12w 
##                                                                   45.542858 
##             starter_offense_player_10_run_blocking_gap_grades_run_block_12w 
##                                                                   16.182530 
##               starter_offense_player_14_blocking_grades_grades_run_block_2w 
##                                                                    5.526661 
##               starter_offense_player_15_blocking_grades_grades_run_block_2w 
##                                                                    5.343383 
##                starter_offense_player_17_blocking_grades_grades_offense_12w 
##                                                                   15.373045 
##                starter_offense_player_18_blocking_grades_grades_offense_12w 
##                                                                   14.772706 
##                starter_offense_player_19_blocking_grades_grades_offense_12w 
##                                                                   13.146898 
##                starter_offense_player_20_blocking_grades_grades_offense_12w 
##                                                                   13.457089 
##                starter_offense_player_21_blocking_grades_grades_offense_12w 
##                                                                   10.788244 
##      starter_defense_player_1_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   12.510126 
##      starter_defense_player_2_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   14.989596 
##      starter_defense_player_3_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   16.855331 
##      starter_defense_player_4_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   14.844557 
##      starter_defense_player_9_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   19.320340 
##        starter_defense_player_9_coverage_grades_grades_coverage_defense_12w 
##                                                                   12.626425 
##     starter_defense_player_10_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   13.388279 
##       starter_defense_player_10_coverage_grades_grades_coverage_defense_12w 
##                                                                   11.723064 
##       starter_defense_player_11_coverage_grades_grades_coverage_defense_12w 
##                                                                    6.320756 
##                starter_defense_player_15_coverage_grades_grades_defense_12w 
##                                                                   15.421722 
##       starter_defense_player_15_defensive_grades_grades_defense_penalty_12w 
##                                                                   14.520883 
##                starter_defense_player_16_coverage_grades_grades_defense_12w 
##                                                                   10.746582 
##       starter_defense_player_16_defensive_grades_grades_defense_penalty_12w 
##                                                                   10.518862 
##                starter_defense_player_17_coverage_grades_grades_defense_12w 
##                                                                    8.845012 
##       starter_defense_player_17_defensive_grades_grades_defense_penalty_12w 
##                                                                   10.074883 
## starter_defense_player_20_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                                   20.028314 
##        starter_defense_player_20_coverage_grades_grades_defense_penalty_12w 
##                                                                   10.797937 
## starter_defense_player_21_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                                    9.859807 
##        starter_defense_player_21_coverage_grades_grades_defense_penalty_12w 
##                                                                    8.705526 
## starter_defense_player_22_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                                    6.365199 
##        starter_defense_player_22_coverage_grades_grades_defense_penalty_12w 
##                                                                    7.244966 
##                                                             home_attendance 
##                                                                   14.355634</code></pre>
<pre class="r"><code># Calculate VIFs for the model without GIMR
vifs_no_gimr &lt;- vif(ols_model_no_gimr)

# Filter to show only VIFs over 5
high_vifs_no_gimr &lt;- vifs_no_gimr[vifs_no_gimr &gt; 5]
if(length(high_vifs_no_gimr) &gt; 0) {
  cat(&quot;\nVariables with VIF &gt; 5 (without GIMR):\n&quot;)
  print(high_vifs_no_gimr)
} else {
  cat(&quot;\nNo variables with VIF &gt; 5 found in the model without GIMR\n&quot;)
}</code></pre>
<pre><code>## 
## Variables with VIF &gt; 5 (without GIMR):
##                                                           prev_shotgun_rate 
##                                                                    9.758687 
##                                                        prev_singleback_rate 
##                                                                    5.665366 
##                                                                 cover1_rate 
##                                                                    6.825986 
##                                                                 cover3_rate 
##                                                                    7.099862 
##                                                   offense_formation_SHOTGUN 
##                                                                    7.328508 
##                      offense_player_9_run_blocking_gap_grades_run_block_12w 
##                                                                    5.725586 
##                     offense_player_10_run_blocking_gap_grades_run_block_12w 
##                                                                    5.473212 
##              defense_player_3_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                    5.142351 
##              defense_player_4_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                    6.262981 
##             defense_player_10_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                    5.315222 
##             defense_player_11_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   14.092531 
##               defense_player_11_coverage_grades_grades_coverage_defense_12w 
##                                                                   13.122097 
##             defense_player_12_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   17.247987 
##               defense_player_12_coverage_grades_grades_coverage_defense_12w 
##                                                                   15.786514 
##                        defense_player_16_coverage_grades_grades_defense_12w 
##                                                                    7.283847 
##               defense_player_16_defensive_grades_grades_defense_penalty_12w 
##                                                                    7.281259 
##                        defense_player_17_coverage_grades_grades_defense_12w 
##                                                                   21.131521 
##               defense_player_17_defensive_grades_grades_defense_penalty_12w 
##                                                                   21.687872 
##         defense_player_21_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                                    9.546473 
##                defense_player_21_coverage_grades_grades_defense_penalty_12w 
##                                                                    9.726822 
##         defense_player_22_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                                   53.951624 
##                defense_player_22_coverage_grades_grades_defense_penalty_12w 
##                                                                   54.194920 
##                      starter_offense_player_1_rushing_grades_grades_run_12w 
##                                                                   10.886721 
##                starter_offense_player_1_passing_depth_short_grades_pass_12w 
##                                                                   20.206972 
##           starter_offense_player_8_receiving_depth_short_caught_percent_12w 
##                                                                    5.998242 
##              starter_offense_player_8_run_blocking_gap_grades_run_block_12w 
##                                                                   49.075263 
##              starter_offense_player_9_run_blocking_gap_grades_run_block_12w 
##                                                                   45.540850 
##             starter_offense_player_10_run_blocking_gap_grades_run_block_12w 
##                                                                   16.177892 
##               starter_offense_player_14_blocking_grades_grades_run_block_2w 
##                                                                    5.526493 
##               starter_offense_player_15_blocking_grades_grades_run_block_2w 
##                                                                    5.342770 
##                starter_offense_player_17_blocking_grades_grades_offense_12w 
##                                                                   15.373009 
##                starter_offense_player_18_blocking_grades_grades_offense_12w 
##                                                                   14.766008 
##                starter_offense_player_19_blocking_grades_grades_offense_12w 
##                                                                   13.143251 
##                starter_offense_player_20_blocking_grades_grades_offense_12w 
##                                                                   13.456802 
##                starter_offense_player_21_blocking_grades_grades_offense_12w 
##                                                                   10.782352 
##      starter_defense_player_1_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   12.507039 
##      starter_defense_player_2_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   14.987523 
##      starter_defense_player_3_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   16.847575 
##      starter_defense_player_4_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   14.844058 
##      starter_defense_player_9_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   19.317733 
##        starter_defense_player_9_coverage_grades_grades_coverage_defense_12w 
##                                                                   12.625426 
##     starter_defense_player_10_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   13.385052 
##       starter_defense_player_10_coverage_grades_grades_coverage_defense_12w 
##                                                                   11.723019 
##       starter_defense_player_11_coverage_grades_grades_coverage_defense_12w 
##                                                                    6.317531 
##                starter_defense_player_15_coverage_grades_grades_defense_12w 
##                                                                   15.421078 
##       starter_defense_player_15_defensive_grades_grades_defense_penalty_12w 
##                                                                   14.520812 
##                starter_defense_player_16_coverage_grades_grades_defense_12w 
##                                                                   10.744912 
##       starter_defense_player_16_defensive_grades_grades_defense_penalty_12w 
##                                                                   10.518819 
##                starter_defense_player_17_coverage_grades_grades_defense_12w 
##                                                                    8.844802 
##       starter_defense_player_17_defensive_grades_grades_defense_penalty_12w 
##                                                                   10.073147 
## starter_defense_player_20_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                                   20.028307 
##        starter_defense_player_20_coverage_grades_grades_defense_penalty_12w 
##                                                                   10.794083 
## starter_defense_player_21_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                                    9.855998 
##        starter_defense_player_21_coverage_grades_grades_defense_penalty_12w 
##                                                                    8.704364 
## starter_defense_player_22_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                                    6.363141 
##        starter_defense_player_22_coverage_grades_grades_defense_penalty_12w 
##                                                                    7.241014 
##                                                             home_attendance 
##                                                                   14.329490</code></pre>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIkhlY2ttYW4gU2VsZWN0aW9uIE1vZGVsIEFuYWx5c2lzIg0Kb3V0cHV0OiBodG1sX2RvY3VtZW50DQotLS0NCg0KYGBge3Igb3B0aW9ucywgaW5jbHVkZT1GQUxTRX0NCm9wdGlvbnMobWF4LnByaW50PTEwMDAwKQ0KYGBgDQoNCmBgYHtyfQ0KbGlicmFyeShkYXRhLnRhYmxlKQ0Kb3V0Y29tZV9kYXRhIDwtIGZyZWFkKCJwcmVkaWN0X291dGNvbWUuY3N2Lmd6IikNCnNlbGVjdF9kYXRhIDwtIGZyZWFkKCJwcmVkaWN0X3NlbGVjdC5jc3YuZ3oiKQ0KYGBgDQoNCmBgYHtyfQ0Kc2VsZWN0X2RhdGFbLCBhdHRlbXB0IDo9IGFzLm51bWVyaWMoYXMuY2hhcmFjdGVyKGF0dGVtcHQpKV0NCmBgYA0KDQoNCmBgYHtyfQ0KIyBDb21tZW50ZWQgb3V0IG9yaWdpbmFsIHZlcnNpb24NCiMgIyBMb2FkIHJlcXVpcmVkIGxpYnJhcmllcw0KIyBsaWJyYXJ5KGRhdGEudGFibGUpDQojIGxpYnJhcnkoeGdib29zdCkNCiMgbGlicmFyeShST0NSKQ0KIyBsaWJyYXJ5KHBhcmFsbGVsKQ0KIyANCiMgIyBQcmVwYXJlIHRoZSBYR0Jvb3N0IG1hdHJpY2VzDQojIHhzIDwtIG1vZGVsLm1hdHJpeCh+IC4gLSAxIC0gYXR0ZW1wdCAtIG15X2lkLCBkYXRhID0gc2VsZWN0X2RhdGEpDQojIHkgPC0gYXMubnVtZXJpYyhhcy5jaGFyYWN0ZXIoc2VsZWN0X2RhdGEkYXR0ZW1wdCkpDQojIA0KIyAjIENyZWF0ZSBwYXJhbWV0ZXIgZ3JpZA0KIyBncmlkIDwtIGV4cGFuZC5ncmlkKA0KIyAgIGV0YSA9IHNlcSgwLjAwMSwgMC4xLCBieSA9IDAuMDIpLA0KIyAgIG1heF9kZXB0aCA9IHNlcSg1LCA3LCBieSA9IDIpLA0KIyAgIG1pbl9jaGlsZF93ZWlnaHQgPSBzZXEoMSwgMSwgYnkgPSAxKSwgICAgICAgIA0KIyAgIHN1YnNhbXBsZSA9IHNlcSgwLjgsIDAuOCwgYnkgPSAwLjIpLA0KIyAgIGNvbHNhbXBsZV9ieXRyZWUgPSBzZXEoMC44LCAwLjgsIGJ5ID0gMC4yKSwNCiMgICBsYW1iZGEgPSBzZXEoMSwgMSwgYnkgPSAxKSwgICAgICAgICAgICAgICAgDQojICAgYWxwaGEgPSBzZXEoMCwgMCwgYnkgPSAxKSwgICAgICAgICAgICAgICAgICANCiMgICBnYW1tYSA9IHNlcSgwLCAwLCBieSA9IDAuMSksICAgICAgICAgICAgICAgDQojICAgbnJvdW5kcyA9IHNlcSgxMDAsIDUwMCwgYnkgPSA1MDApDQojICkNCiMgDQojICMgU2FtcGxlIGdyaWQgcG9pbnRzDQojIGNvbmZfbGV2IDwtIC45NQ0KIyBudW1fbWF4IDwtIDUNCiMgbiA8LSBjZWlsaW5nKGxvZygxLWNvbmZfbGV2KS9sb2coMS1udW1fbWF4L25yb3coZ3JpZCkpKQ0KIyBpbmQgPC0gc2FtcGxlKG5yb3coZ3JpZCksIG4sIHJlcGxhY2UgPSBGQUxTRSkNCiMgcmdyaWQgPC0gZ3JpZFtpbmQsIF0NCiMgDQojICMgU2V0IHVwIHBhcmFsbGVsIHByb2Nlc3NpbmcNCiMgbmMgPC0gZGV0ZWN0Q29yZXMoKSAtIDENCiMgDQojICMgVmFsaWRhdGlvbiBwaGFzZQ0KIyBjYXQoIlxuUGhhc2UgMTogVmFsaWRhdGlvbiBQaGFzZVxuIikNCiMgbl92YWxpZGF0aW9ucyA8LSAyDQojIHZhbGlkYXRpb25fcmVzdWx0cyA8LSBtYXRyaXgobnJvdyA9IG5yb3cocmdyaWQpLCBuY29sID0gbl92YWxpZGF0aW9ucykNCiMgDQojIGZvciAoaiBpbiAxOm5yb3cocmdyaWQpKSB7DQojICAgY2F0KCJcblRlc3RpbmcgcGFyYW1ldGVyIHNldCIsIGosICJvZiIsIG5yb3cocmdyaWQpLCAiXG4iKQ0KIyAgIA0KIyAgIGZvciAoaSBpbiAxOm5fdmFsaWRhdGlvbnMpIHsNCiMgICAgICMgQ3JlYXRlIHZhbGlkYXRpb24gc3BsaXQNCiMgICAgIGlkeCA8LSB1bmlxdWUoc2FtcGxlKG5yb3coeHMpLCBucm93KHhzKSwgVFJVRSkpDQojICAgICB0cmFpbl94IDwtIHhzW2lkeCwgXQ0KIyAgICAgdHJhaW5feSA8LSB5W2lkeF0NCiMgICAgIHZhbF94IDwtIHhzWy1pZHgsIF0NCiMgICAgIHZhbF95IDwtIHlbLWlkeF0NCiMgICAgIA0KIyAgICAgIyBVbmRlcnNhbXBsZSBtYWpvcml0eSBjbGFzcyBpbiB0cmFpbmluZyBkYXRhDQojICAgICB0cmFpbl9pZHhfMCA8LSB3aGljaCh0cmFpbl95ID09IDApDQojICAgICB0cmFpbl9pZHhfMSA8LSB3aGljaCh0cmFpbl95ID09IDEpDQojICAgICANCiMgICAgICMgR2V0IG51bWJlciBvZiBtaW5vcml0eSBjbGFzcyBzYW1wbGVzDQojICAgICBuX21pbm9yaXR5IDwtIGxlbmd0aCh0cmFpbl9pZHhfMSkNCiMgICAgIA0KIyAgICAgIyBSYW5kb21seSBzYW1wbGUgZnJvbSBtYWpvcml0eSBjbGFzcw0KIyAgICAgdHJhaW5faWR4XzBfc2FtcGxlZCA8LSBzYW1wbGUodHJhaW5faWR4XzAsIG5fbWlub3JpdHkpDQojICAgICANCiMgICAgICMgQ29tYmluZSBpbmRpY2VzIGZvciBiYWxhbmNlZCBkYXRhc2V0DQojICAgICBiYWxhbmNlZF9pZHggPC0gYyh0cmFpbl9pZHhfMF9zYW1wbGVkLCB0cmFpbl9pZHhfMSkNCiMgICAgIA0KIyAgICAgIyBDcmVhdGUgYmFsYW5jZWQgdHJhaW5pbmcgZGF0YXNldA0KIyAgICAgdHJhaW5feF9iYWxhbmNlZCA8LSB0cmFpbl94W2JhbGFuY2VkX2lkeCwgXQ0KIyAgICAgdHJhaW5feV9iYWxhbmNlZCA8LSB0cmFpbl95W2JhbGFuY2VkX2lkeF0NCiMgICAgIA0KIyAgICAgcHJtIDwtIGxpc3QoDQojICAgICAgIGJvb3N0ZXIgPSAiZ2J0cmVlIiwNCiMgICAgICAgb2JqZWN0aXZlID0gImJpbmFyeTpsb2dpc3RpYyIsDQojICAgICAgIG1heF9kZXB0aCA9IHJncmlkW2osICJtYXhfZGVwdGgiXSwNCiMgICAgICAgZXRhID0gcmdyaWRbaiwgImV0YSJdLA0KIyAgICAgICBzdWJzYW1wbGUgPSByZ3JpZFtqLCAic3Vic2FtcGxlIl0sDQojICAgICAgIGNvbHNhbXBsZV9ieXRyZWUgPSByZ3JpZFtqLCAiY29sc2FtcGxlX2J5dHJlZSJdLA0KIyAgICAgICBnYW1tYSA9IHJncmlkW2osICJnYW1tYSJdLA0KIyAgICAgICBtaW5fY2hpbGRfd2VpZ2h0ID0gcmdyaWRbaiwgIm1pbl9jaGlsZF93ZWlnaHQiXSwNCiMgICAgICAgYWxwaGEgPSByZ3JpZFtqLCAiYWxwaGEiXSwNCiMgICAgICAgbGFtYmRhID0gcmdyaWRbaiwgImxhbWJkYSJdLA0KIyAgICAgICBudGhyZWFkID0gbmMNCiMgICAgICkNCiMgICAgIA0KIyAgICAgZG1fdHJhaW4gPC0geGdiLkRNYXRyaXgoZGF0YSA9IHRyYWluX3hfYmFsYW5jZWQsIGxhYmVsID0gdHJhaW5feV9iYWxhbmNlZCkNCiMgICAgIG1kbCA8LSB4Z2IudHJhaW4oDQojICAgICAgIHBhcmFtcyA9IHBybSwNCiMgICAgICAgZGF0YSA9IGRtX3RyYWluLA0KIyAgICAgICBucm91bmRzID0gcmdyaWRbaiwgIm5yb3VuZHMiXSwNCiMgICAgICAgdmVyYm9zZSA9IEZBTFNFDQojICAgICApDQojICAgICANCiMgICAgIHAgPC0gcHJlZGljdChtZGwsIHhnYi5ETWF0cml4KGRhdGEgPSB2YWxfeCkpDQojICAgICBwcmVkIDwtIHByZWRpY3Rpb24ocCwgdmFsX3kpDQojICAgICB2YWxpZGF0aW9uX3Jlc3VsdHNbaiwgaV0gPC0gcGVyZm9ybWFuY2UocHJlZCwgImF1YyIpQHkudmFsdWVzW1sxXV0NCiMgICB9DQojIH0NCiMgDQojICMgUnVuIDEwMCB0ZXN0cyB3aXRoIGJlc3QgcGFyYW1ldGVycw0KIyBjYXQoIlxuUnVubmluZyBYIHRlc3QgaXRlcmF0aW9ucyB3aXRoIGJlc3QgcGFyYW1ldGVycy4uLlxuIikNCiMgdGVzdF9hdWNzIDwtIGMoKQ0KIyANCiMgYmVzdF9wYXJhbXNfaWR4IDwtIHdoaWNoLm1heChyb3dNZWFucyh2YWxpZGF0aW9uX3Jlc3VsdHMpKQ0KIyBiZXN0X3BhcmFtcyA8LSByZ3JpZFtiZXN0X3BhcmFtc19pZHgsXQ0KIyANCiMgIyBUcmFpbiBmaW5hbCBtb2RlbCB3aXRoIGJlc3QgcGFyYW1ldGVycw0KIyBiZXN0X3BhcmFtc19saXN0IDwtIGFzLmxpc3QoYmVzdF9wYXJhbXNbLXdoaWNoKG5hbWVzKGJlc3RfcGFyYW1zKSA9PSAibnJvdW5kcyIpXSkNCiMgYmVzdF9wYXJhbXNfbGlzdCRib29zdGVyIDwtICJnYnRyZWUiDQojIGJlc3RfcGFyYW1zX2xpc3Qkb2JqZWN0aXZlIDwtICJiaW5hcnk6bG9naXN0aWMiDQojIGJlc3RfcGFyYW1zX2xpc3QkbnRocmVhZCA8LSBuYw0KIyANCiMgZm9yKGkgaW4gMToxMDApIHsNCiMgICAjIENyZWF0ZSB0ZXN0IHNwbGl0DQojICAgaWR4IDwtIHVuaXF1ZShzYW1wbGUobnJvdyh4cyksIG5yb3coeHMpLCBUKSkNCiMgICB0cmFpbl94IDwtIHhzW2lkeCwgXQ0KIyAgIHRyYWluX3kgPC0geVtpZHhdDQojICAgdGVzdF94IDwtIHhzWy1pZHgsIF0NCiMgICB0ZXN0X3kgPC0geVstaWR4XQ0KIyAgIA0KIyAgICMgVW5kZXJzYW1wbGUgdHJhaW5pbmcgZGF0YQ0KIyAgIHRyYWluX2lkeF8wIDwtIHdoaWNoKHRyYWluX3kgPT0gMCkNCiMgICB0cmFpbl9pZHhfMSA8LSB3aGljaCh0cmFpbl95ID09IDEpDQojICAgbl9taW5vcml0eSA8LSBsZW5ndGgodHJhaW5faWR4XzEpDQojICAgdHJhaW5faWR4XzBfc2FtcGxlZCA8LSBzYW1wbGUodHJhaW5faWR4XzAsIG5fbWlub3JpdHkpDQojICAgYmFsYW5jZWRfaWR4IDwtIGModHJhaW5faWR4XzBfc2FtcGxlZCwgdHJhaW5faWR4XzEpDQojICAgDQojICAgIyBDcmVhdGUgYmFsYW5jZWQgdHJhaW5pbmcgZGF0YXNldA0KIyAgIHRyYWluX3hfYmFsYW5jZWQgPC0gdHJhaW5feFtiYWxhbmNlZF9pZHgsIF0NCiMgICB0cmFpbl95X2JhbGFuY2VkIDwtIHRyYWluX3lbYmFsYW5jZWRfaWR4XQ0KIyAgIA0KIyAgICMgVHJhaW4gbW9kZWwNCiMgICBkbV90cmFpbiA8LSB4Z2IuRE1hdHJpeChkYXRhID0gdHJhaW5feF9iYWxhbmNlZCwgbGFiZWwgPSB0cmFpbl95X2JhbGFuY2VkKQ0KIyAgIG1kbCA8LSB4Z2IudHJhaW4oDQojICAgICBwYXJhbXMgPSBiZXN0X3BhcmFtc19saXN0LA0KIyAgICAgZGF0YSA9IGRtX3RyYWluLA0KIyAgICAgbnJvdW5kcyA9IGJlc3RfcGFyYW1zW1sibnJvdW5kcyJdXSwNCiMgICAgIHZlcmJvc2UgPSBGQUxTRQ0KIyAgICkNCiMgICANCiMgICAjIFRlc3Qgb24gdW5iYWxhbmNlZCB0ZXN0IHNldA0KIyAgIHAgPC0gcHJlZGljdChtZGwsIHhnYi5ETWF0cml4KGRhdGEgPSB0ZXN0X3gpKQ0KIyAgIHByZWQgPC0gcHJlZGljdGlvbihwLCB0ZXN0X3kpDQojICAgdGVzdF9hdWNzW2ldIDwtIHBlcmZvcm1hbmNlKHByZWQsICJhdWMiKUB5LnZhbHVlc1tbMV1dDQojIH0NCiMgDQojICMgUHJpbnQgcmVzdWx0cw0KIyBjYXQoIlxuVGVzdCBSZXN1bHRzIG92ZXIgMTAwIGl0ZXJhdGlvbnM6XG4iKQ0KIyBjYXQoIk1lYW4gQVVDOiIsIG1lYW4odGVzdF9hdWNzKSwgIlxuIikNCiMgY2F0KCJTRCBBVUM6Iiwgc2QodGVzdF9hdWNzKSwgIlxuIikNCiMgY2F0KCI5NSUgQ0k6IiwgbWVhbih0ZXN0X2F1Y3MpIC0gMS45NiAqIHNkKHRlc3RfYXVjcyksIA0KIyAgICAgInRvIiwgbWVhbih0ZXN0X2F1Y3MpICsgMS45NiAqIHNkKHRlc3RfYXVjcyksICJcbiIpDQojIA0KIyAjIFBsb3R0aW5nIEFVQyBkaXN0cmlidXRpb24NCiMgcGxvdCh0ZXN0X2F1Y3MsIGNvbD0icmVkIiwgcGNoPTIwLA0KIyAgICAgIG1haW49IkFVQyBUZXN0IERpc3RyaWJ1dGlvbiIsDQojICAgICAgeGxhYj0iSXRlcmF0aW9uIiwgeWxhYj0iQVVDIikNCiMgYWJsaW5lKGg9bWVhbih0ZXN0X2F1Y3MpLCBjb2w9ImJsdWUiLCBsd2Q9MiwgbHR5PTIpDQojIGFibGluZShoPW1lYW4odGVzdF9hdWNzKSAtIDEuOTYgKiBzZCh0ZXN0X2F1Y3MpLCBjb2w9ImdyZWVuIiwgbHdkPTIsIGx0eT0zKQ0KIyBhYmxpbmUoaD1tZWFuKHRlc3RfYXVjcykgKyAxLjk2ICogc2QodGVzdF9hdWNzKSwgY29sPSJncmVlbiIsIGx3ZD0yLCBsdHk9MykNCiMgbGVnZW5kKCJib3R0b21yaWdodCIsIA0KIyAgICAgICAgbGVnZW5kPWMoIkFVQyBWYWx1ZXMiLCAiTWVhbiIsICI5NSUgQ0kgQm91bmRzIiksDQojICAgICAgICBjb2w9YygicmVkIiwgImJsdWUiLCAiZ3JlZW4iKSwNCiMgICAgICAgIGx0eT1jKE5BLCAyLCAzKSwNCiMgICAgICAgIHBjaD1jKDIwLCBOQSwgTkEpKQ0KIyANCiMgIyBOb3cgdHJhaW4gZmluYWwgbW9kZWwgb24gZnVsbCBkYXRhIGZvciB6IHNjb3Jlcw0KIyBmaW5hbF9pZHhfMCA8LSB3aGljaCh5ID09IDApDQojIGZpbmFsX2lkeF8xIDwtIHdoaWNoKHkgPT0gMSkNCiMgbl9taW5vcml0eV9maW5hbCA8LSBsZW5ndGgoZmluYWxfaWR4XzEpDQojIGZpbmFsX2lkeF8wX3NhbXBsZWQgPC0gc2FtcGxlKGZpbmFsX2lkeF8wLCBuX21pbm9yaXR5X2ZpbmFsKQ0KIyBmaW5hbF9iYWxhbmNlZF9pZHggPC0gYyhmaW5hbF9pZHhfMF9zYW1wbGVkLCBmaW5hbF9pZHhfMSkNCiMgDQojICMgQ3JlYXRlIGJhbGFuY2VkIGZpbmFsIGRhdGFzZXQNCiMgeHNfYmFsYW5jZWQgPC0geHNbZmluYWxfYmFsYW5jZWRfaWR4LCBdDQojIHlfYmFsYW5jZWQgPC0geVtmaW5hbF9iYWxhbmNlZF9pZHhdDQojIA0KIyBkbV9mdWxsIDwtIHhnYi5ETWF0cml4KGRhdGEgPSB4c19iYWxhbmNlZCwgbGFiZWwgPSB5X2JhbGFuY2VkKQ0KIyBmaW5hbF9tb2RlbCA8LSB4Z2IudHJhaW4oDQojICAgcGFyYW1zID0gYmVzdF9wYXJhbXNfbGlzdCwNCiMgICBkYXRhID0gZG1fZnVsbCwNCiMgICBucm91bmRzID0gYmVzdF9wYXJhbXNbWyJucm91bmRzIl1dLA0KIyAgIHZlcmJvc2UgPSBGQUxTRQ0KIyApDQojIA0KIyAjIEdldCBwcm9iYWJpbGl0eSBwcmVkaWN0aW9ucyAoeikgZm9yIEFMTCBkYXRhDQojIHogPC0gcHJlZGljdChmaW5hbF9tb2RlbCwgeGdiLkRNYXRyaXgoZGF0YSA9IHhzKSkNCmBgYA0KDQpgYGB7cn0NCmxpYnJhcnkoZGF0YS50YWJsZSkNCmxpYnJhcnkoeGdib29zdCkNCmxpYnJhcnkoUk9DUikNCmxpYnJhcnkocGFyYWxsZWwpDQoNCiMgUHJlcGFyZSB0aGUgWEdCb29zdCBtYXRyaWNlcw0KeHMgPC0gbW9kZWwubWF0cml4KH4gLiAtIDEgLSBhdHRlbXB0IC0gbXlfaWQsIGRhdGEgPSBzZWxlY3RfZGF0YSkNCnkgPC0gYXMubnVtZXJpYyhhcy5jaGFyYWN0ZXIoc2VsZWN0X2RhdGEkYXR0ZW1wdCkpDQoNCg0KIyBDcmVhdGUgcGFyYW1ldGVyIGdyaWQNCmdyaWQgPC0gZXhwYW5kLmdyaWQoDQogIGV0YSA9IHNlcSgwLjAwMSwgMC4wMywgYnkgPSAwLjAxKSwNCiAgbWF4X2RlcHRoID0gc2VxKDUsIDUsIGJ5ID0gMiksDQogIG1pbl9jaGlsZF93ZWlnaHQgPSBzZXEoMSwgMSwgYnkgPSAxKSwgICAgICAgIA0KICBzdWJzYW1wbGUgPSBzZXEoMSwgMSwgYnkgPSAwLjIpLA0KICBjb2xzYW1wbGVfYnl0cmVlID0gc2VxKDEsIDEsIGJ5ID0gMC4yKSwNCiAgbGFtYmRhID0gc2VxKDEsIDEsIGJ5ID0gMSksICAgICAgICAgICAgICAgIA0KICBhbHBoYSA9IHNlcSgwLCAwLCBieSA9IDEpLCAgICAgICAgICAgICAgICAgIA0KICBnYW1tYSA9IHNlcSgwLCAwLCBieSA9IDAuMSksICAgICAgICAgICAgICAgDQogIG5yb3VuZHMgPSBzZXEoMTAwLCAyNTAsIGJ5ID0gNTApDQopDQoNCg0KIyBTYW1wbGUgZ3JpZCBwb2ludHMNCmNvbmZfbGV2IDwtIC45NQ0KbnVtX21heCA8LSA1DQpuIDwtIGNlaWxpbmcobG9nKDEtY29uZl9sZXYpL2xvZygxLW51bV9tYXgvbnJvdyhncmlkKSkpDQppbmQgPC0gc2FtcGxlKG5yb3coZ3JpZCksIG4sIHJlcGxhY2UgPSBGQUxTRSkNCnJncmlkIDwtIGdyaWRbaW5kLCBdDQoNCiMgU2V0IHVwIHBhcmFsbGVsIHByb2Nlc3NpbmcNCm5jIDwtIGRldGVjdENvcmVzKCkgLSAxDQoNCiMgQ2FsY3VsYXRlIHNjYWxlX3Bvc193ZWlnaHQgZm9yIGltYmFsYW5jZWQgZGF0YXNldA0Kc2NhbGVfcG9zX3dlaWdodCA8LSBzdW0oeSA9PSAwKSAvIHN1bSh5ID09IDEpDQoNCiMgVmFsaWRhdGlvbiBwaGFzZQ0KI2NhdCgiXG5QaGFzZSAxOiBWYWxpZGF0aW9uIFBoYXNlXG4iKQ0Kbl92YWxpZGF0aW9ucyA8LSA1DQp2YWxpZGF0aW9uX3Jlc3VsdHMgPC0gbWF0cml4KG5yb3cgPSBucm93KHJncmlkKSwgbmNvbCA9IG5fdmFsaWRhdGlvbnMpDQoNCmZvciAoaiBpbiAxOm5yb3cocmdyaWQpKSB7DQogICNjYXQoIlxuVGVzdGluZyBwYXJhbWV0ZXIgc2V0IiwgaiwgIm9mIiwgbnJvdyhyZ3JpZCksICJcbiIpDQogIA0KICBmb3IgKGkgaW4gMTpuX3ZhbGlkYXRpb25zKSB7DQogICAgI2NhdCgiXG5WYWxpZGF0aW9uIGl0ZXJhdGlvbiIsIGksICJvZiIsIG5fdmFsaWRhdGlvbnMsICJcbiIpICAgICAgICAgICAgIA0KICAgICMgQ3JlYXRlIHZhbGlkYXRpb24gc3BsaXQNCiAgICBpZHggPC0gdW5pcXVlKHNhbXBsZShucm93KHhzKSwgbnJvdyh4cyksIFRSVUUpKQ0KICAgIHRyYWluX3ggPC0geHNbaWR4LCBdDQogICAgdHJhaW5feSA8LSB5W2lkeF0NCiAgICB2YWxfeCA8LSB4c1staWR4LCBdDQogICAgdmFsX3kgPC0geVstaWR4XQ0KICAgIA0KICAgIHBybSA8LSBsaXN0KA0KICAgICAgYm9vc3RlciA9ICJnYnRyZWUiLA0KICAgICAgb2JqZWN0aXZlID0gImJpbmFyeTpsb2dpc3RpYyIsDQogICAgICBtYXhfZGVwdGggPSByZ3JpZFtqLCAibWF4X2RlcHRoIl0sDQogICAgICBldGEgPSByZ3JpZFtqLCAiZXRhIl0sDQogICAgICBzdWJzYW1wbGUgPSByZ3JpZFtqLCAic3Vic2FtcGxlIl0sDQogICAgICBjb2xzYW1wbGVfYnl0cmVlID0gcmdyaWRbaiwgImNvbHNhbXBsZV9ieXRyZWUiXSwNCiAgICAgIGdhbW1hID0gcmdyaWRbaiwgImdhbW1hIl0sDQogICAgICBtaW5fY2hpbGRfd2VpZ2h0ID0gcmdyaWRbaiwgIm1pbl9jaGlsZF93ZWlnaHQiXSwNCiAgICAgIGFscGhhID0gcmdyaWRbaiwgImFscGhhIl0sDQogICAgICBsYW1iZGEgPSByZ3JpZFtqLCAibGFtYmRhIl0sDQogICAgICBzY2FsZV9wb3Nfd2VpZ2h0ID0gc2NhbGVfcG9zX3dlaWdodCwNCiAgICAgIG50aHJlYWQgPSBuYw0KICAgICkNCiAgICANCiAgICBkbV90cmFpbiA8LSB4Z2IuRE1hdHJpeChkYXRhID0gdHJhaW5feCwgbGFiZWwgPSB0cmFpbl95KQ0KICAgIG1kbCA8LSB4Z2IudHJhaW4oDQogICAgICBwYXJhbXMgPSBwcm0sDQogICAgICBkYXRhID0gZG1fdHJhaW4sDQogICAgICBucm91bmRzID0gcmdyaWRbaiwgIm5yb3VuZHMiXSwNCiAgICAgIHZlcmJvc2UgPSBGQUxTRQ0KICAgICkNCiAgICANCiAgICBwIDwtIHByZWRpY3QobWRsLCB4Z2IuRE1hdHJpeChkYXRhID0gdmFsX3gpKQ0KICAgIHByZWQgPC0gcHJlZGljdGlvbihwLCB2YWxfeSkNCiAgICB2YWxpZGF0aW9uX3Jlc3VsdHNbaiwgaV0gPC0gcGVyZm9ybWFuY2UocHJlZCwgImF1YyIpQHkudmFsdWVzW1sxXV0NCiAgfQ0KfQ0KDQojIFJ1biAxMDAgdGVzdHMgd2l0aCBiZXN0IHBhcmFtZXRlcnMNCmNhdCgiXG5SdW5uaW5nIFggdGVzdCBpdGVyYXRpb25zIHdpdGggYmVzdCBwYXJhbWV0ZXJzLi4uXG4iKQ0KdGVzdF9hdWNzIDwtIGMoKQ0KDQpiZXN0X3BhcmFtc19pZHggPC0gd2hpY2gubWF4KHJvd01lYW5zKHZhbGlkYXRpb25fcmVzdWx0cykpDQpiZXN0X3BhcmFtcyA8LSByZ3JpZFtiZXN0X3BhcmFtc19pZHgsXQ0KDQojIFRyYWluIGZpbmFsIG1vZGVsIHdpdGggYmVzdCBwYXJhbWV0ZXJzDQpiZXN0X3BhcmFtc19saXN0IDwtIGFzLmxpc3QoYmVzdF9wYXJhbXNbLXdoaWNoKG5hbWVzKGJlc3RfcGFyYW1zKSA9PSAibnJvdW5kcyIpXSkNCmJlc3RfcGFyYW1zX2xpc3QkYm9vc3RlciA8LSAiZ2J0cmVlIg0KYmVzdF9wYXJhbXNfbGlzdCRvYmplY3RpdmUgPC0gImJpbmFyeTpsb2dpc3RpYyINCmJlc3RfcGFyYW1zX2xpc3Qkc2NhbGVfcG9zX3dlaWdodCA8LSBzY2FsZV9wb3Nfd2VpZ2h0DQpiZXN0X3BhcmFtc19saXN0JG50aHJlYWQgPC0gbmMNCg0KZm9yKGkgaW4gMToyMCkgew0KICAjIENyZWF0ZSB0ZXN0IHNwbGl0DQogIGlkeCA8LSB1bmlxdWUoc2FtcGxlKG5yb3coeHMpLCBucm93KHhzKSwgVCkpDQogIHRyYWluX3ggPC0geHNbaWR4LCBdDQogIHRyYWluX3kgPC0geVtpZHhdDQogIHRlc3RfeCA8LSB4c1staWR4LCBdDQogIHRlc3RfeSA8LSB5Wy1pZHhdDQogIA0KICAjIFRyYWluIG1vZGVsIG9uIGZ1bGwgdW5iYWxhbmNlZCBkYXRhc2V0DQogIGRtX3RyYWluIDwtIHhnYi5ETWF0cml4KGRhdGEgPSB0cmFpbl94LCBsYWJlbCA9IHRyYWluX3kpDQogIG1kbCA8LSB4Z2IudHJhaW4oDQogICAgcGFyYW1zID0gYmVzdF9wYXJhbXNfbGlzdCwNCiAgICBkYXRhID0gZG1fdHJhaW4sDQogICAgbnJvdW5kcyA9IGJlc3RfcGFyYW1zW1sibnJvdW5kcyJdXSwNCiAgICB2ZXJib3NlID0gRkFMU0UNCiAgKQ0KICANCiAgIyBUZXN0IG9uIHVuYmFsYW5jZWQgdGVzdCBzZXQNCiAgcCA8LSBwcmVkaWN0KG1kbCwgeGdiLkRNYXRyaXgoZGF0YSA9IHRlc3RfeCkpDQogIHByZWQgPC0gcHJlZGljdGlvbihwLCB0ZXN0X3kpDQogIHRlc3RfYXVjc1tpXSA8LSBwZXJmb3JtYW5jZShwcmVkLCAiYXVjIilAeS52YWx1ZXNbWzFdXQ0KfQ0KIyBQcmludCByZXN1bHRzDQpjYXQoIlxuVGVzdCBSZXN1bHRzIG92ZXIgMTAwIGl0ZXJhdGlvbnM6XG4iKQ0KY2F0KCJNZWFuIEFVQzoiLCBtZWFuKHRlc3RfYXVjcyksICJcbiIpDQpjYXQoIlNEIEFVQzoiLCBzZCh0ZXN0X2F1Y3MpLCAiXG4iKQ0KY2F0KCI5NSUgQ0k6IiwgbWVhbih0ZXN0X2F1Y3MpIC0gMS45NiAqIHNkKHRlc3RfYXVjcyksIA0KICAgICJ0byIsIG1lYW4odGVzdF9hdWNzKSArIDEuOTYgKiBzZCh0ZXN0X2F1Y3MpLCAiXG4iKQ0KDQojIFBsb3R0aW5nIEFVQyBkaXN0cmlidXRpb24NCnBsb3QodGVzdF9hdWNzLCBjb2w9InJlZCIsIHBjaD0yMCwNCiAgICAgbWFpbj0iQVVDIFRlc3QgRGlzdHJpYnV0aW9uIiwNCiAgICAgeGxhYj0iSXRlcmF0aW9uIiwgeWxhYj0iQVVDIikNCmFibGluZShoPW1lYW4odGVzdF9hdWNzKSwgY29sPSJibHVlIiwgbHdkPTIsIGx0eT0yKSAgIyBBZGQgdGhpcyBsaW5lIHRvIHNob3cgbWVhbg0KYWJsaW5lKGg9bWVhbih0ZXN0X2F1Y3MpIC0gMS45NiAqIHNkKHRlc3RfYXVjcyksIGNvbD0iZ3JlZW4iLCBsd2Q9MiwgbHR5PTMpDQphYmxpbmUoaD1tZWFuKHRlc3RfYXVjcykgKyAxLjk2ICogc2QodGVzdF9hdWNzKSwgY29sPSJncmVlbiIsIGx3ZD0yLCBsdHk9MykNCmxlZ2VuZCgiYm90dG9tcmlnaHQiLCANCiAgICAgICBsZWdlbmQ9YygiQVVDIFZhbHVlcyIsICJNZWFuIiwgIjk1JSBDSSBCb3VuZHMiKSwNCiAgICAgICBjb2w9YygicmVkIiwgImJsdWUiLCAiZ3JlZW4iKSwNCiAgICAgICBsdHk9YyhOQSwgMiwgMyksDQogICAgICAgcGNoPWMoMjAsIE5BLCBOQSkpDQoNCiMgTm93IHRyYWluIGZpbmFsIG1vZGVsIG9uIGZ1bGwgZGF0YSBmb3IgeiBzY29yZXMNCmRtX2Z1bGwgPC0geGdiLkRNYXRyaXgoZGF0YSA9IHhzLCBsYWJlbCA9IHkpDQpmaW5hbF9tb2RlbCA8LSB4Z2IudHJhaW4oDQogIHBhcmFtcyA9IGJlc3RfcGFyYW1zX2xpc3QsDQogIGRhdGEgPSBkbV9mdWxsLA0KICBucm91bmRzID0gYmVzdF9wYXJhbXNbWyJucm91bmRzIl1dLA0KICB2ZXJib3NlID0gRkFMU0UNCikNCg0KIyBHZXQgcHJvYmFiaWxpdHkgcHJlZGljdGlvbnMgKHopIGZvciBBTEwgZGF0YQ0KeiA8LSBwcmVkaWN0KGZpbmFsX21vZGVsLCB4Z2IuRE1hdHJpeChkYXRhID0geHMpKQ0KYGBgDQoNCg0KYGBge3J9DQojIENhbGN1bGF0ZSByZXNpZHVhbHMgZm9yIFhHQm9vc3QgcHJlZGljdGlvbnMNCnkgPC0gYXMubnVtZXJpYyhhcy5jaGFyYWN0ZXIoc2VsZWN0X2RhdGEkYXR0ZW1wdCkpDQpyZXNpZHVhbHMgPC0geSAtIHoNCg0KIyBIaXN0b2dyYW0gb2YgcmVzaWR1YWxzDQpoaXN0KHJlc2lkdWFscywgbWFpbj0iRGlzdHJpYnV0aW9uIG9mIFhHQm9vc3QgTW9kZWwgUmVzaWR1YWxzIiwgeGxhYj0iUmVzaWR1YWwiLCBicmVha3M9MTAwKQ0KYGBgDQoNCmBgYHtyfQ0KIyBwbG90IG91dCB0aGUgeiB2YWx1ZXNcDQpwbG90KGRlbnNpdHkoeiksIA0KICAgICBtYWluID0gIkRlbnNpdHkgb2YgWiBQcmVkaWN0aW9ucyIsDQogICAgIHhsYWIgPSAiUHJlZGljdGVkIFByb2JhYmlsaXR5IG9mIEF0dGVtcHQiLA0KICAgICB5bGFiID0gIkRlbnNpdHkiKQ0KYGBgDQoNCmBgYHtyfQ0KIyBDYWxjdWxhdGUgR0lNUiAobGFtYmRhKSBUaGlzIGlzIEdlbmVyYWxpemVkIGludmVyc2UgbWlsbHMgcmF0aW8NCkdJTVIgPC0gZG5vcm0ocW5vcm0oeikpIC8gKDEgLSBwbm9ybShxbm9ybSh6KSkpDQoNCiMgQWRkIEdJTVIgdG8gdGhlIGRhdGENCnNlbGVjdF9kYXRhWywgR0lNUiA6PSBHSU1SXQ0KDQojIFByaW50IHZhcmlhYmxlIGltcG9ydGENCmBgYA0KDQpgYGB7cn0NCiMgQ3JlYXRlIGEgZGF0YS50YWJsZSB3aXRoIGp1c3QgbXlfaWQgYW5kIEdJTVIgZnJvbSBzZWxlY3RfZGF0YQ0KR0lNUl9kdCA8LSBkYXRhLnRhYmxlKG15X2lkID0gc2VsZWN0X2RhdGEkbXlfaWQsIEdJTVIgPSBHSU1SKQ0KDQojIEFkZCBHSU1SIHRvIG91dGNvbWVfZGF0YSBieSBtYXRjaGluZyBvbiBteV9pZA0Kb3V0Y29tZV9kYXRhW0dJTVJfZHQsIEdJTVIgOj0gaS5HSU1SLCBvbiA9ICJteV9pZCJdDQpgYGANCg0KYGBge3J9DQojIEV4aXN0aW5nIGNvZGUNCm91dGNvbWVfZGF0YSA8LSBvdXRjb21lX2RhdGFbLCBteV9pZCA6PSBOVUxMXQ0Kb3V0Y29tZV9kYXRhWywgeWFyZGxpbmVfMzFfNDAgOj0gTlVMTF0NCm91dGNvbWVfZGF0YVssIHllYXIyMDIyX3RlYW1fQ0xFIDo9IE5VTExdICMgdGllZCBmb3IgbW9zdCBhdHRlbXB0cyB3aXRoIDMxDQoNCiMgUmVtb3ZlIGFsbCBjb2x1bW5zIHdpdGggIl9wcmVzZW50IiBpbiB0aGUgbmFtZQ0KcHJlc2VudF9jb2xzIDwtIGdyZXAoIl9wcmVzZW50IiwgbmFtZXMob3V0Y29tZV9kYXRhKSwgdmFsdWUgPSBUUlVFKQ0KZm9yIChjb2wgaW4gcHJlc2VudF9jb2xzKSB7DQogIG91dGNvbWVfZGF0YVssIChjb2wpIDo9IE5VTExdDQp9DQojYXR0ZW5kYW5jZV9wY3QgYW5kIHRvdGFsDQpvdXRjb21lX2RhdGFbLCBhdHRlbmRhbmNlX3BjdCA6PSBOVUxMXQ0Kb3V0Y29tZV9kYXRhWywgYXR0ZW5kYW5jZV9yYXcgOj0gTlVMTF0NCiNhbmQgdG9pdGFsX2xpbmUNCm91dGNvbWVfZGF0YVssIHZlZ2FzX3dwX3Bvc3RlYW0gOj0gTlVMTF0NCmBgYA0KDQoNCmBgYHtyfQ0Kb3V0Y29tZV9kYXRhWywgY29udmVyc2lvbiA6PSBhcy5udW1lcmljKGFzLmNoYXJhY3Rlcihjb252ZXJzaW9uKSldDQojIFRoZW4gcnVuIE9MUyB3aXRoIEdJTVIgY29ycmVjdGlvbg0Kb2xzX21vZGVsIDwtIGxtKGNvbnZlcnNpb24gfiAgLiwgZGF0YSA9IG91dGNvbWVfZGF0YSkNCmBgYA0KDQpgYGB7cn0NCmxpYnJhcnkoc2FuZHdpY2gpDQpsaWJyYXJ5KGxtdGVzdCkNCg0KIyBHZXQgSEMwLWFkanVzdGVkIHQtdmFsdWVzIGFuZCBwLXZhbHVlcw0Kcm9idXN0X3Rlc3QgPC0gY29lZnRlc3Qob2xzX21vZGVsLCB2Y292ID0gdmNvdkhDKG9sc19tb2RlbCwgdHlwZSA9ICJIQzAiKSkNCnRfc3RhdHMgPC0gcm9idXN0X3Rlc3RbLCAidCB2YWx1ZSJdDQpwX3ZhbHVlcyA8LSByb2J1c3RfdGVzdFssICJQcig+fHR8KSJdDQoNCiMgRnVuY3Rpb24gdG8gYWRkIHNpZ25pZmljYW5jZSBzdGFycw0KZ2V0X3N0YXJzIDwtIGZ1bmN0aW9uKHApIHsNCiAgICBpZiAocCA8PSAwLjAxKSByZXR1cm4oIioqKiIpDQogICAgaWYgKHAgPD0gMC4wNSkgcmV0dXJuKCIqKiIpDQogICAgaWYgKHAgPD0gMC4xKSByZXR1cm4oIioiKQ0KICAgIGlmIChwIDw9IDAuMTUpIHJldHVybigiLiIpDQogICAgcmV0dXJuKCIiKQ0KfQ0KDQojIE1heGltdW0gd2lkdGggZm9yIHZhcmlhYmxlIG5hbWVzDQpuYW1lX3dpZHRoIDwtIDYwDQoNCiMgUHJpbnQgaGVhZGVyIHdpdGggYWxpZ25tZW50DQpjYXQoc3ByaW50ZigiJS0qcyAgJTEwcyAgJTEwcyAgJTRzXG4iLCBuYW1lX3dpZHRoLCAiVmFyaWFibGUiLCAidC12YWx1ZSIsICJwLXZhbHVlIiwgInNpZyIpKQ0KY2F0KHNwcmludGYoIiUtKnMgICUxMHMgICUxMHMgICU0c1xuIiwgbmFtZV93aWR0aCwgIi0tLS0tLS0tLSIsICItLS0tLS0tIiwgIi0tLS0tLS0iLCAiLS0tLSIpKQ0KDQojIExvb3AgdGhyb3VnaCBhbmQgcHJpbnQgdmFsdWVzDQpmb3IgKGkgaW4gMTpsZW5ndGgodF9zdGF0cykpIHsNCiAgICB2YXJfbmFtZSA8LSByb3duYW1lcyhyb2J1c3RfdGVzdClbaV0NCiAgICAjIFRydW5jYXRlIG5hbWUgaWYgdG9vIGxvbmcNCiAgICBpZiAobmNoYXIodmFyX25hbWUpID4gbmFtZV93aWR0aCkgew0KICAgICAgICB2YXJfbmFtZSA8LSBwYXN0ZTAoc3Vic3RyKHZhcl9uYW1lLCAxLCBuYW1lX3dpZHRoLTMpLCAiLi4uIikNCiAgICB9DQogICAgY2F0KHNwcmludGYoIiUtKnMgICUxMC40ZiAgJTEwLjRmICAlNHNcbiIsIA0KICAgICAgICAgICAgICAgIG5hbWVfd2lkdGgsIHZhcl9uYW1lLCANCiAgICAgICAgICAgICAgICB0X3N0YXRzW2ldLCBwX3ZhbHVlc1tpXSwNCiAgICAgICAgICAgICAgICBnZXRfc3RhcnMocF92YWx1ZXNbaV0pKSkNCn0NCg0KY2F0KCJcblNpZ25pZmljYW5jZSBjb2RlczogMCAnKioqJyAwLjAxICcqKicgMC4wNSAnKicgMC4xICcuJyAwLjE1IikNCg0Kcl9zcXVhcmVkIDwtIHN1bW1hcnkob2xzX21vZGVsKSRhZGouci5zcXVhcmVkDQpyX3NxdWFyZWQNCmBgYA0KDQoNCmBgYHtyfQ0KIyBDcmVhdGUgYSBjb3B5IG9mIG91dGNvbWVfZGF0YSB3aXRob3V0IEdJTVINCm91dGNvbWVfZGF0YV9ub19naW1yIDwtIGNvcHkob3V0Y29tZV9kYXRhKQ0Kb3V0Y29tZV9kYXRhX25vX2dpbXJbLCBHSU1SIDo9IE5VTExdDQpvdXRjb21lX2RhdGFfbm9fZ2ltclssIG15X2lkIDo9IE5VTExdDQoNCiMgUnVuIE9MUyB3aXRob3V0IEdJTVIgY29ycmVjdGlvbg0Kb2xzX21vZGVsX25vX2dpbXIgPC0gbG0oY29udmVyc2lvbiB+IC4sIGRhdGEgPSBvdXRjb21lX2RhdGFfbm9fZ2ltcikNCg0KIyBHZXQgSEMwLWFkanVzdGVkIHQtdmFsdWVzIGFuZCBwLXZhbHVlcw0Kcm9idXN0X3Rlc3Rfbm9fZ2ltciA8LSBjb2VmdGVzdChvbHNfbW9kZWxfbm9fZ2ltciwgdmNvdiA9IHZjb3ZIQyhvbHNfbW9kZWxfbm9fZ2ltciwgdHlwZSA9ICJIQzAiKSkNCnRfc3RhdHNfbm9fZ2ltciA8LSByb2J1c3RfdGVzdF9ub19naW1yWywgInQgdmFsdWUiXQ0KcF92YWx1ZXNfbm9fZ2ltciA8LSByb2J1c3RfdGVzdF9ub19naW1yWywgIlByKD58dHwpIl0NCg0KIyBQcmludCBoZWFkZXIgd2l0aCBhbGlnbm1lbnQNCmNhdChzcHJpbnRmKCIlLSpzICAlMTBzICAlMTBzICAlNHNcbiIsIG5hbWVfd2lkdGgsICJWYXJpYWJsZSIsICJ0LXZhbHVlIiwgInAtdmFsdWUiLCAic2lnIikpDQpjYXQoc3ByaW50ZigiJS0qcyAgJTEwcyAgJTEwcyAgJTRzXG4iLCBuYW1lX3dpZHRoLCAiLS0tLS0tLS0tIiwgIi0tLS0tLS0iLCAiLS0tLS0tLSIsICItLS0tIikpDQoNCiMgTG9vcCB0aHJvdWdoIGFuZCBwcmludCB2YWx1ZXMNCmZvciAoaSBpbiAxOmxlbmd0aCh0X3N0YXRzX25vX2dpbXIpKSB7DQogICAgdmFyX25hbWUgPC0gcm93bmFtZXMocm9idXN0X3Rlc3Rfbm9fZ2ltcilbaV0NCiAgICAjIFRydW5jYXRlIG5hbWUgaWYgdG9vIGxvbmcNCiAgICBpZiAobmNoYXIodmFyX25hbWUpID4gbmFtZV93aWR0aCkgew0KICAgICAgICB2YXJfbmFtZSA8LSBwYXN0ZTAoc3Vic3RyKHZhcl9uYW1lLCAxLCBuYW1lX3dpZHRoLTMpLCAiLi4uIikNCiAgICB9DQogICAgY2F0KHNwcmludGYoIiUtKnMgICUxMC40ZiAgJTEwLjRmICAlNHNcbiIsIA0KICAgICAgICAgICAgICAgIG5hbWVfd2lkdGgsIHZhcl9uYW1lLCANCiAgICAgICAgICAgICAgICB0X3N0YXRzX25vX2dpbXJbaV0sIHBfdmFsdWVzX25vX2dpbXJbaV0sDQogICAgICAgICAgICAgICAgZ2V0X3N0YXJzKHBfdmFsdWVzX25vX2dpbXJbaV0pKSkNCn0NCg0KY2F0KCJcblNpZ25pZmljYW5jZSBjb2RlczogMCAnKioqJyAwLjAxICcqKicgMC4wNSAnKicgMC4xICcuJyAwLjE1IikNCg0KYGBgDQoNCmBgYHtyfQ0KIyB0aGUgciBzcXVhcmQgdmFsdWUNCnJfc3F1YXJlZF9ub19naW1yIDwtIHN1bW1hcnkob2xzX21vZGVsX25vX2dpbXIpJGFkai5yLnNxdWFyZWQNCnJfc3F1YXJlZF9ub19naW1yDQoNCmBgYA0KDQoNCmBgYHtyfQ0KIyBMb2FkIHRoZSBjYXIgcGFja2FnZSB3aGljaCBoYXMgdGhlIHZpZiBmdW5jdGlvbg0KbGlicmFyeShjYXIpDQoNCiMgQ2FsY3VsYXRlIFZJRnMgZm9yIHRoZSBtb2RlbCB3aXRoIEdJTVINCnZpZnMgPC0gdmlmKG9sc19tb2RlbCkNCg0KIyBGaWx0ZXIgdG8gc2hvdyBvbmx5IFZJRnMgb3ZlciA1DQpoaWdoX3ZpZnMgPC0gdmlmc1t2aWZzID4gNV0NCmlmKGxlbmd0aChoaWdoX3ZpZnMpID4gMCkgew0KICBjYXQoIlxuVmFyaWFibGVzIHdpdGggVklGID4gNSAod2l0aCBHSU1SKTpcbiIpDQogIHByaW50KGhpZ2hfdmlmcykNCn0gZWxzZSB7DQogIGNhdCgiXG5ObyB2YXJpYWJsZXMgd2l0aCBWSUYgPiA1IGZvdW5kIGluIHRoZSBtb2RlbCB3aXRoIEdJTVJcbiIpDQp9DQoNCiMgQ2FsY3VsYXRlIFZJRnMgZm9yIHRoZSBtb2RlbCB3aXRob3V0IEdJTVINCnZpZnNfbm9fZ2ltciA8LSB2aWYob2xzX21vZGVsX25vX2dpbXIpDQoNCiMgRmlsdGVyIHRvIHNob3cgb25seSBWSUZzIG92ZXIgNQ0KaGlnaF92aWZzX25vX2dpbXIgPC0gdmlmc19ub19naW1yW3ZpZnNfbm9fZ2ltciA+IDVdDQppZihsZW5ndGgoaGlnaF92aWZzX25vX2dpbXIpID4gMCkgew0KICBjYXQoIlxuVmFyaWFibGVzIHdpdGggVklGID4gNSAod2l0aG91dCBHSU1SKTpcbiIpDQogIHByaW50KGhpZ2hfdmlmc19ub19naW1yKQ0KfSBlbHNlIHsNCiAgY2F0KCJcbk5vIHZhcmlhYmxlcyB3aXRoIFZJRiA+IDUgZm91bmQgaW4gdGhlIG1vZGVsIHdpdGhvdXQgR0lNUlxuIikNCn0NCmBgYA0KDQo=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("heckman.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
