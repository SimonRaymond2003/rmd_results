<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Heckman Selection Model Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">4th Downs in the NFL</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="heckman.html">Heckman Selection</a>
</li>
<li>
  <a href="xgboost.html">XGBoost Prediction</a>
</li>
<li>
  <a href="attendance_binary.html">Attendance Impact Binary</a>
</li>
<li>
  <a href="thirddown.html">Third Down Analysis</a>
</li>
<li>
  <a href="attempt_ols.html">Attempts OLS</a>
</li>
<li>
  <a href="robustness_checks.html">Robustness Checks</a>
</li>
<li>
  <a href="Writing.html">Writing</a>
</li>
<li>
  <a href="kicker_exogenous.html">Proof of Exogeniety</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Heckman Selection Model Analysis</h1>

</div>


<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>outcome_data <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">&quot;predict_outcome.csv.gz&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>select_data <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">&quot;predict_select.csv.gz&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>select_data[, attempt <span class="sc">:=</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(attempt))]</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co"># Prepare the XGBoost matrices</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> . <span class="sc">-</span> <span class="dv">1</span> <span class="sc">-</span> attempt <span class="sc">-</span> my_id, <span class="at">data =</span> select_data)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(select_data<span class="sc">$</span>attempt))</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co"># Create parameter grid</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co"># Create parameter grid</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>  <span class="at">eta =</span> <span class="fu">seq</span>(<span class="fl">0.001</span>, <span class="fl">0.03</span>, <span class="at">by =</span> <span class="fl">0.01</span>),</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>  <span class="at">max_depth =</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>  <span class="at">min_child_weight =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="dv">1</span>),        </span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>  <span class="at">subsample =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.2</span>),</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>  <span class="at">colsample_bytree =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.2</span>),</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="dv">1</span>),                </span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">by =</span> <span class="dv">1</span>),                  </span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>  <span class="at">gamma =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">by =</span> <span class="fl">0.1</span>),               </span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>  <span class="at">nrounds =</span> <span class="fu">seq</span>(<span class="dv">100</span>, <span class="dv">250</span>, <span class="at">by =</span> <span class="dv">50</span>)</span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a>)</span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a><span class="co"># Sample grid points</span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a>conf_lev <span class="ot">&lt;-</span> .<span class="dv">95</span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a>num_max <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>conf_lev)<span class="sc">/</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>num_max<span class="sc">/</span><span class="fu">nrow</span>(grid)))</span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(grid), n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a>rgrid <span class="ot">&lt;-</span> grid[ind, ]</span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a><span class="co"># Set up parallel processing</span></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a>nc <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a><span class="co"># Calculate scale_pos_weight for imbalanced dataset</span></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a>scale_pos_weight <span class="ot">&lt;-</span> <span class="fu">sum</span>(y <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">/</span> <span class="fu">sum</span>(y <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a><span class="co"># Validation phase</span></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a><span class="co">#cat(&quot;\nPhase 1: Validation Phase\n&quot;)</span></span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a>n_validations <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a>validation_results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">nrow</span>(rgrid), <span class="at">ncol =</span> n_validations)</span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(rgrid)) {</span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a>  <span class="co">#cat(&quot;\nTesting parameter set&quot;, j, &quot;of&quot;, nrow(rgrid), &quot;\n&quot;)</span></span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a>  </span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_validations) {</span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a>    <span class="co">#cat(&quot;\nValidation iteration&quot;, i, &quot;of&quot;, n_validations, &quot;\n&quot;)             </span></span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a>    <span class="co"># Create validation split</span></span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(xs), <span class="fu">nrow</span>(xs), <span class="cn">TRUE</span>))</span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a>    train_x <span class="ot">&lt;-</span> xs[idx, ]</span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a>    train_y <span class="ot">&lt;-</span> y[idx]</span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a>    val_x <span class="ot">&lt;-</span> xs[<span class="sc">-</span>idx, ]</span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a>    val_y <span class="ot">&lt;-</span> y[<span class="sc">-</span>idx]</span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a>    </span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a>    prm <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a>      <span class="at">booster =</span> <span class="st">&quot;gbtree&quot;</span>,</span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a>      <span class="at">objective =</span> <span class="st">&quot;binary:logistic&quot;</span>,</span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a>      <span class="at">max_depth =</span> rgrid[j, <span class="st">&quot;max_depth&quot;</span>],</span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a>      <span class="at">eta =</span> rgrid[j, <span class="st">&quot;eta&quot;</span>],</span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a>      <span class="at">subsample =</span> rgrid[j, <span class="st">&quot;subsample&quot;</span>],</span>
<span id="cb3-62"><a href="#cb3-62" tabindex="-1"></a>      <span class="at">colsample_bytree =</span> rgrid[j, <span class="st">&quot;colsample_bytree&quot;</span>],</span>
<span id="cb3-63"><a href="#cb3-63" tabindex="-1"></a>      <span class="at">gamma =</span> rgrid[j, <span class="st">&quot;gamma&quot;</span>],</span>
<span id="cb3-64"><a href="#cb3-64" tabindex="-1"></a>      <span class="at">min_child_weight =</span> rgrid[j, <span class="st">&quot;min_child_weight&quot;</span>],</span>
<span id="cb3-65"><a href="#cb3-65" tabindex="-1"></a>      <span class="at">alpha =</span> rgrid[j, <span class="st">&quot;alpha&quot;</span>],</span>
<span id="cb3-66"><a href="#cb3-66" tabindex="-1"></a>      <span class="at">lambda =</span> rgrid[j, <span class="st">&quot;lambda&quot;</span>],</span>
<span id="cb3-67"><a href="#cb3-67" tabindex="-1"></a>      <span class="at">scale_pos_weight =</span> scale_pos_weight,</span>
<span id="cb3-68"><a href="#cb3-68" tabindex="-1"></a>      <span class="at">nthread =</span> nc</span>
<span id="cb3-69"><a href="#cb3-69" tabindex="-1"></a>    )</span>
<span id="cb3-70"><a href="#cb3-70" tabindex="-1"></a>    </span>
<span id="cb3-71"><a href="#cb3-71" tabindex="-1"></a>    dm_train <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> train_x, <span class="at">label =</span> train_y)</span>
<span id="cb3-72"><a href="#cb3-72" tabindex="-1"></a>    mdl <span class="ot">&lt;-</span> <span class="fu">xgb.train</span>(</span>
<span id="cb3-73"><a href="#cb3-73" tabindex="-1"></a>      <span class="at">params =</span> prm,</span>
<span id="cb3-74"><a href="#cb3-74" tabindex="-1"></a>      <span class="at">data =</span> dm_train,</span>
<span id="cb3-75"><a href="#cb3-75" tabindex="-1"></a>      <span class="at">nrounds =</span> rgrid[j, <span class="st">&quot;nrounds&quot;</span>],</span>
<span id="cb3-76"><a href="#cb3-76" tabindex="-1"></a>      <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb3-77"><a href="#cb3-77" tabindex="-1"></a>    )</span>
<span id="cb3-78"><a href="#cb3-78" tabindex="-1"></a>    </span>
<span id="cb3-79"><a href="#cb3-79" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">predict</span>(mdl, <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> val_x))</span>
<span id="cb3-80"><a href="#cb3-80" tabindex="-1"></a>    pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(p, val_y)</span>
<span id="cb3-81"><a href="#cb3-81" tabindex="-1"></a>    validation_results[j, i] <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="st">&quot;auc&quot;</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb3-82"><a href="#cb3-82" tabindex="-1"></a>  }</span>
<span id="cb3-83"><a href="#cb3-83" tabindex="-1"></a>}</span>
<span id="cb3-84"><a href="#cb3-84" tabindex="-1"></a></span>
<span id="cb3-85"><a href="#cb3-85" tabindex="-1"></a><span class="co"># Run 100 tests with best parameters</span></span>
<span id="cb3-86"><a href="#cb3-86" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Running X test iterations with best parameters...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Running X test iterations with best parameters...</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>test_aucs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>best_params_idx <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">rowMeans</span>(validation_results))</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>best_params <span class="ot">&lt;-</span> rgrid[best_params_idx,]</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co"># Train final model with best parameters</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>best_params_list <span class="ot">&lt;-</span> <span class="fu">as.list</span>(best_params[<span class="sc">-</span><span class="fu">which</span>(<span class="fu">names</span>(best_params) <span class="sc">==</span> <span class="st">&quot;nrounds&quot;</span>)])</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>best_params_list<span class="sc">$</span>booster <span class="ot">&lt;-</span> <span class="st">&quot;gbtree&quot;</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>best_params_list<span class="sc">$</span>objective <span class="ot">&lt;-</span> <span class="st">&quot;binary:logistic&quot;</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>best_params_list<span class="sc">$</span>scale_pos_weight <span class="ot">&lt;-</span> scale_pos_weight</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>best_params_list<span class="sc">$</span>nthread <span class="ot">&lt;-</span> nc</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>  <span class="co"># Create test split</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(xs), <span class="fu">nrow</span>(xs), T))</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>  train_x <span class="ot">&lt;-</span> xs[idx, ]</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>  train_y <span class="ot">&lt;-</span> y[idx]</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>  test_x <span class="ot">&lt;-</span> xs[<span class="sc">-</span>idx, ]</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>  test_y <span class="ot">&lt;-</span> y[<span class="sc">-</span>idx]</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>  </span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>  <span class="co"># Train model on full unbalanced dataset</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>  dm_train <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> train_x, <span class="at">label =</span> train_y)</span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>  mdl <span class="ot">&lt;-</span> <span class="fu">xgb.train</span>(</span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>    <span class="at">params =</span> best_params_list,</span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>    <span class="at">data =</span> dm_train,</span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>    <span class="at">nrounds =</span> best_params[[<span class="st">&quot;nrounds&quot;</span>]],</span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>  )</span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>  </span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>  <span class="co"># Test on unbalanced test set</span></span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">predict</span>(mdl, <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> test_x))</span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(p, test_y)</span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a>  test_aucs[i] <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="st">&quot;auc&quot;</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a>}</span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Test Results over 100 iterations:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Test Results over 100 iterations:</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean AUC:&quot;</span>, <span class="fu">mean</span>(test_aucs), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Mean AUC: 0.8869062</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;SD AUC:&quot;</span>, <span class="fu">sd</span>(test_aucs), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## SD AUC: 0.003498203</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;95% CI:&quot;</span>, <span class="fu">mean</span>(test_aucs) <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(test_aucs), </span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>    <span class="st">&quot;to&quot;</span>, <span class="fu">mean</span>(test_aucs) <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(test_aucs), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 95% CI: 0.8800497 to 0.8937627</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Plotting AUC distribution</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">plot</span>(test_aucs, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">pch=</span><span class="dv">20</span>,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;AUC Test Distribution&quot;</span>,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Iteration&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;AUC&quot;</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">mean</span>(test_aucs), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>)  <span class="co"># Add this line to show mean</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">mean</span>(test_aucs) <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(test_aucs), <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">mean</span>(test_aucs) <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(test_aucs), <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, </span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;AUC Values&quot;</span>, <span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;95% CI Bounds&quot;</span>),</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>),</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>       <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">20</span>, <span class="cn">NA</span>, <span class="cn">NA</span>))</span></code></pre></div>
<p><img src="heckman_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Now train final model on full data for z scores</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>dm_full <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> xs, <span class="at">label =</span> y)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> <span class="fu">xgb.train</span>(</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  <span class="at">params =</span> best_params_list,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="at">data =</span> dm_full,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="at">nrounds =</span> best_params[[<span class="st">&quot;nrounds&quot;</span>]],</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co"># Get probability predictions (z) for ALL data</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model, <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> xs))</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Calculate residuals for XGBoost predictions</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(select_data<span class="sc">$</span>attempt))</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> y <span class="sc">-</span> z</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co"># Histogram of residuals</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="fu">hist</span>(residuals, <span class="at">main=</span><span class="st">&quot;Distribution of XGBoost Model Residuals&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Residual&quot;</span>, <span class="at">breaks=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="heckman_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># plot out the z values\</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(z), </span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Density of Z Predictions&quot;</span>,</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Predicted Probability of Attempt&quot;</span>,</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>)</span></code></pre></div>
<p><img src="heckman_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Calculate GIMR (lambda) This is Generalized inverse mills ratio</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>GIMR <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(<span class="fu">qnorm</span>(z)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">qnorm</span>(z)))</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co"># Add GIMR to the data</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>select_data[, GIMR <span class="sc">:=</span> GIMR]</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co"># Print variable importa</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Create a data.table with just my_id and GIMR from select_data</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>GIMR_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">my_id =</span> select_data<span class="sc">$</span>my_id, <span class="at">GIMR =</span> GIMR)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co"># Add GIMR to outcome_data by matching on my_id</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>outcome_data[GIMR_dt, GIMR <span class="sc">:=</span> i.GIMR, on <span class="ot">=</span> <span class="st">&quot;my_id&quot;</span>]</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># # Existing code</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="co"># outcome_data &lt;- outcome_data[, my_id := NULL]</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="co"># outcome_data[, yardline_31_40 := NULL]</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co"># outcome_data[, year2022_team_CLE := NULL] # tied for most attempts with 31</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co"># Remove all columns with &quot;_present&quot; in the name</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>present_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;_present&quot;</span>, <span class="fu">names</span>(outcome_data), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> present_cols) {</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>  outcome_data[, (col) <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># Create copies of outcome_data for different models</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>outcome_data_player <span class="ot">&lt;-</span> <span class="fu">copy</span>(outcome_data)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>outcome_data_starter <span class="ot">&lt;-</span> <span class="fu">copy</span>(outcome_data)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co"># Remove specific columns as in original code</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="cf">for</span> (dt <span class="cf">in</span> <span class="fu">list</span>(outcome_data_player, outcome_data_starter)) {</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>  dt[, my_id <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>  dt[, yardline_31_40 <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  dt[, year2022_team_CLE <span class="sc">:=</span> <span class="cn">NULL</span>] <span class="co"># tied for most attempts with 31</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>  </span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>  <span class="co"># Remove attendance variables</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>  dt[, attendance_pct <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>  dt[, attendance_raw <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>  dt[, vegas_wp_posteam <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Warning in `[.data.table`(dt, , `:=`(vegas_wp_posteam, NULL)): Column
## &#39;vegas_wp_posteam&#39; does not exist to remove

## Warning in `[.data.table`(dt, , `:=`(vegas_wp_posteam, NULL)): Column
## &#39;vegas_wp_posteam&#39; does not exist to remove</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># For player models, remove starter columns</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>player_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;^starter_&quot;</span>, <span class="fu">names</span>(outcome_data_player), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> player_cols) {</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  outcome_data_player[, (col) <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>}</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="co"># For starter models, remove player columns</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>starter_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;^(offense|defense)_player_&quot;</span>, <span class="fu">names</span>(outcome_data_starter), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> starter_cols) {</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>  outcome_data_starter[, (col) <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>}</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="co"># Ensure conversion is numeric</span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="cf">for</span> (dt <span class="cf">in</span> <span class="fu">list</span>(outcome_data_player, outcome_data_starter)) {</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a>  dt[, conversion <span class="sc">:=</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(conversion))]</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>}</span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a><span class="co"># MODEL 1: Player model with GIMR</span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a>ols_model_player <span class="ot">&lt;-</span> <span class="fu">lm</span>(conversion <span class="sc">~</span> ., <span class="at">data =</span> outcome_data_player)</span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a><span class="co"># MODEL 2: Starter model with GIMR</span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a>ols_model_starter <span class="ot">&lt;-</span> <span class="fu">lm</span>(conversion <span class="sc">~</span> ., <span class="at">data =</span> outcome_data_starter)</span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a><span class="co"># Function to analyze and print model results</span></span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a>analyze_model <span class="ot">&lt;-</span> <span class="cf">function</span>(model, model_name) {</span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a>  <span class="fu">library</span>(sandwich)</span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a>  <span class="fu">library</span>(lmtest)</span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a>  </span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a>  <span class="co"># Get HC0-adjusted t-values and p-values</span></span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a>  robust_test <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model, <span class="at">vcov =</span> <span class="fu">vcovHC</span>(model, <span class="at">type =</span> <span class="st">&quot;HC0&quot;</span>))</span>
<span id="cb22-31"><a href="#cb22-31" tabindex="-1"></a>  t_stats <span class="ot">&lt;-</span> robust_test[, <span class="st">&quot;t value&quot;</span>]</span>
<span id="cb22-32"><a href="#cb22-32" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> robust_test[, <span class="st">&quot;Pr(&gt;|t|)&quot;</span>]</span>
<span id="cb22-33"><a href="#cb22-33" tabindex="-1"></a>  </span>
<span id="cb22-34"><a href="#cb22-34" tabindex="-1"></a>  <span class="co"># Function to add significance stars</span></span>
<span id="cb22-35"><a href="#cb22-35" tabindex="-1"></a>  get_stars <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {</span>
<span id="cb22-36"><a href="#cb22-36" tabindex="-1"></a>    <span class="cf">if</span> (p <span class="sc">&lt;=</span> <span class="fl">0.01</span>) <span class="fu">return</span>(<span class="st">&quot;***&quot;</span>)</span>
<span id="cb22-37"><a href="#cb22-37" tabindex="-1"></a>    <span class="cf">if</span> (p <span class="sc">&lt;=</span> <span class="fl">0.05</span>) <span class="fu">return</span>(<span class="st">&quot;**&quot;</span>)</span>
<span id="cb22-38"><a href="#cb22-38" tabindex="-1"></a>    <span class="cf">if</span> (p <span class="sc">&lt;=</span> <span class="fl">0.1</span>) <span class="fu">return</span>(<span class="st">&quot;*&quot;</span>)</span>
<span id="cb22-39"><a href="#cb22-39" tabindex="-1"></a>    <span class="cf">if</span> (p <span class="sc">&lt;=</span> <span class="fl">0.15</span>) <span class="fu">return</span>(<span class="st">&quot;.&quot;</span>)</span>
<span id="cb22-40"><a href="#cb22-40" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb22-41"><a href="#cb22-41" tabindex="-1"></a>  }</span>
<span id="cb22-42"><a href="#cb22-42" tabindex="-1"></a>  </span>
<span id="cb22-43"><a href="#cb22-43" tabindex="-1"></a>  <span class="co"># Maximum width for variable names</span></span>
<span id="cb22-44"><a href="#cb22-44" tabindex="-1"></a>  name_width <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb22-45"><a href="#cb22-45" tabindex="-1"></a>  </span>
<span id="cb22-46"><a href="#cb22-46" tabindex="-1"></a>  <span class="co"># Print model name and header</span></span>
<span id="cb22-47"><a href="#cb22-47" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>, <span class="fu">paste</span>(<span class="fu">rep</span>(<span class="st">&quot;=&quot;</span>, <span class="dv">80</span>), <span class="at">collapse=</span><span class="st">&quot;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb22-48"><a href="#cb22-48" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;MODEL:&quot;</span>, model_name, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb22-49"><a href="#cb22-49" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="fu">rep</span>(<span class="st">&quot;=&quot;</span>, <span class="dv">80</span>), <span class="at">collapse=</span><span class="st">&quot;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb22-50"><a href="#cb22-50" tabindex="-1"></a>  </span>
<span id="cb22-51"><a href="#cb22-51" tabindex="-1"></a>  <span class="co"># Print header with alignment</span></span>
<span id="cb22-52"><a href="#cb22-52" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10s  %10s  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, name_width, <span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;t-value&quot;</span>, <span class="st">&quot;p-value&quot;</span>, <span class="st">&quot;sig&quot;</span>))</span>
<span id="cb22-53"><a href="#cb22-53" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10s  %10s  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, name_width, <span class="st">&quot;---------&quot;</span>, <span class="st">&quot;-------&quot;</span>, <span class="st">&quot;-------&quot;</span>, <span class="st">&quot;----&quot;</span>))</span>
<span id="cb22-54"><a href="#cb22-54" tabindex="-1"></a>  </span>
<span id="cb22-55"><a href="#cb22-55" tabindex="-1"></a>  <span class="co"># Loop through and print values</span></span>
<span id="cb22-56"><a href="#cb22-56" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(t_stats)) {</span>
<span id="cb22-57"><a href="#cb22-57" tabindex="-1"></a>    var_name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(robust_test)[i]</span>
<span id="cb22-58"><a href="#cb22-58" tabindex="-1"></a>    <span class="co"># Truncate name if too long</span></span>
<span id="cb22-59"><a href="#cb22-59" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nchar</span>(var_name) <span class="sc">&gt;</span> name_width) {</span>
<span id="cb22-60"><a href="#cb22-60" tabindex="-1"></a>      var_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">substr</span>(var_name, <span class="dv">1</span>, name_width<span class="dv">-3</span>), <span class="st">&quot;...&quot;</span>)</span>
<span id="cb22-61"><a href="#cb22-61" tabindex="-1"></a>    }</span>
<span id="cb22-62"><a href="#cb22-62" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10.4f  %10.4f  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, </span>
<span id="cb22-63"><a href="#cb22-63" tabindex="-1"></a>                name_width, var_name, </span>
<span id="cb22-64"><a href="#cb22-64" tabindex="-1"></a>                t_stats[i], p_values[i],</span>
<span id="cb22-65"><a href="#cb22-65" tabindex="-1"></a>                <span class="fu">get_stars</span>(p_values[i])))</span>
<span id="cb22-66"><a href="#cb22-66" tabindex="-1"></a>  }</span>
<span id="cb22-67"><a href="#cb22-67" tabindex="-1"></a>  </span>
<span id="cb22-68"><a href="#cb22-68" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb22-69"><a href="#cb22-69" tabindex="-1"></a>  </span>
<span id="cb22-70"><a href="#cb22-70" tabindex="-1"></a>  <span class="co"># Print R-squared</span></span>
<span id="cb22-71"><a href="#cb22-71" tabindex="-1"></a>  r_squared <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>adj.r.squared</span>
<span id="cb22-72"><a href="#cb22-72" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Adjusted R-squared:&quot;</span>, r_squared, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb22-73"><a href="#cb22-73" tabindex="-1"></a>  </span>
<span id="cb22-74"><a href="#cb22-74" tabindex="-1"></a>  <span class="co"># Calculate VIFs</span></span>
<span id="cb22-75"><a href="#cb22-75" tabindex="-1"></a>  <span class="fu">library</span>(car)</span>
<span id="cb22-76"><a href="#cb22-76" tabindex="-1"></a>  vifs <span class="ot">&lt;-</span> <span class="fu">vif</span>(model)</span>
<span id="cb22-77"><a href="#cb22-77" tabindex="-1"></a>  </span>
<span id="cb22-78"><a href="#cb22-78" tabindex="-1"></a>  <span class="co"># Filter to show only VIFs over 5</span></span>
<span id="cb22-79"><a href="#cb22-79" tabindex="-1"></a>  high_vifs <span class="ot">&lt;-</span> vifs[vifs <span class="sc">&gt;</span> <span class="dv">5</span>]</span>
<span id="cb22-80"><a href="#cb22-80" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(high_vifs) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb22-81"><a href="#cb22-81" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Variables with VIF &gt; 5:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb22-82"><a href="#cb22-82" tabindex="-1"></a>    <span class="fu">print</span>(high_vifs)</span>
<span id="cb22-83"><a href="#cb22-83" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb22-84"><a href="#cb22-84" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">No variables with VIF &gt; 5 found in this model</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb22-85"><a href="#cb22-85" tabindex="-1"></a>  }</span>
<span id="cb22-86"><a href="#cb22-86" tabindex="-1"></a>  </span>
<span id="cb22-87"><a href="#cb22-87" tabindex="-1"></a>  <span class="fu">return</span>(r_squared)</span>
<span id="cb22-88"><a href="#cb22-88" tabindex="-1"></a>}</span>
<span id="cb22-89"><a href="#cb22-89" tabindex="-1"></a></span>
<span id="cb22-90"><a href="#cb22-90" tabindex="-1"></a><span class="co"># Analyze models with GIMR only</span></span>
<span id="cb22-91"><a href="#cb22-91" tabindex="-1"></a>r2_player <span class="ot">&lt;-</span> <span class="fu">analyze_model</span>(ols_model_player, <span class="st">&quot;Player Model with GIMR&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 
##  ================================================================================ 
## MODEL: Player Model with GIMR 
## ================================================================================ 
## 
## Variable                                                         t-value     p-value   sig
## ---------                                                        -------     -------  ----
## (Intercept)                                                       3.5574      0.0004   ***
## ydstogo                                                         -12.3459      0.0000   ***
## posteam_timeouts_remaining                                        1.0838      0.2785      
## defteam_timeouts_remaining                                        1.2158      0.2241      
## rush_attempt                                                      7.1031      0.0000   ***
## week                                                              0.6156      0.5382      
## temp                                                             -0.9656      0.3343      
## wind                                                              0.9855      0.3245      
## vegas_wp                                                          1.7389      0.0821     *
## spread_line                                                      -0.0832      0.9337      
## total_line                                                        2.1306      0.0332    **
## prep_days                                                         0.9995      0.3176      
## overall_win_pct                                                   0.4868      0.6264      
## team_win_pct                                                      1.0447      0.2962      
## prev_win_pct                                                     -2.7786      0.0055   ***
## prev_shotgun_rate                                                 0.3549      0.7227      
## prev_singleback_rate                                              0.5157      0.6061      
## prev_empty_rate                                                   0.6278      0.5302      
## prev_iform_rate                                                   0.0734      0.9415      
## prev_shotgun_success                                              0.2360      0.8135      
## prev_singleback_success                                           0.7554      0.4501      
## prev_empty_success                                                0.5707      0.5682      
## prev_iform_success                                                2.0945      0.0363    **
## prev_stop_rate_run                                                0.1278      0.8984      
## prev_stop_rate_pass                                              -3.2542      0.0011   ***
## shotgun_rate                                                      1.1521      0.2494      
## singleback_rate                                                   0.3105      0.7562      
## empty_rate                                                       -0.1524      0.8789      
## iform_rate                                                       -1.8574      0.0633     *
## shotgun_success                                                  -2.1851      0.0289    **
## singleback_success                                               -0.7905      0.4293      
## empty_success                                                    -0.6881      0.4914      
## iform_success                                                    -1.3723      0.1701      
## def_stop_rate_run                                                 1.6141      0.1066     .
## def_stop_rate_pass                                               -0.9084      0.3637      
## avg_pass_rushers                                                 -1.0201      0.3078      
## avg_box_defenders                                                -0.2987      0.7652      
## cover0_rate                                                      -0.1522      0.8791      
## cover1_rate                                                      -0.3583      0.7201      
## cover2_rate                                                      -0.2272      0.8203      
## cover3_rate                                                       1.6054      0.1085     .
## cover4_rate                                                       0.9455      0.3444      
## cover6_rate                                                      -0.4876      0.6259      
## two_man_rate                                                      1.3630      0.1730      
## prevent_rate                                                      2.6482      0.0081   ***
## roof_outdoors                                                    -0.3958      0.6923      
## posteam_type_home                                                -1.2975      0.1945      
## offense_formation_EMPTY                                          -0.1179      0.9062      
## offense_formation_SHOTGUN                                        -0.7463      0.4555      
## offense_formation_SINGLEBACK                                     -0.5831      0.5599      
## offense_formation_I_FORM                                         -0.2541      0.7994      
## offense_player_1_passing_depth_short_grades_pass_12w              2.5167      0.0119    **
## offense_player_1_passing_depth_medium_grades_pass_12w            -0.4641      0.6426      
## offense_player_1_passing_depth_deep_grades_pass_12w              -1.5543      0.1202     .
## offense_player_4_rushing_grades_first_downs_12w                  -0.4420      0.6585      
## offense_player_4_rushing_grades_yards_12w                         1.0664      0.2863      
## offense_player_4_receiving_grades_grades_pass_block_12w           1.3400      0.1803      
## offense_player_4_receiving_grades_grades_offense_12w             -0.7400      0.4593      
## offense_player_8_receiving_depth_short_grades_pass_route_12w     -0.6557      0.5120      
## offense_player_8_receiving_depth_medium_grades_pass_route...     -0.3576      0.7207      
## offense_player_8_receiving_depth_deep_grades_pass_route_12w       0.4567      0.6479      
## offense_player_9_receiving_depth_short_grades_pass_route_12w     -0.2930      0.7695      
## offense_player_9_receiving_depth_medium_grades_pass_route...     -0.3755      0.7073      
## offense_player_9_receiving_depth_deep_grades_pass_route_12w       0.6990      0.4846      
## offense_player_10_receiving_depth_short_grades_pass_route...     -0.2957      0.7675      
## offense_player_10_receiving_depth_medium_grades_pass_rout...      0.6882      0.4914      
## offense_player_10_receiving_depth_deep_grades_pass_route_12w      0.8114      0.4172      
## offense_player_14_receiving_depth_short_grades_pass_route...      0.4307      0.6667      
## offense_player_14_receiving_depth_medium_grades_pass_rout...      1.8244      0.0682     *
## offense_player_14_receiving_depth_deep_grades_pass_route_12w     -1.4446      0.1487     .
## offense_player_17_blocking_grades_grades_pass_block_12w          -1.0328      0.3018      
## offense_player_17_blocking_grades_grades_run_block_12w            0.6644      0.5065      
## offense_player_18_blocking_grades_grades_pass_block_12w          -0.2975      0.7661      
## offense_player_18_blocking_grades_grades_run_block_12w           -1.3310      0.1833      
## offense_player_19_blocking_grades_grades_pass_block_12w           0.6393      0.5227      
## offense_player_19_blocking_grades_grades_run_block_12w            0.4882      0.6254      
## offense_player_20_blocking_grades_grades_pass_block_12w           1.0703      0.2845      
## offense_player_20_blocking_grades_grades_run_block_12w           -1.6336      0.1024     .
## offense_player_21_blocking_grades_grades_pass_block_12w          -1.5056      0.1323     .
## offense_player_21_blocking_grades_grades_run_block_12w            1.1999      0.2302      
## defense_player_1_defensive_grades_grades_run_defense_12w         -0.3057      0.7599      
## defense_player_1_defensive_grades_grades_pass_rush_defens...     -1.4180      0.1563      
## defense_player_2_defensive_grades_grades_run_defense_12w          0.4663      0.6411      
## defense_player_2_defensive_grades_grades_pass_rush_defens...     -0.3412      0.7330      
## defense_player_3_defensive_grades_grades_run_defense_12w          0.0317      0.9747      
## defense_player_3_defensive_grades_grades_pass_rush_defens...      0.2297      0.8184      
## defense_player_4_defensive_grades_grades_run_defense_12w         -0.8410      0.4004      
## defense_player_4_defensive_grades_grades_pass_rush_defens...      0.1365      0.8914      
## defense_player_9_defensive_grades_grades_run_defense_12w          0.7093      0.4782      
## defense_player_9_defensive_grades_grades_pass_rush_defens...     -1.2324      0.2179      
## defense_player_9_coverage_schemes_zone_grades_coverage_de...      0.1431      0.8863      
## defense_player_9_coverage_schemes_man_grades_coverage_def...      1.0099      0.3126      
## defense_player_10_defensive_grades_grades_run_defense_12w         0.0483      0.9615      
## defense_player_10_defensive_grades_grades_pass_rush_defen...     -1.8982      0.0578     *
## defense_player_10_coverage_schemes_zone_grades_coverage_d...      1.2567      0.2090      
## defense_player_10_coverage_schemes_man_grades_coverage_de...      0.6570      0.5112      
## defense_player_11_defensive_grades_grades_run_defense_12w        -1.2457      0.2129      
## defense_player_11_defensive_grades_grades_pass_rush_defen...      1.6596      0.0971     *
## defense_player_11_coverage_schemes_zone_grades_coverage_d...     -1.4473      0.1479     .
## defense_player_11_coverage_schemes_man_grades_coverage_de...      0.7960      0.4261      
## defense_player_12_defensive_grades_grades_run_defense_12w         0.8257      0.4090      
## defense_player_12_defensive_grades_grades_pass_rush_defen...     -1.0532      0.2923      
## defense_player_12_coverage_schemes_zone_grades_coverage_d...      0.0645      0.9486      
## defense_player_12_coverage_schemes_man_grades_coverage_de...     -0.0443      0.9646      
## defense_player_15_defensive_grades_grades_run_defense_12w         0.9267      0.3541      
## defense_player_15_coverage_schemes_zone_grades_coverage_d...     -0.5820      0.5606      
## defense_player_15_coverage_schemes_man_grades_coverage_de...     -1.4916      0.1359     .
## defense_player_16_defensive_grades_grades_run_defense_12w        -0.6673      0.5046      
## defense_player_16_coverage_schemes_zone_grades_coverage_d...     -0.2952      0.7679      
## defense_player_16_coverage_schemes_man_grades_coverage_de...      0.5463      0.5849      
## defense_player_17_defensive_grades_grades_run_defense_12w         0.3466      0.7289      
## defense_player_17_coverage_schemes_zone_grades_coverage_d...      0.2857      0.7751      
## defense_player_17_coverage_schemes_man_grades_coverage_de...     -0.3005      0.7638      
## defense_player_20_defensive_grades_grades_run_defense_12w        -1.6618      0.0966     *
## defense_player_20_coverage_schemes_zone_grades_coverage_d...      1.3598      0.1740      
## defense_player_20_coverage_schemes_man_grades_coverage_de...      0.0030      0.9976      
## defense_player_21_defensive_grades_grades_run_defense_12w        -0.1185      0.9057      
## defense_player_21_coverage_schemes_zone_grades_coverage_d...      0.4907      0.6237      
## defense_player_21_coverage_schemes_man_grades_coverage_de...     -0.2872      0.7740      
## defense_player_22_defensive_grades_grades_run_defense_12w        -0.0859      0.9315      
## defense_player_22_coverage_schemes_zone_grades_coverage_d...      0.4386      0.6610      
## defense_player_22_coverage_schemes_man_grades_coverage_de...     -0.2432      0.8078      
## yardline_1_10                                                    -2.2386      0.0252    **
## yardline_11_20                                                    0.5360      0.5920      
## yardline_21_30                                                    0.3460      0.7293      
## yardline_41_50                                                    1.9215      0.0547     *
## yardline_51_60                                                    0.7050      0.4809      
## yardline_61_70                                                    1.4256      0.1541      
## yardline_71_80                                                    1.9953      0.0461    **
## yardline_81_90                                                    2.5127      0.0120    **
## yardline_91_100                                                   0.8868      0.3752      
## year2017_team_ARI                                                 0.4819      0.6299      
## year2017_team_BUF                                                -0.5668      0.5709      
## year2017_team_CHI                                                 0.0544      0.9566      
## year2017_team_CLE                                                 0.8600      0.3898      
## year2017_team_DAL                                                -0.8632      0.3881      
## year2017_team_DET                                                -0.5128      0.6082      
## year2017_team_GB                                                  1.9501      0.0512     *
## year2017_team_HOU                                                 1.7955      0.0727     *
## year2017_team_MIA                                                -1.1763      0.2396      
## year2017_team_MIN                                                -0.4951      0.6206      
## year2017_team_NE                                                  0.0804      0.9359      
## year2017_team_SF                                                  1.8931      0.0584     *
## year2017_team_BAL                                                 0.1029      0.9180      
## year2017_team_DEN                                                 0.0023      0.9982      
## year2017_team_LA                                                  0.2706      0.7867      
## year2017_team_NYG                                                -0.3279      0.7430      
## year2017_team_OAK                                                -0.5099      0.6102      
## year2017_team_SEA                                                 0.6868      0.4923      
## year2017_team_CAR                                                 0.6545      0.5128      
## year2017_team_CIN                                                 0.7200      0.4716      
## year2017_team_IND                                                 0.8762      0.3810      
## year2017_team_NO                                                  0.6881      0.4914      
## year2017_team_PHI                                                 0.2158      0.8292      
## year2017_team_PIT                                                -0.7197      0.4718      
## year2017_team_TEN                                                 0.2549      0.7988      
## year2017_team_WAS                                                 0.2218      0.8245      
## year2017_team_KC                                                  1.4205      0.1555      
## year2017_team_LAC                                                 0.2324      0.8162      
## year2017_team_NYJ                                                 0.7529      0.4516      
## year2017_team_TB                                                  0.2063      0.8365      
## year2017_team_ATL                                                -0.0246      0.9803      
## year2017_team_JAX                                                 0.2439      0.8073      
## year2018_team_ARI                                                 0.7203      0.4714      
## year2018_team_BAL                                                 0.1996      0.8418      
## year2018_team_CAR                                                 0.1684      0.8663      
## year2018_team_CLE                                                -0.3145      0.7532      
## year2018_team_DET                                                 0.7522      0.4520      
## year2018_team_HOU                                                 1.3547      0.1756      
## year2018_team_IND                                                -0.6956      0.4868      
## year2018_team_KC                                                  0.8246      0.4096      
## year2018_team_NYG                                                 0.4172      0.6765      
## year2018_team_OAK                                                -0.6758      0.4992      
## year2018_team_PHI                                                 0.6502      0.5156      
## year2018_team_SEA                                                -0.4902      0.6240      
## year2018_team_BUF                                                -0.6460      0.5183      
## year2018_team_CHI                                                -0.1519      0.8793      
## year2018_team_CIN                                                -0.2853      0.7754      
## year2018_team_DAL                                                -0.3669      0.7137      
## year2018_team_DEN                                                 0.2154      0.8295      
## year2018_team_GB                                                 -0.0283      0.9774      
## year2018_team_LAC                                                 0.2858      0.7751      
## year2018_team_NE                                                 -0.5145      0.6069      
## year2018_team_NO                                                  0.6558      0.5120      
## year2018_team_PIT                                                 0.5246      0.5999      
## year2018_team_SF                                                  0.1910      0.8485      
## year2018_team_MIA                                                 0.6201      0.5352      
## year2018_team_MIN                                                 0.0899      0.9284      
## year2018_team_NYJ                                                 0.7295      0.4657      
## year2018_team_TB                                                  0.2208      0.8253      
## year2018_team_ATL                                                 0.4900      0.6241      
## year2018_team_JAX                                                 0.3889      0.6974      
## year2018_team_LA                                                 -1.0110      0.3121      
## year2018_team_TEN                                                 0.6896      0.4905      
## year2018_team_WAS                                                 0.0782      0.9377      
## year2019_team_ARI                                                -0.7167      0.4736      
## year2019_team_BUF                                                -1.1676      0.2431      
## year2019_team_CHI                                                 0.5428      0.5873      
## year2019_team_CLE                                                 0.7415      0.4584      
## year2019_team_DAL                                                -0.4165      0.6771      
## year2019_team_IND                                                -0.4408      0.6594      
## year2019_team_JAX                                                 0.6152      0.5385      
## year2019_team_KC                                                  0.0145      0.9884      
## year2019_team_LAC                                                -0.5384      0.5903      
## year2019_team_MIN                                                -0.5412      0.5884      
## year2019_team_NE                                                 -0.1280      0.8982      
## year2019_team_NO                                                 -1.0991      0.2718      
## year2019_team_PHI                                                 0.3775      0.7058      
## year2019_team_SEA                                                 0.2720      0.7856      
## year2019_team_SF                                                 -0.1287      0.8976      
## year2019_team_TB                                                 -0.8957      0.3705      
## year2019_team_BAL                                                 0.0551      0.9561      
## year2019_team_CAR                                                -0.5875      0.5569      
## year2019_team_DEN                                                 0.6803      0.4964      
## year2019_team_DET                                                -0.6684      0.5039      
## year2019_team_HOU                                                -0.0495      0.9605      
## year2019_team_LA                                                 -0.6244      0.5324      
## year2019_team_MIA                                                -1.9364      0.0529     *
## year2019_team_NYG                                                -0.9034      0.3664      
## year2019_team_NYJ                                                -1.8738      0.0610     *
## year2019_team_OAK                                                -0.2655      0.7907      
## year2019_team_PIT                                                -2.3716      0.0178    **
## year2019_team_TEN                                                -1.2663      0.2055      
## year2019_team_CIN                                                 0.5426      0.5875      
## year2019_team_WAS                                                -0.5309      0.5955      
## year2019_team_ATL                                                -0.0587      0.9532      
## year2019_team_GB                                                 -0.3018      0.7628      
## year2020_team_ATL                                                 0.2060      0.8368      
## year2020_team_BAL                                                 0.3931      0.6943      
## year2020_team_BUF                                                -0.0173      0.9862      
## year2020_team_CAR                                                 0.6662      0.5053      
## year2020_team_CIN                                                 0.3125      0.7547      
## year2020_team_DEN                                                -0.5308      0.5956      
## year2020_team_DET                                                -0.9913      0.3216      
## year2020_team_JAX                                                -0.8397      0.4011      
## year2020_team_KC                                                  0.2771      0.7818      
## year2020_team_LA                                                 -1.1828      0.2370      
## year2020_team_MIN                                                 1.0560      0.2911      
## year2020_team_NE                                                 -0.4472      0.6547      
## year2020_team_NO                                                  0.3269      0.7438      
## year2020_team_NYG                                                 0.1072      0.9146      
## year2020_team_SF                                                  0.5825      0.5603      
## year2020_team_WAS                                                 0.0907      0.9278      
## year2020_team_CHI                                                 0.1740      0.8619      
## year2020_team_DAL                                                -0.3544      0.7230      
## year2020_team_GB                                                 -0.3259      0.7445      
## year2020_team_HOU                                                -0.7054      0.4806      
## year2020_team_MIA                                                -1.2009      0.2299      
## year2020_team_NYJ                                                -0.0851      0.9322      
## year2020_team_TB                                                  0.2080      0.8352      
## year2020_team_TEN                                                -0.6431      0.5202      
## year2020_team_ARI                                                 0.2457      0.8059      
## year2020_team_CLE                                                -1.7340      0.0830     *
## year2020_team_IND                                                -0.8652      0.3870      
## year2020_team_LAC                                                 0.0704      0.9439      
## year2020_team_PHI                                                 0.5082      0.6114      
## year2020_team_SEA                                                -0.1790      0.8579      
## year2020_team_LV                                                  0.6313      0.5279      
## year2020_team_PIT                                                -0.4075      0.6837      
## year2021_team_ATL                                                -1.6992      0.0894     *
## year2021_team_BUF                                                 0.2825      0.7776      
## year2021_team_CIN                                                -1.8387      0.0660     *
## year2021_team_DAL                                                -0.5727      0.5669      
## year2021_team_DEN                                                 0.2612      0.7939      
## year2021_team_DET                                                -0.4811      0.6305      
## year2021_team_KC                                                  0.4150      0.6781      
## year2021_team_LA                                                  0.2240      0.8228      
## year2021_team_LV                                                  0.3584      0.7201      
## year2021_team_MIN                                                -0.2272      0.8203      
## year2021_team_NE                                                  0.4254      0.6706      
## year2021_team_NO                                                 -0.1296      0.8969      
## year2021_team_NYG                                                 0.0262      0.9791      
## year2021_team_SF                                                  0.1319      0.8950      
## year2021_team_TEN                                                -0.6435      0.5199      
## year2021_team_ARI                                                 0.9752      0.3295      
## year2021_team_BAL                                                 0.6786      0.4974      
## year2021_team_CAR                                                -0.5006      0.6167      
## year2021_team_CHI                                                -1.4272      0.1536      
## year2021_team_GB                                                  0.9360      0.3494      
## year2021_team_IND                                                -0.1701      0.8650      
## year2021_team_LAC                                                 0.3475      0.7282      
## year2021_team_MIA                                                 0.0848      0.9324      
## year2021_team_NYJ                                                -0.2397      0.8106      
## year2021_team_PHI                                                -1.4535      0.1462     .
## year2021_team_SEA                                                -1.2411      0.2146      
## year2021_team_TB                                                  0.4152      0.6780      
## year2021_team_WAS                                                -0.4719      0.6370      
## year2021_team_CLE                                                -0.5795      0.5623      
## year2021_team_HOU                                                -0.6999      0.4840      
## year2021_team_JAX                                                -0.2849      0.7757      
## year2021_team_PIT                                                 0.4151      0.6781      
## year2022_team_ARI                                                -0.9844      0.3250      
## year2022_team_ATL                                                -2.1306      0.0332    **
## year2022_team_CAR                                                 0.9111      0.3623      
## year2022_team_CHI                                                -0.3919      0.6952      
## year2022_team_CIN                                                -0.8378      0.4022      
## year2022_team_HOU                                                -0.2167      0.8285      
## year2022_team_IND                                                -0.7813      0.4347      
## year2022_team_LAC                                                -0.4617      0.6444      
## year2022_team_MIA                                                -1.5574      0.1195     .
## year2022_team_SEA                                                -0.4891      0.6248      
## year2022_team_TB                                                  0.0897      0.9285      
## year2022_team_TEN                                                 1.2899      0.1972      
## year2022_team_WAS                                                -0.0708      0.9436      
## year2022_team_BAL                                                -1.4511      0.1468     .
## year2022_team_BUF                                                 0.2242      0.8227      
## year2022_team_DAL                                                -0.0177      0.9859      
## year2022_team_DET                                                -0.7065      0.4799      
## year2022_team_GB                                                 -1.0194      0.3081      
## year2022_team_JAX                                                -0.8887      0.3742      
## year2022_team_KC                                                 -0.6527      0.5140      
## year2022_team_LA                                                  1.4158      0.1569      
## year2022_team_LV                                                  1.0187      0.3084      
## year2022_team_NO                                                 -0.4084      0.6830      
## year2022_team_PHI                                                 0.5039      0.6143      
## year2022_team_PIT                                                 1.4840      0.1379     .
## year2022_team_DEN                                                 0.4966      0.6195      
## year2022_team_MIN                                                -0.7175      0.4731      
## year2022_team_NE                                                  0.1272      0.8988      
## year2022_team_NYJ                                                -0.8576      0.3912      
## year2022_team_NYG                                                -0.6223      0.5338      
## year2022_team_SF                                                 -1.1234      0.2614      
## year2023_team_BAL                                                -0.3504      0.7261      
## year2023_team_CHI                                                -1.0721      0.2838      
## year2023_team_CLE                                                -0.7805      0.4352      
## year2023_team_GB                                                  0.3472      0.7284      
## year2023_team_IND                                                 0.6538      0.5133      
## year2023_team_KC                                                  0.3281      0.7428      
## year2023_team_LAC                                                 0.3281      0.7428      
## year2023_team_LV                                                  0.3540      0.7234      
## year2023_team_MIA                                                 0.3038      0.7613      
## year2023_team_MIN                                                 1.0547      0.2917      
## year2023_team_NO                                                 -0.4726      0.6365      
## year2023_team_NYG                                                 0.0493      0.9607      
## year2023_team_SEA                                                -1.9920      0.0464    **
## year2023_team_SF                                                  0.1317      0.8953      
## year2023_team_WAS                                                 1.4241      0.1545      
## year2023_team_ATL                                                -0.5077      0.6117      
## year2023_team_BUF                                                -0.6095      0.5422      
## year2023_team_CAR                                                 0.4295      0.6676      
## year2023_team_DAL                                                 0.9802      0.3271      
## year2023_team_DEN                                                 0.3357      0.7371      
## year2023_team_HOU                                                -0.1785      0.8583      
## year2023_team_LA                                                  0.2946      0.7684      
## year2023_team_NE                                                  0.2452      0.8063      
## year2023_team_PHI                                                -0.1565      0.8756      
## year2023_team_PIT                                                 0.0179      0.9857      
## year2023_team_TEN                                                 0.1588      0.8739      
## year2023_team_ARI                                                -1.1902      0.2340      
## year2023_team_CIN                                                -0.8117      0.4170      
## year2023_team_DET                                                 0.3322      0.7397      
## year2023_team_TB                                                  0.7286      0.4663      
## year2023_team_JAX                                                -0.3245      0.7456      
## year2023_team_NYJ                                                 1.4111      0.1583      
## is_first_half                                                    -0.6401      0.5221      
## time_in_half                                                      1.6023      0.1092     .
## home_attendance                                                  -0.6048      0.5454      
## GIMR                                                              1.9579      0.0503     *
## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15
## 
## Adjusted R-squared: 0.1084406 
## 
## Variables with VIF &gt; 5:
##                                                   prev_shotgun_rate 
##                                                            9.641747 
##                                                prev_singleback_rate 
##                                                            5.525282 
##                                                         cover1_rate 
##                                                            6.284767 
##                                                         cover3_rate 
##                                                            6.591289 
##                                           offense_formation_SHOTGUN 
##                                                            7.020384 
##                     offense_player_4_rushing_grades_first_downs_12w 
##                                                           11.536708 
##                           offense_player_4_rushing_grades_yards_12w 
##                                                           11.543485 
##        offense_player_9_receiving_depth_short_grades_pass_route_12w 
##                                                            7.756056 
##       offense_player_9_receiving_depth_medium_grades_pass_route_12w 
##                                                            7.228077 
##       offense_player_10_receiving_depth_short_grades_pass_route_12w 
##                                                            6.006879 
##      offense_player_10_receiving_depth_medium_grades_pass_route_12w 
##                                                            6.001801 
##            defense_player_2_defensive_grades_grades_run_defense_12w 
##                                                            8.049749 
##      defense_player_2_defensive_grades_grades_pass_rush_defense_12w 
##                                                            8.043240 
##            defense_player_3_defensive_grades_grades_run_defense_12w 
##                                                           25.667100 
##      defense_player_3_defensive_grades_grades_pass_rush_defense_12w 
##                                                           25.538488 
##            defense_player_4_defensive_grades_grades_run_defense_12w 
##                                                           38.991477 
##      defense_player_4_defensive_grades_grades_pass_rush_defense_12w 
##                                                           39.949078 
##           defense_player_10_defensive_grades_grades_run_defense_12w 
##                                                            6.570328 
##     defense_player_10_defensive_grades_grades_pass_rush_defense_12w 
##                                                            5.906140 
## defense_player_10_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                            6.514985 
##           defense_player_11_defensive_grades_grades_run_defense_12w 
##                                                           20.290974 
##     defense_player_11_defensive_grades_grades_pass_rush_defense_12w 
##                                                           17.461827 
## defense_player_11_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                           14.497986 
##  defense_player_11_coverage_schemes_man_grades_coverage_defense_12w 
##                                                            6.382152 
##           defense_player_12_defensive_grades_grades_run_defense_12w 
##                                                           25.642774 
##     defense_player_12_defensive_grades_grades_pass_rush_defense_12w 
##                                                           22.281344 
## defense_player_12_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                           17.479279 
##  defense_player_12_coverage_schemes_man_grades_coverage_defense_12w 
##                                                            6.344399 
##           defense_player_16_defensive_grades_grades_run_defense_12w 
##                                                            6.194734 
## defense_player_16_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                            7.617617 
##  defense_player_16_coverage_schemes_man_grades_coverage_defense_12w 
##                                                            5.933983 
##           defense_player_17_defensive_grades_grades_run_defense_12w 
##                                                           16.904366 
## defense_player_17_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                           20.508297 
##  defense_player_17_coverage_schemes_man_grades_coverage_defense_12w 
##                                                           15.215795 
##           defense_player_21_defensive_grades_grades_run_defense_12w 
##                                                           11.627913 
## defense_player_21_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                           11.970697 
##  defense_player_21_coverage_schemes_man_grades_coverage_defense_12w 
##                                                           11.221438 
##           defense_player_22_defensive_grades_grades_run_defense_12w 
##                                                           41.255338 
## defense_player_22_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                           48.899234 
##  defense_player_22_coverage_schemes_man_grades_coverage_defense_12w 
##                                                           41.486341 
##                                                     home_attendance 
##                                                           14.022036</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>r2_starter <span class="ot">&lt;-</span> <span class="fu">analyze_model</span>(ols_model_starter, <span class="st">&quot;Starter Model with GIMR&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 
##  ================================================================================ 
## MODEL: Starter Model with GIMR 
## ================================================================================ 
## 
## Variable                                                         t-value     p-value   sig
## ---------                                                        -------     -------  ----
## (Intercept)                                                       3.1542      0.0016   ***
## ydstogo                                                         -12.9287      0.0000   ***
## posteam_timeouts_remaining                                        1.2676      0.2050      
## defteam_timeouts_remaining                                        1.1358      0.2561      
## rush_attempt                                                      6.9105      0.0000   ***
## week                                                              0.8877      0.3748      
## temp                                                             -0.4369      0.6622      
## wind                                                              0.3763      0.7067      
## vegas_wp                                                          1.1762      0.2396      
## spread_line                                                      -0.6696      0.5032      
## total_line                                                        2.2294      0.0259    **
## prep_days                                                         1.0051      0.3149      
## overall_win_pct                                                   0.3146      0.7531      
## team_win_pct                                                      1.5686      0.1168     .
## prev_win_pct                                                     -2.5823      0.0099   ***
## prev_shotgun_rate                                                 0.5109      0.6094      
## prev_singleback_rate                                              0.8164      0.4143      
## prev_empty_rate                                                   0.9378      0.3484      
## prev_iform_rate                                                   0.1169      0.9070      
## prev_shotgun_success                                              0.6288      0.5295      
## prev_singleback_success                                           0.7276      0.4669      
## prev_empty_success                                                0.0093      0.9925      
## prev_iform_success                                                2.7249      0.0065   ***
## prev_stop_rate_run                                               -0.1293      0.8971      
## prev_stop_rate_pass                                              -3.2482      0.0012   ***
## shotgun_rate                                                      1.3413      0.1799      
## singleback_rate                                                   0.4902      0.6241      
## empty_rate                                                        0.0703      0.9439      
## iform_rate                                                       -1.3579      0.1746      
## shotgun_success                                                  -2.5116      0.0121    **
## singleback_success                                               -1.6244      0.1044     .
## empty_success                                                    -1.4406      0.1498     .
## iform_success                                                    -1.1970      0.2314      
## def_stop_rate_run                                                 1.7735      0.0762     *
## def_stop_rate_pass                                               -1.3230      0.1859      
## avg_pass_rushers                                                 -1.0399      0.2985      
## avg_box_defenders                                                -0.6797      0.4967      
## cover0_rate                                                      -0.5557      0.5785      
## cover1_rate                                                      -0.3139      0.7536      
## cover2_rate                                                      -0.0754      0.9399      
## cover3_rate                                                       1.2278      0.2196      
## cover4_rate                                                       0.8926      0.3721      
## cover6_rate                                                      -0.4349      0.6636      
## two_man_rate                                                      1.6897      0.0912     *
## prevent_rate                                                      2.2756      0.0229    **
## roof_outdoors                                                    -0.0073      0.9942      
## posteam_type_home                                                -1.4982      0.1342     .
## offense_formation_EMPTY                                           0.2731      0.7848      
## offense_formation_SHOTGUN                                        -0.2960      0.7672      
## offense_formation_SINGLEBACK                                     -0.8049      0.4209      
## offense_formation_I_FORM                                         -0.8755      0.3814      
## starter_offense_player_1_passing_depth_short_grades_pass_12w      1.7608      0.0784     *
## starter_offense_player_1_passing_depth_medium_grades_pass...     -1.3469      0.1781      
## starter_offense_player_1_passing_depth_deep_grades_pass_12w      -0.8136      0.4159      
## starter_offense_player_4_rushing_grades_first_downs_12w          -0.5293      0.5967      
## starter_offense_player_4_rushing_grades_yards_12w                 0.4648      0.6421      
## starter_offense_player_4_receiving_grades_grades_pass_blo...     -2.6095      0.0091   ***
## starter_offense_player_4_receiving_grades_grades_offense_12w      0.9835      0.3254      
## starter_offense_player_8_receiving_depth_short_grades_pas...      0.3095      0.7569      
## starter_offense_player_8_receiving_depth_medium_grades_pa...      1.6063      0.1083     .
## starter_offense_player_8_receiving_depth_deep_grades_pass...     -0.0078      0.9938      
## starter_offense_player_9_receiving_depth_short_grades_pas...     -1.1447      0.2524      
## starter_offense_player_9_receiving_depth_medium_grades_pa...      1.0302      0.3030      
## starter_offense_player_9_receiving_depth_deep_grades_pass...      0.3355      0.7373      
## starter_offense_player_10_receiving_depth_short_grades_pa...     -1.1398      0.2544      
## starter_offense_player_10_receiving_depth_medium_grades_p...      0.6563      0.5117      
## starter_offense_player_10_receiving_depth_deep_grades_pas...      0.3497      0.7266      
## starter_offense_player_14_receiving_depth_short_grades_pa...      0.7579      0.4486      
## starter_offense_player_14_receiving_depth_medium_grades_p...     -1.9715      0.0487    **
## starter_offense_player_14_receiving_depth_deep_grades_pas...     -0.1797      0.8574      
## starter_offense_player_17_blocking_grades_grades_pass_blo...      1.1795      0.2383      
## starter_offense_player_17_blocking_grades_grades_run_bloc...      0.4898      0.6243      
## starter_offense_player_18_blocking_grades_grades_pass_blo...     -0.7047      0.4811      
## starter_offense_player_18_blocking_grades_grades_run_bloc...     -0.5500      0.5824      
## starter_offense_player_19_blocking_grades_grades_pass_blo...      0.5290      0.5968      
## starter_offense_player_19_blocking_grades_grades_run_bloc...     -1.0594      0.2895      
## starter_offense_player_20_blocking_grades_grades_pass_blo...      1.7875      0.0739     *
## starter_offense_player_20_blocking_grades_grades_run_bloc...     -0.5814      0.5610      
## starter_offense_player_21_blocking_grades_grades_pass_blo...      2.4349      0.0149    **
## starter_offense_player_21_blocking_grades_grades_run_bloc...     -2.5330      0.0114    **
## starter_defense_player_1_defensive_grades_grades_run_defe...      0.1240      0.9013      
## starter_defense_player_1_defensive_grades_grades_pass_rus...      0.1534      0.8781      
## starter_defense_player_2_defensive_grades_grades_run_defe...      2.0552      0.0399    **
## starter_defense_player_2_defensive_grades_grades_pass_rus...     -1.3193      0.1871      
## starter_defense_player_3_defensive_grades_grades_run_defe...     -0.3096      0.7568      
## starter_defense_player_3_defensive_grades_grades_pass_rus...      0.0706      0.9437      
## starter_defense_player_4_defensive_grades_grades_run_defe...      0.8565      0.3918      
## starter_defense_player_4_defensive_grades_grades_pass_rus...     -0.1975      0.8435      
## starter_defense_player_9_defensive_grades_grades_run_defe...      2.0156      0.0439    **
## starter_defense_player_9_defensive_grades_grades_pass_rus...      1.2781      0.2013      
## starter_defense_player_9_coverage_schemes_zone_grades_cov...     -0.9131      0.3613      
## starter_defense_player_9_coverage_schemes_man_grades_cove...     -3.0479      0.0023   ***
## starter_defense_player_10_defensive_grades_grades_run_def...      1.9073      0.0566     *
## starter_defense_player_10_defensive_grades_grades_pass_ru...      1.1288      0.2591      
## starter_defense_player_10_coverage_schemes_zone_grades_co...     -1.0774      0.2814      
## starter_defense_player_10_coverage_schemes_man_grades_cov...     -1.3082      0.1909      
## starter_defense_player_11_defensive_grades_grades_run_def...     -0.3202      0.7488      
## starter_defense_player_11_defensive_grades_grades_pass_ru...      0.2196      0.8262      
## starter_defense_player_11_coverage_schemes_zone_grades_co...     -0.8020      0.4226      
## starter_defense_player_11_coverage_schemes_man_grades_cov...      1.9006      0.0574     *
## starter_defense_player_12_defensive_grades_grades_run_def...     -2.1744      0.0297    **
## starter_defense_player_12_defensive_grades_grades_pass_ru...     -0.6892      0.4907      
## starter_defense_player_12_coverage_schemes_zone_grades_co...      0.2708      0.7866      
## starter_defense_player_12_coverage_schemes_man_grades_cov...      1.8929      0.0585     *
## starter_defense_player_15_defensive_grades_grades_run_def...     -1.1794      0.2383      
## starter_defense_player_15_coverage_schemes_zone_grades_co...      0.6324      0.5271      
## starter_defense_player_15_coverage_schemes_man_grades_cov...     -0.6155      0.5383      
## starter_defense_player_16_defensive_grades_grades_run_def...      2.0581      0.0396    **
## starter_defense_player_16_coverage_schemes_zone_grades_co...     -0.8272      0.4082      
## starter_defense_player_16_coverage_schemes_man_grades_cov...     -1.0429      0.2971      
## starter_defense_player_17_defensive_grades_grades_run_def...     -1.3042      0.1922      
## starter_defense_player_17_coverage_schemes_zone_grades_co...     -0.8568      0.3916      
## starter_defense_player_17_coverage_schemes_man_grades_cov...      1.5524      0.1206     .
## starter_defense_player_20_defensive_grades_grades_run_def...      0.4161      0.6773      
## starter_defense_player_20_coverage_schemes_zone_grades_co...     -0.3622      0.7173      
## starter_defense_player_20_coverage_schemes_man_grades_cov...     -0.4906      0.6238      
## starter_defense_player_21_defensive_grades_grades_run_def...     -0.0409      0.9674      
## starter_defense_player_21_coverage_schemes_zone_grades_co...     -0.7047      0.4810      
## starter_defense_player_21_coverage_schemes_man_grades_cov...     -0.5893      0.5557      
## starter_defense_player_22_defensive_grades_grades_run_def...     -0.3695      0.7118      
## starter_defense_player_22_coverage_schemes_zone_grades_co...      1.7861      0.0742     *
## starter_defense_player_22_coverage_schemes_man_grades_cov...     -0.8986      0.3689      
## yardline_1_10                                                    -2.5337      0.0113    **
## yardline_11_20                                                    0.1887      0.8504      
## yardline_21_30                                                    0.1567      0.8755      
## yardline_41_50                                                    1.8893      0.0589     *
## yardline_51_60                                                    0.6159      0.5380      
## yardline_61_70                                                    1.5567      0.1196     .
## yardline_71_80                                                    1.9302      0.0537     *
## yardline_81_90                                                    2.3219      0.0203    **
## yardline_91_100                                                   1.0162      0.3096      
## year2017_team_ARI                                                 0.3501      0.7262      
## year2017_team_BUF                                                -0.5861      0.5579      
## year2017_team_CHI                                                -0.1850      0.8532      
## year2017_team_CLE                                                 0.4851      0.6276      
## year2017_team_DAL                                                -0.8490      0.3959      
## year2017_team_DET                                                -0.5747      0.5656      
## year2017_team_GB                                                  1.7088      0.0876     *
## year2017_team_HOU                                                 1.7532      0.0796     *
## year2017_team_MIA                                                -1.0463      0.2955      
## year2017_team_MIN                                                -0.8622      0.3886      
## year2017_team_NE                                                 -0.1798      0.8573      
## year2017_team_SF                                                  1.9460      0.0517     *
## year2017_team_BAL                                                -0.1571      0.8752      
## year2017_team_DEN                                                -0.1907      0.8487      
## year2017_team_LA                                                  0.3630      0.7166      
## year2017_team_NYG                                                -0.5340      0.5934      
## year2017_team_OAK                                                 0.0182      0.9855      
## year2017_team_SEA                                                 0.6388      0.5230      
## year2017_team_CAR                                                 0.3124      0.7548      
## year2017_team_CIN                                                 0.2235      0.8232      
## year2017_team_IND                                                 0.8311      0.4059      
## year2017_team_NO                                                  0.3305      0.7411      
## year2017_team_PHI                                                 0.0565      0.9550      
## year2017_team_PIT                                                -1.0056      0.3147      
## year2017_team_TEN                                                -0.0440      0.9649      
## year2017_team_WAS                                                 0.1153      0.9082      
## year2017_team_KC                                                  1.2530      0.2103      
## year2017_team_LAC                                                -0.0985      0.9216      
## year2017_team_NYJ                                                 0.5515      0.5813      
## year2017_team_TB                                                  0.3238      0.7461      
## year2017_team_ATL                                                -0.3251      0.7451      
## year2017_team_JAX                                                 0.6302      0.5286      
## year2018_team_ARI                                                 1.0525      0.2927      
## year2018_team_BAL                                                 0.4660      0.6413      
## year2018_team_CAR                                                 0.3948      0.6930      
## year2018_team_CLE                                                -0.4169      0.6767      
## year2018_team_DET                                                 0.1042      0.9170      
## year2018_team_HOU                                                 0.7857      0.4321      
## year2018_team_IND                                                -1.1431      0.2531      
## year2018_team_KC                                                  0.0998      0.9205      
## year2018_team_NYG                                                 0.1195      0.9049      
## year2018_team_OAK                                                -0.2695      0.7876      
## year2018_team_PHI                                                 0.3683      0.7127      
## year2018_team_SEA                                                -0.4517      0.6515      
## year2018_team_BUF                                                -0.5163      0.6057      
## year2018_team_CHI                                                -0.1173      0.9067      
## year2018_team_CIN                                                -0.7069      0.4797      
## year2018_team_DAL                                                -0.0849      0.9323      
## year2018_team_DEN                                                -0.1169      0.9070      
## year2018_team_GB                                                 -0.2330      0.8158      
## year2018_team_LAC                                                 0.4725      0.6366      
## year2018_team_NE                                                 -0.7141      0.4752      
## year2018_team_NO                                                  0.2803      0.7793      
## year2018_team_PIT                                                 0.1442      0.8853      
## year2018_team_SF                                                  0.3858      0.6997      
## year2018_team_MIA                                                 0.3746      0.7080      
## year2018_team_MIN                                                 0.1916      0.8481      
## year2018_team_NYJ                                                 0.7516      0.4523      
## year2018_team_TB                                                 -0.0047      0.9962      
## year2018_team_ATL                                                 0.1939      0.8463      
## year2018_team_JAX                                                -0.0943      0.9249      
## year2018_team_LA                                                 -1.3168      0.1880      
## year2018_team_TEN                                                 0.8153      0.4149      
## year2018_team_WAS                                                -0.1655      0.8686      
## year2019_team_ARI                                                -0.8211      0.4116      
## year2019_team_BUF                                                -0.8632      0.3881      
## year2019_team_CHI                                                 0.1805      0.8567      
## year2019_team_CLE                                                 0.3722      0.7098      
## year2019_team_DAL                                                -0.3632      0.7165      
## year2019_team_IND                                                -0.5409      0.5886      
## year2019_team_JAX                                                 0.4615      0.6445      
## year2019_team_KC                                                  0.0330      0.9736      
## year2019_team_LAC                                                -0.8426      0.3995      
## year2019_team_MIN                                                -1.0025      0.3162      
## year2019_team_NE                                                 -0.1542      0.8774      
## year2019_team_NO                                                 -1.2721      0.2034      
## year2019_team_PHI                                                 0.4299      0.6673      
## year2019_team_SEA                                                 0.0387      0.9691      
## year2019_team_SF                                                 -0.5261      0.5989      
## year2019_team_TB                                                 -0.9316      0.3516      
## year2019_team_BAL                                                 0.0124      0.9901      
## year2019_team_CAR                                                -0.6741      0.5003      
## year2019_team_DEN                                                 0.8106      0.4176      
## year2019_team_DET                                                -0.6963      0.4863      
## year2019_team_HOU                                                -0.4050      0.6855      
## year2019_team_LA                                                 -1.3609      0.1736      
## year2019_team_MIA                                                -2.0088      0.0446    **
## year2019_team_NYG                                                -1.0271      0.3044      
## year2019_team_NYJ                                                -1.6012      0.1094     .
## year2019_team_OAK                                                -0.0392      0.9688      
## year2019_team_PIT                                                -3.3215      0.0009   ***
## year2019_team_TEN                                                -1.3993      0.1618      
## year2019_team_CIN                                                 0.2866      0.7744      
## year2019_team_WAS                                                -0.4589      0.6463      
## year2019_team_ATL                                                 0.0551      0.9561      
## year2019_team_GB                                                 -0.5578      0.5770      
## year2020_team_ATL                                                 0.6633      0.5072      
## year2020_team_BAL                                                 0.5600      0.5755      
## year2020_team_BUF                                                 0.2068      0.8362      
## year2020_team_CAR                                                 1.1994      0.2305      
## year2020_team_CIN                                                 0.6315      0.5277      
## year2020_team_DEN                                                -0.3112      0.7556      
## year2020_team_DET                                                -0.7017      0.4829      
## year2020_team_JAX                                                -0.6246      0.5323      
## year2020_team_KC                                                  0.1955      0.8450      
## year2020_team_LA                                                 -0.7118      0.4767      
## year2020_team_MIN                                                 1.6561      0.0978     *
## year2020_team_NE                                                  0.2722      0.7855      
## year2020_team_NO                                                  0.2152      0.8296      
## year2020_team_NYG                                                 0.2080      0.8352      
## year2020_team_SF                                                  0.3545      0.7229      
## year2020_team_WAS                                                 0.4379      0.6615      
## year2020_team_CHI                                                 1.0617      0.2884      
## year2020_team_DAL                                                 0.1689      0.8659      
## year2020_team_GB                                                  0.3787      0.7050      
## year2020_team_HOU                                                -0.8401      0.4009      
## year2020_team_MIA                                                -0.6925      0.4886      
## year2020_team_NYJ                                                 0.1512      0.8798      
## year2020_team_TB                                                  0.5413      0.5883      
## year2020_team_TEN                                                -0.3502      0.7262      
## year2020_team_ARI                                                 0.6700      0.5029      
## year2020_team_CLE                                                -1.3856      0.1660      
## year2020_team_IND                                                -0.7551      0.4502      
## year2020_team_LAC                                                 0.1001      0.9203      
## year2020_team_PHI                                                 1.1663      0.2436      
## year2020_team_SEA                                                 0.0558      0.9555      
## year2020_team_LV                                                  0.8304      0.4064      
## year2020_team_PIT                                                -0.7632      0.4454      
## year2021_team_ATL                                                -1.5130      0.1304     .
## year2021_team_BUF                                                 0.0472      0.9623      
## year2021_team_CIN                                                -1.2306      0.2185      
## year2021_team_DAL                                                -0.5629      0.5735      
## year2021_team_DEN                                                 0.1194      0.9050      
## year2021_team_DET                                                -0.7166      0.4736      
## year2021_team_KC                                                  0.6859      0.4928      
## year2021_team_LA                                                 -0.0179      0.9858      
## year2021_team_LV                                                  0.6633      0.5072      
## year2021_team_MIN                                                -0.2851      0.7756      
## year2021_team_NE                                                  0.5933      0.5530      
## year2021_team_NO                                                 -0.0010      0.9992      
## year2021_team_NYG                                                 0.2362      0.8133      
## year2021_team_SF                                                 -0.2968      0.7666      
## year2021_team_TEN                                                -0.1894      0.8498      
## year2021_team_ARI                                                 1.2214      0.2220      
## year2021_team_BAL                                                 0.8023      0.4224      
## year2021_team_CAR                                                 0.1719      0.8635      
## year2021_team_CHI                                                -1.4896      0.1364     .
## year2021_team_GB                                                  0.6434      0.5200      
## year2021_team_IND                                                -0.3476      0.7282      
## year2021_team_LAC                                                 0.3045      0.7608      
## year2021_team_MIA                                                 0.1056      0.9159      
## year2021_team_NYJ                                                -0.2202      0.8258      
## year2021_team_PHI                                                -1.4795      0.1391     .
## year2021_team_SEA                                                -1.4261      0.1539      
## year2021_team_TB                                                  0.2689      0.7881      
## year2021_team_WAS                                                -0.6317      0.5276      
## year2021_team_CLE                                                -0.2155      0.8294      
## year2021_team_HOU                                                -0.3365      0.7365      
## year2021_team_JAX                                                -0.2941      0.7687      
## year2021_team_PIT                                                -0.0268      0.9786      
## year2022_team_ARI                                                -1.1324      0.2576      
## year2022_team_ATL                                                -1.3441      0.1790      
## year2022_team_CAR                                                 0.1409      0.8879      
## year2022_team_CHI                                                -0.0450      0.9641      
## year2022_team_CIN                                                -0.6516      0.5147      
## year2022_team_HOU                                                -0.0987      0.9214      
## year2022_team_IND                                                -0.3569      0.7212      
## year2022_team_LAC                                                -0.7132      0.4758      
## year2022_team_MIA                                                -1.1274      0.2596      
## year2022_team_SEA                                                -0.2772      0.7816      
## year2022_team_TB                                                  0.1304      0.8963      
## year2022_team_TEN                                                 1.9698      0.0489    **
## year2022_team_WAS                                                 0.3638      0.7161      
## year2022_team_BAL                                                -1.3402      0.1803      
## year2022_team_BUF                                                 0.5615      0.5745      
## year2022_team_DAL                                                 0.1525      0.8788      
## year2022_team_DET                                                -0.0068      0.9946      
## year2022_team_GB                                                 -0.9879      0.3232      
## year2022_team_JAX                                                -1.6577      0.0975     *
## year2022_team_KC                                                 -0.4918      0.6229      
## year2022_team_LA                                                  1.0298      0.3032      
## year2022_team_LV                                                  0.8054      0.4206      
## year2022_team_NO                                                 -0.3799      0.7041      
## year2022_team_PHI                                                 0.4461      0.6556      
## year2022_team_PIT                                                 1.0213      0.3072      
## year2022_team_DEN                                                 0.5102      0.6099      
## year2022_team_MIN                                                -0.2862      0.7747      
## year2022_team_NE                                                  0.1046      0.9167      
## year2022_team_NYJ                                                -1.0883      0.2765      
## year2022_team_NYG                                                -0.2394      0.8108      
## year2022_team_SF                                                 -1.1036      0.2698      
## year2023_team_BAL                                                -0.2996      0.7645      
## year2023_team_CHI                                                -1.0460      0.2957      
## year2023_team_CLE                                                -0.8581      0.3909      
## year2023_team_GB                                                 -0.2875      0.7738      
## year2023_team_IND                                                 0.5730      0.5667      
## year2023_team_KC                                                  0.0404      0.9678      
## year2023_team_LAC                                                 0.2022      0.8398      
## year2023_team_LV                                                  0.1149      0.9085      
## year2023_team_MIA                                                 0.1983      0.8428      
## year2023_team_MIN                                                 1.5533      0.1204     .
## year2023_team_NO                                                 -0.9002      0.3681      
## year2023_team_NYG                                                 1.0697      0.2848      
## year2023_team_SEA                                                -2.3955      0.0166    **
## year2023_team_SF                                                 -0.0171      0.9864      
## year2023_team_WAS                                                 1.4241      0.1545      
## year2023_team_ATL                                                -0.7692      0.4418      
## year2023_team_BUF                                                -0.5602      0.5754      
## year2023_team_CAR                                                 0.6622      0.5079      
## year2023_team_DAL                                                 0.7470      0.4551      
## year2023_team_DEN                                                 0.0336      0.9732      
## year2023_team_HOU                                                -0.0034      0.9973      
## year2023_team_LA                                                  0.2748      0.7835      
## year2023_team_NE                                                  0.5921      0.5538      
## year2023_team_PHI                                                -0.5658      0.5716      
## year2023_team_PIT                                                -0.0893      0.9288      
## year2023_team_TEN                                                -0.1751      0.8610      
## year2023_team_ARI                                                -1.2849      0.1989      
## year2023_team_CIN                                                -0.9953      0.3196      
## year2023_team_DET                                                 0.2196      0.8262      
## year2023_team_TB                                                  0.5056      0.6132      
## year2023_team_JAX                                                -0.8398      0.4011      
## year2023_team_NYJ                                                 1.4268      0.1537      
## is_first_half                                                    -0.7873      0.4312      
## time_in_half                                                      1.7821      0.0748     *
## home_attendance                                                  -0.0627      0.9500      
## GIMR                                                              2.0393      0.0415    **
## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15
## 
## Adjusted R-squared: 0.1125358 
## 
## Variables with VIF &gt; 5:
##                                                 prev_shotgun_rate 
##                                                         10.145758 
##                                              prev_singleback_rate 
##                                                          5.897958 
##                                                       cover1_rate 
##                                                          6.262624 
##                                                       cover3_rate 
##                                                          6.643556 
##                                         offense_formation_SHOTGUN 
##                                                          5.657591 
##           starter_offense_player_4_rushing_grades_first_downs_12w 
##                                                         12.691776 
##                 starter_offense_player_4_rushing_grades_yards_12w 
##                                                         12.825308 
## starter_defense_player_20_defensive_grades_grades_run_defense_12w 
##                                                          5.093012 
##                                                   home_attendance 
##                                                         14.119209</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># Compare R-squared values</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>, <span class="fu">paste</span>(<span class="fu">rep</span>(<span class="st">&quot;=&quot;</span>, <span class="dv">80</span>), <span class="at">collapse=</span><span class="st">&quot;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 
##  ================================================================================</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MODEL COMPARISON - Adjusted R-squared values</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## MODEL COMPARISON - Adjusted R-squared values</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="fu">rep</span>(<span class="st">&quot;=&quot;</span>, <span class="dv">80</span>), <span class="at">collapse=</span><span class="st">&quot;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## ================================================================================</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Player Model with GIMR:&quot;</span>, r2_player, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Player Model with GIMR: 0.1084406</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Starter Model with GIMR:&quot;</span>, r2_starter, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Starter Model with GIMR: 0.1125358</code></pre>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIkhlY2ttYW4gU2VsZWN0aW9uIE1vZGVsIEFuYWx5c2lzIg0Kb3V0cHV0OiBodG1sX2RvY3VtZW50DQotLS0NCg0KYGBge3Igb3B0aW9ucywgaW5jbHVkZT1GQUxTRX0NCm9wdGlvbnMobWF4LnByaW50PTEwMDAwKQ0KYGBgDQoNCmBgYHtyfQ0KbGlicmFyeShkYXRhLnRhYmxlKQ0Kb3V0Y29tZV9kYXRhIDwtIGZyZWFkKCJwcmVkaWN0X291dGNvbWUuY3N2Lmd6IikNCnNlbGVjdF9kYXRhIDwtIGZyZWFkKCJwcmVkaWN0X3NlbGVjdC5jc3YuZ3oiKQ0KYGBgDQoNCg0KDQoNCmBgYHtyfQ0Kc2VsZWN0X2RhdGFbLCBhdHRlbXB0IDo9IGFzLm51bWVyaWMoYXMuY2hhcmFjdGVyKGF0dGVtcHQpKV0NCmBgYA0KDQpgYGB7cn0NCmxpYnJhcnkoZGF0YS50YWJsZSkNCmxpYnJhcnkoeGdib29zdCkNCmxpYnJhcnkoUk9DUikNCmxpYnJhcnkocGFyYWxsZWwpDQoNCiMgUHJlcGFyZSB0aGUgWEdCb29zdCBtYXRyaWNlcw0KeHMgPC0gbW9kZWwubWF0cml4KH4gLiAtIDEgLSBhdHRlbXB0IC0gbXlfaWQsIGRhdGEgPSBzZWxlY3RfZGF0YSkNCnkgPC0gYXMubnVtZXJpYyhhcy5jaGFyYWN0ZXIoc2VsZWN0X2RhdGEkYXR0ZW1wdCkpDQoNCg0KIyBDcmVhdGUgcGFyYW1ldGVyIGdyaWQNCg0KIyBDcmVhdGUgcGFyYW1ldGVyIGdyaWQNCmdyaWQgPC0gZXhwYW5kLmdyaWQoDQogIGV0YSA9IHNlcSgwLjAwMSwgMC4wMywgYnkgPSAwLjAxKSwNCiAgbWF4X2RlcHRoID0gc2VxKDUsIDUsIGJ5ID0gMiksDQogIG1pbl9jaGlsZF93ZWlnaHQgPSBzZXEoMSwgMSwgYnkgPSAxKSwgICAgICAgIA0KICBzdWJzYW1wbGUgPSBzZXEoMSwgMSwgYnkgPSAwLjIpLA0KICBjb2xzYW1wbGVfYnl0cmVlID0gc2VxKDEsIDEsIGJ5ID0gMC4yKSwNCiAgbGFtYmRhID0gc2VxKDEsIDEsIGJ5ID0gMSksICAgICAgICAgICAgICAgIA0KICBhbHBoYSA9IHNlcSgwLCAwLCBieSA9IDEpLCAgICAgICAgICAgICAgICAgIA0KICBnYW1tYSA9IHNlcSgwLCAwLCBieSA9IDAuMSksICAgICAgICAgICAgICAgDQogIG5yb3VuZHMgPSBzZXEoMTAwLCAyNTAsIGJ5ID0gNTApDQopDQoNCiMgU2FtcGxlIGdyaWQgcG9pbnRzDQpjb25mX2xldiA8LSAuOTUNCm51bV9tYXggPC0gNQ0KbiA8LSBjZWlsaW5nKGxvZygxLWNvbmZfbGV2KS9sb2coMS1udW1fbWF4L25yb3coZ3JpZCkpKQ0KaW5kIDwtIHNhbXBsZShucm93KGdyaWQpLCBuLCByZXBsYWNlID0gRkFMU0UpDQpyZ3JpZCA8LSBncmlkW2luZCwgXQ0KDQojIFNldCB1cCBwYXJhbGxlbCBwcm9jZXNzaW5nDQpuYyA8LSBkZXRlY3RDb3JlcygpIC0gMQ0KDQojIENhbGN1bGF0ZSBzY2FsZV9wb3Nfd2VpZ2h0IGZvciBpbWJhbGFuY2VkIGRhdGFzZXQNCnNjYWxlX3Bvc193ZWlnaHQgPC0gc3VtKHkgPT0gMCkgLyBzdW0oeSA9PSAxKQ0KDQojIFZhbGlkYXRpb24gcGhhc2UNCiNjYXQoIlxuUGhhc2UgMTogVmFsaWRhdGlvbiBQaGFzZVxuIikNCm5fdmFsaWRhdGlvbnMgPC0gMw0KdmFsaWRhdGlvbl9yZXN1bHRzIDwtIG1hdHJpeChucm93ID0gbnJvdyhyZ3JpZCksIG5jb2wgPSBuX3ZhbGlkYXRpb25zKQ0KDQpmb3IgKGogaW4gMTpucm93KHJncmlkKSkgew0KICAjY2F0KCJcblRlc3RpbmcgcGFyYW1ldGVyIHNldCIsIGosICJvZiIsIG5yb3cocmdyaWQpLCAiXG4iKQ0KICANCiAgZm9yIChpIGluIDE6bl92YWxpZGF0aW9ucykgew0KICAgICNjYXQoIlxuVmFsaWRhdGlvbiBpdGVyYXRpb24iLCBpLCAib2YiLCBuX3ZhbGlkYXRpb25zLCAiXG4iKSAgICAgICAgICAgICANCiAgICAjIENyZWF0ZSB2YWxpZGF0aW9uIHNwbGl0DQogICAgaWR4IDwtIHVuaXF1ZShzYW1wbGUobnJvdyh4cyksIG5yb3coeHMpLCBUUlVFKSkNCiAgICB0cmFpbl94IDwtIHhzW2lkeCwgXQ0KICAgIHRyYWluX3kgPC0geVtpZHhdDQogICAgdmFsX3ggPC0geHNbLWlkeCwgXQ0KICAgIHZhbF95IDwtIHlbLWlkeF0NCiAgICANCiAgICBwcm0gPC0gbGlzdCgNCiAgICAgIGJvb3N0ZXIgPSAiZ2J0cmVlIiwNCiAgICAgIG9iamVjdGl2ZSA9ICJiaW5hcnk6bG9naXN0aWMiLA0KICAgICAgbWF4X2RlcHRoID0gcmdyaWRbaiwgIm1heF9kZXB0aCJdLA0KICAgICAgZXRhID0gcmdyaWRbaiwgImV0YSJdLA0KICAgICAgc3Vic2FtcGxlID0gcmdyaWRbaiwgInN1YnNhbXBsZSJdLA0KICAgICAgY29sc2FtcGxlX2J5dHJlZSA9IHJncmlkW2osICJjb2xzYW1wbGVfYnl0cmVlIl0sDQogICAgICBnYW1tYSA9IHJncmlkW2osICJnYW1tYSJdLA0KICAgICAgbWluX2NoaWxkX3dlaWdodCA9IHJncmlkW2osICJtaW5fY2hpbGRfd2VpZ2h0Il0sDQogICAgICBhbHBoYSA9IHJncmlkW2osICJhbHBoYSJdLA0KICAgICAgbGFtYmRhID0gcmdyaWRbaiwgImxhbWJkYSJdLA0KICAgICAgc2NhbGVfcG9zX3dlaWdodCA9IHNjYWxlX3Bvc193ZWlnaHQsDQogICAgICBudGhyZWFkID0gbmMNCiAgICApDQogICAgDQogICAgZG1fdHJhaW4gPC0geGdiLkRNYXRyaXgoZGF0YSA9IHRyYWluX3gsIGxhYmVsID0gdHJhaW5feSkNCiAgICBtZGwgPC0geGdiLnRyYWluKA0KICAgICAgcGFyYW1zID0gcHJtLA0KICAgICAgZGF0YSA9IGRtX3RyYWluLA0KICAgICAgbnJvdW5kcyA9IHJncmlkW2osICJucm91bmRzIl0sDQogICAgICB2ZXJib3NlID0gRkFMU0UNCiAgICApDQogICAgDQogICAgcCA8LSBwcmVkaWN0KG1kbCwgeGdiLkRNYXRyaXgoZGF0YSA9IHZhbF94KSkNCiAgICBwcmVkIDwtIHByZWRpY3Rpb24ocCwgdmFsX3kpDQogICAgdmFsaWRhdGlvbl9yZXN1bHRzW2osIGldIDwtIHBlcmZvcm1hbmNlKHByZWQsICJhdWMiKUB5LnZhbHVlc1tbMV1dDQogIH0NCn0NCg0KIyBSdW4gMTAwIHRlc3RzIHdpdGggYmVzdCBwYXJhbWV0ZXJzDQpjYXQoIlxuUnVubmluZyBYIHRlc3QgaXRlcmF0aW9ucyB3aXRoIGJlc3QgcGFyYW1ldGVycy4uLlxuIikNCnRlc3RfYXVjcyA8LSBjKCkNCg0KYmVzdF9wYXJhbXNfaWR4IDwtIHdoaWNoLm1heChyb3dNZWFucyh2YWxpZGF0aW9uX3Jlc3VsdHMpKQ0KYmVzdF9wYXJhbXMgPC0gcmdyaWRbYmVzdF9wYXJhbXNfaWR4LF0NCg0KIyBUcmFpbiBmaW5hbCBtb2RlbCB3aXRoIGJlc3QgcGFyYW1ldGVycw0KYmVzdF9wYXJhbXNfbGlzdCA8LSBhcy5saXN0KGJlc3RfcGFyYW1zWy13aGljaChuYW1lcyhiZXN0X3BhcmFtcykgPT0gIm5yb3VuZHMiKV0pDQpiZXN0X3BhcmFtc19saXN0JGJvb3N0ZXIgPC0gImdidHJlZSINCmJlc3RfcGFyYW1zX2xpc3Qkb2JqZWN0aXZlIDwtICJiaW5hcnk6bG9naXN0aWMiDQpiZXN0X3BhcmFtc19saXN0JHNjYWxlX3Bvc193ZWlnaHQgPC0gc2NhbGVfcG9zX3dlaWdodA0KYmVzdF9wYXJhbXNfbGlzdCRudGhyZWFkIDwtIG5jDQoNCmZvcihpIGluIDE6MTAwKSB7DQogICMgQ3JlYXRlIHRlc3Qgc3BsaXQNCiAgaWR4IDwtIHVuaXF1ZShzYW1wbGUobnJvdyh4cyksIG5yb3coeHMpLCBUKSkNCiAgdHJhaW5feCA8LSB4c1tpZHgsIF0NCiAgdHJhaW5feSA8LSB5W2lkeF0NCiAgdGVzdF94IDwtIHhzWy1pZHgsIF0NCiAgdGVzdF95IDwtIHlbLWlkeF0NCiAgDQogICMgVHJhaW4gbW9kZWwgb24gZnVsbCB1bmJhbGFuY2VkIGRhdGFzZXQNCiAgZG1fdHJhaW4gPC0geGdiLkRNYXRyaXgoZGF0YSA9IHRyYWluX3gsIGxhYmVsID0gdHJhaW5feSkNCiAgbWRsIDwtIHhnYi50cmFpbigNCiAgICBwYXJhbXMgPSBiZXN0X3BhcmFtc19saXN0LA0KICAgIGRhdGEgPSBkbV90cmFpbiwNCiAgICBucm91bmRzID0gYmVzdF9wYXJhbXNbWyJucm91bmRzIl1dLA0KICAgIHZlcmJvc2UgPSBGQUxTRQ0KICApDQogIA0KICAjIFRlc3Qgb24gdW5iYWxhbmNlZCB0ZXN0IHNldA0KICBwIDwtIHByZWRpY3QobWRsLCB4Z2IuRE1hdHJpeChkYXRhID0gdGVzdF94KSkNCiAgcHJlZCA8LSBwcmVkaWN0aW9uKHAsIHRlc3RfeSkNCiAgdGVzdF9hdWNzW2ldIDwtIHBlcmZvcm1hbmNlKHByZWQsICJhdWMiKUB5LnZhbHVlc1tbMV1dDQp9DQojIFByaW50IHJlc3VsdHMNCmNhdCgiXG5UZXN0IFJlc3VsdHMgb3ZlciAxMDAgaXRlcmF0aW9uczpcbiIpDQpjYXQoIk1lYW4gQVVDOiIsIG1lYW4odGVzdF9hdWNzKSwgIlxuIikNCmNhdCgiU0QgQVVDOiIsIHNkKHRlc3RfYXVjcyksICJcbiIpDQpjYXQoIjk1JSBDSToiLCBtZWFuKHRlc3RfYXVjcykgLSAxLjk2ICogc2QodGVzdF9hdWNzKSwgDQogICAgInRvIiwgbWVhbih0ZXN0X2F1Y3MpICsgMS45NiAqIHNkKHRlc3RfYXVjcyksICJcbiIpDQoNCiMgUGxvdHRpbmcgQVVDIGRpc3RyaWJ1dGlvbg0KcGxvdCh0ZXN0X2F1Y3MsIGNvbD0icmVkIiwgcGNoPTIwLA0KICAgICBtYWluPSJBVUMgVGVzdCBEaXN0cmlidXRpb24iLA0KICAgICB4bGFiPSJJdGVyYXRpb24iLCB5bGFiPSJBVUMiKQ0KYWJsaW5lKGg9bWVhbih0ZXN0X2F1Y3MpLCBjb2w9ImJsdWUiLCBsd2Q9MiwgbHR5PTIpICAjIEFkZCB0aGlzIGxpbmUgdG8gc2hvdyBtZWFuDQphYmxpbmUoaD1tZWFuKHRlc3RfYXVjcykgLSAxLjk2ICogc2QodGVzdF9hdWNzKSwgY29sPSJncmVlbiIsIGx3ZD0yLCBsdHk9MykNCmFibGluZShoPW1lYW4odGVzdF9hdWNzKSArIDEuOTYgKiBzZCh0ZXN0X2F1Y3MpLCBjb2w9ImdyZWVuIiwgbHdkPTIsIGx0eT0zKQ0KbGVnZW5kKCJib3R0b21yaWdodCIsIA0KICAgICAgIGxlZ2VuZD1jKCJBVUMgVmFsdWVzIiwgIk1lYW4iLCAiOTUlIENJIEJvdW5kcyIpLA0KICAgICAgIGNvbD1jKCJyZWQiLCAiYmx1ZSIsICJncmVlbiIpLA0KICAgICAgIGx0eT1jKE5BLCAyLCAzKSwNCiAgICAgICBwY2g9YygyMCwgTkEsIE5BKSkNCg0KIyBOb3cgdHJhaW4gZmluYWwgbW9kZWwgb24gZnVsbCBkYXRhIGZvciB6IHNjb3Jlcw0KZG1fZnVsbCA8LSB4Z2IuRE1hdHJpeChkYXRhID0geHMsIGxhYmVsID0geSkNCmZpbmFsX21vZGVsIDwtIHhnYi50cmFpbigNCiAgcGFyYW1zID0gYmVzdF9wYXJhbXNfbGlzdCwNCiAgZGF0YSA9IGRtX2Z1bGwsDQogIG5yb3VuZHMgPSBiZXN0X3BhcmFtc1tbIm5yb3VuZHMiXV0sDQogIHZlcmJvc2UgPSBGQUxTRQ0KKQ0KDQojIEdldCBwcm9iYWJpbGl0eSBwcmVkaWN0aW9ucyAoeikgZm9yIEFMTCBkYXRhDQp6IDwtIHByZWRpY3QoZmluYWxfbW9kZWwsIHhnYi5ETWF0cml4KGRhdGEgPSB4cykpDQpgYGANCg0KDQpgYGB7cn0NCiMgQ2FsY3VsYXRlIHJlc2lkdWFscyBmb3IgWEdCb29zdCBwcmVkaWN0aW9ucw0KeSA8LSBhcy5udW1lcmljKGFzLmNoYXJhY3RlcihzZWxlY3RfZGF0YSRhdHRlbXB0KSkNCnJlc2lkdWFscyA8LSB5IC0geg0KDQojIEhpc3RvZ3JhbSBvZiByZXNpZHVhbHMNCmhpc3QocmVzaWR1YWxzLCBtYWluPSJEaXN0cmlidXRpb24gb2YgWEdCb29zdCBNb2RlbCBSZXNpZHVhbHMiLCB4bGFiPSJSZXNpZHVhbCIsIGJyZWFrcz0xMDApDQpgYGANCg0KYGBge3J9DQojIHBsb3Qgb3V0IHRoZSB6IHZhbHVlc1wNCnBsb3QoZGVuc2l0eSh6KSwgDQogICAgIG1haW4gPSAiRGVuc2l0eSBvZiBaIFByZWRpY3Rpb25zIiwNCiAgICAgeGxhYiA9ICJQcmVkaWN0ZWQgUHJvYmFiaWxpdHkgb2YgQXR0ZW1wdCIsDQogICAgIHlsYWIgPSAiRGVuc2l0eSIpDQpgYGANCg0KYGBge3J9DQojIENhbGN1bGF0ZSBHSU1SIChsYW1iZGEpIFRoaXMgaXMgR2VuZXJhbGl6ZWQgaW52ZXJzZSBtaWxscyByYXRpbw0KR0lNUiA8LSBkbm9ybShxbm9ybSh6KSkgLyAoMSAtIHBub3JtKHFub3JtKHopKSkNCg0KIyBBZGQgR0lNUiB0byB0aGUgZGF0YQ0Kc2VsZWN0X2RhdGFbLCBHSU1SIDo9IEdJTVJdDQoNCiMgUHJpbnQgdmFyaWFibGUgaW1wb3J0YQ0KYGBgDQoNCmBgYHtyfQ0KIyBDcmVhdGUgYSBkYXRhLnRhYmxlIHdpdGgganVzdCBteV9pZCBhbmQgR0lNUiBmcm9tIHNlbGVjdF9kYXRhDQpHSU1SX2R0IDwtIGRhdGEudGFibGUobXlfaWQgPSBzZWxlY3RfZGF0YSRteV9pZCwgR0lNUiA9IEdJTVIpDQoNCiMgQWRkIEdJTVIgdG8gb3V0Y29tZV9kYXRhIGJ5IG1hdGNoaW5nIG9uIG15X2lkDQpvdXRjb21lX2RhdGFbR0lNUl9kdCwgR0lNUiA6PSBpLkdJTVIsIG9uID0gIm15X2lkIl0NCmBgYA0KDQpgYGB7cn0NCiMgIyBFeGlzdGluZyBjb2RlDQojIG91dGNvbWVfZGF0YSA8LSBvdXRjb21lX2RhdGFbLCBteV9pZCA6PSBOVUxMXQ0KIyBvdXRjb21lX2RhdGFbLCB5YXJkbGluZV8zMV80MCA6PSBOVUxMXQ0KIyBvdXRjb21lX2RhdGFbLCB5ZWFyMjAyMl90ZWFtX0NMRSA6PSBOVUxMXSAjIHRpZWQgZm9yIG1vc3QgYXR0ZW1wdHMgd2l0aCAzMQ0KDQojIFJlbW92ZSBhbGwgY29sdW1ucyB3aXRoICJfcHJlc2VudCIgaW4gdGhlIG5hbWUNCnByZXNlbnRfY29scyA8LSBncmVwKCJfcHJlc2VudCIsIG5hbWVzKG91dGNvbWVfZGF0YSksIHZhbHVlID0gVFJVRSkNCmZvciAoY29sIGluIHByZXNlbnRfY29scykgew0KICBvdXRjb21lX2RhdGFbLCAoY29sKSA6PSBOVUxMXQ0KfQ0KYGBgDQoNCg0KYGBge3J9DQoNCiMgQ3JlYXRlIGNvcGllcyBvZiBvdXRjb21lX2RhdGEgZm9yIGRpZmZlcmVudCBtb2RlbHMNCm91dGNvbWVfZGF0YV9wbGF5ZXIgPC0gY29weShvdXRjb21lX2RhdGEpDQpvdXRjb21lX2RhdGFfc3RhcnRlciA8LSBjb3B5KG91dGNvbWVfZGF0YSkNCg0KIyBSZW1vdmUgc3BlY2lmaWMgY29sdW1ucyBhcyBpbiBvcmlnaW5hbCBjb2RlDQpmb3IgKGR0IGluIGxpc3Qob3V0Y29tZV9kYXRhX3BsYXllciwgb3V0Y29tZV9kYXRhX3N0YXJ0ZXIpKSB7DQogIGR0WywgbXlfaWQgOj0gTlVMTF0NCiAgZHRbLCB5YXJkbGluZV8zMV80MCA6PSBOVUxMXQ0KICBkdFssIHllYXIyMDIyX3RlYW1fQ0xFIDo9IE5VTExdICMgdGllZCBmb3IgbW9zdCBhdHRlbXB0cyB3aXRoIDMxDQogIA0KICAjIFJlbW92ZSBhdHRlbmRhbmNlIHZhcmlhYmxlcw0KICBkdFssIGF0dGVuZGFuY2VfcGN0IDo9IE5VTExdDQogIGR0WywgYXR0ZW5kYW5jZV9yYXcgOj0gTlVMTF0NCiAgZHRbLCB2ZWdhc193cF9wb3N0ZWFtIDo9IE5VTExdDQp9DQoNCiMgRm9yIHBsYXllciBtb2RlbHMsIHJlbW92ZSBzdGFydGVyIGNvbHVtbnMNCnBsYXllcl9jb2xzIDwtIGdyZXAoIl5zdGFydGVyXyIsIG5hbWVzKG91dGNvbWVfZGF0YV9wbGF5ZXIpLCB2YWx1ZSA9IFRSVUUpDQpmb3IgKGNvbCBpbiBwbGF5ZXJfY29scykgew0KICBvdXRjb21lX2RhdGFfcGxheWVyWywgKGNvbCkgOj0gTlVMTF0NCn0NCg0KIyBGb3Igc3RhcnRlciBtb2RlbHMsIHJlbW92ZSBwbGF5ZXIgY29sdW1ucw0Kc3RhcnRlcl9jb2xzIDwtIGdyZXAoIl4ob2ZmZW5zZXxkZWZlbnNlKV9wbGF5ZXJfIiwgbmFtZXMob3V0Y29tZV9kYXRhX3N0YXJ0ZXIpLCB2YWx1ZSA9IFRSVUUpDQpmb3IgKGNvbCBpbiBzdGFydGVyX2NvbHMpIHsNCiAgb3V0Y29tZV9kYXRhX3N0YXJ0ZXJbLCAoY29sKSA6PSBOVUxMXQ0KfQ0KDQojIEVuc3VyZSBjb252ZXJzaW9uIGlzIG51bWVyaWMNCmZvciAoZHQgaW4gbGlzdChvdXRjb21lX2RhdGFfcGxheWVyLCBvdXRjb21lX2RhdGFfc3RhcnRlcikpIHsNCiAgZHRbLCBjb252ZXJzaW9uIDo9IGFzLm51bWVyaWMoYXMuY2hhcmFjdGVyKGNvbnZlcnNpb24pKV0NCn0NCg0KIyBNT0RFTCAxOiBQbGF5ZXIgbW9kZWwgd2l0aCBHSU1SDQpvbHNfbW9kZWxfcGxheWVyIDwtIGxtKGNvbnZlcnNpb24gfiAuLCBkYXRhID0gb3V0Y29tZV9kYXRhX3BsYXllcikNCg0KIyBNT0RFTCAyOiBTdGFydGVyIG1vZGVsIHdpdGggR0lNUg0Kb2xzX21vZGVsX3N0YXJ0ZXIgPC0gbG0oY29udmVyc2lvbiB+IC4sIGRhdGEgPSBvdXRjb21lX2RhdGFfc3RhcnRlcikNCg0KIyBGdW5jdGlvbiB0byBhbmFseXplIGFuZCBwcmludCBtb2RlbCByZXN1bHRzDQphbmFseXplX21vZGVsIDwtIGZ1bmN0aW9uKG1vZGVsLCBtb2RlbF9uYW1lKSB7DQogIGxpYnJhcnkoc2FuZHdpY2gpDQogIGxpYnJhcnkobG10ZXN0KQ0KICANCiAgIyBHZXQgSEMwLWFkanVzdGVkIHQtdmFsdWVzIGFuZCBwLXZhbHVlcw0KICByb2J1c3RfdGVzdCA8LSBjb2VmdGVzdChtb2RlbCwgdmNvdiA9IHZjb3ZIQyhtb2RlbCwgdHlwZSA9ICJIQzAiKSkNCiAgdF9zdGF0cyA8LSByb2J1c3RfdGVzdFssICJ0IHZhbHVlIl0NCiAgcF92YWx1ZXMgPC0gcm9idXN0X3Rlc3RbLCAiUHIoPnx0fCkiXQ0KICANCiAgIyBGdW5jdGlvbiB0byBhZGQgc2lnbmlmaWNhbmNlIHN0YXJzDQogIGdldF9zdGFycyA8LSBmdW5jdGlvbihwKSB7DQogICAgaWYgKHAgPD0gMC4wMSkgcmV0dXJuKCIqKioiKQ0KICAgIGlmIChwIDw9IDAuMDUpIHJldHVybigiKioiKQ0KICAgIGlmIChwIDw9IDAuMSkgcmV0dXJuKCIqIikNCiAgICBpZiAocCA8PSAwLjE1KSByZXR1cm4oIi4iKQ0KICAgIHJldHVybigiIikNCiAgfQ0KICANCiAgIyBNYXhpbXVtIHdpZHRoIGZvciB2YXJpYWJsZSBuYW1lcw0KICBuYW1lX3dpZHRoIDwtIDYwDQogIA0KICAjIFByaW50IG1vZGVsIG5hbWUgYW5kIGhlYWRlcg0KICBjYXQoIlxuXG4iLCBwYXN0ZShyZXAoIj0iLCA4MCksIGNvbGxhcHNlPSIiKSwgIlxuIikNCiAgY2F0KCJNT0RFTDoiLCBtb2RlbF9uYW1lLCAiXG4iKQ0KICBjYXQocGFzdGUocmVwKCI9IiwgODApLCBjb2xsYXBzZT0iIiksICJcblxuIikNCiAgDQogICMgUHJpbnQgaGVhZGVyIHdpdGggYWxpZ25tZW50DQogIGNhdChzcHJpbnRmKCIlLSpzICAlMTBzICAlMTBzICAlNHNcbiIsIG5hbWVfd2lkdGgsICJWYXJpYWJsZSIsICJ0LXZhbHVlIiwgInAtdmFsdWUiLCAic2lnIikpDQogIGNhdChzcHJpbnRmKCIlLSpzICAlMTBzICAlMTBzICAlNHNcbiIsIG5hbWVfd2lkdGgsICItLS0tLS0tLS0iLCAiLS0tLS0tLSIsICItLS0tLS0tIiwgIi0tLS0iKSkNCiAgDQogICMgTG9vcCB0aHJvdWdoIGFuZCBwcmludCB2YWx1ZXMNCiAgZm9yIChpIGluIDE6bGVuZ3RoKHRfc3RhdHMpKSB7DQogICAgdmFyX25hbWUgPC0gcm93bmFtZXMocm9idXN0X3Rlc3QpW2ldDQogICAgIyBUcnVuY2F0ZSBuYW1lIGlmIHRvbyBsb25nDQogICAgaWYgKG5jaGFyKHZhcl9uYW1lKSA+IG5hbWVfd2lkdGgpIHsNCiAgICAgIHZhcl9uYW1lIDwtIHBhc3RlMChzdWJzdHIodmFyX25hbWUsIDEsIG5hbWVfd2lkdGgtMyksICIuLi4iKQ0KICAgIH0NCiAgICBjYXQoc3ByaW50ZigiJS0qcyAgJTEwLjRmICAlMTAuNGYgICU0c1xuIiwgDQogICAgICAgICAgICAgICAgbmFtZV93aWR0aCwgdmFyX25hbWUsIA0KICAgICAgICAgICAgICAgIHRfc3RhdHNbaV0sIHBfdmFsdWVzW2ldLA0KICAgICAgICAgICAgICAgIGdldF9zdGFycyhwX3ZhbHVlc1tpXSkpKQ0KICB9DQogIA0KICBjYXQoIlxuU2lnbmlmaWNhbmNlIGNvZGVzOiAwICcqKionIDAuMDEgJyoqJyAwLjA1ICcqJyAwLjEgJy4nIDAuMTVcbiIpDQogIA0KICAjIFByaW50IFItc3F1YXJlZA0KICByX3NxdWFyZWQgPC0gc3VtbWFyeShtb2RlbCkkYWRqLnIuc3F1YXJlZA0KICBjYXQoIlxuQWRqdXN0ZWQgUi1zcXVhcmVkOiIsIHJfc3F1YXJlZCwgIlxuIikNCiAgDQogICMgQ2FsY3VsYXRlIFZJRnMNCiAgbGlicmFyeShjYXIpDQogIHZpZnMgPC0gdmlmKG1vZGVsKQ0KICANCiAgIyBGaWx0ZXIgdG8gc2hvdyBvbmx5IFZJRnMgb3ZlciA1DQogIGhpZ2hfdmlmcyA8LSB2aWZzW3ZpZnMgPiA1XQ0KICBpZihsZW5ndGgoaGlnaF92aWZzKSA+IDApIHsNCiAgICBjYXQoIlxuVmFyaWFibGVzIHdpdGggVklGID4gNTpcbiIpDQogICAgcHJpbnQoaGlnaF92aWZzKQ0KICB9IGVsc2Ugew0KICAgIGNhdCgiXG5ObyB2YXJpYWJsZXMgd2l0aCBWSUYgPiA1IGZvdW5kIGluIHRoaXMgbW9kZWxcbiIpDQogIH0NCiAgDQogIHJldHVybihyX3NxdWFyZWQpDQp9DQoNCiMgQW5hbHl6ZSBtb2RlbHMgd2l0aCBHSU1SIG9ubHkNCnIyX3BsYXllciA8LSBhbmFseXplX21vZGVsKG9sc19tb2RlbF9wbGF5ZXIsICJQbGF5ZXIgTW9kZWwgd2l0aCBHSU1SIikNCnIyX3N0YXJ0ZXIgPC0gYW5hbHl6ZV9tb2RlbChvbHNfbW9kZWxfc3RhcnRlciwgIlN0YXJ0ZXIgTW9kZWwgd2l0aCBHSU1SIikNCg0KIyBDb21wYXJlIFItc3F1YXJlZCB2YWx1ZXMNCmNhdCgiXG5cbiIsIHBhc3RlKHJlcCgiPSIsIDgwKSwgY29sbGFwc2U9IiIpLCAiXG4iKQ0KY2F0KCJNT0RFTCBDT01QQVJJU09OIC0gQWRqdXN0ZWQgUi1zcXVhcmVkIHZhbHVlc1xuIikNCmNhdChwYXN0ZShyZXAoIj0iLCA4MCksIGNvbGxhcHNlPSIiKSwgIlxuXG4iKQ0KY2F0KCJQbGF5ZXIgTW9kZWwgd2l0aCBHSU1SOiIsIHIyX3BsYXllciwgIlxuIikNCmNhdCgiU3RhcnRlciBNb2RlbCB3aXRoIEdJTVI6IiwgcjJfc3RhcnRlciwgIlxuIikNCg0KYGBgDQoNCg==</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("heckman.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
