<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Heckman Selection Model Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">4th Downs in the NFL</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="heckman.html">Heckman Selection</a>
</li>
<li>
  <a href="xgboost.html">XGBoost Prediction</a>
</li>
<li>
  <a href="attendance_binary.html">Attendance Impact Binary</a>
</li>
<li>
  <a href="thirddown.html">Third Down Analysis</a>
</li>
<li>
  <a href="attempt_ols.html">Attempts OLS</a>
</li>
<li>
  <a href="robustness_checks.html">Robustness Checks</a>
</li>
<li>
  <a href="Writing.html">Writing</a>
</li>
<li>
  <a href="kicker_exogenous.html">Proof of Exogeniety</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Heckman Selection Model Analysis</h1>

</div>


<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>outcome_data <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">&quot;predict_outcome.csv.gz&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>select_data <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">&quot;predict_select.csv.gz&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>select_data[, score_diff <span class="sc">:=</span> <span class="fu">as.integer</span>(score_diff <span class="sc">&gt;</span> <span class="dv">0</span>)]</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>select_data[, attempt <span class="sc">:=</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(attempt))]</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co"># Prepare the XGBoost matrices</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> . <span class="sc">-</span> <span class="dv">1</span> <span class="sc">-</span> attempt <span class="sc">-</span> my_id, <span class="at">data =</span> select_data)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(select_data<span class="sc">$</span>attempt))</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co"># Create parameter grid</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co"># Create parameter grid</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  <span class="at">eta =</span> <span class="fu">seq</span>(<span class="fl">0.001</span>, <span class="fl">0.03</span>, <span class="at">by =</span> <span class="fl">0.01</span>),</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>  <span class="at">max_depth =</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>  <span class="at">min_child_weight =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="dv">1</span>),        </span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>  <span class="at">subsample =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.2</span>),</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>  <span class="at">colsample_bytree =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.2</span>),</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="dv">1</span>),                </span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">by =</span> <span class="dv">1</span>),                  </span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>  <span class="at">gamma =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">by =</span> <span class="fl">0.1</span>),               </span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>  <span class="at">nrounds =</span> <span class="fu">seq</span>(<span class="dv">100</span>, <span class="dv">250</span>, <span class="at">by =</span> <span class="dv">50</span>)</span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>)</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co"># Sample grid points</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a>conf_lev <span class="ot">&lt;-</span> .<span class="dv">95</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>num_max <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>conf_lev)<span class="sc">/</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>num_max<span class="sc">/</span><span class="fu">nrow</span>(grid)))</span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(grid), n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a>rgrid <span class="ot">&lt;-</span> grid[ind, ]</span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a><span class="co"># Set up parallel processing</span></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a>nc <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a></span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a><span class="co"># Calculate scale_pos_weight for imbalanced dataset</span></span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a>scale_pos_weight <span class="ot">&lt;-</span> <span class="fu">sum</span>(y <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">/</span> <span class="fu">sum</span>(y <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a></span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a><span class="co"># Validation phase</span></span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a><span class="co">#cat(&quot;\nPhase 1: Validation Phase\n&quot;)</span></span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a>n_validations <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a>validation_results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">nrow</span>(rgrid), <span class="at">ncol =</span> n_validations)</span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a></span>
<span id="cb4-44"><a href="#cb4-44" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(rgrid)) {</span>
<span id="cb4-45"><a href="#cb4-45" tabindex="-1"></a>  <span class="co">#cat(&quot;\nTesting parameter set&quot;, j, &quot;of&quot;, nrow(rgrid), &quot;\n&quot;)</span></span>
<span id="cb4-46"><a href="#cb4-46" tabindex="-1"></a>  </span>
<span id="cb4-47"><a href="#cb4-47" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_validations) {</span>
<span id="cb4-48"><a href="#cb4-48" tabindex="-1"></a>    <span class="co">#cat(&quot;\nValidation iteration&quot;, i, &quot;of&quot;, n_validations, &quot;\n&quot;)             </span></span>
<span id="cb4-49"><a href="#cb4-49" tabindex="-1"></a>    <span class="co"># Create validation split</span></span>
<span id="cb4-50"><a href="#cb4-50" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(xs), <span class="fu">nrow</span>(xs), <span class="cn">TRUE</span>))</span>
<span id="cb4-51"><a href="#cb4-51" tabindex="-1"></a>    train_x <span class="ot">&lt;-</span> xs[idx, ]</span>
<span id="cb4-52"><a href="#cb4-52" tabindex="-1"></a>    train_y <span class="ot">&lt;-</span> y[idx]</span>
<span id="cb4-53"><a href="#cb4-53" tabindex="-1"></a>    val_x <span class="ot">&lt;-</span> xs[<span class="sc">-</span>idx, ]</span>
<span id="cb4-54"><a href="#cb4-54" tabindex="-1"></a>    val_y <span class="ot">&lt;-</span> y[<span class="sc">-</span>idx]</span>
<span id="cb4-55"><a href="#cb4-55" tabindex="-1"></a>    </span>
<span id="cb4-56"><a href="#cb4-56" tabindex="-1"></a>    prm <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb4-57"><a href="#cb4-57" tabindex="-1"></a>      <span class="at">booster =</span> <span class="st">&quot;gbtree&quot;</span>,</span>
<span id="cb4-58"><a href="#cb4-58" tabindex="-1"></a>      <span class="at">objective =</span> <span class="st">&quot;binary:logistic&quot;</span>,</span>
<span id="cb4-59"><a href="#cb4-59" tabindex="-1"></a>      <span class="at">max_depth =</span> rgrid[j, <span class="st">&quot;max_depth&quot;</span>],</span>
<span id="cb4-60"><a href="#cb4-60" tabindex="-1"></a>      <span class="at">eta =</span> rgrid[j, <span class="st">&quot;eta&quot;</span>],</span>
<span id="cb4-61"><a href="#cb4-61" tabindex="-1"></a>      <span class="at">subsample =</span> rgrid[j, <span class="st">&quot;subsample&quot;</span>],</span>
<span id="cb4-62"><a href="#cb4-62" tabindex="-1"></a>      <span class="at">colsample_bytree =</span> rgrid[j, <span class="st">&quot;colsample_bytree&quot;</span>],</span>
<span id="cb4-63"><a href="#cb4-63" tabindex="-1"></a>      <span class="at">gamma =</span> rgrid[j, <span class="st">&quot;gamma&quot;</span>],</span>
<span id="cb4-64"><a href="#cb4-64" tabindex="-1"></a>      <span class="at">min_child_weight =</span> rgrid[j, <span class="st">&quot;min_child_weight&quot;</span>],</span>
<span id="cb4-65"><a href="#cb4-65" tabindex="-1"></a>      <span class="at">alpha =</span> rgrid[j, <span class="st">&quot;alpha&quot;</span>],</span>
<span id="cb4-66"><a href="#cb4-66" tabindex="-1"></a>      <span class="at">lambda =</span> rgrid[j, <span class="st">&quot;lambda&quot;</span>],</span>
<span id="cb4-67"><a href="#cb4-67" tabindex="-1"></a>      <span class="at">scale_pos_weight =</span> scale_pos_weight,</span>
<span id="cb4-68"><a href="#cb4-68" tabindex="-1"></a>      <span class="at">nthread =</span> nc</span>
<span id="cb4-69"><a href="#cb4-69" tabindex="-1"></a>    )</span>
<span id="cb4-70"><a href="#cb4-70" tabindex="-1"></a>    </span>
<span id="cb4-71"><a href="#cb4-71" tabindex="-1"></a>    dm_train <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> train_x, <span class="at">label =</span> train_y)</span>
<span id="cb4-72"><a href="#cb4-72" tabindex="-1"></a>    mdl <span class="ot">&lt;-</span> <span class="fu">xgb.train</span>(</span>
<span id="cb4-73"><a href="#cb4-73" tabindex="-1"></a>      <span class="at">params =</span> prm,</span>
<span id="cb4-74"><a href="#cb4-74" tabindex="-1"></a>      <span class="at">data =</span> dm_train,</span>
<span id="cb4-75"><a href="#cb4-75" tabindex="-1"></a>      <span class="at">nrounds =</span> rgrid[j, <span class="st">&quot;nrounds&quot;</span>],</span>
<span id="cb4-76"><a href="#cb4-76" tabindex="-1"></a>      <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb4-77"><a href="#cb4-77" tabindex="-1"></a>    )</span>
<span id="cb4-78"><a href="#cb4-78" tabindex="-1"></a>    </span>
<span id="cb4-79"><a href="#cb4-79" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">predict</span>(mdl, <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> val_x))</span>
<span id="cb4-80"><a href="#cb4-80" tabindex="-1"></a>    pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(p, val_y)</span>
<span id="cb4-81"><a href="#cb4-81" tabindex="-1"></a>    validation_results[j, i] <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="st">&quot;auc&quot;</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb4-82"><a href="#cb4-82" tabindex="-1"></a>  }</span>
<span id="cb4-83"><a href="#cb4-83" tabindex="-1"></a>}</span>
<span id="cb4-84"><a href="#cb4-84" tabindex="-1"></a></span>
<span id="cb4-85"><a href="#cb4-85" tabindex="-1"></a><span class="co"># Run 100 tests with best parameters</span></span>
<span id="cb4-86"><a href="#cb4-86" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Running X test iterations with best parameters...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Running X test iterations with best parameters...</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>test_aucs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>best_params_idx <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">rowMeans</span>(validation_results))</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>best_params <span class="ot">&lt;-</span> rgrid[best_params_idx,]</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co"># Train final model with best parameters</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>best_params_list <span class="ot">&lt;-</span> <span class="fu">as.list</span>(best_params[<span class="sc">-</span><span class="fu">which</span>(<span class="fu">names</span>(best_params) <span class="sc">==</span> <span class="st">&quot;nrounds&quot;</span>)])</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>best_params_list<span class="sc">$</span>booster <span class="ot">&lt;-</span> <span class="st">&quot;gbtree&quot;</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>best_params_list<span class="sc">$</span>objective <span class="ot">&lt;-</span> <span class="st">&quot;binary:logistic&quot;</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>best_params_list<span class="sc">$</span>scale_pos_weight <span class="ot">&lt;-</span> scale_pos_weight</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>best_params_list<span class="sc">$</span>nthread <span class="ot">&lt;-</span> nc</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  <span class="co"># Create test split</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(xs), <span class="fu">nrow</span>(xs), T))</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>  train_x <span class="ot">&lt;-</span> xs[idx, ]</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>  train_y <span class="ot">&lt;-</span> y[idx]</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>  test_x <span class="ot">&lt;-</span> xs[<span class="sc">-</span>idx, ]</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>  test_y <span class="ot">&lt;-</span> y[<span class="sc">-</span>idx]</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>  </span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>  <span class="co"># Train model on full unbalanced dataset</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>  dm_train <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> train_x, <span class="at">label =</span> train_y)</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>  mdl <span class="ot">&lt;-</span> <span class="fu">xgb.train</span>(</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>    <span class="at">params =</span> best_params_list,</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>    <span class="at">data =</span> dm_train,</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>    <span class="at">nrounds =</span> best_params[[<span class="st">&quot;nrounds&quot;</span>]],</span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>  )</span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a>  </span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a>  <span class="co"># Test on unbalanced test set</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">predict</span>(mdl, <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> test_x))</span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(p, test_y)</span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a>  test_aucs[i] <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="st">&quot;auc&quot;</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a>}</span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Test Results over 100 iterations:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Test Results over 100 iterations:</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean AUC:&quot;</span>, <span class="fu">mean</span>(test_aucs), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Mean AUC: 0.8834326</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;SD AUC:&quot;</span>, <span class="fu">sd</span>(test_aucs), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## SD AUC: 0.003989491</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;95% CI:&quot;</span>, <span class="fu">mean</span>(test_aucs) <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(test_aucs), </span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>    <span class="st">&quot;to&quot;</span>, <span class="fu">mean</span>(test_aucs) <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(test_aucs), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 95% CI: 0.8756132 to 0.891252</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Plotting AUC distribution</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">plot</span>(test_aucs, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">pch=</span><span class="dv">20</span>,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;AUC Test Distribution&quot;</span>,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Iteration&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;AUC&quot;</span>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">mean</span>(test_aucs), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>)  <span class="co"># Add this line to show mean</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">mean</span>(test_aucs) <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(test_aucs), <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">mean</span>(test_aucs) <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sd</span>(test_aucs), <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, </span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;AUC Values&quot;</span>, <span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;95% CI Bounds&quot;</span>),</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>),</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>       <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">20</span>, <span class="cn">NA</span>, <span class="cn">NA</span>))</span></code></pre></div>
<p><img src="heckman_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Now train final model on full data for z scores</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>dm_full <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> xs, <span class="at">label =</span> y)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> <span class="fu">xgb.train</span>(</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="at">params =</span> best_params_list,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="at">data =</span> dm_full,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  <span class="at">nrounds =</span> best_params[[<span class="st">&quot;nrounds&quot;</span>]],</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>)</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co"># Get probability predictions (z) for ALL data</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model, <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> xs))</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Calculate residuals for XGBoost predictions</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(select_data<span class="sc">$</span>attempt))</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> y <span class="sc">-</span> z</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co"># Histogram of residuals</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="fu">hist</span>(residuals, <span class="at">main=</span><span class="st">&quot;Distribution of XGBoost Model Residuals&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Residual&quot;</span>, <span class="at">breaks=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="heckman_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># plot out the z values\</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(z), </span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Density of Z Predictions&quot;</span>,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Predicted Probability of Attempt&quot;</span>,</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>)</span></code></pre></div>
<p><img src="heckman_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Calculate GIMR (lambda) This is Generalized inverse mills ratio</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>GIMR <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(<span class="fu">qnorm</span>(z)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">qnorm</span>(z)))</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co"># Add GIMR to the data</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>select_data[, GIMR <span class="sc">:=</span> GIMR]</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co"># Print variable importa</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Create a data.table with just my_id and GIMR from select_data</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>GIMR_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">my_id =</span> select_data<span class="sc">$</span>my_id, <span class="at">GIMR =</span> GIMR)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co"># Add GIMR to outcome_data by matching on my_id</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>outcome_data[GIMR_dt, GIMR <span class="sc">:=</span> i.GIMR, on <span class="ot">=</span> <span class="st">&quot;my_id&quot;</span>]</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># # Existing code</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="co"># outcome_data &lt;- outcome_data[, my_id := NULL]</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co"># outcome_data[, yardline_31_40 := NULL]</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co"># outcome_data[, year2022_team_CLE := NULL] # tied for most attempts with 31</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co"># Remove all columns with &quot;_present&quot; in the name</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>present_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;_present&quot;</span>, <span class="fu">names</span>(outcome_data), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> present_cols) {</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  outcome_data[, (col) <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># Create copies of outcome_data for different models</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>outcome_data_player <span class="ot">&lt;-</span> <span class="fu">copy</span>(outcome_data)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>outcome_data_starter <span class="ot">&lt;-</span> <span class="fu">copy</span>(outcome_data)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co"># Remove specific columns as in original code</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="cf">for</span> (dt <span class="cf">in</span> <span class="fu">list</span>(outcome_data_player, outcome_data_starter)) {</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>  dt[, my_id <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  dt[, yardline_31_40 <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>  dt[, year2022_team_CLE <span class="sc">:=</span> <span class="cn">NULL</span>] <span class="co"># tied for most attempts with 31</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>  </span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>  <span class="co"># Remove attendance variables</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>  dt[, attendance_pct <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>  dt[, attendance_raw <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>  dt[, vegas_wp_posteam <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Warning in `[.data.table`(dt, , `:=`(vegas_wp_posteam, NULL)): Column
## &#39;vegas_wp_posteam&#39; does not exist to remove

## Warning in `[.data.table`(dt, , `:=`(vegas_wp_posteam, NULL)): Column
## &#39;vegas_wp_posteam&#39; does not exist to remove</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># For player models, remove starter columns</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>player_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;^starter_&quot;</span>, <span class="fu">names</span>(outcome_data_player), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> player_cols) {</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  outcome_data_player[, (col) <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>}</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co"># For starter models, remove player columns</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>starter_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;^(offense|defense)_player_&quot;</span>, <span class="fu">names</span>(outcome_data_starter), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> starter_cols) {</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>  outcome_data_starter[, (col) <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>}</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co"># Ensure conversion is numeric</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="cf">for</span> (dt <span class="cf">in</span> <span class="fu">list</span>(outcome_data_player, outcome_data_starter)) {</span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>  dt[, conversion <span class="sc">:=</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(conversion))]</span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>}</span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="co"># MODEL 1: Player model with GIMR</span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a>ols_model_player <span class="ot">&lt;-</span> <span class="fu">lm</span>(conversion <span class="sc">~</span> ., <span class="at">data =</span> outcome_data_player)</span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="co"># MODEL 2: Starter model with GIMR</span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a>ols_model_starter <span class="ot">&lt;-</span> <span class="fu">lm</span>(conversion <span class="sc">~</span> ., <span class="at">data =</span> outcome_data_starter)</span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a><span class="co"># Function to analyze and print model results</span></span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a>analyze_model <span class="ot">&lt;-</span> <span class="cf">function</span>(model, model_name) {</span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a>  <span class="fu">library</span>(sandwich)</span>
<span id="cb23-27"><a href="#cb23-27" tabindex="-1"></a>  <span class="fu">library</span>(lmtest)</span>
<span id="cb23-28"><a href="#cb23-28" tabindex="-1"></a>  </span>
<span id="cb23-29"><a href="#cb23-29" tabindex="-1"></a>  <span class="co"># Get HC0-adjusted t-values and p-values</span></span>
<span id="cb23-30"><a href="#cb23-30" tabindex="-1"></a>  robust_test <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(model, <span class="at">vcov =</span> <span class="fu">vcovHC</span>(model, <span class="at">type =</span> <span class="st">&quot;HC0&quot;</span>))</span>
<span id="cb23-31"><a href="#cb23-31" tabindex="-1"></a>  t_stats <span class="ot">&lt;-</span> robust_test[, <span class="st">&quot;t value&quot;</span>]</span>
<span id="cb23-32"><a href="#cb23-32" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> robust_test[, <span class="st">&quot;Pr(&gt;|t|)&quot;</span>]</span>
<span id="cb23-33"><a href="#cb23-33" tabindex="-1"></a>  </span>
<span id="cb23-34"><a href="#cb23-34" tabindex="-1"></a>  <span class="co"># Function to add significance stars</span></span>
<span id="cb23-35"><a href="#cb23-35" tabindex="-1"></a>  get_stars <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {</span>
<span id="cb23-36"><a href="#cb23-36" tabindex="-1"></a>    <span class="cf">if</span> (p <span class="sc">&lt;=</span> <span class="fl">0.01</span>) <span class="fu">return</span>(<span class="st">&quot;***&quot;</span>)</span>
<span id="cb23-37"><a href="#cb23-37" tabindex="-1"></a>    <span class="cf">if</span> (p <span class="sc">&lt;=</span> <span class="fl">0.05</span>) <span class="fu">return</span>(<span class="st">&quot;**&quot;</span>)</span>
<span id="cb23-38"><a href="#cb23-38" tabindex="-1"></a>    <span class="cf">if</span> (p <span class="sc">&lt;=</span> <span class="fl">0.1</span>) <span class="fu">return</span>(<span class="st">&quot;*&quot;</span>)</span>
<span id="cb23-39"><a href="#cb23-39" tabindex="-1"></a>    <span class="cf">if</span> (p <span class="sc">&lt;=</span> <span class="fl">0.15</span>) <span class="fu">return</span>(<span class="st">&quot;.&quot;</span>)</span>
<span id="cb23-40"><a href="#cb23-40" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb23-41"><a href="#cb23-41" tabindex="-1"></a>  }</span>
<span id="cb23-42"><a href="#cb23-42" tabindex="-1"></a>  </span>
<span id="cb23-43"><a href="#cb23-43" tabindex="-1"></a>  <span class="co"># Maximum width for variable names</span></span>
<span id="cb23-44"><a href="#cb23-44" tabindex="-1"></a>  name_width <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb23-45"><a href="#cb23-45" tabindex="-1"></a>  </span>
<span id="cb23-46"><a href="#cb23-46" tabindex="-1"></a>  <span class="co"># Print model name and header</span></span>
<span id="cb23-47"><a href="#cb23-47" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>, <span class="fu">paste</span>(<span class="fu">rep</span>(<span class="st">&quot;=&quot;</span>, <span class="dv">80</span>), <span class="at">collapse=</span><span class="st">&quot;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-48"><a href="#cb23-48" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;MODEL:&quot;</span>, model_name, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-49"><a href="#cb23-49" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="fu">rep</span>(<span class="st">&quot;=&quot;</span>, <span class="dv">80</span>), <span class="at">collapse=</span><span class="st">&quot;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-50"><a href="#cb23-50" tabindex="-1"></a>  </span>
<span id="cb23-51"><a href="#cb23-51" tabindex="-1"></a>  <span class="co"># Print header with alignment</span></span>
<span id="cb23-52"><a href="#cb23-52" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10s  %10s  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, name_width, <span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;t-value&quot;</span>, <span class="st">&quot;p-value&quot;</span>, <span class="st">&quot;sig&quot;</span>))</span>
<span id="cb23-53"><a href="#cb23-53" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10s  %10s  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, name_width, <span class="st">&quot;---------&quot;</span>, <span class="st">&quot;-------&quot;</span>, <span class="st">&quot;-------&quot;</span>, <span class="st">&quot;----&quot;</span>))</span>
<span id="cb23-54"><a href="#cb23-54" tabindex="-1"></a>  </span>
<span id="cb23-55"><a href="#cb23-55" tabindex="-1"></a>  <span class="co"># Loop through and print values</span></span>
<span id="cb23-56"><a href="#cb23-56" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(t_stats)) {</span>
<span id="cb23-57"><a href="#cb23-57" tabindex="-1"></a>    var_name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(robust_test)[i]</span>
<span id="cb23-58"><a href="#cb23-58" tabindex="-1"></a>    <span class="co"># Truncate name if too long</span></span>
<span id="cb23-59"><a href="#cb23-59" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nchar</span>(var_name) <span class="sc">&gt;</span> name_width) {</span>
<span id="cb23-60"><a href="#cb23-60" tabindex="-1"></a>      var_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">substr</span>(var_name, <span class="dv">1</span>, name_width<span class="dv">-3</span>), <span class="st">&quot;...&quot;</span>)</span>
<span id="cb23-61"><a href="#cb23-61" tabindex="-1"></a>    }</span>
<span id="cb23-62"><a href="#cb23-62" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10.4f  %10.4f  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, </span>
<span id="cb23-63"><a href="#cb23-63" tabindex="-1"></a>                name_width, var_name, </span>
<span id="cb23-64"><a href="#cb23-64" tabindex="-1"></a>                t_stats[i], p_values[i],</span>
<span id="cb23-65"><a href="#cb23-65" tabindex="-1"></a>                <span class="fu">get_stars</span>(p_values[i])))</span>
<span id="cb23-66"><a href="#cb23-66" tabindex="-1"></a>  }</span>
<span id="cb23-67"><a href="#cb23-67" tabindex="-1"></a>  </span>
<span id="cb23-68"><a href="#cb23-68" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-69"><a href="#cb23-69" tabindex="-1"></a>  </span>
<span id="cb23-70"><a href="#cb23-70" tabindex="-1"></a>  <span class="co"># Print R-squared</span></span>
<span id="cb23-71"><a href="#cb23-71" tabindex="-1"></a>  r_squared <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>adj.r.squared</span>
<span id="cb23-72"><a href="#cb23-72" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Adjusted R-squared:&quot;</span>, r_squared, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-73"><a href="#cb23-73" tabindex="-1"></a>  </span>
<span id="cb23-74"><a href="#cb23-74" tabindex="-1"></a>  <span class="co"># Calculate VIFs</span></span>
<span id="cb23-75"><a href="#cb23-75" tabindex="-1"></a>  <span class="fu">library</span>(car)</span>
<span id="cb23-76"><a href="#cb23-76" tabindex="-1"></a>  vifs <span class="ot">&lt;-</span> <span class="fu">vif</span>(model)</span>
<span id="cb23-77"><a href="#cb23-77" tabindex="-1"></a>  </span>
<span id="cb23-78"><a href="#cb23-78" tabindex="-1"></a>  <span class="co"># Filter to show only VIFs over 5</span></span>
<span id="cb23-79"><a href="#cb23-79" tabindex="-1"></a>  high_vifs <span class="ot">&lt;-</span> vifs[vifs <span class="sc">&gt;</span> <span class="dv">5</span>]</span>
<span id="cb23-80"><a href="#cb23-80" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(high_vifs) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb23-81"><a href="#cb23-81" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Variables with VIF &gt; 5:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-82"><a href="#cb23-82" tabindex="-1"></a>    <span class="fu">print</span>(high_vifs)</span>
<span id="cb23-83"><a href="#cb23-83" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb23-84"><a href="#cb23-84" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">No variables with VIF &gt; 5 found in this model</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-85"><a href="#cb23-85" tabindex="-1"></a>  }</span>
<span id="cb23-86"><a href="#cb23-86" tabindex="-1"></a>  </span>
<span id="cb23-87"><a href="#cb23-87" tabindex="-1"></a>  <span class="fu">return</span>(r_squared)</span>
<span id="cb23-88"><a href="#cb23-88" tabindex="-1"></a>}</span>
<span id="cb23-89"><a href="#cb23-89" tabindex="-1"></a></span>
<span id="cb23-90"><a href="#cb23-90" tabindex="-1"></a><span class="co"># Analyze models with GIMR only</span></span>
<span id="cb23-91"><a href="#cb23-91" tabindex="-1"></a>r2_player <span class="ot">&lt;-</span> <span class="fu">analyze_model</span>(ols_model_player, <span class="st">&quot;Player Model with GIMR&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 
##  ================================================================================ 
## MODEL: Player Model with GIMR 
## ================================================================================ 
## 
## Variable                                                         t-value     p-value   sig
## ---------                                                        -------     -------  ----
## (Intercept)                                                       3.6192      0.0003   ***
## ydstogo                                                         -12.4922      0.0000   ***
## posteam_timeouts_remaining                                        1.0756      0.2822      
## defteam_timeouts_remaining                                        1.1980      0.2310      
## rush_attempt                                                      7.1269      0.0000   ***
## week                                                              0.6140      0.5393      
## temp                                                             -0.9747      0.3298      
## wind                                                              0.9892      0.3226      
## vegas_wp                                                          1.6149      0.1064     .
## spread_line                                                      -0.0955      0.9240      
## total_line                                                        2.1285      0.0334    **
## prep_days                                                         1.0032      0.3159      
## overall_win_pct                                                   0.5097      0.6103      
## team_win_pct                                                      1.0862      0.2774      
## prev_win_pct                                                     -2.7607      0.0058   ***
## prev_shotgun_rate                                                 0.3586      0.7199      
## prev_singleback_rate                                              0.5025      0.6153      
## prev_empty_rate                                                   0.6114      0.5410      
## prev_iform_rate                                                   0.0701      0.9441      
## prev_shotgun_success                                              0.2472      0.8048      
## prev_singleback_success                                           0.7659      0.4438      
## prev_empty_success                                                0.5857      0.5581      
## prev_iform_success                                                2.1089      0.0350    **
## prev_stop_rate_run                                                0.1309      0.8959      
## prev_stop_rate_pass                                              -3.2831      0.0010   ***
## shotgun_rate                                                      1.1798      0.2382      
## singleback_rate                                                   0.3511      0.7255      
## empty_rate                                                       -0.1429      0.8864      
## iform_rate                                                       -1.8473      0.0648     *
## shotgun_success                                                  -2.1355      0.0328    **
## singleback_success                                               -0.7617      0.4463      
## empty_success                                                    -0.6412      0.5214      
## iform_success                                                    -1.3401      0.1803      
## def_stop_rate_run                                                 1.6218      0.1049     .
## def_stop_rate_pass                                               -0.9409      0.3468      
## avg_pass_rushers                                                 -1.0149      0.3102      
## avg_box_defenders                                                -0.2940      0.7687      
## cover0_rate                                                      -0.1552      0.8766      
## cover1_rate                                                      -0.3561      0.7218      
## cover2_rate                                                      -0.2416      0.8091      
## cover3_rate                                                       1.5942      0.1110     .
## cover4_rate                                                       0.9277      0.3536      
## cover6_rate                                                      -0.4986      0.6181      
## two_man_rate                                                      1.3663      0.1719      
## prevent_rate                                                      2.6630      0.0078   ***
## roof_outdoors                                                    -0.3963      0.6919      
## posteam_type_home                                                -1.2686      0.2047      
## offense_formation_EMPTY                                          -0.1265      0.8993      
## offense_formation_SHOTGUN                                        -0.7589      0.4479      
## offense_formation_SINGLEBACK                                     -0.5902      0.5551      
## offense_formation_I_FORM                                         -0.2540      0.7995      
## offense_player_1_passing_depth_short_grades_pass_12w              2.5235      0.0117    **
## offense_player_1_passing_depth_medium_grades_pass_12w            -0.4775      0.6330      
## offense_player_1_passing_depth_deep_grades_pass_12w              -1.5502      0.1212     .
## offense_player_4_rushing_grades_first_downs_12w                  -0.4294      0.6677      
## offense_player_4_rushing_grades_yards_12w                         1.0537      0.2921      
## offense_player_4_receiving_grades_grades_pass_block_12w           1.3561      0.1751      
## offense_player_4_receiving_grades_grades_offense_12w             -0.7449      0.4564      
## offense_player_8_receiving_depth_short_grades_pass_route_12w     -0.6444      0.5194      
## offense_player_8_receiving_depth_medium_grades_pass_route...     -0.3592      0.7195      
## offense_player_8_receiving_depth_deep_grades_pass_route_12w       0.4565      0.6480      
## offense_player_9_receiving_depth_short_grades_pass_route_12w     -0.3089      0.7574      
## offense_player_9_receiving_depth_medium_grades_pass_route...     -0.3692      0.7120      
## offense_player_9_receiving_depth_deep_grades_pass_route_12w       0.7085      0.4787      
## offense_player_10_receiving_depth_short_grades_pass_route...     -0.3017      0.7629      
## offense_player_10_receiving_depth_medium_grades_pass_rout...      0.6884      0.4913      
## offense_player_10_receiving_depth_deep_grades_pass_route_12w      0.8138      0.4158      
## offense_player_14_receiving_depth_short_grades_pass_route...      0.4252      0.6707      
## offense_player_14_receiving_depth_medium_grades_pass_rout...      1.8240      0.0682     *
## offense_player_14_receiving_depth_deep_grades_pass_route_12w     -1.4165      0.1567      
## offense_player_17_blocking_grades_grades_pass_block_12w          -1.0343      0.3011      
## offense_player_17_blocking_grades_grades_run_block_12w            0.6806      0.4961      
## offense_player_18_blocking_grades_grades_pass_block_12w          -0.2874      0.7739      
## offense_player_18_blocking_grades_grades_run_block_12w           -1.3203      0.1868      
## offense_player_19_blocking_grades_grades_pass_block_12w           0.6354      0.5252      
## offense_player_19_blocking_grades_grades_run_block_12w            0.5119      0.6087      
## offense_player_20_blocking_grades_grades_pass_block_12w           1.0681      0.2855      
## offense_player_20_blocking_grades_grades_run_block_12w           -1.6452      0.1000     .
## offense_player_21_blocking_grades_grades_pass_block_12w          -1.4990      0.1340     .
## offense_player_21_blocking_grades_grades_run_block_12w            1.1792      0.2384      
## defense_player_1_defensive_grades_grades_run_defense_12w         -0.3143      0.7533      
## defense_player_1_defensive_grades_grades_pass_rush_defens...     -1.4299      0.1528      
## defense_player_2_defensive_grades_grades_run_defense_12w          0.4775      0.6330      
## defense_player_2_defensive_grades_grades_pass_rush_defens...     -0.3505      0.7260      
## defense_player_3_defensive_grades_grades_run_defense_12w          0.0358      0.9715      
## defense_player_3_defensive_grades_grades_pass_rush_defens...      0.2231      0.8235      
## defense_player_4_defensive_grades_grades_run_defense_12w         -0.8468      0.3971      
## defense_player_4_defensive_grades_grades_pass_rush_defens...      0.1411      0.8878      
## defense_player_9_defensive_grades_grades_run_defense_12w          0.7149      0.4747      
## defense_player_9_defensive_grades_grades_pass_rush_defens...     -1.2323      0.2179      
## defense_player_9_coverage_schemes_zone_grades_coverage_de...      0.1379      0.8903      
## defense_player_9_coverage_schemes_man_grades_coverage_def...      1.0106      0.3123      
## defense_player_10_defensive_grades_grades_run_defense_12w         0.0527      0.9580      
## defense_player_10_defensive_grades_grades_pass_rush_defen...     -1.8857      0.0594     *
## defense_player_10_coverage_schemes_zone_grades_coverage_d...      1.2499      0.2114      
## defense_player_10_coverage_schemes_man_grades_coverage_de...      0.6460      0.5183      
## defense_player_11_defensive_grades_grades_run_defense_12w        -1.2639      0.2064      
## defense_player_11_defensive_grades_grades_pass_rush_defen...      1.6673      0.0955     *
## defense_player_11_coverage_schemes_zone_grades_coverage_d...     -1.4402      0.1499     .
## defense_player_11_coverage_schemes_man_grades_coverage_de...      0.7927      0.4280      
## defense_player_12_defensive_grades_grades_run_defense_12w         0.8346      0.4040      
## defense_player_12_defensive_grades_grades_pass_rush_defen...     -1.0741      0.2828      
## defense_player_12_coverage_schemes_zone_grades_coverage_d...      0.0731      0.9417      
## defense_player_12_coverage_schemes_man_grades_coverage_de...     -0.0383      0.9694      
## defense_player_15_defensive_grades_grades_run_defense_12w         0.9215      0.3568      
## defense_player_15_coverage_schemes_zone_grades_coverage_d...     -0.5842      0.5591      
## defense_player_15_coverage_schemes_man_grades_coverage_de...     -1.4892      0.1365     .
## defense_player_16_defensive_grades_grades_run_defense_12w        -0.6778      0.4980      
## defense_player_16_coverage_schemes_zone_grades_coverage_d...     -0.3038      0.7613      
## defense_player_16_coverage_schemes_man_grades_coverage_de...      0.5579      0.5769      
## defense_player_17_defensive_grades_grades_run_defense_12w         0.3523      0.7246      
## defense_player_17_coverage_schemes_zone_grades_coverage_d...      0.2846      0.7759      
## defense_player_17_coverage_schemes_man_grades_coverage_de...     -0.3084      0.7578      
## defense_player_20_defensive_grades_grades_run_defense_12w        -1.6628      0.0964     *
## defense_player_20_coverage_schemes_zone_grades_coverage_d...      1.3548      0.1756      
## defense_player_20_coverage_schemes_man_grades_coverage_de...      0.0118      0.9906      
## defense_player_21_defensive_grades_grades_run_defense_12w        -0.1169      0.9069      
## defense_player_21_coverage_schemes_zone_grades_coverage_d...      0.4926      0.6223      
## defense_player_21_coverage_schemes_man_grades_coverage_de...     -0.2938      0.7689      
## defense_player_22_defensive_grades_grades_run_defense_12w        -0.0622      0.9504      
## defense_player_22_coverage_schemes_zone_grades_coverage_d...      0.4218      0.6732      
## defense_player_22_coverage_schemes_man_grades_coverage_de...     -0.2538      0.7997      
## yardline_1_10                                                    -2.2386      0.0252    **
## yardline_11_20                                                    0.4742      0.6354      
## yardline_21_30                                                    0.3000      0.7642      
## yardline_41_50                                                    1.9616      0.0499    **
## yardline_51_60                                                    0.5911      0.5545      
## yardline_61_70                                                    1.3154      0.1885      
## yardline_71_80                                                    1.9297      0.0537     *
## yardline_81_90                                                    2.4516      0.0143    **
## yardline_91_100                                                   0.8108      0.4175      
## year2017_team_ARI                                                 0.4507      0.6523      
## year2017_team_BUF                                                -0.6019      0.5473      
## year2017_team_CHI                                                 0.0326      0.9740      
## year2017_team_CLE                                                 0.8435      0.3990      
## year2017_team_DAL                                                -0.8926      0.3721      
## year2017_team_DET                                                -0.5476      0.5840      
## year2017_team_GB                                                  1.9202      0.0549     *
## year2017_team_HOU                                                 1.7758      0.0759     *
## year2017_team_MIA                                                -1.2086      0.2269      
## year2017_team_MIN                                                -0.5299      0.5962      
## year2017_team_NE                                                  0.0608      0.9515      
## year2017_team_SF                                                  1.8635      0.0625     *
## year2017_team_BAL                                                 0.0729      0.9419      
## year2017_team_DEN                                                -0.0138      0.9890      
## year2017_team_LA                                                  0.2396      0.8107      
## year2017_team_NYG                                                -0.3558      0.7220      
## year2017_team_OAK                                                -0.5459      0.5852      
## year2017_team_SEA                                                 0.6687      0.5037      
## year2017_team_CAR                                                 0.6402      0.5221      
## year2017_team_CIN                                                 0.6947      0.4873      
## year2017_team_IND                                                 0.8399      0.4010      
## year2017_team_NO                                                  0.6612      0.5085      
## year2017_team_PHI                                                 0.1948      0.8456      
## year2017_team_PIT                                                -0.7481      0.4544      
## year2017_team_TEN                                                 0.2173      0.8280      
## year2017_team_WAS                                                 0.1998      0.8417      
## year2017_team_KC                                                  1.3925      0.1639      
## year2017_team_LAC                                                 0.2076      0.8356      
## year2017_team_NYJ                                                 0.7313      0.4647      
## year2017_team_TB                                                  0.1931      0.8469      
## year2017_team_ATL                                                -0.0562      0.9551      
## year2017_team_JAX                                                 0.2212      0.8250      
## year2018_team_ARI                                                 0.6957      0.4867      
## year2018_team_BAL                                                 0.1745      0.8615      
## year2018_team_CAR                                                 0.1517      0.8794      
## year2018_team_CLE                                                -0.3470      0.7286      
## year2018_team_DET                                                 0.7332      0.4635      
## year2018_team_HOU                                                 1.3140      0.1889      
## year2018_team_IND                                                -0.7148      0.4748      
## year2018_team_KC                                                  0.7916      0.4286      
## year2018_team_NYG                                                 0.3901      0.6965      
## year2018_team_OAK                                                -0.7101      0.4777      
## year2018_team_PHI                                                 0.6380      0.5235      
## year2018_team_SEA                                                -0.5175      0.6048      
## year2018_team_BUF                                                -0.6547      0.5127      
## year2018_team_CHI                                                -0.1727      0.8629      
## year2018_team_CIN                                                -0.2989      0.7650      
## year2018_team_DAL                                                -0.3923      0.6949      
## year2018_team_DEN                                                 0.2149      0.8299      
## year2018_team_GB                                                 -0.0389      0.9690      
## year2018_team_LAC                                                 0.2678      0.7889      
## year2018_team_NE                                                 -0.5352      0.5925      
## year2018_team_NO                                                  0.6352      0.5253      
## year2018_team_PIT                                                 0.5060      0.6129      
## year2018_team_SF                                                  0.1774      0.8592      
## year2018_team_MIA                                                 0.5882      0.5564      
## year2018_team_MIN                                                 0.0602      0.9520      
## year2018_team_NYJ                                                 0.7262      0.4677      
## year2018_team_TB                                                  0.2062      0.8367      
## year2018_team_ATL                                                 0.4732      0.6361      
## year2018_team_JAX                                                 0.3752      0.7075      
## year2018_team_LA                                                 -1.0457      0.2958      
## year2018_team_TEN                                                 0.6640      0.5067      
## year2018_team_WAS                                                 0.0604      0.9518      
## year2019_team_ARI                                                -0.7230      0.4697      
## year2019_team_BUF                                                -1.1851      0.2360      
## year2019_team_CHI                                                 0.5199      0.6032      
## year2019_team_CLE                                                 0.7269      0.4673      
## year2019_team_DAL                                                -0.4322      0.6656      
## year2019_team_IND                                                -0.4731      0.6361      
## year2019_team_JAX                                                 0.5870      0.5573      
## year2019_team_KC                                                 -0.0183      0.9854      
## year2019_team_LAC                                                -0.5602      0.5754      
## year2019_team_MIN                                                -0.5749      0.5654      
## year2019_team_NE                                                 -0.1509      0.8801      
## year2019_team_NO                                                 -1.1305      0.2583      
## year2019_team_PHI                                                 0.3613      0.7179      
## year2019_team_SEA                                                 0.2620      0.7934      
## year2019_team_SF                                                 -0.1520      0.8792      
## year2019_team_TB                                                 -0.9133      0.3612      
## year2019_team_BAL                                                 0.0370      0.9705      
## year2019_team_CAR                                                -0.5941      0.5525      
## year2019_team_DEN                                                 0.6713      0.5021      
## year2019_team_DET                                                -0.6718      0.5017      
## year2019_team_HOU                                                -0.0754      0.9399      
## year2019_team_LA                                                 -0.6463      0.5181      
## year2019_team_MIA                                                -1.9441      0.0520     *
## year2019_team_NYG                                                -0.9187      0.3583      
## year2019_team_NYJ                                                -1.8817      0.0600     *
## year2019_team_OAK                                                -0.3095      0.7569      
## year2019_team_PIT                                                -2.3924      0.0168    **
## year2019_team_TEN                                                -1.2912      0.1967      
## year2019_team_CIN                                                 0.5233      0.6008      
## year2019_team_WAS                                                -0.5528      0.5804      
## year2019_team_ATL                                                -0.0754      0.9399      
## year2019_team_GB                                                 -0.3217      0.7477      
## year2020_team_ATL                                                 0.1925      0.8474      
## year2020_team_BAL                                                 0.3659      0.7145      
## year2020_team_BUF                                                -0.0281      0.9776      
## year2020_team_CAR                                                 0.6516      0.5147      
## year2020_team_CIN                                                 0.3087      0.7576      
## year2020_team_DEN                                                -0.5310      0.5955      
## year2020_team_DET                                                -0.9960      0.3193      
## year2020_team_JAX                                                -0.8492      0.3959      
## year2020_team_KC                                                  0.2532      0.8001      
## year2020_team_LA                                                 -1.1904      0.2340      
## year2020_team_MIN                                                 1.0424      0.2973      
## year2020_team_NE                                                 -0.4567      0.6479      
## year2020_team_NO                                                  0.3021      0.7626      
## year2020_team_NYG                                                 0.0884      0.9296      
## year2020_team_SF                                                  0.5705      0.5684      
## year2020_team_WAS                                                 0.0754      0.9399      
## year2020_team_CHI                                                 0.1684      0.8663      
## year2020_team_DAL                                                -0.3651      0.7151      
## year2020_team_GB                                                 -0.3500      0.7264      
## year2020_team_HOU                                                -0.7244      0.4689      
## year2020_team_MIA                                                -1.2189      0.2230      
## year2020_team_NYJ                                                -0.0950      0.9243      
## year2020_team_TB                                                  0.2012      0.8405      
## year2020_team_TEN                                                -0.6505      0.5154      
## year2020_team_ARI                                                 0.2320      0.8166      
## year2020_team_CLE                                                -1.7448      0.0811     *
## year2020_team_IND                                                -0.8752      0.3815      
## year2020_team_LAC                                                 0.0627      0.9500      
## year2020_team_PHI                                                 0.4845      0.6281      
## year2020_team_SEA                                                -0.2028      0.8393      
## year2020_team_LV                                                  0.6198      0.5355      
## year2020_team_PIT                                                -0.4170      0.6767      
## year2021_team_ATL                                                -1.7120      0.0870     *
## year2021_team_BUF                                                 0.2527      0.8005      
## year2021_team_CIN                                                -1.8516      0.0642     *
## year2021_team_DAL                                                -0.5929      0.5533      
## year2021_team_DEN                                                 0.2472      0.8048      
## year2021_team_DET                                                -0.4901      0.6241      
## year2021_team_KC                                                  0.3930      0.6943      
## year2021_team_LA                                                  0.2118      0.8323      
## year2021_team_LV                                                  0.3493      0.7269      
## year2021_team_MIN                                                -0.2298      0.8182      
## year2021_team_NE                                                  0.4059      0.6848      
## year2021_team_NO                                                 -0.1376      0.8906      
## year2021_team_NYG                                                 0.0058      0.9954      
## year2021_team_SF                                                  0.1152      0.9083      
## year2021_team_TEN                                                -0.6757      0.4993      
## year2021_team_ARI                                                 0.9751      0.3296      
## year2021_team_BAL                                                 0.6437      0.5198      
## year2021_team_CAR                                                -0.5263      0.5987      
## year2021_team_CHI                                                -1.4510      0.1469     .
## year2021_team_GB                                                  0.9130      0.3613      
## year2021_team_IND                                                -0.1880      0.8509      
## year2021_team_LAC                                                 0.3354      0.7374      
## year2021_team_MIA                                                 0.0664      0.9471      
## year2021_team_NYJ                                                -0.2588      0.7958      
## year2021_team_PHI                                                -1.4548      0.1458     .
## year2021_team_SEA                                                -1.2488      0.2118      
## year2021_team_TB                                                  0.4068      0.6842      
## year2021_team_WAS                                                -0.4848      0.6278      
## year2021_team_CLE                                                -0.6017      0.5474      
## year2021_team_HOU                                                -0.7075      0.4793      
## year2021_team_JAX                                                -0.2955      0.7677      
## year2021_team_PIT                                                 0.3924      0.6948      
## year2022_team_ARI                                                -0.9843      0.3250      
## year2022_team_ATL                                                -2.1470      0.0319    **
## year2022_team_CAR                                                 0.9007      0.3678      
## year2022_team_CHI                                                -0.3910      0.6958      
## year2022_team_CIN                                                -0.8614      0.3891      
## year2022_team_HOU                                                -0.2287      0.8191      
## year2022_team_IND                                                -0.7785      0.4363      
## year2022_team_LAC                                                -0.4771      0.6333      
## year2022_team_MIA                                                -1.5782      0.1146     .
## year2022_team_SEA                                                -0.4984      0.6183      
## year2022_team_TB                                                  0.0905      0.9279      
## year2022_team_TEN                                                 1.2622      0.2070      
## year2022_team_WAS                                                -0.0836      0.9334      
## year2022_team_BAL                                                -1.4843      0.1378     .
## year2022_team_BUF                                                 0.2014      0.8404      
## year2022_team_DAL                                                -0.0380      0.9697      
## year2022_team_DET                                                -0.7183      0.4726      
## year2022_team_GB                                                 -1.0275      0.3042      
## year2022_team_JAX                                                -0.8958      0.3704      
## year2022_team_KC                                                 -0.6786      0.4974      
## year2022_team_LA                                                  1.4090      0.1589      
## year2022_team_LV                                                  1.0123      0.3114      
## year2022_team_NO                                                 -0.4205      0.6741      
## year2022_team_PHI                                                 0.5035      0.6147      
## year2022_team_PIT                                                 1.4648      0.1431     .
## year2022_team_DEN                                                 0.4732      0.6361      
## year2022_team_MIN                                                -0.7291      0.4660      
## year2022_team_NE                                                  0.1229      0.9022      
## year2022_team_NYJ                                                -0.8583      0.3908      
## year2022_team_NYG                                                -0.6361      0.5248      
## year2022_team_SF                                                 -1.1322      0.2576      
## year2023_team_BAL                                                -0.3700      0.7114      
## year2023_team_CHI                                                -1.0800      0.2802      
## year2023_team_CLE                                                -0.7760      0.4378      
## year2023_team_GB                                                  0.3353      0.7374      
## year2023_team_IND                                                 0.6317      0.5277      
## year2023_team_KC                                                  0.3155      0.7524      
## year2023_team_LAC                                                 0.3217      0.7477      
## year2023_team_LV                                                  0.3447      0.7304      
## year2023_team_MIA                                                 0.2906      0.7714      
## year2023_team_MIN                                                 1.0205      0.3075      
## year2023_team_NO                                                 -0.4944      0.6211      
## year2023_team_NYG                                                 0.0503      0.9599      
## year2023_team_SEA                                                -1.9985      0.0457    **
## year2023_team_SF                                                  0.1326      0.8945      
## year2023_team_WAS                                                 1.4104      0.1585      
## year2023_team_ATL                                                -0.5255      0.5993      
## year2023_team_BUF                                                -0.6107      0.5414      
## year2023_team_CAR                                                 0.4166      0.6770      
## year2023_team_DAL                                                 0.9737      0.3303      
## year2023_team_DEN                                                 0.3412      0.7329      
## year2023_team_HOU                                                -0.1907      0.8488      
## year2023_team_LA                                                  0.2703      0.7870      
## year2023_team_NE                                                  0.2401      0.8103      
## year2023_team_PHI                                                -0.1618      0.8715      
## year2023_team_PIT                                                -0.0031      0.9975      
## year2023_team_TEN                                                 0.1457      0.8841      
## year2023_team_ARI                                                -1.1832      0.2368      
## year2023_team_CIN                                                -0.8231      0.4105      
## year2023_team_DET                                                 0.3294      0.7419      
## year2023_team_TB                                                  0.7067      0.4798      
## year2023_team_JAX                                                -0.3474      0.7283      
## year2023_team_NYJ                                                 1.4055      0.1600      
## is_first_half                                                    -0.6980      0.4852      
## time_in_half                                                      1.5690      0.1167     .
## home_attendance                                                  -0.6008      0.5480      
## GIMR                                                              1.9642      0.0496    **
## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15
## 
## Adjusted R-squared: 0.10845 
## 
## Variables with VIF &gt; 5:
##                                                   prev_shotgun_rate 
##                                                            9.640017 
##                                                prev_singleback_rate 
##                                                            5.528692 
##                                                         cover1_rate 
##                                                            6.284823 
##                                                         cover3_rate 
##                                                            6.591259 
##                                           offense_formation_SHOTGUN 
##                                                            7.011725 
##                     offense_player_4_rushing_grades_first_downs_12w 
##                                                           11.537084 
##                           offense_player_4_rushing_grades_yards_12w 
##                                                           11.544013 
##        offense_player_9_receiving_depth_short_grades_pass_route_12w 
##                                                            7.758865 
##       offense_player_9_receiving_depth_medium_grades_pass_route_12w 
##                                                            7.228774 
##       offense_player_10_receiving_depth_short_grades_pass_route_12w 
##                                                            6.005939 
##      offense_player_10_receiving_depth_medium_grades_pass_route_12w 
##                                                            6.001818 
##            defense_player_2_defensive_grades_grades_run_defense_12w 
##                                                            8.047152 
##      defense_player_2_defensive_grades_grades_pass_rush_defense_12w 
##                                                            8.041357 
##            defense_player_3_defensive_grades_grades_run_defense_12w 
##                                                           25.665955 
##      defense_player_3_defensive_grades_grades_pass_rush_defense_12w 
##                                                           25.538113 
##            defense_player_4_defensive_grades_grades_run_defense_12w 
##                                                           38.992410 
##      defense_player_4_defensive_grades_grades_pass_rush_defense_12w 
##                                                           39.949078 
##           defense_player_10_defensive_grades_grades_run_defense_12w 
##                                                            6.570275 
##     defense_player_10_defensive_grades_grades_pass_rush_defense_12w 
##                                                            5.905753 
## defense_player_10_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                            6.515465 
##           defense_player_11_defensive_grades_grades_run_defense_12w 
##                                                           20.293933 
##     defense_player_11_defensive_grades_grades_pass_rush_defense_12w 
##                                                           17.461958 
## defense_player_11_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                           14.497881 
##  defense_player_11_coverage_schemes_man_grades_coverage_defense_12w 
##                                                            6.382210 
##           defense_player_12_defensive_grades_grades_run_defense_12w 
##                                                           25.642548 
##     defense_player_12_defensive_grades_grades_pass_rush_defense_12w 
##                                                           22.289433 
## defense_player_12_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                           17.481640 
##  defense_player_12_coverage_schemes_man_grades_coverage_defense_12w 
##                                                            6.344659 
##           defense_player_16_defensive_grades_grades_run_defense_12w 
##                                                            6.195281 
## defense_player_16_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                            7.617785 
##  defense_player_16_coverage_schemes_man_grades_coverage_defense_12w 
##                                                            5.935345 
##           defense_player_17_defensive_grades_grades_run_defense_12w 
##                                                           16.904962 
## defense_player_17_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                           20.508020 
##  defense_player_17_coverage_schemes_man_grades_coverage_defense_12w 
##                                                           15.216223 
##           defense_player_21_defensive_grades_grades_run_defense_12w 
##                                                           11.628235 
## defense_player_21_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                           11.970861 
##  defense_player_21_coverage_schemes_man_grades_coverage_defense_12w 
##                                                           11.223059 
##           defense_player_22_defensive_grades_grades_run_defense_12w 
##                                                           41.263523 
## defense_player_22_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                           48.908234 
##  defense_player_22_coverage_schemes_man_grades_coverage_defense_12w 
##                                                           41.483128 
##                                                     home_attendance 
##                                                           14.019869</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>r2_starter <span class="ot">&lt;-</span> <span class="fu">analyze_model</span>(ols_model_starter, <span class="st">&quot;Starter Model with GIMR&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 
##  ================================================================================ 
## MODEL: Starter Model with GIMR 
## ================================================================================ 
## 
## Variable                                                         t-value     p-value   sig
## ---------                                                        -------     -------  ----
## (Intercept)                                                       3.2213      0.0013   ***
## ydstogo                                                         -13.1257      0.0000   ***
## posteam_timeouts_remaining                                        1.2405      0.2149      
## defteam_timeouts_remaining                                        1.1198      0.2629      
## rush_attempt                                                      6.9485      0.0000   ***
## week                                                              0.8836      0.3770      
## temp                                                             -0.4452      0.6562      
## wind                                                              0.3749      0.7078      
## vegas_wp                                                          0.9961      0.3193      
## spread_line                                                      -0.6876      0.4918      
## total_line                                                        2.2234      0.0262    **
## prep_days                                                         1.0120      0.3116      
## overall_win_pct                                                   0.3356      0.7372      
## team_win_pct                                                      1.6119      0.1071     .
## prev_win_pct                                                     -2.5566      0.0106    **
## prev_shotgun_rate                                                 0.5116      0.6090      
## prev_singleback_rate                                              0.8021      0.4225      
## prev_empty_rate                                                   0.9229      0.3561      
## prev_iform_rate                                                   0.1119      0.9109      
## prev_shotgun_success                                              0.6347      0.5257      
## prev_singleback_success                                           0.7386      0.4602      
## prev_empty_success                                                0.0235      0.9813      
## prev_iform_success                                                2.7437      0.0061   ***
## prev_stop_rate_run                                               -0.1283      0.8979      
## prev_stop_rate_pass                                              -3.2766      0.0011   ***
## shotgun_rate                                                      1.3703      0.1707      
## singleback_rate                                                   0.5322      0.5946      
## empty_rate                                                        0.0833      0.9336      
## iform_rate                                                       -1.3475      0.1779      
## shotgun_success                                                  -2.4624      0.0138    **
## singleback_success                                               -1.5945      0.1109     .
## empty_success                                                    -1.3946      0.1632      
## iform_success                                                    -1.1681      0.2428      
## def_stop_rate_run                                                 1.7755      0.0759     *
## def_stop_rate_pass                                               -1.3629      0.1730      
## avg_pass_rushers                                                 -1.0353      0.3006      
## avg_box_defenders                                                -0.6821      0.4952      
## cover0_rate                                                      -0.5525      0.5807      
## cover1_rate                                                      -0.3076      0.7584      
## cover2_rate                                                      -0.0879      0.9300      
## cover3_rate                                                       1.2179      0.2233      
## cover4_rate                                                       0.8754      0.3814      
## cover6_rate                                                      -0.4452      0.6562      
## two_man_rate                                                      1.6924      0.0907     *
## prevent_rate                                                      2.2939      0.0219    **
## roof_outdoors                                                    -0.0011      0.9991      
## posteam_type_home                                                -1.4660      0.1427     .
## offense_formation_EMPTY                                           0.2503      0.8024      
## offense_formation_SHOTGUN                                        -0.3225      0.7471      
## offense_formation_SINGLEBACK                                     -0.8146      0.4154      
## offense_formation_I_FORM                                         -0.8710      0.3838      
## starter_offense_player_1_passing_depth_short_grades_pass_12w      1.7674      0.0772     *
## starter_offense_player_1_passing_depth_medium_grades_pass...     -1.3402      0.1803      
## starter_offense_player_1_passing_depth_deep_grades_pass_12w      -0.8085      0.4188      
## starter_offense_player_4_rushing_grades_first_downs_12w          -0.5154      0.6063      
## starter_offense_player_4_rushing_grades_yards_12w                 0.4556      0.6487      
## starter_offense_player_4_receiving_grades_grades_pass_blo...     -2.6041      0.0093   ***
## starter_offense_player_4_receiving_grades_grades_offense_12w      0.9736      0.3303      
## starter_offense_player_8_receiving_depth_short_grades_pas...      0.3169      0.7513      
## starter_offense_player_8_receiving_depth_medium_grades_pa...      1.6075      0.1080     .
## starter_offense_player_8_receiving_depth_deep_grades_pass...      0.0014      0.9989      
## starter_offense_player_9_receiving_depth_short_grades_pas...     -1.1400      0.2544      
## starter_offense_player_9_receiving_depth_medium_grades_pa...      1.0250      0.3054      
## starter_offense_player_9_receiving_depth_deep_grades_pass...      0.3523      0.7246      
## starter_offense_player_10_receiving_depth_short_grades_pa...     -1.1556      0.2479      
## starter_offense_player_10_receiving_depth_medium_grades_p...      0.6745      0.5000      
## starter_offense_player_10_receiving_depth_deep_grades_pas...      0.3561      0.7218      
## starter_offense_player_14_receiving_depth_short_grades_pa...      0.7507      0.4529      
## starter_offense_player_14_receiving_depth_medium_grades_p...     -1.9662      0.0493    **
## starter_offense_player_14_receiving_depth_deep_grades_pas...     -0.1779      0.8588      
## starter_offense_player_17_blocking_grades_grades_pass_blo...      1.1927      0.2330      
## starter_offense_player_17_blocking_grades_grades_run_bloc...      0.4760      0.6341      
## starter_offense_player_18_blocking_grades_grades_pass_blo...     -0.7071      0.4795      
## starter_offense_player_18_blocking_grades_grades_run_bloc...     -0.5208      0.6025      
## starter_offense_player_19_blocking_grades_grades_pass_blo...      0.5327      0.5943      
## starter_offense_player_19_blocking_grades_grades_run_bloc...     -1.0439      0.2966      
## starter_offense_player_20_blocking_grades_grades_pass_blo...      1.7588      0.0787     *
## starter_offense_player_20_blocking_grades_grades_run_bloc...     -0.5626      0.5738      
## starter_offense_player_21_blocking_grades_grades_pass_blo...      2.4457      0.0145    **
## starter_offense_player_21_blocking_grades_grades_run_bloc...     -2.5327      0.0114    **
## starter_defense_player_1_defensive_grades_grades_run_defe...      0.1143      0.9090      
## starter_defense_player_1_defensive_grades_grades_pass_rus...      0.1443      0.8853      
## starter_defense_player_2_defensive_grades_grades_run_defe...      2.0536      0.0401    **
## starter_defense_player_2_defensive_grades_grades_pass_rus...     -1.3240      0.1856      
## starter_defense_player_3_defensive_grades_grades_run_defe...     -0.3279      0.7430      
## starter_defense_player_3_defensive_grades_grades_pass_rus...      0.0724      0.9423      
## starter_defense_player_4_defensive_grades_grades_run_defe...      0.8568      0.3916      
## starter_defense_player_4_defensive_grades_grades_pass_rus...     -0.1971      0.8437      
## starter_defense_player_9_defensive_grades_grades_run_defe...      2.0064      0.0449    **
## starter_defense_player_9_defensive_grades_grades_pass_rus...      1.2699      0.2042      
## starter_defense_player_9_coverage_schemes_zone_grades_cov...     -0.9198      0.3577      
## starter_defense_player_9_coverage_schemes_man_grades_cove...     -3.0303      0.0025   ***
## starter_defense_player_10_defensive_grades_grades_run_def...      1.9167      0.0554     *
## starter_defense_player_10_defensive_grades_grades_pass_ru...      1.1340      0.2569      
## starter_defense_player_10_coverage_schemes_zone_grades_co...     -1.0900      0.2758      
## starter_defense_player_10_coverage_schemes_man_grades_cov...     -1.3084      0.1908      
## starter_defense_player_11_defensive_grades_grades_run_def...     -0.3071      0.7588      
## starter_defense_player_11_defensive_grades_grades_pass_ru...      0.2396      0.8106      
## starter_defense_player_11_coverage_schemes_zone_grades_co...     -0.8150      0.4151      
## starter_defense_player_11_coverage_schemes_man_grades_cov...      1.8820      0.0599     *
## starter_defense_player_12_defensive_grades_grades_run_def...     -2.1709      0.0300    **
## starter_defense_player_12_defensive_grades_grades_pass_ru...     -0.6930      0.4883      
## starter_defense_player_12_coverage_schemes_zone_grades_co...      0.2762      0.7824      
## starter_defense_player_12_coverage_schemes_man_grades_cov...      1.8863      0.0593     *
## starter_defense_player_15_defensive_grades_grades_run_def...     -1.1814      0.2375      
## starter_defense_player_15_coverage_schemes_zone_grades_co...      0.6217      0.5342      
## starter_defense_player_15_coverage_schemes_man_grades_cov...     -0.5909      0.5547      
## starter_defense_player_16_defensive_grades_grades_run_def...      2.0257      0.0429    **
## starter_defense_player_16_coverage_schemes_zone_grades_co...     -0.8184      0.4132      
## starter_defense_player_16_coverage_schemes_man_grades_cov...     -1.0460      0.2956      
## starter_defense_player_17_defensive_grades_grades_run_def...     -1.3099      0.1903      
## starter_defense_player_17_coverage_schemes_zone_grades_co...     -0.8639      0.3877      
## starter_defense_player_17_coverage_schemes_man_grades_cov...      1.5756      0.1152     .
## starter_defense_player_20_defensive_grades_grades_run_def...      0.4278      0.6688      
## starter_defense_player_20_coverage_schemes_zone_grades_co...     -0.3641      0.7158      
## starter_defense_player_20_coverage_schemes_man_grades_cov...     -0.5059      0.6129      
## starter_defense_player_21_defensive_grades_grades_run_def...     -0.0356      0.9716      
## starter_defense_player_21_coverage_schemes_zone_grades_co...     -0.6949      0.4871      
## starter_defense_player_21_coverage_schemes_man_grades_cov...     -0.5872      0.5571      
## starter_defense_player_22_defensive_grades_grades_run_def...     -0.3887      0.6975      
## starter_defense_player_22_coverage_schemes_zone_grades_co...      1.7881      0.0738     *
## starter_defense_player_22_coverage_schemes_man_grades_cov...     -0.8966      0.3700      
## yardline_1_10                                                    -2.5338      0.0113    **
## yardline_11_20                                                    0.1098      0.9126      
## yardline_21_30                                                    0.0909      0.9276      
## yardline_41_50                                                    1.9258      0.0542     *
## yardline_51_60                                                    0.4848      0.6278      
## yardline_61_70                                                    1.4255      0.1541      
## yardline_71_80                                                    1.8486      0.0646     *
## yardline_81_90                                                    2.2499      0.0245    **
## yardline_91_100                                                   0.9478      0.3433      
## year2017_team_ARI                                                 0.3292      0.7420      
## year2017_team_BUF                                                -0.6151      0.5386      
## year2017_team_CHI                                                -0.1951      0.8453      
## year2017_team_CLE                                                 0.4812      0.6304      
## year2017_team_DAL                                                -0.8719      0.3833      
## year2017_team_DET                                                -0.6037      0.5461      
## year2017_team_GB                                                  1.6915      0.0908     *
## year2017_team_HOU                                                 1.7408      0.0818     *
## year2017_team_MIA                                                -1.0690      0.2851      
## year2017_team_MIN                                                -0.8886      0.3743      
## year2017_team_NE                                                 -0.1879      0.8510      
## year2017_team_SF                                                  1.9229      0.0546     *
## year2017_team_BAL                                                -0.1762      0.8602      
## year2017_team_DEN                                                -0.2008      0.8409      
## year2017_team_LA                                                  0.3456      0.7297      
## year2017_team_NYG                                                -0.5510      0.5817      
## year2017_team_OAK                                                 0.0031      0.9975      
## year2017_team_SEA                                                 0.6298      0.5289      
## year2017_team_CAR                                                 0.3036      0.7615      
## year2017_team_CIN                                                 0.2060      0.8368      
## year2017_team_IND                                                 0.8056      0.4205      
## year2017_team_NO                                                  0.3093      0.7571      
## year2017_team_PHI                                                 0.0412      0.9671      
## year2017_team_PIT                                                -1.0260      0.3050      
## year2017_team_TEN                                                -0.0733      0.9416      
## year2017_team_WAS                                                 0.0982      0.9217      
## year2017_team_KC                                                  1.2337      0.2174      
## year2017_team_LAC                                                -0.1182      0.9059      
## year2017_team_NYJ                                                 0.5407      0.5888      
## year2017_team_TB                                                  0.3169      0.7513      
## year2017_team_ATL                                                -0.3519      0.7249      
## year2017_team_JAX                                                 0.6173      0.5371      
## year2018_team_ARI                                                 1.0376      0.2995      
## year2018_team_BAL                                                 0.4458      0.6558      
## year2018_team_CAR                                                 0.3876      0.6984      
## year2018_team_CLE                                                -0.4401      0.6599      
## year2018_team_DET                                                 0.0935      0.9255      
## year2018_team_HOU                                                 0.7511      0.4527      
## year2018_team_IND                                                -1.1514      0.2497      
## year2018_team_KC                                                  0.0765      0.9390      
## year2018_team_NYG                                                 0.1020      0.9188      
## year2018_team_OAK                                                -0.2883      0.7731      
## year2018_team_PHI                                                 0.3604      0.7186      
## year2018_team_SEA                                                -0.4711      0.6376      
## year2018_team_BUF                                                -0.5188      0.6040      
## year2018_team_CHI                                                -0.1271      0.8989      
## year2018_team_CIN                                                -0.7156      0.4743      
## year2018_team_DAL                                                -0.1033      0.9178      
## year2018_team_DEN                                                -0.1086      0.9135      
## year2018_team_GB                                                 -0.2358      0.8136      
## year2018_team_LAC                                                 0.4677      0.6400      
## year2018_team_NE                                                 -0.7278      0.4668      
## year2018_team_NO                                                  0.2691      0.7878      
## year2018_team_PIT                                                 0.1346      0.8930      
## year2018_team_SF                                                  0.3827      0.7019      
## year2018_team_MIA                                                 0.3530      0.7241      
## year2018_team_MIN                                                 0.1697      0.8653      
## year2018_team_NYJ                                                 0.7527      0.4517      
## year2018_team_TB                                                 -0.0152      0.9879      
## year2018_team_ATL                                                 0.1885      0.8505      
## year2018_team_JAX                                                -0.1003      0.9201      
## year2018_team_LA                                                 -1.3431      0.1793      
## year2018_team_TEN                                                 0.7995      0.4241      
## year2018_team_WAS                                                -0.1738      0.8620      
## year2019_team_ARI                                                -0.8218      0.4113      
## year2019_team_BUF                                                -0.8739      0.3822      
## year2019_team_CHI                                                 0.1612      0.8719      
## year2019_team_CLE                                                 0.3667      0.7139      
## year2019_team_DAL                                                -0.3744      0.7081      
## year2019_team_IND                                                -0.5622      0.5740      
## year2019_team_JAX                                                 0.4444      0.6568      
## year2019_team_KC                                                  0.0066      0.9947      
## year2019_team_LAC                                                -0.8565      0.3918      
## year2019_team_MIN                                                -1.0270      0.3045      
## year2019_team_NE                                                 -0.1729      0.8628      
## year2019_team_NO                                                 -1.2961      0.1950      
## year2019_team_PHI                                                 0.4216      0.6734      
## year2019_team_SEA                                                 0.0324      0.9741      
## year2019_team_SF                                                 -0.5399      0.5893      
## year2019_team_TB                                                 -0.9407      0.3469      
## year2019_team_BAL                                                 0.0002      0.9998      
## year2019_team_CAR                                                -0.6733      0.5008      
## year2019_team_DEN                                                 0.8068      0.4198      
## year2019_team_DET                                                -0.6909      0.4897      
## year2019_team_HOU                                                -0.4200      0.6745      
## year2019_team_LA                                                 -1.3780      0.1683      
## year2019_team_MIA                                                -2.0040      0.0451    **
## year2019_team_NYG                                                -1.0289      0.3036      
## year2019_team_NYJ                                                -1.6010      0.1095     .
## year2019_team_OAK                                                -0.0621      0.9505      
## year2019_team_PIT                                                -3.3319      0.0009   ***
## year2019_team_TEN                                                -1.4133      0.1576      
## year2019_team_CIN                                                 0.2792      0.7801      
## year2019_team_WAS                                                -0.4706      0.6380      
## year2019_team_ATL                                                 0.0436      0.9652      
## year2019_team_GB                                                 -0.5686      0.5697      
## year2020_team_ATL                                                 0.6553      0.5123      
## year2020_team_BAL                                                 0.5413      0.5884      
## year2020_team_BUF                                                 0.2052      0.8375      
## year2020_team_CAR                                                 1.1928      0.2330      
## year2020_team_CIN                                                 0.6352      0.5254      
## year2020_team_DEN                                                -0.3075      0.7585      
## year2020_team_DET                                                -0.6971      0.4858      
## year2020_team_JAX                                                -0.6298      0.5288      
## year2020_team_KC                                                  0.1831      0.8547      
## year2020_team_LA                                                 -0.7157      0.4742      
## year2020_team_MIN                                                 1.6490      0.0992     *
## year2020_team_NE                                                  0.2649      0.7911      
## year2020_team_NO                                                  0.1991      0.8422      
## year2020_team_NYG                                                 0.2001      0.8414      
## year2020_team_SF                                                  0.3506      0.7259      
## year2020_team_WAS                                                 0.4325      0.6654      
## year2020_team_CHI                                                 1.0665      0.2862      
## year2020_team_DAL                                                 0.1723      0.8632      
## year2020_team_GB                                                  0.3629      0.7167      
## year2020_team_HOU                                                -0.8495      0.3957      
## year2020_team_MIA                                                -0.7032      0.4820      
## year2020_team_NYJ                                                 0.1542      0.8775      
## year2020_team_TB                                                  0.5384      0.5903      
## year2020_team_TEN                                                -0.3549      0.7227      
## year2020_team_ARI                                                 0.6662      0.5053      
## year2020_team_CLE                                                -1.3884      0.1651      
## year2020_team_IND                                                -0.7577      0.4487      
## year2020_team_LAC                                                 0.1000      0.9204      
## year2020_team_PHI                                                 1.1528      0.2491      
## year2020_team_SEA                                                 0.0405      0.9677      
## year2020_team_LV                                                  0.8274      0.4081      
## year2020_team_PIT                                                -0.7675      0.4428      
## year2021_team_ATL                                                -1.5219      0.1281     .
## year2021_team_BUF                                                 0.0193      0.9846      
## year2021_team_CIN                                                -1.2404      0.2149      
## year2021_team_DAL                                                -0.5801      0.5619      
## year2021_team_DEN                                                 0.1123      0.9106      
## year2021_team_DET                                                -0.7156      0.4743      
## year2021_team_KC                                                  0.6730      0.5010      
## year2021_team_LA                                                 -0.0278      0.9778      
## year2021_team_LV                                                  0.6597      0.5095      
## year2021_team_MIN                                                -0.2857      0.7751      
## year2021_team_NE                                                  0.5841      0.5592      
## year2021_team_NO                                                 -0.0039      0.9969      
## year2021_team_NYG                                                 0.2236      0.8231      
## year2021_team_SF                                                 -0.3027      0.7622      
## year2021_team_TEN                                                -0.2222      0.8242      
## year2021_team_ARI                                                 1.2266      0.2200      
## year2021_team_BAL                                                 0.7697      0.4415      
## year2021_team_CAR                                                 0.1608      0.8723      
## year2021_team_CHI                                                -1.5024      0.1331     .
## year2021_team_GB                                                  0.6258      0.5315      
## year2021_team_IND                                                -0.3602      0.7187      
## year2021_team_LAC                                                 0.2965      0.7669      
## year2021_team_MIA                                                 0.0889      0.9291      
## year2021_team_NYJ                                                -0.2330      0.8158      
## year2021_team_PHI                                                -1.4735      0.1407     .
## year2021_team_SEA                                                -1.4219      0.1551      
## year2021_team_TB                                                  0.2607      0.7943      
## year2021_team_WAS                                                -0.6365      0.5245      
## year2021_team_CLE                                                -0.2359      0.8135      
## year2021_team_HOU                                                -0.3384      0.7351      
## year2021_team_JAX                                                -0.2993      0.7647      
## year2021_team_PIT                                                -0.0424      0.9662      
## year2022_team_ARI                                                -1.1289      0.2590      
## year2022_team_ATL                                                -1.3567      0.1750      
## year2022_team_CAR                                                 0.1393      0.8892      
## year2022_team_CHI                                                -0.0382      0.9695      
## year2022_team_CIN                                                -0.6697      0.5031      
## year2022_team_HOU                                                -0.1022      0.9186      
## year2022_team_IND                                                -0.3535      0.7237      
## year2022_team_LAC                                                -0.7259      0.4680      
## year2022_team_MIA                                                -1.1411      0.2539      
## year2022_team_SEA                                                -0.2797      0.7797      
## year2022_team_TB                                                  0.1366      0.8913      
## year2022_team_TEN                                                 1.9480      0.0515     *
## year2022_team_WAS                                                 0.3543      0.7232      
## year2022_team_BAL                                                -1.3667      0.1718      
## year2022_team_BUF                                                 0.5439      0.5865      
## year2022_team_DAL                                                 0.1322      0.8948      
## year2022_team_DET                                                -0.0157      0.9875      
## year2022_team_GB                                                 -0.9938      0.3204      
## year2022_team_JAX                                                -1.6601      0.0970     *
## year2022_team_KC                                                 -0.5148      0.6067      
## year2022_team_LA                                                  1.0258      0.3050      
## year2022_team_LV                                                  0.8046      0.4211      
## year2022_team_NO                                                 -0.3863      0.6993      
## year2022_team_PHI                                                 0.4480      0.6542      
## year2022_team_PIT                                                 1.0031      0.3159      
## year2022_team_DEN                                                 0.4976      0.6188      
## year2022_team_MIN                                                -0.2946      0.7683      
## year2022_team_NE                                                  0.1057      0.9158      
## year2022_team_NYJ                                                -1.0858      0.2776      
## year2022_team_NYG                                                -0.2468      0.8051      
## year2022_team_SF                                                 -1.1071      0.2683      
## year2023_team_BAL                                                -0.3177      0.7507      
## year2023_team_CHI                                                -1.0480      0.2947      
## year2023_team_CLE                                                -0.8447      0.3983      
## year2023_team_GB                                                 -0.2945      0.7684      
## year2023_team_IND                                                 0.5635      0.5731      
## year2023_team_KC                                                  0.0284      0.9773      
## year2023_team_LAC                                                 0.2009      0.8408      
## year2023_team_LV                                                  0.1105      0.9120      
## year2023_team_MIA                                                 0.1917      0.8480      
## year2023_team_MIN                                                 1.5321      0.1256     .
## year2023_team_NO                                                 -0.9147      0.3604      
## year2023_team_NYG                                                 1.0699      0.2847      
## year2023_team_SEA                                                -2.3932      0.0168    **
## year2023_team_SF                                                 -0.0160      0.9872      
## year2023_team_WAS                                                 1.4169      0.1566      
## year2023_team_ATL                                                -0.7785      0.4363      
## year2023_team_BUF                                                -0.5595      0.5759      
## year2023_team_CAR                                                 0.6611      0.5086      
## year2023_team_DAL                                                 0.7474      0.4549      
## year2023_team_DEN                                                 0.0385      0.9693      
## year2023_team_HOU                                                -0.0099      0.9921      
## year2023_team_LA                                                  0.2564      0.7977      
## year2023_team_NE                                                  0.5932      0.5531      
## year2023_team_PHI                                                -0.5661      0.5714      
## year2023_team_PIT                                                -0.1014      0.9193      
## year2023_team_TEN                                                -0.1824      0.8552      
## year2023_team_ARI                                                -1.2752      0.2023      
## year2023_team_CIN                                                -1.0017      0.3165      
## year2023_team_DET                                                 0.2157      0.8293      
## year2023_team_TB                                                  0.4915      0.6231      
## year2023_team_JAX                                                -0.8539      0.3932      
## year2023_team_NYJ                                                 1.4261      0.1539      
## is_first_half                                                    -0.8621      0.3887      
## time_in_half                                                      1.7330      0.0832     *
## home_attendance                                                  -0.0533      0.9575      
## GIMR                                                              1.9512      0.0511     *
## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15
## 
## Adjusted R-squared: 0.1124625 
## 
## Variables with VIF &gt; 5:
##                                                 prev_shotgun_rate 
##                                                         10.146520 
##                                              prev_singleback_rate 
##                                                          5.902880 
##                                                       cover1_rate 
##                                                          6.262779 
##                                                       cover3_rate 
##                                                          6.644092 
##                                         offense_formation_SHOTGUN 
##                                                          5.646466 
##           starter_offense_player_4_rushing_grades_first_downs_12w 
##                                                         12.690334 
##                 starter_offense_player_4_rushing_grades_yards_12w 
##                                                         12.825323 
## starter_defense_player_20_defensive_grades_grades_run_defense_12w 
##                                                          5.092974 
##                                                   home_attendance 
##                                                         14.115816</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co"># Compare R-squared values</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>, <span class="fu">paste</span>(<span class="fu">rep</span>(<span class="st">&quot;=&quot;</span>, <span class="dv">80</span>), <span class="at">collapse=</span><span class="st">&quot;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 
##  ================================================================================</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MODEL COMPARISON - Adjusted R-squared values</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## MODEL COMPARISON - Adjusted R-squared values</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="fu">rep</span>(<span class="st">&quot;=&quot;</span>, <span class="dv">80</span>), <span class="at">collapse=</span><span class="st">&quot;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## ================================================================================</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Player Model with GIMR:&quot;</span>, r2_player, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Player Model with GIMR: 0.10845</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Starter Model with GIMR:&quot;</span>, r2_starter, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Starter Model with GIMR: 0.1124625</code></pre>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIkhlY2ttYW4gU2VsZWN0aW9uIE1vZGVsIEFuYWx5c2lzIg0Kb3V0cHV0OiBodG1sX2RvY3VtZW50DQotLS0NCg0KYGBge3Igb3B0aW9ucywgaW5jbHVkZT1GQUxTRX0NCm9wdGlvbnMobWF4LnByaW50PTEwMDAwKQ0KYGBgDQoNCmBgYHtyfQ0KbGlicmFyeShkYXRhLnRhYmxlKQ0Kb3V0Y29tZV9kYXRhIDwtIGZyZWFkKCJwcmVkaWN0X291dGNvbWUuY3N2Lmd6IikNCnNlbGVjdF9kYXRhIDwtIGZyZWFkKCJwcmVkaWN0X3NlbGVjdC5jc3YuZ3oiKQ0KYGBgDQoNCmBgYHtyfQ0Kc2VsZWN0X2RhdGFbLCBzY29yZV9kaWZmIDo9IGFzLmludGVnZXIoc2NvcmVfZGlmZiA+IDApXQ0KYGBgDQoNCg0KYGBge3J9DQpzZWxlY3RfZGF0YVssIGF0dGVtcHQgOj0gYXMubnVtZXJpYyhhcy5jaGFyYWN0ZXIoYXR0ZW1wdCkpXQ0KYGBgDQoNCmBgYHtyfQ0KbGlicmFyeShkYXRhLnRhYmxlKQ0KbGlicmFyeSh4Z2Jvb3N0KQ0KbGlicmFyeShST0NSKQ0KbGlicmFyeShwYXJhbGxlbCkNCg0KIyBQcmVwYXJlIHRoZSBYR0Jvb3N0IG1hdHJpY2VzDQp4cyA8LSBtb2RlbC5tYXRyaXgofiAuIC0gMSAtIGF0dGVtcHQgLSBteV9pZCwgZGF0YSA9IHNlbGVjdF9kYXRhKQ0KeSA8LSBhcy5udW1lcmljKGFzLmNoYXJhY3RlcihzZWxlY3RfZGF0YSRhdHRlbXB0KSkNCg0KDQojIENyZWF0ZSBwYXJhbWV0ZXIgZ3JpZA0KDQojIENyZWF0ZSBwYXJhbWV0ZXIgZ3JpZA0KZ3JpZCA8LSBleHBhbmQuZ3JpZCgNCiAgZXRhID0gc2VxKDAuMDAxLCAwLjAzLCBieSA9IDAuMDEpLA0KICBtYXhfZGVwdGggPSBzZXEoNSwgNSwgYnkgPSAyKSwNCiAgbWluX2NoaWxkX3dlaWdodCA9IHNlcSgxLCAxLCBieSA9IDEpLCAgICAgICAgDQogIHN1YnNhbXBsZSA9IHNlcSgxLCAxLCBieSA9IDAuMiksDQogIGNvbHNhbXBsZV9ieXRyZWUgPSBzZXEoMSwgMSwgYnkgPSAwLjIpLA0KICBsYW1iZGEgPSBzZXEoMSwgMSwgYnkgPSAxKSwgICAgICAgICAgICAgICAgDQogIGFscGhhID0gc2VxKDAsIDAsIGJ5ID0gMSksICAgICAgICAgICAgICAgICAgDQogIGdhbW1hID0gc2VxKDAsIDAsIGJ5ID0gMC4xKSwgICAgICAgICAgICAgICANCiAgbnJvdW5kcyA9IHNlcSgxMDAsIDI1MCwgYnkgPSA1MCkNCikNCg0KIyBTYW1wbGUgZ3JpZCBwb2ludHMNCmNvbmZfbGV2IDwtIC45NQ0KbnVtX21heCA8LSA1DQpuIDwtIGNlaWxpbmcobG9nKDEtY29uZl9sZXYpL2xvZygxLW51bV9tYXgvbnJvdyhncmlkKSkpDQppbmQgPC0gc2FtcGxlKG5yb3coZ3JpZCksIG4sIHJlcGxhY2UgPSBGQUxTRSkNCnJncmlkIDwtIGdyaWRbaW5kLCBdDQoNCiMgU2V0IHVwIHBhcmFsbGVsIHByb2Nlc3NpbmcNCm5jIDwtIGRldGVjdENvcmVzKCkgLSAxDQoNCiMgQ2FsY3VsYXRlIHNjYWxlX3Bvc193ZWlnaHQgZm9yIGltYmFsYW5jZWQgZGF0YXNldA0Kc2NhbGVfcG9zX3dlaWdodCA8LSBzdW0oeSA9PSAwKSAvIHN1bSh5ID09IDEpDQoNCiMgVmFsaWRhdGlvbiBwaGFzZQ0KI2NhdCgiXG5QaGFzZSAxOiBWYWxpZGF0aW9uIFBoYXNlXG4iKQ0Kbl92YWxpZGF0aW9ucyA8LSAzDQp2YWxpZGF0aW9uX3Jlc3VsdHMgPC0gbWF0cml4KG5yb3cgPSBucm93KHJncmlkKSwgbmNvbCA9IG5fdmFsaWRhdGlvbnMpDQoNCmZvciAoaiBpbiAxOm5yb3cocmdyaWQpKSB7DQogICNjYXQoIlxuVGVzdGluZyBwYXJhbWV0ZXIgc2V0IiwgaiwgIm9mIiwgbnJvdyhyZ3JpZCksICJcbiIpDQogIA0KICBmb3IgKGkgaW4gMTpuX3ZhbGlkYXRpb25zKSB7DQogICAgI2NhdCgiXG5WYWxpZGF0aW9uIGl0ZXJhdGlvbiIsIGksICJvZiIsIG5fdmFsaWRhdGlvbnMsICJcbiIpICAgICAgICAgICAgIA0KICAgICMgQ3JlYXRlIHZhbGlkYXRpb24gc3BsaXQNCiAgICBpZHggPC0gdW5pcXVlKHNhbXBsZShucm93KHhzKSwgbnJvdyh4cyksIFRSVUUpKQ0KICAgIHRyYWluX3ggPC0geHNbaWR4LCBdDQogICAgdHJhaW5feSA8LSB5W2lkeF0NCiAgICB2YWxfeCA8LSB4c1staWR4LCBdDQogICAgdmFsX3kgPC0geVstaWR4XQ0KICAgIA0KICAgIHBybSA8LSBsaXN0KA0KICAgICAgYm9vc3RlciA9ICJnYnRyZWUiLA0KICAgICAgb2JqZWN0aXZlID0gImJpbmFyeTpsb2dpc3RpYyIsDQogICAgICBtYXhfZGVwdGggPSByZ3JpZFtqLCAibWF4X2RlcHRoIl0sDQogICAgICBldGEgPSByZ3JpZFtqLCAiZXRhIl0sDQogICAgICBzdWJzYW1wbGUgPSByZ3JpZFtqLCAic3Vic2FtcGxlIl0sDQogICAgICBjb2xzYW1wbGVfYnl0cmVlID0gcmdyaWRbaiwgImNvbHNhbXBsZV9ieXRyZWUiXSwNCiAgICAgIGdhbW1hID0gcmdyaWRbaiwgImdhbW1hIl0sDQogICAgICBtaW5fY2hpbGRfd2VpZ2h0ID0gcmdyaWRbaiwgIm1pbl9jaGlsZF93ZWlnaHQiXSwNCiAgICAgIGFscGhhID0gcmdyaWRbaiwgImFscGhhIl0sDQogICAgICBsYW1iZGEgPSByZ3JpZFtqLCAibGFtYmRhIl0sDQogICAgICBzY2FsZV9wb3Nfd2VpZ2h0ID0gc2NhbGVfcG9zX3dlaWdodCwNCiAgICAgIG50aHJlYWQgPSBuYw0KICAgICkNCiAgICANCiAgICBkbV90cmFpbiA8LSB4Z2IuRE1hdHJpeChkYXRhID0gdHJhaW5feCwgbGFiZWwgPSB0cmFpbl95KQ0KICAgIG1kbCA8LSB4Z2IudHJhaW4oDQogICAgICBwYXJhbXMgPSBwcm0sDQogICAgICBkYXRhID0gZG1fdHJhaW4sDQogICAgICBucm91bmRzID0gcmdyaWRbaiwgIm5yb3VuZHMiXSwNCiAgICAgIHZlcmJvc2UgPSBGQUxTRQ0KICAgICkNCiAgICANCiAgICBwIDwtIHByZWRpY3QobWRsLCB4Z2IuRE1hdHJpeChkYXRhID0gdmFsX3gpKQ0KICAgIHByZWQgPC0gcHJlZGljdGlvbihwLCB2YWxfeSkNCiAgICB2YWxpZGF0aW9uX3Jlc3VsdHNbaiwgaV0gPC0gcGVyZm9ybWFuY2UocHJlZCwgImF1YyIpQHkudmFsdWVzW1sxXV0NCiAgfQ0KfQ0KDQojIFJ1biAxMDAgdGVzdHMgd2l0aCBiZXN0IHBhcmFtZXRlcnMNCmNhdCgiXG5SdW5uaW5nIFggdGVzdCBpdGVyYXRpb25zIHdpdGggYmVzdCBwYXJhbWV0ZXJzLi4uXG4iKQ0KdGVzdF9hdWNzIDwtIGMoKQ0KDQpiZXN0X3BhcmFtc19pZHggPC0gd2hpY2gubWF4KHJvd01lYW5zKHZhbGlkYXRpb25fcmVzdWx0cykpDQpiZXN0X3BhcmFtcyA8LSByZ3JpZFtiZXN0X3BhcmFtc19pZHgsXQ0KDQojIFRyYWluIGZpbmFsIG1vZGVsIHdpdGggYmVzdCBwYXJhbWV0ZXJzDQpiZXN0X3BhcmFtc19saXN0IDwtIGFzLmxpc3QoYmVzdF9wYXJhbXNbLXdoaWNoKG5hbWVzKGJlc3RfcGFyYW1zKSA9PSAibnJvdW5kcyIpXSkNCmJlc3RfcGFyYW1zX2xpc3QkYm9vc3RlciA8LSAiZ2J0cmVlIg0KYmVzdF9wYXJhbXNfbGlzdCRvYmplY3RpdmUgPC0gImJpbmFyeTpsb2dpc3RpYyINCmJlc3RfcGFyYW1zX2xpc3Qkc2NhbGVfcG9zX3dlaWdodCA8LSBzY2FsZV9wb3Nfd2VpZ2h0DQpiZXN0X3BhcmFtc19saXN0JG50aHJlYWQgPC0gbmMNCg0KZm9yKGkgaW4gMToxMDApIHsNCiAgIyBDcmVhdGUgdGVzdCBzcGxpdA0KICBpZHggPC0gdW5pcXVlKHNhbXBsZShucm93KHhzKSwgbnJvdyh4cyksIFQpKQ0KICB0cmFpbl94IDwtIHhzW2lkeCwgXQ0KICB0cmFpbl95IDwtIHlbaWR4XQ0KICB0ZXN0X3ggPC0geHNbLWlkeCwgXQ0KICB0ZXN0X3kgPC0geVstaWR4XQ0KICANCiAgIyBUcmFpbiBtb2RlbCBvbiBmdWxsIHVuYmFsYW5jZWQgZGF0YXNldA0KICBkbV90cmFpbiA8LSB4Z2IuRE1hdHJpeChkYXRhID0gdHJhaW5feCwgbGFiZWwgPSB0cmFpbl95KQ0KICBtZGwgPC0geGdiLnRyYWluKA0KICAgIHBhcmFtcyA9IGJlc3RfcGFyYW1zX2xpc3QsDQogICAgZGF0YSA9IGRtX3RyYWluLA0KICAgIG5yb3VuZHMgPSBiZXN0X3BhcmFtc1tbIm5yb3VuZHMiXV0sDQogICAgdmVyYm9zZSA9IEZBTFNFDQogICkNCiAgDQogICMgVGVzdCBvbiB1bmJhbGFuY2VkIHRlc3Qgc2V0DQogIHAgPC0gcHJlZGljdChtZGwsIHhnYi5ETWF0cml4KGRhdGEgPSB0ZXN0X3gpKQ0KICBwcmVkIDwtIHByZWRpY3Rpb24ocCwgdGVzdF95KQ0KICB0ZXN0X2F1Y3NbaV0gPC0gcGVyZm9ybWFuY2UocHJlZCwgImF1YyIpQHkudmFsdWVzW1sxXV0NCn0NCiMgUHJpbnQgcmVzdWx0cw0KY2F0KCJcblRlc3QgUmVzdWx0cyBvdmVyIDEwMCBpdGVyYXRpb25zOlxuIikNCmNhdCgiTWVhbiBBVUM6IiwgbWVhbih0ZXN0X2F1Y3MpLCAiXG4iKQ0KY2F0KCJTRCBBVUM6Iiwgc2QodGVzdF9hdWNzKSwgIlxuIikNCmNhdCgiOTUlIENJOiIsIG1lYW4odGVzdF9hdWNzKSAtIDEuOTYgKiBzZCh0ZXN0X2F1Y3MpLCANCiAgICAidG8iLCBtZWFuKHRlc3RfYXVjcykgKyAxLjk2ICogc2QodGVzdF9hdWNzKSwgIlxuIikNCg0KIyBQbG90dGluZyBBVUMgZGlzdHJpYnV0aW9uDQpwbG90KHRlc3RfYXVjcywgY29sPSJyZWQiLCBwY2g9MjAsDQogICAgIG1haW49IkFVQyBUZXN0IERpc3RyaWJ1dGlvbiIsDQogICAgIHhsYWI9Ikl0ZXJhdGlvbiIsIHlsYWI9IkFVQyIpDQphYmxpbmUoaD1tZWFuKHRlc3RfYXVjcyksIGNvbD0iYmx1ZSIsIGx3ZD0yLCBsdHk9MikgICMgQWRkIHRoaXMgbGluZSB0byBzaG93IG1lYW4NCmFibGluZShoPW1lYW4odGVzdF9hdWNzKSAtIDEuOTYgKiBzZCh0ZXN0X2F1Y3MpLCBjb2w9ImdyZWVuIiwgbHdkPTIsIGx0eT0zKQ0KYWJsaW5lKGg9bWVhbih0ZXN0X2F1Y3MpICsgMS45NiAqIHNkKHRlc3RfYXVjcyksIGNvbD0iZ3JlZW4iLCBsd2Q9MiwgbHR5PTMpDQpsZWdlbmQoImJvdHRvbXJpZ2h0IiwgDQogICAgICAgbGVnZW5kPWMoIkFVQyBWYWx1ZXMiLCAiTWVhbiIsICI5NSUgQ0kgQm91bmRzIiksDQogICAgICAgY29sPWMoInJlZCIsICJibHVlIiwgImdyZWVuIiksDQogICAgICAgbHR5PWMoTkEsIDIsIDMpLA0KICAgICAgIHBjaD1jKDIwLCBOQSwgTkEpKQ0KDQojIE5vdyB0cmFpbiBmaW5hbCBtb2RlbCBvbiBmdWxsIGRhdGEgZm9yIHogc2NvcmVzDQpkbV9mdWxsIDwtIHhnYi5ETWF0cml4KGRhdGEgPSB4cywgbGFiZWwgPSB5KQ0KZmluYWxfbW9kZWwgPC0geGdiLnRyYWluKA0KICBwYXJhbXMgPSBiZXN0X3BhcmFtc19saXN0LA0KICBkYXRhID0gZG1fZnVsbCwNCiAgbnJvdW5kcyA9IGJlc3RfcGFyYW1zW1sibnJvdW5kcyJdXSwNCiAgdmVyYm9zZSA9IEZBTFNFDQopDQoNCiMgR2V0IHByb2JhYmlsaXR5IHByZWRpY3Rpb25zICh6KSBmb3IgQUxMIGRhdGENCnogPC0gcHJlZGljdChmaW5hbF9tb2RlbCwgeGdiLkRNYXRyaXgoZGF0YSA9IHhzKSkNCmBgYA0KDQoNCmBgYHtyfQ0KIyBDYWxjdWxhdGUgcmVzaWR1YWxzIGZvciBYR0Jvb3N0IHByZWRpY3Rpb25zDQp5IDwtIGFzLm51bWVyaWMoYXMuY2hhcmFjdGVyKHNlbGVjdF9kYXRhJGF0dGVtcHQpKQ0KcmVzaWR1YWxzIDwtIHkgLSB6DQoNCiMgSGlzdG9ncmFtIG9mIHJlc2lkdWFscw0KaGlzdChyZXNpZHVhbHMsIG1haW49IkRpc3RyaWJ1dGlvbiBvZiBYR0Jvb3N0IE1vZGVsIFJlc2lkdWFscyIsIHhsYWI9IlJlc2lkdWFsIiwgYnJlYWtzPTEwMCkNCmBgYA0KDQpgYGB7cn0NCiMgcGxvdCBvdXQgdGhlIHogdmFsdWVzXA0KcGxvdChkZW5zaXR5KHopLCANCiAgICAgbWFpbiA9ICJEZW5zaXR5IG9mIFogUHJlZGljdGlvbnMiLA0KICAgICB4bGFiID0gIlByZWRpY3RlZCBQcm9iYWJpbGl0eSBvZiBBdHRlbXB0IiwNCiAgICAgeWxhYiA9ICJEZW5zaXR5IikNCmBgYA0KDQpgYGB7cn0NCiMgQ2FsY3VsYXRlIEdJTVIgKGxhbWJkYSkgVGhpcyBpcyBHZW5lcmFsaXplZCBpbnZlcnNlIG1pbGxzIHJhdGlvDQpHSU1SIDwtIGRub3JtKHFub3JtKHopKSAvICgxIC0gcG5vcm0ocW5vcm0oeikpKQ0KDQojIEFkZCBHSU1SIHRvIHRoZSBkYXRhDQpzZWxlY3RfZGF0YVssIEdJTVIgOj0gR0lNUl0NCg0KIyBQcmludCB2YXJpYWJsZSBpbXBvcnRhDQpgYGANCg0KYGBge3J9DQojIENyZWF0ZSBhIGRhdGEudGFibGUgd2l0aCBqdXN0IG15X2lkIGFuZCBHSU1SIGZyb20gc2VsZWN0X2RhdGENCkdJTVJfZHQgPC0gZGF0YS50YWJsZShteV9pZCA9IHNlbGVjdF9kYXRhJG15X2lkLCBHSU1SID0gR0lNUikNCg0KIyBBZGQgR0lNUiB0byBvdXRjb21lX2RhdGEgYnkgbWF0Y2hpbmcgb24gbXlfaWQNCm91dGNvbWVfZGF0YVtHSU1SX2R0LCBHSU1SIDo9IGkuR0lNUiwgb24gPSAibXlfaWQiXQ0KYGBgDQoNCmBgYHtyfQ0KIyAjIEV4aXN0aW5nIGNvZGUNCiMgb3V0Y29tZV9kYXRhIDwtIG91dGNvbWVfZGF0YVssIG15X2lkIDo9IE5VTExdDQojIG91dGNvbWVfZGF0YVssIHlhcmRsaW5lXzMxXzQwIDo9IE5VTExdDQojIG91dGNvbWVfZGF0YVssIHllYXIyMDIyX3RlYW1fQ0xFIDo9IE5VTExdICMgdGllZCBmb3IgbW9zdCBhdHRlbXB0cyB3aXRoIDMxDQoNCiMgUmVtb3ZlIGFsbCBjb2x1bW5zIHdpdGggIl9wcmVzZW50IiBpbiB0aGUgbmFtZQ0KcHJlc2VudF9jb2xzIDwtIGdyZXAoIl9wcmVzZW50IiwgbmFtZXMob3V0Y29tZV9kYXRhKSwgdmFsdWUgPSBUUlVFKQ0KZm9yIChjb2wgaW4gcHJlc2VudF9jb2xzKSB7DQogIG91dGNvbWVfZGF0YVssIChjb2wpIDo9IE5VTExdDQp9DQpgYGANCg0KDQpgYGB7cn0NCg0KIyBDcmVhdGUgY29waWVzIG9mIG91dGNvbWVfZGF0YSBmb3IgZGlmZmVyZW50IG1vZGVscw0Kb3V0Y29tZV9kYXRhX3BsYXllciA8LSBjb3B5KG91dGNvbWVfZGF0YSkNCm91dGNvbWVfZGF0YV9zdGFydGVyIDwtIGNvcHkob3V0Y29tZV9kYXRhKQ0KDQojIFJlbW92ZSBzcGVjaWZpYyBjb2x1bW5zIGFzIGluIG9yaWdpbmFsIGNvZGUNCmZvciAoZHQgaW4gbGlzdChvdXRjb21lX2RhdGFfcGxheWVyLCBvdXRjb21lX2RhdGFfc3RhcnRlcikpIHsNCiAgZHRbLCBteV9pZCA6PSBOVUxMXQ0KICBkdFssIHlhcmRsaW5lXzMxXzQwIDo9IE5VTExdDQogIGR0WywgeWVhcjIwMjJfdGVhbV9DTEUgOj0gTlVMTF0gIyB0aWVkIGZvciBtb3N0IGF0dGVtcHRzIHdpdGggMzENCiAgDQogICMgUmVtb3ZlIGF0dGVuZGFuY2UgdmFyaWFibGVzDQogIGR0WywgYXR0ZW5kYW5jZV9wY3QgOj0gTlVMTF0NCiAgZHRbLCBhdHRlbmRhbmNlX3JhdyA6PSBOVUxMXQ0KICBkdFssIHZlZ2FzX3dwX3Bvc3RlYW0gOj0gTlVMTF0NCn0NCg0KIyBGb3IgcGxheWVyIG1vZGVscywgcmVtb3ZlIHN0YXJ0ZXIgY29sdW1ucw0KcGxheWVyX2NvbHMgPC0gZ3JlcCgiXnN0YXJ0ZXJfIiwgbmFtZXMob3V0Y29tZV9kYXRhX3BsYXllciksIHZhbHVlID0gVFJVRSkNCmZvciAoY29sIGluIHBsYXllcl9jb2xzKSB7DQogIG91dGNvbWVfZGF0YV9wbGF5ZXJbLCAoY29sKSA6PSBOVUxMXQ0KfQ0KDQojIEZvciBzdGFydGVyIG1vZGVscywgcmVtb3ZlIHBsYXllciBjb2x1bW5zDQpzdGFydGVyX2NvbHMgPC0gZ3JlcCgiXihvZmZlbnNlfGRlZmVuc2UpX3BsYXllcl8iLCBuYW1lcyhvdXRjb21lX2RhdGFfc3RhcnRlciksIHZhbHVlID0gVFJVRSkNCmZvciAoY29sIGluIHN0YXJ0ZXJfY29scykgew0KICBvdXRjb21lX2RhdGFfc3RhcnRlclssIChjb2wpIDo9IE5VTExdDQp9DQoNCiMgRW5zdXJlIGNvbnZlcnNpb24gaXMgbnVtZXJpYw0KZm9yIChkdCBpbiBsaXN0KG91dGNvbWVfZGF0YV9wbGF5ZXIsIG91dGNvbWVfZGF0YV9zdGFydGVyKSkgew0KICBkdFssIGNvbnZlcnNpb24gOj0gYXMubnVtZXJpYyhhcy5jaGFyYWN0ZXIoY29udmVyc2lvbikpXQ0KfQ0KDQojIE1PREVMIDE6IFBsYXllciBtb2RlbCB3aXRoIEdJTVINCm9sc19tb2RlbF9wbGF5ZXIgPC0gbG0oY29udmVyc2lvbiB+IC4sIGRhdGEgPSBvdXRjb21lX2RhdGFfcGxheWVyKQ0KDQojIE1PREVMIDI6IFN0YXJ0ZXIgbW9kZWwgd2l0aCBHSU1SDQpvbHNfbW9kZWxfc3RhcnRlciA8LSBsbShjb252ZXJzaW9uIH4gLiwgZGF0YSA9IG91dGNvbWVfZGF0YV9zdGFydGVyKQ0KDQojIEZ1bmN0aW9uIHRvIGFuYWx5emUgYW5kIHByaW50IG1vZGVsIHJlc3VsdHMNCmFuYWx5emVfbW9kZWwgPC0gZnVuY3Rpb24obW9kZWwsIG1vZGVsX25hbWUpIHsNCiAgbGlicmFyeShzYW5kd2ljaCkNCiAgbGlicmFyeShsbXRlc3QpDQogIA0KICAjIEdldCBIQzAtYWRqdXN0ZWQgdC12YWx1ZXMgYW5kIHAtdmFsdWVzDQogIHJvYnVzdF90ZXN0IDwtIGNvZWZ0ZXN0KG1vZGVsLCB2Y292ID0gdmNvdkhDKG1vZGVsLCB0eXBlID0gIkhDMCIpKQ0KICB0X3N0YXRzIDwtIHJvYnVzdF90ZXN0WywgInQgdmFsdWUiXQ0KICBwX3ZhbHVlcyA8LSByb2J1c3RfdGVzdFssICJQcig+fHR8KSJdDQogIA0KICAjIEZ1bmN0aW9uIHRvIGFkZCBzaWduaWZpY2FuY2Ugc3RhcnMNCiAgZ2V0X3N0YXJzIDwtIGZ1bmN0aW9uKHApIHsNCiAgICBpZiAocCA8PSAwLjAxKSByZXR1cm4oIioqKiIpDQogICAgaWYgKHAgPD0gMC4wNSkgcmV0dXJuKCIqKiIpDQogICAgaWYgKHAgPD0gMC4xKSByZXR1cm4oIioiKQ0KICAgIGlmIChwIDw9IDAuMTUpIHJldHVybigiLiIpDQogICAgcmV0dXJuKCIiKQ0KICB9DQogIA0KICAjIE1heGltdW0gd2lkdGggZm9yIHZhcmlhYmxlIG5hbWVzDQogIG5hbWVfd2lkdGggPC0gNjANCiAgDQogICMgUHJpbnQgbW9kZWwgbmFtZSBhbmQgaGVhZGVyDQogIGNhdCgiXG5cbiIsIHBhc3RlKHJlcCgiPSIsIDgwKSwgY29sbGFwc2U9IiIpLCAiXG4iKQ0KICBjYXQoIk1PREVMOiIsIG1vZGVsX25hbWUsICJcbiIpDQogIGNhdChwYXN0ZShyZXAoIj0iLCA4MCksIGNvbGxhcHNlPSIiKSwgIlxuXG4iKQ0KICANCiAgIyBQcmludCBoZWFkZXIgd2l0aCBhbGlnbm1lbnQNCiAgY2F0KHNwcmludGYoIiUtKnMgICUxMHMgICUxMHMgICU0c1xuIiwgbmFtZV93aWR0aCwgIlZhcmlhYmxlIiwgInQtdmFsdWUiLCAicC12YWx1ZSIsICJzaWciKSkNCiAgY2F0KHNwcmludGYoIiUtKnMgICUxMHMgICUxMHMgICU0c1xuIiwgbmFtZV93aWR0aCwgIi0tLS0tLS0tLSIsICItLS0tLS0tIiwgIi0tLS0tLS0iLCAiLS0tLSIpKQ0KICANCiAgIyBMb29wIHRocm91Z2ggYW5kIHByaW50IHZhbHVlcw0KICBmb3IgKGkgaW4gMTpsZW5ndGgodF9zdGF0cykpIHsNCiAgICB2YXJfbmFtZSA8LSByb3duYW1lcyhyb2J1c3RfdGVzdClbaV0NCiAgICAjIFRydW5jYXRlIG5hbWUgaWYgdG9vIGxvbmcNCiAgICBpZiAobmNoYXIodmFyX25hbWUpID4gbmFtZV93aWR0aCkgew0KICAgICAgdmFyX25hbWUgPC0gcGFzdGUwKHN1YnN0cih2YXJfbmFtZSwgMSwgbmFtZV93aWR0aC0zKSwgIi4uLiIpDQogICAgfQ0KICAgIGNhdChzcHJpbnRmKCIlLSpzICAlMTAuNGYgICUxMC40ZiAgJTRzXG4iLCANCiAgICAgICAgICAgICAgICBuYW1lX3dpZHRoLCB2YXJfbmFtZSwgDQogICAgICAgICAgICAgICAgdF9zdGF0c1tpXSwgcF92YWx1ZXNbaV0sDQogICAgICAgICAgICAgICAgZ2V0X3N0YXJzKHBfdmFsdWVzW2ldKSkpDQogIH0NCiAgDQogIGNhdCgiXG5TaWduaWZpY2FuY2UgY29kZXM6IDAgJyoqKicgMC4wMSAnKionIDAuMDUgJyonIDAuMSAnLicgMC4xNVxuIikNCiAgDQogICMgUHJpbnQgUi1zcXVhcmVkDQogIHJfc3F1YXJlZCA8LSBzdW1tYXJ5KG1vZGVsKSRhZGouci5zcXVhcmVkDQogIGNhdCgiXG5BZGp1c3RlZCBSLXNxdWFyZWQ6Iiwgcl9zcXVhcmVkLCAiXG4iKQ0KICANCiAgIyBDYWxjdWxhdGUgVklGcw0KICBsaWJyYXJ5KGNhcikNCiAgdmlmcyA8LSB2aWYobW9kZWwpDQogIA0KICAjIEZpbHRlciB0byBzaG93IG9ubHkgVklGcyBvdmVyIDUNCiAgaGlnaF92aWZzIDwtIHZpZnNbdmlmcyA+IDVdDQogIGlmKGxlbmd0aChoaWdoX3ZpZnMpID4gMCkgew0KICAgIGNhdCgiXG5WYXJpYWJsZXMgd2l0aCBWSUYgPiA1OlxuIikNCiAgICBwcmludChoaWdoX3ZpZnMpDQogIH0gZWxzZSB7DQogICAgY2F0KCJcbk5vIHZhcmlhYmxlcyB3aXRoIFZJRiA+IDUgZm91bmQgaW4gdGhpcyBtb2RlbFxuIikNCiAgfQ0KICANCiAgcmV0dXJuKHJfc3F1YXJlZCkNCn0NCg0KIyBBbmFseXplIG1vZGVscyB3aXRoIEdJTVIgb25seQ0KcjJfcGxheWVyIDwtIGFuYWx5emVfbW9kZWwob2xzX21vZGVsX3BsYXllciwgIlBsYXllciBNb2RlbCB3aXRoIEdJTVIiKQ0KcjJfc3RhcnRlciA8LSBhbmFseXplX21vZGVsKG9sc19tb2RlbF9zdGFydGVyLCAiU3RhcnRlciBNb2RlbCB3aXRoIEdJTVIiKQ0KDQojIENvbXBhcmUgUi1zcXVhcmVkIHZhbHVlcw0KY2F0KCJcblxuIiwgcGFzdGUocmVwKCI9IiwgODApLCBjb2xsYXBzZT0iIiksICJcbiIpDQpjYXQoIk1PREVMIENPTVBBUklTT04gLSBBZGp1c3RlZCBSLXNxdWFyZWQgdmFsdWVzXG4iKQ0KY2F0KHBhc3RlKHJlcCgiPSIsIDgwKSwgY29sbGFwc2U9IiIpLCAiXG5cbiIpDQpjYXQoIlBsYXllciBNb2RlbCB3aXRoIEdJTVI6IiwgcjJfcGxheWVyLCAiXG4iKQ0KY2F0KCJTdGFydGVyIE1vZGVsIHdpdGggR0lNUjoiLCByMl9zdGFydGVyLCAiXG4iKQ0KDQpgYGANCg0K</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("heckman.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
