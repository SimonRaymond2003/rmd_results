<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Heckman Selection Model Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">4th Downs in the NFL</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="heckman.html">Heckman Selection</a>
</li>
<li>
  <a href="xgboost.html">XGBoost Prediction</a>
</li>
<li>
  <a href="attendance_binary.html">Attendance Impact Binary</a>
</li>
<li>
  <a href="attendance_pcts.html">Attendance Impact Percentages</a>
</li>
<li>
  <a href="attendance_totals.html">Attendance Impact Totals</a>
</li>
<li>
  <a href="thirddown.html">Third Down Analysis</a>
</li>
<li>
  <a href="attempt_ols.html">Attempts OLS</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Heckman Selection Model Analysis</h1>

</div>


<pre class="r"><code>library(data.table)
outcome_data &lt;- fread(&quot;predict_outcome.csv.gz&quot;)
select_data &lt;- fread(&quot;predict_select.csv.gz&quot;)</code></pre>
<pre class="r"><code>select_data[, attempt := as.numeric(as.character(attempt))]</code></pre>
<pre class="r"><code># Commented out original version
# # Load required libraries
# library(data.table)
# library(xgboost)
# library(ROCR)
# library(parallel)
# 
# # Prepare the XGBoost matrices
# xs &lt;- model.matrix(~ . - 1 - attempt - my_id, data = select_data)
# y &lt;- as.numeric(as.character(select_data$attempt))
# 
# # Create parameter grid
# grid &lt;- expand.grid(
#   eta = seq(0.001, 0.1, by = 0.02),
#   max_depth = seq(5, 7, by = 2),
#   min_child_weight = seq(1, 1, by = 1),        
#   subsample = seq(0.8, 0.8, by = 0.2),
#   colsample_bytree = seq(0.8, 0.8, by = 0.2),
#   lambda = seq(1, 1, by = 1),                
#   alpha = seq(0, 0, by = 1),                  
#   gamma = seq(0, 0, by = 0.1),               
#   nrounds = seq(100, 500, by = 500)
# )
# 
# # Sample grid points
# conf_lev &lt;- .95
# num_max &lt;- 5
# n &lt;- ceiling(log(1-conf_lev)/log(1-num_max/nrow(grid)))
# ind &lt;- sample(nrow(grid), n, replace = FALSE)
# rgrid &lt;- grid[ind, ]
# 
# # Set up parallel processing
# nc &lt;- detectCores() - 1
# 
# # Validation phase
# cat(&quot;\nPhase 1: Validation Phase\n&quot;)
# n_validations &lt;- 2
# validation_results &lt;- matrix(nrow = nrow(rgrid), ncol = n_validations)
# 
# for (j in 1:nrow(rgrid)) {
#   cat(&quot;\nTesting parameter set&quot;, j, &quot;of&quot;, nrow(rgrid), &quot;\n&quot;)
#   
#   for (i in 1:n_validations) {
#     # Create validation split
#     idx &lt;- unique(sample(nrow(xs), nrow(xs), TRUE))
#     train_x &lt;- xs[idx, ]
#     train_y &lt;- y[idx]
#     val_x &lt;- xs[-idx, ]
#     val_y &lt;- y[-idx]
#     
#     # Undersample majority class in training data
#     train_idx_0 &lt;- which(train_y == 0)
#     train_idx_1 &lt;- which(train_y == 1)
#     
#     # Get number of minority class samples
#     n_minority &lt;- length(train_idx_1)
#     
#     # Randomly sample from majority class
#     train_idx_0_sampled &lt;- sample(train_idx_0, n_minority)
#     
#     # Combine indices for balanced dataset
#     balanced_idx &lt;- c(train_idx_0_sampled, train_idx_1)
#     
#     # Create balanced training dataset
#     train_x_balanced &lt;- train_x[balanced_idx, ]
#     train_y_balanced &lt;- train_y[balanced_idx]
#     
#     prm &lt;- list(
#       booster = &quot;gbtree&quot;,
#       objective = &quot;binary:logistic&quot;,
#       max_depth = rgrid[j, &quot;max_depth&quot;],
#       eta = rgrid[j, &quot;eta&quot;],
#       subsample = rgrid[j, &quot;subsample&quot;],
#       colsample_bytree = rgrid[j, &quot;colsample_bytree&quot;],
#       gamma = rgrid[j, &quot;gamma&quot;],
#       min_child_weight = rgrid[j, &quot;min_child_weight&quot;],
#       alpha = rgrid[j, &quot;alpha&quot;],
#       lambda = rgrid[j, &quot;lambda&quot;],
#       nthread = nc
#     )
#     
#     dm_train &lt;- xgb.DMatrix(data = train_x_balanced, label = train_y_balanced)
#     mdl &lt;- xgb.train(
#       params = prm,
#       data = dm_train,
#       nrounds = rgrid[j, &quot;nrounds&quot;],
#       verbose = FALSE
#     )
#     
#     p &lt;- predict(mdl, xgb.DMatrix(data = val_x))
#     pred &lt;- prediction(p, val_y)
#     validation_results[j, i] &lt;- performance(pred, &quot;auc&quot;)@y.values[[1]]
#   }
# }
# 
# # Run 100 tests with best parameters
# cat(&quot;\nRunning X test iterations with best parameters...\n&quot;)
# test_aucs &lt;- c()
# 
# best_params_idx &lt;- which.max(rowMeans(validation_results))
# best_params &lt;- rgrid[best_params_idx,]
# 
# # Train final model with best parameters
# best_params_list &lt;- as.list(best_params[-which(names(best_params) == &quot;nrounds&quot;)])
# best_params_list$booster &lt;- &quot;gbtree&quot;
# best_params_list$objective &lt;- &quot;binary:logistic&quot;
# best_params_list$nthread &lt;- nc
# 
# for(i in 1:100) {
#   # Create test split
#   idx &lt;- unique(sample(nrow(xs), nrow(xs), T))
#   train_x &lt;- xs[idx, ]
#   train_y &lt;- y[idx]
#   test_x &lt;- xs[-idx, ]
#   test_y &lt;- y[-idx]
#   
#   # Undersample training data
#   train_idx_0 &lt;- which(train_y == 0)
#   train_idx_1 &lt;- which(train_y == 1)
#   n_minority &lt;- length(train_idx_1)
#   train_idx_0_sampled &lt;- sample(train_idx_0, n_minority)
#   balanced_idx &lt;- c(train_idx_0_sampled, train_idx_1)
#   
#   # Create balanced training dataset
#   train_x_balanced &lt;- train_x[balanced_idx, ]
#   train_y_balanced &lt;- train_y[balanced_idx]
#   
#   # Train model
#   dm_train &lt;- xgb.DMatrix(data = train_x_balanced, label = train_y_balanced)
#   mdl &lt;- xgb.train(
#     params = best_params_list,
#     data = dm_train,
#     nrounds = best_params[[&quot;nrounds&quot;]],
#     verbose = FALSE
#   )
#   
#   # Test on unbalanced test set
#   p &lt;- predict(mdl, xgb.DMatrix(data = test_x))
#   pred &lt;- prediction(p, test_y)
#   test_aucs[i] &lt;- performance(pred, &quot;auc&quot;)@y.values[[1]]
# }
# 
# # Print results
# cat(&quot;\nTest Results over 100 iterations:\n&quot;)
# cat(&quot;Mean AUC:&quot;, mean(test_aucs), &quot;\n&quot;)
# cat(&quot;SD AUC:&quot;, sd(test_aucs), &quot;\n&quot;)
# cat(&quot;95% CI:&quot;, mean(test_aucs) - 1.96 * sd(test_aucs), 
#     &quot;to&quot;, mean(test_aucs) + 1.96 * sd(test_aucs), &quot;\n&quot;)
# 
# # Plotting AUC distribution
# plot(test_aucs, col=&quot;red&quot;, pch=20,
#      main=&quot;AUC Test Distribution&quot;,
#      xlab=&quot;Iteration&quot;, ylab=&quot;AUC&quot;)
# abline(h=mean(test_aucs), col=&quot;blue&quot;, lwd=2, lty=2)
# abline(h=mean(test_aucs) - 1.96 * sd(test_aucs), col=&quot;green&quot;, lwd=2, lty=3)
# abline(h=mean(test_aucs) + 1.96 * sd(test_aucs), col=&quot;green&quot;, lwd=2, lty=3)
# legend(&quot;bottomright&quot;, 
#        legend=c(&quot;AUC Values&quot;, &quot;Mean&quot;, &quot;95% CI Bounds&quot;),
#        col=c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;),
#        lty=c(NA, 2, 3),
#        pch=c(20, NA, NA))
# 
# # Now train final model on full data for z scores
# final_idx_0 &lt;- which(y == 0)
# final_idx_1 &lt;- which(y == 1)
# n_minority_final &lt;- length(final_idx_1)
# final_idx_0_sampled &lt;- sample(final_idx_0, n_minority_final)
# final_balanced_idx &lt;- c(final_idx_0_sampled, final_idx_1)
# 
# # Create balanced final dataset
# xs_balanced &lt;- xs[final_balanced_idx, ]
# y_balanced &lt;- y[final_balanced_idx]
# 
# dm_full &lt;- xgb.DMatrix(data = xs_balanced, label = y_balanced)
# final_model &lt;- xgb.train(
#   params = best_params_list,
#   data = dm_full,
#   nrounds = best_params[[&quot;nrounds&quot;]],
#   verbose = FALSE
# )
# 
# # Get probability predictions (z) for ALL data
# z &lt;- predict(final_model, xgb.DMatrix(data = xs))</code></pre>
<pre class="r"><code>library(data.table)
library(xgboost)
library(ROCR)
library(parallel)

# Prepare the XGBoost matrices
xs &lt;- model.matrix(~ . - 1 - attempt - my_id, data = select_data)
y &lt;- as.numeric(as.character(select_data$attempt))

# Create parameter grid
grid &lt;- expand.grid(
  eta = seq(0.001, 0.1, by = 0.02),
  max_depth = seq(5, 7, by = 2),
  min_child_weight = seq(1, 1, by = 1),        
  subsample = seq(0.8, 1, by = 0.2),
  colsample_bytree = seq(0.8, 1, by = 0.2),
  lambda = seq(1, 1, by = 1),                
  alpha = seq(0, 0, by = 1),                  
  gamma = seq(0, 0, by = 0.1),               
  nrounds = seq(100, 500, by = 50)
)

# Sample grid points
conf_lev &lt;- .95
num_max &lt;- 5
n &lt;- ceiling(log(1-conf_lev)/log(1-num_max/nrow(grid)))
ind &lt;- sample(nrow(grid), n, replace = FALSE)
rgrid &lt;- grid[ind, ]

# Set up parallel processing
nc &lt;- detectCores() - 1

# Calculate scale_pos_weight for imbalanced dataset
scale_pos_weight &lt;- sum(y == 0) / sum(y == 1)

# Validation phase
cat(&quot;\nPhase 1: Validation Phase\n&quot;)</code></pre>
<pre><code>## 
## Phase 1: Validation Phase</code></pre>
<pre class="r"><code>n_validations &lt;- 20
validation_results &lt;- matrix(nrow = nrow(rgrid), ncol = n_validations)

for (j in 1:nrow(rgrid)) {
  #cat(&quot;\nTesting parameter set&quot;, j, &quot;of&quot;, nrow(rgrid), &quot;\n&quot;)
  
  for (i in 1:n_validations) {
    # Create validation split
    idx &lt;- unique(sample(nrow(xs), nrow(xs), TRUE))
    train_x &lt;- xs[idx, ]
    train_y &lt;- y[idx]
    val_x &lt;- xs[-idx, ]
    val_y &lt;- y[-idx]
    
    prm &lt;- list(
      booster = &quot;gbtree&quot;,
      objective = &quot;binary:logistic&quot;,
      max_depth = rgrid[j, &quot;max_depth&quot;],
      eta = rgrid[j, &quot;eta&quot;],
      subsample = rgrid[j, &quot;subsample&quot;],
      colsample_bytree = rgrid[j, &quot;colsample_bytree&quot;],
      gamma = rgrid[j, &quot;gamma&quot;],
      min_child_weight = rgrid[j, &quot;min_child_weight&quot;],
      alpha = rgrid[j, &quot;alpha&quot;],
      lambda = rgrid[j, &quot;lambda&quot;],
      scale_pos_weight = scale_pos_weight,
      nthread = nc
    )
    
    dm_train &lt;- xgb.DMatrix(data = train_x, label = train_y)
    mdl &lt;- xgb.train(
      params = prm,
      data = dm_train,
      nrounds = rgrid[j, &quot;nrounds&quot;],
      verbose = FALSE
    )
    
    p &lt;- predict(mdl, xgb.DMatrix(data = val_x))
    pred &lt;- prediction(p, val_y)
    validation_results[j, i] &lt;- performance(pred, &quot;auc&quot;)@y.values[[1]]
  }
}

# Run 100 tests with best parameters
cat(&quot;\nRunning X test iterations with best parameters...\n&quot;)</code></pre>
<pre><code>## 
## Running X test iterations with best parameters...</code></pre>
<pre class="r"><code>test_aucs &lt;- c()

best_params_idx &lt;- which.max(rowMeans(validation_results))
best_params &lt;- rgrid[best_params_idx,]

# Train final model with best parameters
best_params_list &lt;- as.list(best_params[-which(names(best_params) == &quot;nrounds&quot;)])
best_params_list$booster &lt;- &quot;gbtree&quot;
best_params_list$objective &lt;- &quot;binary:logistic&quot;
best_params_list$scale_pos_weight &lt;- scale_pos_weight
best_params_list$nthread &lt;- nc

for(i in 1:10) {
  # Create test split
  idx &lt;- unique(sample(nrow(xs), nrow(xs), T))
  train_x &lt;- xs[idx, ]
  train_y &lt;- y[idx]
  test_x &lt;- xs[-idx, ]
  test_y &lt;- y[-idx]
  
  # Train model on full unbalanced dataset
  dm_train &lt;- xgb.DMatrix(data = train_x, label = train_y)
  mdl &lt;- xgb.train(
    params = best_params_list,
    data = dm_train,
    nrounds = best_params[[&quot;nrounds&quot;]],
    verbose = FALSE
  )
  
  # Test on unbalanced test set
  p &lt;- predict(mdl, xgb.DMatrix(data = test_x))
  pred &lt;- prediction(p, test_y)
  test_aucs[i] &lt;- performance(pred, &quot;auc&quot;)@y.values[[1]]
}

# Print results
cat(&quot;\nTest Results over 100 iterations:\n&quot;)</code></pre>
<pre><code>## 
## Test Results over 100 iterations:</code></pre>
<pre class="r"><code>cat(&quot;Mean AUC:&quot;, mean(test_aucs), &quot;\n&quot;)</code></pre>
<pre><code>## Mean AUC: 0.8898602</code></pre>
<pre class="r"><code>cat(&quot;SD AUC:&quot;, sd(test_aucs), &quot;\n&quot;)</code></pre>
<pre><code>## SD AUC: 0.001789953</code></pre>
<pre class="r"><code>cat(&quot;95% CI:&quot;, mean(test_aucs) - 1.96 * sd(test_aucs), 
    &quot;to&quot;, mean(test_aucs) + 1.96 * sd(test_aucs), &quot;\n&quot;)</code></pre>
<pre><code>## 95% CI: 0.8863519 to 0.8933685</code></pre>
<pre class="r"><code># Plotting AUC distribution
plot(test_aucs, col=&quot;red&quot;, pch=20,
     main=&quot;AUC Test Distribution&quot;,
     xlab=&quot;Iteration&quot;, ylab=&quot;AUC&quot;)
abline(h=mean(test_aucs) - 1.96 * sd(test_aucs), col=&quot;green&quot;, lwd=2, lty=3)
abline(h=mean(test_aucs) + 1.96 * sd(test_aucs), col=&quot;green&quot;, lwd=2, lty=3)
legend(&quot;bottomright&quot;, 
       legend=c(&quot;AUC Values&quot;, &quot;Mean&quot;, &quot;95% CI Bounds&quot;),
       col=c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;),
       lty=c(NA, 2, 3),
       pch=c(20, NA, NA))</code></pre>
<p><img src="heckman_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code># Now train final model on full data for z scores
dm_full &lt;- xgb.DMatrix(data = xs, label = y)
final_model &lt;- xgb.train(
  params = best_params_list,
  data = dm_full,
  nrounds = best_params[[&quot;nrounds&quot;]],
  verbose = FALSE
)

# Get probability predictions (z) for ALL data
z &lt;- predict(final_model, xgb.DMatrix(data = xs))</code></pre>
<pre class="r"><code># Calculate residuals for XGBoost predictions
y &lt;- as.numeric(as.character(select_data$attempt))
residuals &lt;- y - z

# Histogram of residuals
hist(residuals, main=&quot;Distribution of XGBoost Model Residuals&quot;, xlab=&quot;Residual&quot;, breaks=100)</code></pre>
<p><img src="heckman_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code># plot out the z values\
plot(density(z), 
     main = &quot;Density of Z Predictions&quot;,
     xlab = &quot;Predicted Probability of Attempt&quot;,
     ylab = &quot;Density&quot;)</code></pre>
<p><img src="heckman_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code># Calculate GIMR (lambda) This is Generalized inverse mills ratio
GIMR &lt;- dnorm(qnorm(z)) / (1 - pnorm(qnorm(z)))

# Add GIMR to the data
select_data[, GIMR := GIMR]

# Print variable importa</code></pre>
<pre class="r"><code># Create a data.table with just my_id and GIMR from select_data
GIMR_dt &lt;- data.table(my_id = select_data$my_id, GIMR = GIMR)

# Add GIMR to outcome_data by matching on my_id
outcome_data[GIMR_dt, GIMR := i.GIMR, on = &quot;my_id&quot;]</code></pre>
<pre class="r"><code>#kill - my_id
outcome_data &lt;- outcome_data[, my_id := NULL]
outcome_data[, year2017_team_ARI := NULL]
outcome_data &lt;- outcome_data[, yardline_1_10:= NULL]</code></pre>
<pre class="r"><code>outcome_data[, conversion := as.numeric(as.character(conversion))]
# Then run OLS with GIMR correction
ols_model &lt;- lm(conversion ~  ., data = outcome_data)</code></pre>
<pre class="r"><code>library(sandwich)
library(lmtest)

# Get HC0-adjusted t-values and p-values
robust_test &lt;- coeftest(ols_model, vcov = vcovHC(ols_model, type = &quot;HC0&quot;))
t_stats &lt;- robust_test[, &quot;t value&quot;]
p_values &lt;- robust_test[, &quot;Pr(&gt;|t|)&quot;]

# Function to add significance stars
get_stars &lt;- function(p) {
    if (p &lt;= 0.01) return(&quot;***&quot;)
    if (p &lt;= 0.05) return(&quot;**&quot;)
    if (p &lt;= 0.1) return(&quot;*&quot;)
    if (p &lt;= 0.15) return(&quot;.&quot;)
    return(&quot;&quot;)
}

# Maximum width for variable names
name_width &lt;- 20

# Print header with alignment
cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;Variable&quot;, &quot;t-value&quot;, &quot;p-value&quot;, &quot;sig&quot;))</code></pre>
<pre><code>## Variable                 t-value     p-value   sig</code></pre>
<pre class="r"><code>cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;---------&quot;, &quot;-------&quot;, &quot;-------&quot;, &quot;----&quot;))</code></pre>
<pre><code>## ---------                -------     -------  ----</code></pre>
<pre class="r"><code># Loop through and print values
for (i in 1:length(t_stats)) {
    var_name &lt;- rownames(robust_test)[i]
    # Truncate name if too long
    if (nchar(var_name) &gt; name_width) {
        var_name &lt;- paste0(substr(var_name, 1, name_width-3), &quot;...&quot;)
    }
    cat(sprintf(&quot;%-*s  %10.4f  %10.4f  %4s\n&quot;, 
                name_width, var_name, 
                t_stats[i], p_values[i],
                get_stars(p_values[i])))
}</code></pre>
<pre><code>## (Intercept)               0.5953      0.5517      
## ydstogo                 -12.2655      0.0000   ***
## posteam_timeouts_...      1.3416      0.1798      
## defteam_timeouts_...      0.7646      0.4445      
## rush_attempt              7.2690      0.0000   ***
## week                      1.1610      0.2457      
## temp                     -0.4141      0.6788      
## wind                      1.0229      0.3064      
## vegas_wp                  1.7581      0.0788     *
## vegas_wp_posteam          0.8732      0.3826      
## total_line                2.1518      0.0315    **
## prep_days                 0.8176      0.4137      
## overall_win_pct           0.2264      0.8209      
## team_win_pct              0.9241      0.3555      
## prev_shotgun_rate         0.3854      0.6999      
## prev_singleback_rate      0.4063      0.6846      
## prev_empty_rate           0.5503      0.5822      
## prev_shotgun_success     -0.9821      0.3261      
## prev_singleback_s...      0.7079      0.4791      
## prev_empty_success        0.0330      0.9737      
## prev_stop_rate_run        0.2366      0.8130      
## prev_stop_rate_pass      -2.6818      0.0074   ***
## shotgun_rate              1.5176      0.1292     .
## singleback_rate           0.8225      0.4109      
## empty_rate               -0.4266      0.6697      
## shotgun_success          -2.4473      0.0144    **
## singleback_success       -1.1162      0.2644      
## empty_success            -0.5246      0.5999      
## def_stop_rate_run         1.6184      0.1057     .
## def_stop_rate_pass       -1.2293      0.2190      
## avg_pass_rushers         -0.7884      0.4305      
## avg_box_defenders        -0.1553      0.8766      
## cover0_rate              -0.3068      0.7590      
## cover1_rate               0.0074      0.9941      
## cover2_rate              -0.0618      0.9508      
## cover3_rate               1.8694      0.0616     *
## cover4_rate               1.2799      0.2007      
## cover6_rate              -0.1233      0.9018      
## two_man_rate              1.5603      0.1188     .
## prevent_rate              2.7919      0.0053   ***
## attendance_raw           -1.0080      0.3135      
## roof_outdoors            -0.1967      0.8441      
## posteam_type_away         0.9330      0.3509      
## offense_formation...      0.7801      0.4354      
## offense_formation...      0.1815      0.8560      
## offense_formation...      0.1730      0.8627      
## offense_player_1_...      3.0984      0.0020   ***
## offense_player_2_...     -1.4647      0.1431     .
## offense_player_4_...      0.6019      0.5473      
## offense_player_5_...     -0.2562      0.7978      
## offense_player_6_...     -0.5771      0.5639      
## offense_player_8_...     -2.4914      0.0128    **
## offense_player_9_...     -1.9417      0.0523     *
## offense_player_10...     -0.7575      0.4488      
## offense_player_11...     -0.6305      0.5284      
## offense_player_12...      2.8220      0.0048   ***
## offense_player_14...     -0.6577      0.5108      
## offense_player_15...     -1.1153      0.2648      
## offense_player_16...     -0.8693      0.3848      
## offense_player_17...     -0.2644      0.7915      
## offense_player_20...      0.3667      0.7139      
## offense_player_22...     -1.3491      0.1774      
## offense_player_23...      1.4594      0.1445     .
## offense_player_24...     -5.2626      0.0000   ***
## offense_player_9_...     -1.4053      0.1600      
## offense_player_17...      0.7374      0.4609      
## offense_player_9_...     -2.7181      0.0066   ***
## offense_player_1_...      0.5347      0.5929      
## offense_player_8_...      1.3677      0.1715      
## offense_player_8_...     -0.0151      0.9880      
## offense_player_9_...     -0.2939      0.7689      
## offense_player_17...     -0.8903      0.3734      
## offense_player_9_...      2.0585      0.0396    **
## offense_player_1_...      0.1625      0.8709      
## offense_player_4_...     -0.9899      0.3223      
## offense_player_1_...      0.2539      0.7996      
## offense_player_9_...      2.4676      0.0136    **
## offense_player_9_...     -0.2746      0.7836      
## offense_player_1_...      1.5907      0.1118     .
## offense_player_9_...      0.7496      0.4535      
## offense_player_8_...     -0.4430      0.6578      
## offense_player_8_...      0.1624      0.8710      
## offense_player_10...      2.4087      0.0161    **
## offense_player_9_...     -0.7687      0.4421      
## offense_player_4_...     -1.4350      0.1514      
## offense_player_20...     -1.0549      0.2915      
## offense_player_8_...      0.7653      0.4442      
## offense_player_1_...     -1.0691      0.2851      
## offense_player_9_...     -0.0851      0.9322      
## offense_player_1_...      0.5137      0.6075      
## offense_player_1_...     -0.7194      0.4719      
## offense_player_14...      2.3192      0.0204    **
## offense_player_1_...      0.4751      0.6347      
## offense_player_9_...      0.2927      0.7698      
## offense_player_8_...     -0.6043      0.5457      
## offense_player_1_...     -1.4013      0.1612      
## defense_player_1_...     -1.6978      0.0896     *
## defense_player_2_...      1.7498      0.0802     *
## defense_player_3_...      0.0496      0.9604      
## defense_player_4_...     -1.0925      0.2747      
## defense_player_5_...     -1.0371      0.2998      
## defense_player_6_...     -0.8750      0.3817      
## defense_player_9_...      0.4910      0.6235      
## defense_player_10...     -0.6088      0.5427      
## defense_player_11...     -0.4684      0.6395      
## defense_player_12...      0.3024      0.7624      
## defense_player_13...      2.0819      0.0374    **
## defense_player_14...      0.4876      0.6259      
## defense_player_15...      0.2763      0.7823      
## defense_player_16...      0.0293      0.9766      
## defense_player_17...      0.5750      0.5654      
## defense_player_18...      1.4037      0.1605      
## defense_player_19...      0.5771      0.5639      
## defense_player_20...     -0.5323      0.5945      
## defense_player_21...      0.7771      0.4371      
## defense_player_22...      1.1003      0.2713      
## defense_player_23...      0.9796      0.3274      
## defense_player_3_...      0.0766      0.9390      
## defense_player_10...      1.2950      0.1954      
## defense_player_17...     -0.1158      0.9078      
## defense_player_3_...     -0.2408      0.8097      
## defense_player_3_...     -0.0234      0.9813      
## defense_player_3_...     -0.3662      0.7143      
## defense_player_3_...      0.1631      0.8705      
## defense_player_3_...      1.3664      0.1719      
## defense_player_1_...     -0.3907      0.6960      
## defense_player_3_...     -0.3591      0.7195      
## defense_player_15...     -0.1785      0.8584      
## defense_player_21...      0.1189      0.9054      
## defense_player_3_...     -0.0698      0.9443      
## yardline_11_20            2.4603      0.0139    **
## yardline_21_30            2.2423      0.0250    **
## yardline_31_40            2.0917      0.0365    **
## yardline_41_50            3.6733      0.0002   ***
## yardline_51_60            2.6316      0.0085   ***
## yardline_61_70            3.2752      0.0011   ***
## yardline_71_80            3.3843      0.0007   ***
## yardline_81_90            3.1891      0.0014   ***
## yardline_91_100           1.6433      0.1004     .
## year2017_team_BUF        -0.2451      0.8064      
## year2017_team_CHI         0.5296      0.5964      
## year2017_team_CLE         0.8532      0.3936      
## year2017_team_DAL        -0.7427      0.4577      
## year2017_team_DET        -0.2758      0.7827      
## year2017_team_GB          2.3322      0.0197    **
## year2017_team_HOU         1.2693      0.2044      
## year2017_team_MIA        -0.6588      0.5101      
## year2017_team_MIN        -0.3295      0.7418      
## year2017_team_NE         -0.0026      0.9979      
## year2017_team_SF          1.6544      0.0981     *
## year2017_team_BAL         0.5639      0.5728      
## year2017_team_DEN        -0.0523      0.9583      
## year2017_team_LA          0.6621      0.5079      
## year2017_team_NYG        -0.3766      0.7065      
## year2017_team_OAK        -0.4780      0.6327      
## year2017_team_SEA         0.9852      0.3246      
## year2017_team_CAR         0.5139      0.6073      
## year2017_team_CIN         0.8553      0.3924      
## year2017_team_IND         0.7995      0.4241      
## year2017_team_NO          1.1627      0.2450      
## year2017_team_PHI         1.0813      0.2796      
## year2017_team_PIT        -0.8324      0.4053      
## year2017_team_TEN        -0.0225      0.9821      
## year2017_team_WAS         0.8031      0.4219      
## year2017_team_KC          1.6685      0.0953     *
## year2017_team_LAC         0.5293      0.5966      
## year2017_team_NYJ         0.9689      0.3327      
## year2017_team_TB          0.0690      0.9450      
## year2017_team_ATL         0.3153      0.7526      
## year2017_team_JAX         0.1501      0.8807      
## year2018_team_ARI        -0.1241      0.9012      
## year2018_team_BAL         0.1503      0.8806      
## year2018_team_CAR        -0.1344      0.8931      
## year2018_team_CLE        -0.3113      0.7556      
## year2018_team_DET         0.6520      0.5145      
## year2018_team_HOU         0.8840      0.3768      
## year2018_team_IND        -0.4966      0.6195      
## year2018_team_KC          0.3298      0.7416      
## year2018_team_NYG         0.4679      0.6399      
## year2018_team_OAK        -0.5773      0.5638      
## year2018_team_PHI         0.5333      0.5939      
## year2018_team_SEA        -0.3418      0.7325      
## year2018_team_BUF        -0.5527      0.5805      
## year2018_team_CHI        -0.2524      0.8007      
## year2018_team_CIN        -0.5651      0.5721      
## year2018_team_DAL        -0.5228      0.6011      
## year2018_team_DEN        -0.1907      0.8488      
## year2018_team_GB         -0.2760      0.7825      
## year2018_team_LAC         0.1260      0.8998      
## year2018_team_NE         -0.3062      0.7594      
## year2018_team_NO          0.7983      0.4247      
## year2018_team_PIT        -0.0114      0.9909      
## year2018_team_SF          0.1787      0.8582      
## year2018_team_MIA         0.4175      0.6763      
## year2018_team_MIN         0.0052      0.9958      
## year2018_team_NYJ         0.2541      0.7994      
## year2018_team_TB          0.4963      0.6197      
## year2018_team_ATL         0.1648      0.8691      
## year2018_team_JAX         0.2720      0.7856      
## year2018_team_LA         -1.0698      0.2848      
## year2018_team_TEN         0.8111      0.4173      
## year2018_team_WAS         0.1837      0.8542      
## year2019_team_ARI        -0.5357      0.5922      
## year2019_team_BUF        -0.2055      0.8372      
## year2019_team_CHI         0.1241      0.9013      
## year2019_team_CLE         0.3039      0.7612      
## year2019_team_DAL        -0.4730      0.6363      
## year2019_team_IND        -0.3081      0.7580      
## year2019_team_JAX         0.1630      0.8705      
## year2019_team_KC          0.0020      0.9984      
## year2019_team_LAC        -0.8937      0.3715      
## year2019_team_MIN        -0.1846      0.8535      
## year2019_team_NE          0.1190      0.9053      
## year2019_team_NO         -1.0980      0.2723      
## year2019_team_PHI         0.4124      0.6801      
## year2019_team_SEA        -0.0835      0.9335      
## year2019_team_SF         -0.1856      0.8527      
## year2019_team_TB         -0.7309      0.4649      
## year2019_team_BAL        -0.1986      0.8426      
## year2019_team_CAR        -0.2345      0.8146      
## year2019_team_DEN         0.4214      0.6735      
## year2019_team_DET        -0.7877      0.4309      
## year2019_team_HOU        -0.1124      0.9105      
## year2019_team_LA         -0.4087      0.6828      
## year2019_team_MIA        -0.8586      0.3906      
## year2019_team_NYG        -0.7228      0.4698      
## year2019_team_NYJ        -1.4130      0.1577      
## year2019_team_OAK        -0.4978      0.6186      
## year2019_team_PIT        -1.6129      0.1068     .
## year2019_team_TEN        -0.6395      0.5225      
## year2019_team_CIN         0.5608      0.5750      
## year2019_team_WAS         0.1305      0.8961      
## year2019_team_ATL        -0.1817      0.8558      
## year2019_team_GB         -0.3960      0.6921      
## year2020_team_ATL         0.1025      0.9184      
## year2020_team_BAL         0.4973      0.6190      
## year2020_team_BUF         0.0300      0.9761      
## year2020_team_CAR         0.6138      0.5394      
## year2020_team_CIN         0.5117      0.6089      
## year2020_team_DEN        -0.3515      0.7253      
## year2020_team_DET        -0.4911      0.6234      
## year2020_team_JAX        -0.4870      0.6263      
## year2020_team_KC          0.1520      0.8792      
## year2020_team_LA         -0.6082      0.5431      
## year2020_team_MIN         0.7772      0.4371      
## year2020_team_NE         -0.1698      0.8652      
## year2020_team_NO          0.3825      0.7021      
## year2020_team_NYG         0.1362      0.8916      
## year2020_team_SF          0.2796      0.7798      
## year2020_team_WAS         0.2405      0.8100      
## year2020_team_CHI         0.1826      0.8551      
## year2020_team_DAL        -0.0125      0.9901      
## year2020_team_GB         -0.0180      0.9856      
## year2020_team_HOU        -0.4392      0.6606      
## year2020_team_MIA        -0.5395      0.5896      
## year2020_team_NYJ         0.0526      0.9581      
## year2020_team_TB          0.5092      0.6106      
## year2020_team_TEN        -0.2993      0.7648      
## year2020_team_ARI         0.5283      0.5973      
## year2020_team_CLE        -0.8276      0.4079      
## year2020_team_IND        -0.3705      0.7110      
## year2020_team_LAC         0.2668      0.7896      
## year2020_team_PHI         0.5952      0.5517      
## year2020_team_SEA        -0.2149      0.8299      
## year2020_team_LV         -0.7868      0.4315      
## year2020_team_PIT        -0.4626      0.6437      
## year2021_team_ATL        -0.2755      0.7829      
## year2021_team_BUF         0.3012      0.7633      
## year2021_team_CIN        -1.0359      0.3003      
## year2021_team_DAL        -0.3137      0.7537      
## year2021_team_DEN         0.5883      0.5564      
## year2021_team_DET        -0.3069      0.7590      
## year2021_team_KC         -0.0829      0.9339      
## year2021_team_LA         -0.2800      0.7795      
## year2021_team_LV          0.2555      0.7983      
## year2021_team_MIN        -0.1536      0.8779      
## year2021_team_NE          0.0540      0.9570      
## year2021_team_NO         -0.4305      0.6668      
## year2021_team_NYG         0.5541      0.5796      
## year2021_team_SF         -0.3180      0.7505      
## year2021_team_TEN        -0.4609      0.6449      
## year2021_team_ARI         0.7582      0.4484      
## year2021_team_BAL         0.2384      0.8116      
## year2021_team_CAR         0.1246      0.9008      
## year2021_team_CHI        -0.9955      0.3196      
## year2021_team_GB          0.3369      0.7362      
## year2021_team_IND        -0.5816      0.5609      
## year2021_team_LAC        -0.0389      0.9690      
## year2021_team_MIA        -0.0390      0.9689      
## year2021_team_NYJ        -0.2274      0.8201      
## year2021_team_PHI        -0.2509      0.8019      
## year2021_team_SEA        -0.9017      0.3673      
## year2021_team_TB          0.1303      0.8963      
## year2021_team_WAS         0.0508      0.9595      
## year2021_team_CLE        -0.5696      0.5690      
## year2021_team_HOU        -0.4592      0.6461      
## year2021_team_JAX        -0.2408      0.8097      
## year2021_team_PIT        -0.1504      0.8805      
## year2022_team_ARI        -1.3362      0.1816      
## year2022_team_ATL        -1.4286      0.1532      
## year2022_team_CAR         0.3170      0.7513      
## year2022_team_CHI         0.1195      0.9049      
## year2022_team_CIN        -0.1880      0.8509      
## year2022_team_HOU         0.1440      0.8855      
## year2022_team_IND        -0.0833      0.9336      
## year2022_team_LAC        -0.6153      0.5384      
## year2022_team_MIA        -0.7688      0.4420      
## year2022_team_SEA        -0.4686      0.6394      
## year2022_team_TB         -0.2842      0.7763      
## year2022_team_TEN         0.8031      0.4219      
## year2022_team_WAS         0.2397      0.8106      
## year2022_team_BAL        -1.2325      0.2178      
## year2022_team_BUF         0.5016      0.6160      
## year2022_team_DAL         0.0450      0.9641      
## year2022_team_DET        -0.2737      0.7843      
## year2022_team_GB         -0.7167      0.4736      
## year2022_team_JAX        -0.7914      0.4288      
## year2022_team_KC         -0.3238      0.7461      
## year2022_team_LA          0.7408      0.4589      
## year2022_team_LV          0.3406      0.7334      
## year2022_team_NO         -0.5726      0.5670      
## year2022_team_PHI         0.7409      0.4588      
## year2022_team_PIT         0.3865      0.6992      
## year2022_team_CLE        -0.2527      0.8005      
## year2022_team_DEN         0.4724      0.6367      
## year2022_team_MIN        -0.3958      0.6923      
## year2022_team_NE          0.2203      0.8257      
## year2022_team_NYJ        -0.5699      0.5688      
## year2022_team_NYG         0.0853      0.9320      
## year2022_team_SF         -0.7290      0.4660      
## year2023_team_BAL        -0.7486      0.4541      
## year2023_team_CHI        -0.8094      0.4183      
## year2023_team_CLE        -1.1363      0.2559      
## year2023_team_GB          0.1641      0.8697      
## year2023_team_IND         0.1302      0.8964      
## year2023_team_KC          0.1071      0.9147      
## year2023_team_LAC         0.1198      0.9047      
## year2023_team_LV         -0.2768      0.7820      
## year2023_team_MIA         0.4427      0.6580      
## year2023_team_MIN         0.6458      0.5185      
## year2023_team_NO         -0.1505      0.8804      
## year2023_team_NYG         0.5058      0.6130      
## year2023_team_SEA        -0.6855      0.4930      
## year2023_team_SF          0.1444      0.8852      
## year2023_team_WAS         0.8550      0.3926      
## year2023_team_ATL        -0.3740      0.7084      
## year2023_team_BUF        -0.7166      0.4737      
## year2023_team_CAR        -0.3229      0.7468      
## year2023_team_DAL        -0.0805      0.9358      
## year2023_team_DEN        -0.2657      0.7905      
## year2023_team_HOU        -0.1726      0.8629      
## year2023_team_LA          0.4775      0.6331      
## year2023_team_NE          0.5157      0.6061      
## year2023_team_PHI         0.2472      0.8048      
## year2023_team_PIT        -0.2424      0.8085      
## year2023_team_TEN        -0.2601      0.7948      
## year2023_team_ARI        -1.2600      0.2077      
## year2023_team_CIN        -1.1165      0.2643      
## year2023_team_DET         0.5788      0.5627      
## year2023_team_TB          0.3000      0.7642      
## year2023_team_JAX        -0.9230      0.3561      
## year2023_team_NYJ         0.6615      0.5083      
## is_first_half            -0.7948      0.4268      
## time_in_half              1.6182      0.1057     .
## attendance_pct            1.0044      0.3152      
## home_attendance          -0.1769      0.8596      
## GIMR                      2.6498      0.0081   ***</code></pre>
<pre class="r"><code>cat(&quot;\nSignificance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15&quot;)</code></pre>
<pre><code>## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</code></pre>
<pre class="r"><code># Create a copy of outcome_data without GIMR
outcome_data_no_gimr &lt;- copy(outcome_data)
outcome_data_no_gimr[, GIMR := NULL]

# Run OLS without GIMR correction
ols_model_no_gimr &lt;- lm(conversion ~ ., data = outcome_data_no_gimr)

# Get HC0-adjusted t-values and p-values for model without GIMR
robust_test_no_gimr &lt;- coeftest(ols_model_no_gimr, vcov = vcovHC(ols_model_no_gimr, type = &quot;HC0&quot;))
t_stats_no_gimr &lt;- robust_test_no_gimr[, &quot;t value&quot;]
p_values_no_gimr &lt;- robust_test_no_gimr[, &quot;Pr(&gt;|t|)&quot;]
coefficients_no_gimr &lt;- coef(ols_model_no_gimr)

# Print results for model without GIMR
cat(&quot;\nModel Results WITHOUT GIMR:\n&quot;)</code></pre>
<pre><code>## 
## Model Results WITHOUT GIMR:</code></pre>
<pre class="r"><code>cat(sprintf(&quot;%-*s  %10s  %10s  %10s  %4s\n&quot;, name_width, &quot;Variable&quot;, &quot;Coef&quot;, &quot;t-value&quot;, &quot;p-value&quot;, &quot;sig&quot;))</code></pre>
<pre><code>## Variable                    Coef     t-value     p-value   sig</code></pre>
<pre class="r"><code>cat(sprintf(&quot;%-*s  %10s  %10s  %10s  %4s\n&quot;, name_width, &quot;---------&quot;, &quot;----&quot;, &quot;-------&quot;, &quot;-------&quot;, &quot;---&quot;))</code></pre>
<pre><code>## ---------                   ----     -------     -------   ---</code></pre>
<pre class="r"><code>for (i in 1:length(t_stats_no_gimr)) {
    var_name &lt;- rownames(robust_test_no_gimr)[i]
    if (nchar(var_name) &gt; name_width) {
        var_name &lt;- paste0(substr(var_name, 1, name_width-3), &quot;...&quot;)
    }
    cat(sprintf(&quot;%-*s  %10.4f  %10.4f  %10.4f  %4s\n&quot;, 
                name_width, var_name,
                coefficients_no_gimr[i],
                t_stats_no_gimr[i], 
                p_values_no_gimr[i],
                get_stars(p_values_no_gimr[i])))
}</code></pre>
<pre><code>## (Intercept)               0.3053      0.7015      0.4830      
## ydstogo                  -0.1161    -13.3577      0.0000   ***
## posteam_timeouts_...      0.0075      0.8172      0.4139      
## defteam_timeouts_...      0.0077      0.8619      0.3888      
## rush_attempt              0.1655      7.8489      0.0000   ***
## week                      0.0122      1.2340      0.2173      
## temp                     -0.0046     -0.4283      0.6685      
## wind                      0.0099      0.9363      0.3492      
## vegas_wp                  0.0078      0.7337      0.4632      
## vegas_wp_posteam          0.0087      0.8594      0.3902      
## total_line                0.0286      2.2387      0.0252    **
## prep_days                 0.0069      0.8724      0.3830      
## overall_win_pct           0.0026      0.1906      0.8489      
## team_win_pct              0.0153      1.0757      0.2821      
## prev_shotgun_rate         0.0061      0.4354      0.6633      
## prev_singleback_rate      0.0062      0.4590      0.6463      
## prev_empty_rate           0.0058      0.5812      0.5611      
## prev_shotgun_success     -0.0104     -0.9681      0.3331      
## prev_singleback_s...      0.0070      0.6819      0.4953      
## prev_empty_success        0.0003      0.0257      0.9795      
## prev_stop_rate_run        0.0018      0.1522      0.8791      
## prev_stop_rate_pass      -0.0268     -2.6330      0.0085   ***
## shotgun_rate              0.0170      1.4749      0.1403     .
## singleback_rate           0.0098      0.9002      0.3681      
## empty_rate               -0.0041     -0.3862      0.6993      
## shotgun_success          -0.0208     -2.3376      0.0195    **
## singleback_success       -0.0099     -1.0522      0.2928      
## empty_success            -0.0046     -0.4781      0.6326      
## def_stop_rate_run         0.0147      1.5807      0.1140     .
## def_stop_rate_pass       -0.0120     -1.2825      0.1998      
## avg_pass_rushers         -0.0091     -0.8080      0.4192      
## avg_box_defenders        -0.0022     -0.2013      0.8405      
## cover0_rate              -0.0034     -0.2968      0.7666      
## cover1_rate               0.0007      0.0411      0.9673      
## cover2_rate              -0.0008     -0.0607      0.9516      
## cover3_rate               0.0342      1.8574      0.0633     *
## cover4_rate               0.0180      1.3137      0.1890      
## cover6_rate              -0.0015     -0.1252      0.9003      
## two_man_rate              0.0149      1.5653      0.1176     .
## prevent_rate              0.0224      2.7816      0.0054   ***
## attendance_raw           -0.2127     -1.0678      0.2857      
## roof_outdoors            -0.0023     -0.0915      0.9271      
## posteam_type_away         0.0143      0.8245      0.4097      
## offense_formation...      0.0175      0.4679      0.6399      
## offense_formation...     -0.0039     -0.1269      0.8990      
## offense_formation...      0.0059      0.1962      0.8445      
## offense_player_1_...      0.5899      3.2767      0.0011   ***
## offense_player_2_...     -0.1599     -1.3890      0.1649      
## offense_player_4_...      0.0376      0.5512      0.5815      
## offense_player_5_...     -0.0180     -0.2720      0.7857      
## offense_player_6_...     -0.1674     -0.6269      0.5308      
## offense_player_8_...     -0.2210     -2.4965      0.0126    **
## offense_player_9_...     -0.2215     -1.9682      0.0491    **
## offense_player_10...     -0.0506     -0.7193      0.4720      
## offense_player_11...     -0.0586     -0.6590      0.5099      
## offense_player_12...      0.4482      2.6919      0.0071   ***
## offense_player_14...     -0.0609     -0.6824      0.4951      
## offense_player_15...     -0.0744     -1.0906      0.2755      
## offense_player_16...     -0.0675     -0.9218      0.3567      
## offense_player_17...     -0.0824     -0.1674      0.8671      
## offense_player_20...      0.0555      0.1709      0.8643      
## offense_player_22...     -0.0983     -1.3458      0.1784      
## offense_player_23...      0.1989      1.4421      0.1494     .
## offense_player_24...     -0.8816     -5.1875      0.0000   ***
## offense_player_9_...     -0.0173     -1.3881      0.1652      
## offense_player_17...      0.0250      0.6623      0.5078      
## offense_player_9_...     -0.0382     -2.7681      0.0057   ***
## offense_player_1_...      0.0051      0.5855      0.5583      
## offense_player_8_...      0.0312      1.2358      0.2166      
## offense_player_8_...     -0.0000     -0.0038      0.9969      
## offense_player_9_...     -0.0054     -0.2764      0.7823      
## offense_player_17...     -0.0320     -0.8257      0.4090      
## offense_player_9_...      0.0707      2.0400      0.0414    **
## offense_player_1_...      0.0011      0.0750      0.9402      
## offense_player_4_...     -0.0088     -1.0790      0.2807      
## offense_player_1_...      0.0045      0.3523      0.7246      
## offense_player_9_...      0.0233      2.3942      0.0167    **
## offense_player_9_...     -0.0033     -0.2536      0.7998      
## offense_player_1_...      0.0996      1.5536      0.1204     .
## offense_player_9_...      0.0315      0.7037      0.4817      
## offense_player_8_...     -0.0109     -0.4115      0.6807      
## offense_player_8_...      0.0036      0.2732      0.7847      
## offense_player_10...      0.0207      2.3594      0.0184    **
## offense_player_9_...     -0.0208     -0.6935      0.4881      
## offense_player_4_...     -0.0123     -1.4463      0.1482     .
## offense_player_20...     -0.0087     -1.1161      0.2644      
## offense_player_8_...      0.0066      0.7886      0.4304      
## offense_player_1_...     -0.0109     -1.0441      0.2965      
## offense_player_9_...     -0.0018     -0.0830      0.9339      
## offense_player_1_...      0.0126      0.5897      0.5554      
## offense_player_1_...     -0.0102     -0.7233      0.4695      
## offense_player_14...      0.0191      2.3135      0.0208    **
## offense_player_1_...      0.0053      0.4721      0.6369      
## offense_player_9_...      0.0101      0.3350      0.7377      
## offense_player_8_...     -0.0082     -0.4822      0.6297      
## offense_player_1_...     -0.0910     -1.3818      0.1671      
## defense_player_1_...     -0.1728     -1.6867      0.0917     *
## defense_player_2_...      0.0857      1.8462      0.0649     *
## defense_player_3_...      0.0112      0.1175      0.9065      
## defense_player_4_...     -0.0323     -0.9785      0.3279      
## defense_player_5_...     -0.0390     -0.8568      0.3916      
## defense_player_6_...     -0.0724     -0.8681      0.3854      
## defense_player_9_...      0.0882      0.4727      0.6364      
## defense_player_10...     -0.0189     -0.4407      0.6594      
## defense_player_11...     -0.0108     -0.3383      0.7351      
## defense_player_12...      0.0127      0.3920      0.6951      
## defense_player_13...      0.1164      2.1029      0.0355    **
## defense_player_14...      0.1199      0.5399      0.5893      
## defense_player_15...      0.0335      0.3700      0.7114      
## defense_player_16...      0.0018      0.0413      0.9671      
## defense_player_17...      0.0250      0.6071      0.5438      
## defense_player_18...      0.0538      1.4252      0.1542      
## defense_player_19...      0.0732      0.5749      0.5654      
## defense_player_20...     -0.0390     -0.4495      0.6531      
## defense_player_21...      0.0376      0.8641      0.3876      
## defense_player_22...      0.0346      1.1568      0.2474      
## defense_player_23...      0.0502      0.9754      0.3294      
## defense_player_3_...      0.0246      0.1285      0.8978      
## defense_player_10...      0.0118      1.2444      0.2134      
## defense_player_17...     -0.0028     -0.1724      0.8631      
## defense_player_3_...     -0.0387     -0.2802      0.7793      
## defense_player_3_...     -0.0006     -0.0042      0.9966      
## defense_player_3_...     -0.0045     -0.3518      0.7250      
## defense_player_3_...      0.0236      0.1221      0.9028      
## defense_player_3_...      0.0154      1.3574      0.1747      
## defense_player_1_...     -0.0043     -0.5004      0.6168      
## defense_player_3_...     -0.0025     -0.3118      0.7552      
## defense_player_15...     -0.0023     -0.2541      0.7994      
## defense_player_21...      0.0001      0.0045      0.9964      
## defense_player_3_...     -0.0034     -0.0802      0.9361      
## yardline_11_20            0.0711      2.2404      0.0251    **
## yardline_21_30            0.0600      1.9531      0.0509     *
## yardline_31_40            0.0624      2.2949      0.0218    **
## yardline_41_50            0.1079      3.9006      0.0001   ***
## yardline_51_60            0.0751      2.3631      0.0182    **
## yardline_61_70            0.0966      2.8177      0.0049   ***
## yardline_71_80            0.1304      3.1034      0.0019   ***
## yardline_81_90            0.1850      2.9834      0.0029   ***
## yardline_91_100           0.1702      1.6895      0.0912     *
## year2017_team_BUF        -0.0555     -0.2925      0.7699      
## year2017_team_CHI         0.0983      0.5866      0.5575      
## year2017_team_CLE         0.1796      0.9667      0.3338      
## year2017_team_DAL        -0.1295     -0.7555      0.4500      
## year2017_team_DET        -0.0481     -0.2727      0.7851      
## year2017_team_GB          0.5203      2.4341      0.0150    **
## year2017_team_HOU         0.2519      1.2864      0.1984      
## year2017_team_MIA        -0.1101     -0.6239      0.5327      
## year2017_team_MIN        -0.0459     -0.2524      0.8008      
## year2017_team_NE          0.0131      0.0727      0.9420      
## year2017_team_SF          0.3277      1.6787      0.0933     *
## year2017_team_BAL         0.1295      0.6209      0.5347      
## year2017_team_DEN        -0.0013     -0.0072      0.9942      
## year2017_team_LA          0.1570      0.7180      0.4728      
## year2017_team_NYG        -0.0596     -0.3628      0.7168      
## year2017_team_OAK        -0.0834     -0.4610      0.6449      
## year2017_team_SEA         0.2390      1.0690      0.2851      
## year2017_team_CAR         0.1145      0.5250      0.5996      
## year2017_team_CIN         0.1703      0.8567      0.3917      
## year2017_team_IND         0.1252      0.7455      0.4560      
## year2017_team_NO          0.2629      1.1800      0.2381      
## year2017_team_PHI         0.2453      1.1129      0.2658      
## year2017_team_PIT        -0.1434     -0.8635      0.3879      
## year2017_team_TEN         0.0011      0.0052      0.9959      
## year2017_team_WAS         0.1901      0.8445      0.3985      
## year2017_team_KC          0.3851      1.6649      0.0960     *
## year2017_team_LAC         0.1246      0.5546      0.5792      
## year2017_team_NYJ         0.2042      0.9836      0.3254      
## year2017_team_TB          0.0137      0.0583      0.9535      
## year2017_team_ATL         0.0490      0.2608      0.7943      
## year2017_team_JAX         0.0389      0.1989      0.8423      
## year2018_team_ARI        -0.0195     -0.0931      0.9258      
## year2018_team_BAL         0.0334      0.1570      0.8753      
## year2018_team_CAR        -0.0239     -0.1114      0.9113      
## year2018_team_CLE        -0.0621     -0.2946      0.7683      
## year2018_team_DET         0.1637      0.6943      0.4875      
## year2018_team_HOU         0.1909      0.8651      0.3870      
## year2018_team_IND        -0.1005     -0.4891      0.6248      
## year2018_team_KC          0.0772      0.3721      0.7098      
## year2018_team_NYG         0.1410      0.5360      0.5920      
## year2018_team_OAK        -0.1179     -0.5327      0.5943      
## year2018_team_PHI         0.1482      0.5634      0.5732      
## year2018_team_SEA        -0.0861     -0.3380      0.7353      
## year2018_team_BUF        -0.1210     -0.5431      0.5871      
## year2018_team_CHI        -0.0527     -0.2642      0.7916      
## year2018_team_CIN        -0.1279     -0.5692      0.5692      
## year2018_team_DAL        -0.1053     -0.4889      0.6249      
## year2018_team_DEN        -0.0425     -0.1957      0.8448      
## year2018_team_GB         -0.0536     -0.2424      0.8085      
## year2018_team_LAC         0.0411      0.1917      0.8480      
## year2018_team_NE         -0.0575     -0.2523      0.8008      
## year2018_team_NO          0.2119      0.8679      0.3855      
## year2018_team_PIT         0.0009      0.0037      0.9971      
## year2018_team_SF          0.0352      0.1607      0.8723      
## year2018_team_MIA         0.0967      0.4675      0.6402      
## year2018_team_MIN         0.0063      0.0288      0.9770      
## year2018_team_NYJ         0.0719      0.2467      0.8051      
## year2018_team_TB          0.1419      0.5514      0.5814      
## year2018_team_ATL         0.0438      0.2111      0.8329      
## year2018_team_JAX         0.0852      0.3418      0.7325      
## year2018_team_LA         -0.2332     -1.0346      0.3009      
## year2018_team_TEN         0.2316      0.9139      0.3608      
## year2018_team_WAS         0.0714      0.2509      0.8019      
## year2019_team_ARI        -0.1170     -0.5310      0.5955      
## year2019_team_BUF        -0.0348     -0.1491      0.8815      
## year2019_team_CHI         0.0234      0.1099      0.9125      
## year2019_team_CLE         0.0740      0.3383      0.7352      
## year2019_team_DAL        -0.1041     -0.4583      0.6468      
## year2019_team_IND        -0.0683     -0.3296      0.7418      
## year2019_team_JAX         0.0419      0.1966      0.8442      
## year2019_team_KC          0.0035      0.0171      0.9864      
## year2019_team_LAC        -0.1656     -0.8136      0.4159      
## year2019_team_MIN        -0.0474     -0.1973      0.8436      
## year2019_team_NE          0.0319      0.1370      0.8910      
## year2019_team_NO         -0.2304     -1.0638      0.2875      
## year2019_team_PHI         0.1165      0.4675      0.6401      
## year2019_team_SEA        -0.0180     -0.0719      0.9427      
## year2019_team_SF         -0.0314     -0.1504      0.8805      
## year2019_team_TB         -0.1457     -0.7086      0.4786      
## year2019_team_BAL        -0.0403     -0.1921      0.8476      
## year2019_team_CAR        -0.0404     -0.1758      0.8605      
## year2019_team_DEN         0.0944      0.4559      0.6485      
## year2019_team_DET        -0.1637     -0.7671      0.4431      
## year2019_team_HOU        -0.0167     -0.0728      0.9420      
## year2019_team_LA         -0.1032     -0.4127      0.6799      
## year2019_team_MIA        -0.1967     -0.7937      0.4274      
## year2019_team_NYG        -0.1552     -0.6888      0.4910      
## year2019_team_NYJ        -0.2763     -1.3790      0.1680      
## year2019_team_OAK        -0.1084     -0.4919      0.6228      
## year2019_team_PIT        -0.2988     -1.5389      0.1239     .
## year2019_team_TEN        -0.1233     -0.5979      0.5499      
## year2019_team_CIN         0.1343      0.5985      0.5495      
## year2019_team_WAS         0.0445      0.1788      0.8581      
## year2019_team_ATL        -0.0368     -0.1688      0.8660      
## year2019_team_GB         -0.0736     -0.3496      0.7266      
## year2020_team_ATL         0.0333      0.1479      0.8824      
## year2020_team_BAL         0.1216      0.5469      0.5845      
## year2020_team_BUF         0.0268      0.1102      0.9122      
## year2020_team_CAR         0.1533      0.6678      0.5043      
## year2020_team_CIN         0.1190      0.5451      0.5857      
## year2020_team_DEN        -0.0756     -0.3176      0.7508      
## year2020_team_DET        -0.1001     -0.4475      0.6546      
## year2020_team_JAX        -0.1051     -0.4621      0.6441      
## year2020_team_KC          0.0489      0.2141      0.8305      
## year2020_team_LA         -0.1439     -0.6038      0.5460      
## year2020_team_MIN         0.1827      0.8292      0.4071      
## year2020_team_NE         -0.0242     -0.1096      0.9127      
## year2020_team_NO          0.0908      0.4150      0.6781      
## year2020_team_NYG         0.0415      0.1840      0.8540      
## year2020_team_SF          0.0590      0.2503      0.8024      
## year2020_team_WAS         0.0533      0.2397      0.8106      
## year2020_team_CHI         0.0501      0.2166      0.8286      
## year2020_team_DAL         0.0096      0.0436      0.9652      
## year2020_team_GB          0.0073      0.0304      0.9758      
## year2020_team_HOU        -0.0888     -0.3856      0.6998      
## year2020_team_MIA        -0.1189     -0.5067      0.6124      
## year2020_team_NYJ         0.0226      0.0981      0.9219      
## year2020_team_TB          0.1251      0.5463      0.5849      
## year2020_team_TEN        -0.0706     -0.2987      0.7652      
## year2020_team_ARI         0.1390      0.5953      0.5517      
## year2020_team_CLE        -0.1874     -0.7763      0.4376      
## year2020_team_IND        -0.0670     -0.2863      0.7746      
## year2020_team_LAC         0.0734      0.3017      0.7629      
## year2020_team_PHI         0.1406      0.6334      0.5265      
## year2020_team_SEA        -0.0487     -0.2060      0.8368      
## year2020_team_LV         -0.4182     -0.8248      0.4095      
## year2020_team_PIT        -0.1024     -0.4487      0.6537      
## year2021_team_ATL        -0.0551     -0.2269      0.8205      
## year2021_team_BUF         0.0626      0.3085      0.7577      
## year2021_team_CIN        -0.2081     -1.0081      0.3135      
## year2021_team_DAL        -0.0679     -0.3217      0.7477      
## year2021_team_DEN         0.1440      0.6003      0.5483      
## year2021_team_DET        -0.0514     -0.2586      0.7960      
## year2021_team_KC         -0.0031     -0.0156      0.9875      
## year2021_team_LA         -0.0510     -0.2477      0.8044      
## year2021_team_LV          0.0558      0.2631      0.7925      
## year2021_team_MIN        -0.0339     -0.1700      0.8651      
## year2021_team_NE          0.0266      0.1269      0.8990      
## year2021_team_NO         -0.0819     -0.3972      0.6913      
## year2021_team_NYG         0.1503      0.6129      0.5400      
## year2021_team_SF         -0.0617     -0.2940      0.7687      
## year2021_team_TEN        -0.0879     -0.4454      0.6561      
## year2021_team_ARI         0.1977      0.8204      0.4121      
## year2021_team_BAL         0.0645      0.2636      0.7921      
## year2021_team_CAR         0.0422      0.1764      0.8600      
## year2021_team_CHI        -0.1914     -0.9519      0.3412      
## year2021_team_GB          0.0658      0.3287      0.7424      
## year2021_team_IND        -0.1171     -0.5837      0.5594      
## year2021_team_LAC        -0.0142     -0.0669      0.9467      
## year2021_team_MIA        -0.0148     -0.0661      0.9473      
## year2021_team_NYJ        -0.0385     -0.1815      0.8560      
## year2021_team_PHI        -0.0444     -0.1873      0.8514      
## year2021_team_SEA        -0.1870     -0.8603      0.3897      
## year2021_team_TB          0.0229      0.1087      0.9135      
## year2021_team_WAS         0.0229      0.0942      0.9250      
## year2021_team_CLE        -0.1136     -0.5697      0.5689      
## year2021_team_HOU        -0.0951     -0.4544      0.6496      
## year2021_team_JAX        -0.0521     -0.2488      0.8035      
## year2021_team_PIT        -0.0254     -0.1241      0.9013      
## year2022_team_ARI        -0.2581     -1.3001      0.1936      
## year2022_team_ATL        -0.2868     -1.4127      0.1578      
## year2022_team_CAR         0.0703      0.3379      0.7355      
## year2022_team_CHI         0.0435      0.1702      0.8649      
## year2022_team_CIN        -0.0318     -0.1266      0.8993      
## year2022_team_HOU         0.0483      0.1957      0.8448      
## year2022_team_IND        -0.0042     -0.0174      0.9861      
## year2022_team_LAC        -0.1227     -0.6146      0.5389      
## year2022_team_MIA        -0.1530     -0.7359      0.4618      
## year2022_team_SEA        -0.0952     -0.4673      0.6403      
## year2022_team_TB         -0.0557     -0.2803      0.7793      
## year2022_team_TEN         0.1584      0.8109      0.4174      
## year2022_team_WAS         0.0665      0.2804      0.7792      
## year2022_team_BAL        -0.2651     -1.2339      0.2173      
## year2022_team_BUF         0.1061      0.4956      0.6202      
## year2022_team_DAL         0.0110      0.0488      0.9611      
## year2022_team_DET        -0.0493     -0.2466      0.8053      
## year2022_team_GB         -0.1417     -0.7037      0.4817      
## year2022_team_JAX        -0.1483     -0.7664      0.4435      
## year2022_team_KC         -0.0739     -0.3180      0.7505      
## year2022_team_LA          0.1424      0.7090      0.4784      
## year2022_team_LV          0.0772      0.3596      0.7191      
## year2022_team_NO         -0.1197     -0.5549      0.5790      
## year2022_team_PHI         0.1944      0.7807      0.4350      
## year2022_team_PIT         0.0790      0.3966      0.6917      
## year2022_team_CLE        -0.0405     -0.2108      0.8330      
## year2022_team_DEN         0.1161      0.5372      0.5912      
## year2022_team_MIN        -0.0860     -0.3988      0.6900      
## year2022_team_NE          0.0630      0.2870      0.7742      
## year2022_team_NYJ        -0.1190     -0.5911      0.5545      
## year2022_team_NYG         0.0390      0.1571      0.8752      
## year2022_team_SF         -0.1456     -0.6515      0.5148      
## year2023_team_BAL        -0.1429     -0.6995      0.4843      
## year2023_team_CHI        -0.1649     -0.8120      0.4168      
## year2023_team_CLE        -0.2186     -1.0958      0.2732      
## year2023_team_GB          0.0309      0.1516      0.8795      
## year2023_team_IND         0.0287      0.1467      0.8834      
## year2023_team_KC          0.0226      0.1096      0.9127      
## year2023_team_LAC         0.0257      0.1236      0.9016      
## year2023_team_LV         -0.0529     -0.2669      0.7896      
## year2023_team_MIA         0.0984      0.4601      0.6455      
## year2023_team_MIN         0.1355      0.6980      0.4852      
## year2023_team_NO         -0.0316     -0.1462      0.8838      
## year2023_team_NYG         0.1418      0.5849      0.5587      
## year2023_team_SEA        -0.1536     -0.6449      0.5191      
## year2023_team_SF          0.0369      0.1644      0.8694      
## year2023_team_WAS         0.2219      0.9243      0.3554      
## year2023_team_ATL        -0.0711     -0.3150      0.7528      
## year2023_team_BUF        -0.1360     -0.6545      0.5128      
## year2023_team_CAR        -0.0598     -0.3048      0.7605      
## year2023_team_DAL        -0.0074     -0.0363      0.9710      
## year2023_team_DEN        -0.0488     -0.2478      0.8043      
## year2023_team_HOU        -0.0339     -0.1699      0.8651      
## year2023_team_LA          0.1316      0.5298      0.5963      
## year2023_team_NE          0.1419      0.5682      0.5699      
## year2023_team_PHI         0.0746      0.2920      0.7703      
## year2023_team_PIT        -0.0422     -0.1990      0.8422      
## year2023_team_TEN        -0.0557     -0.2690      0.7880      
## year2023_team_ARI        -0.2519     -1.2222      0.2217      
## year2023_team_CIN        -0.2207     -1.0726      0.2835      
## year2023_team_DET         0.1511      0.6120      0.5406      
## year2023_team_TB          0.0695      0.3333      0.7389      
## year2023_team_JAX        -0.1960     -0.9012      0.3675      
## year2023_team_NYJ         0.1447      0.6831      0.4946      
## is_first_half            -0.0255     -1.4445      0.1487     .
## time_in_half              0.0118      1.2041      0.2286      
## attendance_pct            0.2200      1.0610      0.2888      
## home_attendance          -0.0112     -0.1316      0.8953</code></pre>
<pre class="r"><code>cat(&quot;\nSignificance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15\n&quot;)</code></pre>
<pre><code>## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</code></pre>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIkhlY2ttYW4gU2VsZWN0aW9uIE1vZGVsIEFuYWx5c2lzIg0Kb3V0cHV0OiBodG1sX2RvY3VtZW50DQotLS0NCg0KYGBge3Igb3B0aW9ucywgaW5jbHVkZT1GQUxTRX0NCm9wdGlvbnMobWF4LnByaW50PTEwMDAwKQ0KYGBgDQoNCmBgYHtyfQ0KbGlicmFyeShkYXRhLnRhYmxlKQ0Kb3V0Y29tZV9kYXRhIDwtIGZyZWFkKCJwcmVkaWN0X291dGNvbWUuY3N2Lmd6IikNCnNlbGVjdF9kYXRhIDwtIGZyZWFkKCJwcmVkaWN0X3NlbGVjdC5jc3YuZ3oiKQ0KYGBgDQoNCmBgYHtyfQ0Kc2VsZWN0X2RhdGFbLCBhdHRlbXB0IDo9IGFzLm51bWVyaWMoYXMuY2hhcmFjdGVyKGF0dGVtcHQpKV0NCmBgYA0KDQoNCg0KYGBge3J9DQojIENvbW1lbnRlZCBvdXQgb3JpZ2luYWwgdmVyc2lvbg0KIyAjIExvYWQgcmVxdWlyZWQgbGlicmFyaWVzDQojIGxpYnJhcnkoZGF0YS50YWJsZSkNCiMgbGlicmFyeSh4Z2Jvb3N0KQ0KIyBsaWJyYXJ5KFJPQ1IpDQojIGxpYnJhcnkocGFyYWxsZWwpDQojIA0KIyAjIFByZXBhcmUgdGhlIFhHQm9vc3QgbWF0cmljZXMNCiMgeHMgPC0gbW9kZWwubWF0cml4KH4gLiAtIDEgLSBhdHRlbXB0IC0gbXlfaWQsIGRhdGEgPSBzZWxlY3RfZGF0YSkNCiMgeSA8LSBhcy5udW1lcmljKGFzLmNoYXJhY3RlcihzZWxlY3RfZGF0YSRhdHRlbXB0KSkNCiMgDQojICMgQ3JlYXRlIHBhcmFtZXRlciBncmlkDQojIGdyaWQgPC0gZXhwYW5kLmdyaWQoDQojICAgZXRhID0gc2VxKDAuMDAxLCAwLjEsIGJ5ID0gMC4wMiksDQojICAgbWF4X2RlcHRoID0gc2VxKDUsIDcsIGJ5ID0gMiksDQojICAgbWluX2NoaWxkX3dlaWdodCA9IHNlcSgxLCAxLCBieSA9IDEpLCAgICAgICAgDQojICAgc3Vic2FtcGxlID0gc2VxKDAuOCwgMC44LCBieSA9IDAuMiksDQojICAgY29sc2FtcGxlX2J5dHJlZSA9IHNlcSgwLjgsIDAuOCwgYnkgPSAwLjIpLA0KIyAgIGxhbWJkYSA9IHNlcSgxLCAxLCBieSA9IDEpLCAgICAgICAgICAgICAgICANCiMgICBhbHBoYSA9IHNlcSgwLCAwLCBieSA9IDEpLCAgICAgICAgICAgICAgICAgIA0KIyAgIGdhbW1hID0gc2VxKDAsIDAsIGJ5ID0gMC4xKSwgICAgICAgICAgICAgICANCiMgICBucm91bmRzID0gc2VxKDEwMCwgNTAwLCBieSA9IDUwMCkNCiMgKQ0KIyANCiMgIyBTYW1wbGUgZ3JpZCBwb2ludHMNCiMgY29uZl9sZXYgPC0gLjk1DQojIG51bV9tYXggPC0gNQ0KIyBuIDwtIGNlaWxpbmcobG9nKDEtY29uZl9sZXYpL2xvZygxLW51bV9tYXgvbnJvdyhncmlkKSkpDQojIGluZCA8LSBzYW1wbGUobnJvdyhncmlkKSwgbiwgcmVwbGFjZSA9IEZBTFNFKQ0KIyByZ3JpZCA8LSBncmlkW2luZCwgXQ0KIyANCiMgIyBTZXQgdXAgcGFyYWxsZWwgcHJvY2Vzc2luZw0KIyBuYyA8LSBkZXRlY3RDb3JlcygpIC0gMQ0KIyANCiMgIyBWYWxpZGF0aW9uIHBoYXNlDQojIGNhdCgiXG5QaGFzZSAxOiBWYWxpZGF0aW9uIFBoYXNlXG4iKQ0KIyBuX3ZhbGlkYXRpb25zIDwtIDINCiMgdmFsaWRhdGlvbl9yZXN1bHRzIDwtIG1hdHJpeChucm93ID0gbnJvdyhyZ3JpZCksIG5jb2wgPSBuX3ZhbGlkYXRpb25zKQ0KIyANCiMgZm9yIChqIGluIDE6bnJvdyhyZ3JpZCkpIHsNCiMgICBjYXQoIlxuVGVzdGluZyBwYXJhbWV0ZXIgc2V0IiwgaiwgIm9mIiwgbnJvdyhyZ3JpZCksICJcbiIpDQojICAgDQojICAgZm9yIChpIGluIDE6bl92YWxpZGF0aW9ucykgew0KIyAgICAgIyBDcmVhdGUgdmFsaWRhdGlvbiBzcGxpdA0KIyAgICAgaWR4IDwtIHVuaXF1ZShzYW1wbGUobnJvdyh4cyksIG5yb3coeHMpLCBUUlVFKSkNCiMgICAgIHRyYWluX3ggPC0geHNbaWR4LCBdDQojICAgICB0cmFpbl95IDwtIHlbaWR4XQ0KIyAgICAgdmFsX3ggPC0geHNbLWlkeCwgXQ0KIyAgICAgdmFsX3kgPC0geVstaWR4XQ0KIyAgICAgDQojICAgICAjIFVuZGVyc2FtcGxlIG1ham9yaXR5IGNsYXNzIGluIHRyYWluaW5nIGRhdGENCiMgICAgIHRyYWluX2lkeF8wIDwtIHdoaWNoKHRyYWluX3kgPT0gMCkNCiMgICAgIHRyYWluX2lkeF8xIDwtIHdoaWNoKHRyYWluX3kgPT0gMSkNCiMgICAgIA0KIyAgICAgIyBHZXQgbnVtYmVyIG9mIG1pbm9yaXR5IGNsYXNzIHNhbXBsZXMNCiMgICAgIG5fbWlub3JpdHkgPC0gbGVuZ3RoKHRyYWluX2lkeF8xKQ0KIyAgICAgDQojICAgICAjIFJhbmRvbWx5IHNhbXBsZSBmcm9tIG1ham9yaXR5IGNsYXNzDQojICAgICB0cmFpbl9pZHhfMF9zYW1wbGVkIDwtIHNhbXBsZSh0cmFpbl9pZHhfMCwgbl9taW5vcml0eSkNCiMgICAgIA0KIyAgICAgIyBDb21iaW5lIGluZGljZXMgZm9yIGJhbGFuY2VkIGRhdGFzZXQNCiMgICAgIGJhbGFuY2VkX2lkeCA8LSBjKHRyYWluX2lkeF8wX3NhbXBsZWQsIHRyYWluX2lkeF8xKQ0KIyAgICAgDQojICAgICAjIENyZWF0ZSBiYWxhbmNlZCB0cmFpbmluZyBkYXRhc2V0DQojICAgICB0cmFpbl94X2JhbGFuY2VkIDwtIHRyYWluX3hbYmFsYW5jZWRfaWR4LCBdDQojICAgICB0cmFpbl95X2JhbGFuY2VkIDwtIHRyYWluX3lbYmFsYW5jZWRfaWR4XQ0KIyAgICAgDQojICAgICBwcm0gPC0gbGlzdCgNCiMgICAgICAgYm9vc3RlciA9ICJnYnRyZWUiLA0KIyAgICAgICBvYmplY3RpdmUgPSAiYmluYXJ5OmxvZ2lzdGljIiwNCiMgICAgICAgbWF4X2RlcHRoID0gcmdyaWRbaiwgIm1heF9kZXB0aCJdLA0KIyAgICAgICBldGEgPSByZ3JpZFtqLCAiZXRhIl0sDQojICAgICAgIHN1YnNhbXBsZSA9IHJncmlkW2osICJzdWJzYW1wbGUiXSwNCiMgICAgICAgY29sc2FtcGxlX2J5dHJlZSA9IHJncmlkW2osICJjb2xzYW1wbGVfYnl0cmVlIl0sDQojICAgICAgIGdhbW1hID0gcmdyaWRbaiwgImdhbW1hIl0sDQojICAgICAgIG1pbl9jaGlsZF93ZWlnaHQgPSByZ3JpZFtqLCAibWluX2NoaWxkX3dlaWdodCJdLA0KIyAgICAgICBhbHBoYSA9IHJncmlkW2osICJhbHBoYSJdLA0KIyAgICAgICBsYW1iZGEgPSByZ3JpZFtqLCAibGFtYmRhIl0sDQojICAgICAgIG50aHJlYWQgPSBuYw0KIyAgICAgKQ0KIyAgICAgDQojICAgICBkbV90cmFpbiA8LSB4Z2IuRE1hdHJpeChkYXRhID0gdHJhaW5feF9iYWxhbmNlZCwgbGFiZWwgPSB0cmFpbl95X2JhbGFuY2VkKQ0KIyAgICAgbWRsIDwtIHhnYi50cmFpbigNCiMgICAgICAgcGFyYW1zID0gcHJtLA0KIyAgICAgICBkYXRhID0gZG1fdHJhaW4sDQojICAgICAgIG5yb3VuZHMgPSByZ3JpZFtqLCAibnJvdW5kcyJdLA0KIyAgICAgICB2ZXJib3NlID0gRkFMU0UNCiMgICAgICkNCiMgICAgIA0KIyAgICAgcCA8LSBwcmVkaWN0KG1kbCwgeGdiLkRNYXRyaXgoZGF0YSA9IHZhbF94KSkNCiMgICAgIHByZWQgPC0gcHJlZGljdGlvbihwLCB2YWxfeSkNCiMgICAgIHZhbGlkYXRpb25fcmVzdWx0c1tqLCBpXSA8LSBwZXJmb3JtYW5jZShwcmVkLCAiYXVjIilAeS52YWx1ZXNbWzFdXQ0KIyAgIH0NCiMgfQ0KIyANCiMgIyBSdW4gMTAwIHRlc3RzIHdpdGggYmVzdCBwYXJhbWV0ZXJzDQojIGNhdCgiXG5SdW5uaW5nIFggdGVzdCBpdGVyYXRpb25zIHdpdGggYmVzdCBwYXJhbWV0ZXJzLi4uXG4iKQ0KIyB0ZXN0X2F1Y3MgPC0gYygpDQojIA0KIyBiZXN0X3BhcmFtc19pZHggPC0gd2hpY2gubWF4KHJvd01lYW5zKHZhbGlkYXRpb25fcmVzdWx0cykpDQojIGJlc3RfcGFyYW1zIDwtIHJncmlkW2Jlc3RfcGFyYW1zX2lkeCxdDQojIA0KIyAjIFRyYWluIGZpbmFsIG1vZGVsIHdpdGggYmVzdCBwYXJhbWV0ZXJzDQojIGJlc3RfcGFyYW1zX2xpc3QgPC0gYXMubGlzdChiZXN0X3BhcmFtc1std2hpY2gobmFtZXMoYmVzdF9wYXJhbXMpID09ICJucm91bmRzIildKQ0KIyBiZXN0X3BhcmFtc19saXN0JGJvb3N0ZXIgPC0gImdidHJlZSINCiMgYmVzdF9wYXJhbXNfbGlzdCRvYmplY3RpdmUgPC0gImJpbmFyeTpsb2dpc3RpYyINCiMgYmVzdF9wYXJhbXNfbGlzdCRudGhyZWFkIDwtIG5jDQojIA0KIyBmb3IoaSBpbiAxOjEwMCkgew0KIyAgICMgQ3JlYXRlIHRlc3Qgc3BsaXQNCiMgICBpZHggPC0gdW5pcXVlKHNhbXBsZShucm93KHhzKSwgbnJvdyh4cyksIFQpKQ0KIyAgIHRyYWluX3ggPC0geHNbaWR4LCBdDQojICAgdHJhaW5feSA8LSB5W2lkeF0NCiMgICB0ZXN0X3ggPC0geHNbLWlkeCwgXQ0KIyAgIHRlc3RfeSA8LSB5Wy1pZHhdDQojICAgDQojICAgIyBVbmRlcnNhbXBsZSB0cmFpbmluZyBkYXRhDQojICAgdHJhaW5faWR4XzAgPC0gd2hpY2godHJhaW5feSA9PSAwKQ0KIyAgIHRyYWluX2lkeF8xIDwtIHdoaWNoKHRyYWluX3kgPT0gMSkNCiMgICBuX21pbm9yaXR5IDwtIGxlbmd0aCh0cmFpbl9pZHhfMSkNCiMgICB0cmFpbl9pZHhfMF9zYW1wbGVkIDwtIHNhbXBsZSh0cmFpbl9pZHhfMCwgbl9taW5vcml0eSkNCiMgICBiYWxhbmNlZF9pZHggPC0gYyh0cmFpbl9pZHhfMF9zYW1wbGVkLCB0cmFpbl9pZHhfMSkNCiMgICANCiMgICAjIENyZWF0ZSBiYWxhbmNlZCB0cmFpbmluZyBkYXRhc2V0DQojICAgdHJhaW5feF9iYWxhbmNlZCA8LSB0cmFpbl94W2JhbGFuY2VkX2lkeCwgXQ0KIyAgIHRyYWluX3lfYmFsYW5jZWQgPC0gdHJhaW5feVtiYWxhbmNlZF9pZHhdDQojICAgDQojICAgIyBUcmFpbiBtb2RlbA0KIyAgIGRtX3RyYWluIDwtIHhnYi5ETWF0cml4KGRhdGEgPSB0cmFpbl94X2JhbGFuY2VkLCBsYWJlbCA9IHRyYWluX3lfYmFsYW5jZWQpDQojICAgbWRsIDwtIHhnYi50cmFpbigNCiMgICAgIHBhcmFtcyA9IGJlc3RfcGFyYW1zX2xpc3QsDQojICAgICBkYXRhID0gZG1fdHJhaW4sDQojICAgICBucm91bmRzID0gYmVzdF9wYXJhbXNbWyJucm91bmRzIl1dLA0KIyAgICAgdmVyYm9zZSA9IEZBTFNFDQojICAgKQ0KIyAgIA0KIyAgICMgVGVzdCBvbiB1bmJhbGFuY2VkIHRlc3Qgc2V0DQojICAgcCA8LSBwcmVkaWN0KG1kbCwgeGdiLkRNYXRyaXgoZGF0YSA9IHRlc3RfeCkpDQojICAgcHJlZCA8LSBwcmVkaWN0aW9uKHAsIHRlc3RfeSkNCiMgICB0ZXN0X2F1Y3NbaV0gPC0gcGVyZm9ybWFuY2UocHJlZCwgImF1YyIpQHkudmFsdWVzW1sxXV0NCiMgfQ0KIyANCiMgIyBQcmludCByZXN1bHRzDQojIGNhdCgiXG5UZXN0IFJlc3VsdHMgb3ZlciAxMDAgaXRlcmF0aW9uczpcbiIpDQojIGNhdCgiTWVhbiBBVUM6IiwgbWVhbih0ZXN0X2F1Y3MpLCAiXG4iKQ0KIyBjYXQoIlNEIEFVQzoiLCBzZCh0ZXN0X2F1Y3MpLCAiXG4iKQ0KIyBjYXQoIjk1JSBDSToiLCBtZWFuKHRlc3RfYXVjcykgLSAxLjk2ICogc2QodGVzdF9hdWNzKSwgDQojICAgICAidG8iLCBtZWFuKHRlc3RfYXVjcykgKyAxLjk2ICogc2QodGVzdF9hdWNzKSwgIlxuIikNCiMgDQojICMgUGxvdHRpbmcgQVVDIGRpc3RyaWJ1dGlvbg0KIyBwbG90KHRlc3RfYXVjcywgY29sPSJyZWQiLCBwY2g9MjAsDQojICAgICAgbWFpbj0iQVVDIFRlc3QgRGlzdHJpYnV0aW9uIiwNCiMgICAgICB4bGFiPSJJdGVyYXRpb24iLCB5bGFiPSJBVUMiKQ0KIyBhYmxpbmUoaD1tZWFuKHRlc3RfYXVjcyksIGNvbD0iYmx1ZSIsIGx3ZD0yLCBsdHk9MikNCiMgYWJsaW5lKGg9bWVhbih0ZXN0X2F1Y3MpIC0gMS45NiAqIHNkKHRlc3RfYXVjcyksIGNvbD0iZ3JlZW4iLCBsd2Q9MiwgbHR5PTMpDQojIGFibGluZShoPW1lYW4odGVzdF9hdWNzKSArIDEuOTYgKiBzZCh0ZXN0X2F1Y3MpLCBjb2w9ImdyZWVuIiwgbHdkPTIsIGx0eT0zKQ0KIyBsZWdlbmQoImJvdHRvbXJpZ2h0IiwgDQojICAgICAgICBsZWdlbmQ9YygiQVVDIFZhbHVlcyIsICJNZWFuIiwgIjk1JSBDSSBCb3VuZHMiKSwNCiMgICAgICAgIGNvbD1jKCJyZWQiLCAiYmx1ZSIsICJncmVlbiIpLA0KIyAgICAgICAgbHR5PWMoTkEsIDIsIDMpLA0KIyAgICAgICAgcGNoPWMoMjAsIE5BLCBOQSkpDQojIA0KIyAjIE5vdyB0cmFpbiBmaW5hbCBtb2RlbCBvbiBmdWxsIGRhdGEgZm9yIHogc2NvcmVzDQojIGZpbmFsX2lkeF8wIDwtIHdoaWNoKHkgPT0gMCkNCiMgZmluYWxfaWR4XzEgPC0gd2hpY2goeSA9PSAxKQ0KIyBuX21pbm9yaXR5X2ZpbmFsIDwtIGxlbmd0aChmaW5hbF9pZHhfMSkNCiMgZmluYWxfaWR4XzBfc2FtcGxlZCA8LSBzYW1wbGUoZmluYWxfaWR4XzAsIG5fbWlub3JpdHlfZmluYWwpDQojIGZpbmFsX2JhbGFuY2VkX2lkeCA8LSBjKGZpbmFsX2lkeF8wX3NhbXBsZWQsIGZpbmFsX2lkeF8xKQ0KIyANCiMgIyBDcmVhdGUgYmFsYW5jZWQgZmluYWwgZGF0YXNldA0KIyB4c19iYWxhbmNlZCA8LSB4c1tmaW5hbF9iYWxhbmNlZF9pZHgsIF0NCiMgeV9iYWxhbmNlZCA8LSB5W2ZpbmFsX2JhbGFuY2VkX2lkeF0NCiMgDQojIGRtX2Z1bGwgPC0geGdiLkRNYXRyaXgoZGF0YSA9IHhzX2JhbGFuY2VkLCBsYWJlbCA9IHlfYmFsYW5jZWQpDQojIGZpbmFsX21vZGVsIDwtIHhnYi50cmFpbigNCiMgICBwYXJhbXMgPSBiZXN0X3BhcmFtc19saXN0LA0KIyAgIGRhdGEgPSBkbV9mdWxsLA0KIyAgIG5yb3VuZHMgPSBiZXN0X3BhcmFtc1tbIm5yb3VuZHMiXV0sDQojICAgdmVyYm9zZSA9IEZBTFNFDQojICkNCiMgDQojICMgR2V0IHByb2JhYmlsaXR5IHByZWRpY3Rpb25zICh6KSBmb3IgQUxMIGRhdGENCiMgeiA8LSBwcmVkaWN0KGZpbmFsX21vZGVsLCB4Z2IuRE1hdHJpeChkYXRhID0geHMpKQ0KYGBgDQoNCmBgYHtyfQ0KbGlicmFyeShkYXRhLnRhYmxlKQ0KbGlicmFyeSh4Z2Jvb3N0KQ0KbGlicmFyeShST0NSKQ0KbGlicmFyeShwYXJhbGxlbCkNCg0KIyBQcmVwYXJlIHRoZSBYR0Jvb3N0IG1hdHJpY2VzDQp4cyA8LSBtb2RlbC5tYXRyaXgofiAuIC0gMSAtIGF0dGVtcHQgLSBteV9pZCwgZGF0YSA9IHNlbGVjdF9kYXRhKQ0KeSA8LSBhcy5udW1lcmljKGFzLmNoYXJhY3RlcihzZWxlY3RfZGF0YSRhdHRlbXB0KSkNCg0KIyBDcmVhdGUgcGFyYW1ldGVyIGdyaWQNCmdyaWQgPC0gZXhwYW5kLmdyaWQoDQogIGV0YSA9IHNlcSgwLjAwMSwgMC4xLCBieSA9IDAuMDIpLA0KICBtYXhfZGVwdGggPSBzZXEoNSwgNywgYnkgPSAyKSwNCiAgbWluX2NoaWxkX3dlaWdodCA9IHNlcSgxLCAxLCBieSA9IDEpLCAgICAgICAgDQogIHN1YnNhbXBsZSA9IHNlcSgwLjgsIDEsIGJ5ID0gMC4yKSwNCiAgY29sc2FtcGxlX2J5dHJlZSA9IHNlcSgwLjgsIDEsIGJ5ID0gMC4yKSwNCiAgbGFtYmRhID0gc2VxKDEsIDEsIGJ5ID0gMSksICAgICAgICAgICAgICAgIA0KICBhbHBoYSA9IHNlcSgwLCAwLCBieSA9IDEpLCAgICAgICAgICAgICAgICAgIA0KICBnYW1tYSA9IHNlcSgwLCAwLCBieSA9IDAuMSksICAgICAgICAgICAgICAgDQogIG5yb3VuZHMgPSBzZXEoMTAwLCA1MDAsIGJ5ID0gNTApDQopDQoNCiMgU2FtcGxlIGdyaWQgcG9pbnRzDQpjb25mX2xldiA8LSAuOTUNCm51bV9tYXggPC0gNQ0KbiA8LSBjZWlsaW5nKGxvZygxLWNvbmZfbGV2KS9sb2coMS1udW1fbWF4L25yb3coZ3JpZCkpKQ0KaW5kIDwtIHNhbXBsZShucm93KGdyaWQpLCBuLCByZXBsYWNlID0gRkFMU0UpDQpyZ3JpZCA8LSBncmlkW2luZCwgXQ0KDQojIFNldCB1cCBwYXJhbGxlbCBwcm9jZXNzaW5nDQpuYyA8LSBkZXRlY3RDb3JlcygpIC0gMQ0KDQojIENhbGN1bGF0ZSBzY2FsZV9wb3Nfd2VpZ2h0IGZvciBpbWJhbGFuY2VkIGRhdGFzZXQNCnNjYWxlX3Bvc193ZWlnaHQgPC0gc3VtKHkgPT0gMCkgLyBzdW0oeSA9PSAxKQ0KDQojIFZhbGlkYXRpb24gcGhhc2UNCmNhdCgiXG5QaGFzZSAxOiBWYWxpZGF0aW9uIFBoYXNlXG4iKQ0Kbl92YWxpZGF0aW9ucyA8LSAyMA0KdmFsaWRhdGlvbl9yZXN1bHRzIDwtIG1hdHJpeChucm93ID0gbnJvdyhyZ3JpZCksIG5jb2wgPSBuX3ZhbGlkYXRpb25zKQ0KDQpmb3IgKGogaW4gMTpucm93KHJncmlkKSkgew0KICAjY2F0KCJcblRlc3RpbmcgcGFyYW1ldGVyIHNldCIsIGosICJvZiIsIG5yb3cocmdyaWQpLCAiXG4iKQ0KICANCiAgZm9yIChpIGluIDE6bl92YWxpZGF0aW9ucykgew0KICAgICMgQ3JlYXRlIHZhbGlkYXRpb24gc3BsaXQNCiAgICBpZHggPC0gdW5pcXVlKHNhbXBsZShucm93KHhzKSwgbnJvdyh4cyksIFRSVUUpKQ0KICAgIHRyYWluX3ggPC0geHNbaWR4LCBdDQogICAgdHJhaW5feSA8LSB5W2lkeF0NCiAgICB2YWxfeCA8LSB4c1staWR4LCBdDQogICAgdmFsX3kgPC0geVstaWR4XQ0KICAgIA0KICAgIHBybSA8LSBsaXN0KA0KICAgICAgYm9vc3RlciA9ICJnYnRyZWUiLA0KICAgICAgb2JqZWN0aXZlID0gImJpbmFyeTpsb2dpc3RpYyIsDQogICAgICBtYXhfZGVwdGggPSByZ3JpZFtqLCAibWF4X2RlcHRoIl0sDQogICAgICBldGEgPSByZ3JpZFtqLCAiZXRhIl0sDQogICAgICBzdWJzYW1wbGUgPSByZ3JpZFtqLCAic3Vic2FtcGxlIl0sDQogICAgICBjb2xzYW1wbGVfYnl0cmVlID0gcmdyaWRbaiwgImNvbHNhbXBsZV9ieXRyZWUiXSwNCiAgICAgIGdhbW1hID0gcmdyaWRbaiwgImdhbW1hIl0sDQogICAgICBtaW5fY2hpbGRfd2VpZ2h0ID0gcmdyaWRbaiwgIm1pbl9jaGlsZF93ZWlnaHQiXSwNCiAgICAgIGFscGhhID0gcmdyaWRbaiwgImFscGhhIl0sDQogICAgICBsYW1iZGEgPSByZ3JpZFtqLCAibGFtYmRhIl0sDQogICAgICBzY2FsZV9wb3Nfd2VpZ2h0ID0gc2NhbGVfcG9zX3dlaWdodCwNCiAgICAgIG50aHJlYWQgPSBuYw0KICAgICkNCiAgICANCiAgICBkbV90cmFpbiA8LSB4Z2IuRE1hdHJpeChkYXRhID0gdHJhaW5feCwgbGFiZWwgPSB0cmFpbl95KQ0KICAgIG1kbCA8LSB4Z2IudHJhaW4oDQogICAgICBwYXJhbXMgPSBwcm0sDQogICAgICBkYXRhID0gZG1fdHJhaW4sDQogICAgICBucm91bmRzID0gcmdyaWRbaiwgIm5yb3VuZHMiXSwNCiAgICAgIHZlcmJvc2UgPSBGQUxTRQ0KICAgICkNCiAgICANCiAgICBwIDwtIHByZWRpY3QobWRsLCB4Z2IuRE1hdHJpeChkYXRhID0gdmFsX3gpKQ0KICAgIHByZWQgPC0gcHJlZGljdGlvbihwLCB2YWxfeSkNCiAgICB2YWxpZGF0aW9uX3Jlc3VsdHNbaiwgaV0gPC0gcGVyZm9ybWFuY2UocHJlZCwgImF1YyIpQHkudmFsdWVzW1sxXV0NCiAgfQ0KfQ0KDQojIFJ1biAxMDAgdGVzdHMgd2l0aCBiZXN0IHBhcmFtZXRlcnMNCmNhdCgiXG5SdW5uaW5nIFggdGVzdCBpdGVyYXRpb25zIHdpdGggYmVzdCBwYXJhbWV0ZXJzLi4uXG4iKQ0KdGVzdF9hdWNzIDwtIGMoKQ0KDQpiZXN0X3BhcmFtc19pZHggPC0gd2hpY2gubWF4KHJvd01lYW5zKHZhbGlkYXRpb25fcmVzdWx0cykpDQpiZXN0X3BhcmFtcyA8LSByZ3JpZFtiZXN0X3BhcmFtc19pZHgsXQ0KDQojIFRyYWluIGZpbmFsIG1vZGVsIHdpdGggYmVzdCBwYXJhbWV0ZXJzDQpiZXN0X3BhcmFtc19saXN0IDwtIGFzLmxpc3QoYmVzdF9wYXJhbXNbLXdoaWNoKG5hbWVzKGJlc3RfcGFyYW1zKSA9PSAibnJvdW5kcyIpXSkNCmJlc3RfcGFyYW1zX2xpc3QkYm9vc3RlciA8LSAiZ2J0cmVlIg0KYmVzdF9wYXJhbXNfbGlzdCRvYmplY3RpdmUgPC0gImJpbmFyeTpsb2dpc3RpYyINCmJlc3RfcGFyYW1zX2xpc3Qkc2NhbGVfcG9zX3dlaWdodCA8LSBzY2FsZV9wb3Nfd2VpZ2h0DQpiZXN0X3BhcmFtc19saXN0JG50aHJlYWQgPC0gbmMNCg0KZm9yKGkgaW4gMToxMCkgew0KICAjIENyZWF0ZSB0ZXN0IHNwbGl0DQogIGlkeCA8LSB1bmlxdWUoc2FtcGxlKG5yb3coeHMpLCBucm93KHhzKSwgVCkpDQogIHRyYWluX3ggPC0geHNbaWR4LCBdDQogIHRyYWluX3kgPC0geVtpZHhdDQogIHRlc3RfeCA8LSB4c1staWR4LCBdDQogIHRlc3RfeSA8LSB5Wy1pZHhdDQogIA0KICAjIFRyYWluIG1vZGVsIG9uIGZ1bGwgdW5iYWxhbmNlZCBkYXRhc2V0DQogIGRtX3RyYWluIDwtIHhnYi5ETWF0cml4KGRhdGEgPSB0cmFpbl94LCBsYWJlbCA9IHRyYWluX3kpDQogIG1kbCA8LSB4Z2IudHJhaW4oDQogICAgcGFyYW1zID0gYmVzdF9wYXJhbXNfbGlzdCwNCiAgICBkYXRhID0gZG1fdHJhaW4sDQogICAgbnJvdW5kcyA9IGJlc3RfcGFyYW1zW1sibnJvdW5kcyJdXSwNCiAgICB2ZXJib3NlID0gRkFMU0UNCiAgKQ0KICANCiAgIyBUZXN0IG9uIHVuYmFsYW5jZWQgdGVzdCBzZXQNCiAgcCA8LSBwcmVkaWN0KG1kbCwgeGdiLkRNYXRyaXgoZGF0YSA9IHRlc3RfeCkpDQogIHByZWQgPC0gcHJlZGljdGlvbihwLCB0ZXN0X3kpDQogIHRlc3RfYXVjc1tpXSA8LSBwZXJmb3JtYW5jZShwcmVkLCAiYXVjIilAeS52YWx1ZXNbWzFdXQ0KfQ0KDQojIFByaW50IHJlc3VsdHMNCmNhdCgiXG5UZXN0IFJlc3VsdHMgb3ZlciAxMDAgaXRlcmF0aW9uczpcbiIpDQpjYXQoIk1lYW4gQVVDOiIsIG1lYW4odGVzdF9hdWNzKSwgIlxuIikNCmNhdCgiU0QgQVVDOiIsIHNkKHRlc3RfYXVjcyksICJcbiIpDQpjYXQoIjk1JSBDSToiLCBtZWFuKHRlc3RfYXVjcykgLSAxLjk2ICogc2QodGVzdF9hdWNzKSwgDQogICAgInRvIiwgbWVhbih0ZXN0X2F1Y3MpICsgMS45NiAqIHNkKHRlc3RfYXVjcyksICJcbiIpDQoNCiMgUGxvdHRpbmcgQVVDIGRpc3RyaWJ1dGlvbg0KcGxvdCh0ZXN0X2F1Y3MsIGNvbD0icmVkIiwgcGNoPTIwLA0KICAgICBtYWluPSJBVUMgVGVzdCBEaXN0cmlidXRpb24iLA0KICAgICB4bGFiPSJJdGVyYXRpb24iLCB5bGFiPSJBVUMiKQ0KYWJsaW5lKGg9bWVhbih0ZXN0X2F1Y3MpIC0gMS45NiAqIHNkKHRlc3RfYXVjcyksIGNvbD0iZ3JlZW4iLCBsd2Q9MiwgbHR5PTMpDQphYmxpbmUoaD1tZWFuKHRlc3RfYXVjcykgKyAxLjk2ICogc2QodGVzdF9hdWNzKSwgY29sPSJncmVlbiIsIGx3ZD0yLCBsdHk9MykNCmxlZ2VuZCgiYm90dG9tcmlnaHQiLCANCiAgICAgICBsZWdlbmQ9YygiQVVDIFZhbHVlcyIsICJNZWFuIiwgIjk1JSBDSSBCb3VuZHMiKSwNCiAgICAgICBjb2w9YygicmVkIiwgImJsdWUiLCAiZ3JlZW4iKSwNCiAgICAgICBsdHk9YyhOQSwgMiwgMyksDQogICAgICAgcGNoPWMoMjAsIE5BLCBOQSkpDQoNCiMgTm93IHRyYWluIGZpbmFsIG1vZGVsIG9uIGZ1bGwgZGF0YSBmb3IgeiBzY29yZXMNCmRtX2Z1bGwgPC0geGdiLkRNYXRyaXgoZGF0YSA9IHhzLCBsYWJlbCA9IHkpDQpmaW5hbF9tb2RlbCA8LSB4Z2IudHJhaW4oDQogIHBhcmFtcyA9IGJlc3RfcGFyYW1zX2xpc3QsDQogIGRhdGEgPSBkbV9mdWxsLA0KICBucm91bmRzID0gYmVzdF9wYXJhbXNbWyJucm91bmRzIl1dLA0KICB2ZXJib3NlID0gRkFMU0UNCikNCg0KIyBHZXQgcHJvYmFiaWxpdHkgcHJlZGljdGlvbnMgKHopIGZvciBBTEwgZGF0YQ0KeiA8LSBwcmVkaWN0KGZpbmFsX21vZGVsLCB4Z2IuRE1hdHJpeChkYXRhID0geHMpKQ0KYGBgDQoNCg0KYGBge3J9DQojIENhbGN1bGF0ZSByZXNpZHVhbHMgZm9yIFhHQm9vc3QgcHJlZGljdGlvbnMNCnkgPC0gYXMubnVtZXJpYyhhcy5jaGFyYWN0ZXIoc2VsZWN0X2RhdGEkYXR0ZW1wdCkpDQpyZXNpZHVhbHMgPC0geSAtIHoNCg0KIyBIaXN0b2dyYW0gb2YgcmVzaWR1YWxzDQpoaXN0KHJlc2lkdWFscywgbWFpbj0iRGlzdHJpYnV0aW9uIG9mIFhHQm9vc3QgTW9kZWwgUmVzaWR1YWxzIiwgeGxhYj0iUmVzaWR1YWwiLCBicmVha3M9MTAwKQ0KYGBgDQoNCmBgYHtyfQ0KIyBwbG90IG91dCB0aGUgeiB2YWx1ZXNcDQpwbG90KGRlbnNpdHkoeiksIA0KICAgICBtYWluID0gIkRlbnNpdHkgb2YgWiBQcmVkaWN0aW9ucyIsDQogICAgIHhsYWIgPSAiUHJlZGljdGVkIFByb2JhYmlsaXR5IG9mIEF0dGVtcHQiLA0KICAgICB5bGFiID0gIkRlbnNpdHkiKQ0KYGBgDQoNCmBgYHtyfQ0KIyBDYWxjdWxhdGUgR0lNUiAobGFtYmRhKSBUaGlzIGlzIEdlbmVyYWxpemVkIGludmVyc2UgbWlsbHMgcmF0aW8NCkdJTVIgPC0gZG5vcm0ocW5vcm0oeikpIC8gKDEgLSBwbm9ybShxbm9ybSh6KSkpDQoNCiMgQWRkIEdJTVIgdG8gdGhlIGRhdGENCnNlbGVjdF9kYXRhWywgR0lNUiA6PSBHSU1SXQ0KDQojIFByaW50IHZhcmlhYmxlIGltcG9ydGENCmBgYA0KDQpgYGB7cn0NCiMgQ3JlYXRlIGEgZGF0YS50YWJsZSB3aXRoIGp1c3QgbXlfaWQgYW5kIEdJTVIgZnJvbSBzZWxlY3RfZGF0YQ0KR0lNUl9kdCA8LSBkYXRhLnRhYmxlKG15X2lkID0gc2VsZWN0X2RhdGEkbXlfaWQsIEdJTVIgPSBHSU1SKQ0KDQojIEFkZCBHSU1SIHRvIG91dGNvbWVfZGF0YSBieSBtYXRjaGluZyBvbiBteV9pZA0Kb3V0Y29tZV9kYXRhW0dJTVJfZHQsIEdJTVIgOj0gaS5HSU1SLCBvbiA9ICJteV9pZCJdDQpgYGANCg0KYGBge3J9DQoja2lsbCAtIG15X2lkDQpvdXRjb21lX2RhdGEgPC0gb3V0Y29tZV9kYXRhWywgbXlfaWQgOj0gTlVMTF0NCm91dGNvbWVfZGF0YVssIHllYXIyMDE3X3RlYW1fQVJJIDo9IE5VTExdDQpvdXRjb21lX2RhdGEgPC0gb3V0Y29tZV9kYXRhWywgeWFyZGxpbmVfMV8xMDo9IE5VTExdDQpgYGANCg0KYGBge3J9DQpvdXRjb21lX2RhdGFbLCBjb252ZXJzaW9uIDo9IGFzLm51bWVyaWMoYXMuY2hhcmFjdGVyKGNvbnZlcnNpb24pKV0NCiMgVGhlbiBydW4gT0xTIHdpdGggR0lNUiBjb3JyZWN0aW9uDQpvbHNfbW9kZWwgPC0gbG0oY29udmVyc2lvbiB+ICAuLCBkYXRhID0gb3V0Y29tZV9kYXRhKQ0KYGBgDQoNCmBgYHtyfQ0KbGlicmFyeShzYW5kd2ljaCkNCmxpYnJhcnkobG10ZXN0KQ0KDQojIEdldCBIQzAtYWRqdXN0ZWQgdC12YWx1ZXMgYW5kIHAtdmFsdWVzDQpyb2J1c3RfdGVzdCA8LSBjb2VmdGVzdChvbHNfbW9kZWwsIHZjb3YgPSB2Y292SEMob2xzX21vZGVsLCB0eXBlID0gIkhDMCIpKQ0KdF9zdGF0cyA8LSByb2J1c3RfdGVzdFssICJ0IHZhbHVlIl0NCnBfdmFsdWVzIDwtIHJvYnVzdF90ZXN0WywgIlByKD58dHwpIl0NCg0KIyBGdW5jdGlvbiB0byBhZGQgc2lnbmlmaWNhbmNlIHN0YXJzDQpnZXRfc3RhcnMgPC0gZnVuY3Rpb24ocCkgew0KICAgIGlmIChwIDw9IDAuMDEpIHJldHVybigiKioqIikNCiAgICBpZiAocCA8PSAwLjA1KSByZXR1cm4oIioqIikNCiAgICBpZiAocCA8PSAwLjEpIHJldHVybigiKiIpDQogICAgaWYgKHAgPD0gMC4xNSkgcmV0dXJuKCIuIikNCiAgICByZXR1cm4oIiIpDQp9DQoNCiMgTWF4aW11bSB3aWR0aCBmb3IgdmFyaWFibGUgbmFtZXMNCm5hbWVfd2lkdGggPC0gMjANCg0KIyBQcmludCBoZWFkZXIgd2l0aCBhbGlnbm1lbnQNCmNhdChzcHJpbnRmKCIlLSpzICAlMTBzICAlMTBzICAlNHNcbiIsIG5hbWVfd2lkdGgsICJWYXJpYWJsZSIsICJ0LXZhbHVlIiwgInAtdmFsdWUiLCAic2lnIikpDQpjYXQoc3ByaW50ZigiJS0qcyAgJTEwcyAgJTEwcyAgJTRzXG4iLCBuYW1lX3dpZHRoLCAiLS0tLS0tLS0tIiwgIi0tLS0tLS0iLCAiLS0tLS0tLSIsICItLS0tIikpDQoNCiMgTG9vcCB0aHJvdWdoIGFuZCBwcmludCB2YWx1ZXMNCmZvciAoaSBpbiAxOmxlbmd0aCh0X3N0YXRzKSkgew0KICAgIHZhcl9uYW1lIDwtIHJvd25hbWVzKHJvYnVzdF90ZXN0KVtpXQ0KICAgICMgVHJ1bmNhdGUgbmFtZSBpZiB0b28gbG9uZw0KICAgIGlmIChuY2hhcih2YXJfbmFtZSkgPiBuYW1lX3dpZHRoKSB7DQogICAgICAgIHZhcl9uYW1lIDwtIHBhc3RlMChzdWJzdHIodmFyX25hbWUsIDEsIG5hbWVfd2lkdGgtMyksICIuLi4iKQ0KICAgIH0NCiAgICBjYXQoc3ByaW50ZigiJS0qcyAgJTEwLjRmICAlMTAuNGYgICU0c1xuIiwgDQogICAgICAgICAgICAgICAgbmFtZV93aWR0aCwgdmFyX25hbWUsIA0KICAgICAgICAgICAgICAgIHRfc3RhdHNbaV0sIHBfdmFsdWVzW2ldLA0KICAgICAgICAgICAgICAgIGdldF9zdGFycyhwX3ZhbHVlc1tpXSkpKQ0KfQ0KDQpjYXQoIlxuU2lnbmlmaWNhbmNlIGNvZGVzOiAwICcqKionIDAuMDEgJyoqJyAwLjA1ICcqJyAwLjEgJy4nIDAuMTUiKQ0KYGBgDQoNCg0KYGBge3J9DQojIENyZWF0ZSBhIGNvcHkgb2Ygb3V0Y29tZV9kYXRhIHdpdGhvdXQgR0lNUg0Kb3V0Y29tZV9kYXRhX25vX2dpbXIgPC0gY29weShvdXRjb21lX2RhdGEpDQpvdXRjb21lX2RhdGFfbm9fZ2ltclssIEdJTVIgOj0gTlVMTF0NCg0KIyBSdW4gT0xTIHdpdGhvdXQgR0lNUiBjb3JyZWN0aW9uDQpvbHNfbW9kZWxfbm9fZ2ltciA8LSBsbShjb252ZXJzaW9uIH4gLiwgZGF0YSA9IG91dGNvbWVfZGF0YV9ub19naW1yKQ0KDQojIEdldCBIQzAtYWRqdXN0ZWQgdC12YWx1ZXMgYW5kIHAtdmFsdWVzIGZvciBtb2RlbCB3aXRob3V0IEdJTVINCnJvYnVzdF90ZXN0X25vX2dpbXIgPC0gY29lZnRlc3Qob2xzX21vZGVsX25vX2dpbXIsIHZjb3YgPSB2Y292SEMob2xzX21vZGVsX25vX2dpbXIsIHR5cGUgPSAiSEMwIikpDQp0X3N0YXRzX25vX2dpbXIgPC0gcm9idXN0X3Rlc3Rfbm9fZ2ltclssICJ0IHZhbHVlIl0NCnBfdmFsdWVzX25vX2dpbXIgPC0gcm9idXN0X3Rlc3Rfbm9fZ2ltclssICJQcig+fHR8KSJdDQpjb2VmZmljaWVudHNfbm9fZ2ltciA8LSBjb2VmKG9sc19tb2RlbF9ub19naW1yKQ0KDQojIFByaW50IHJlc3VsdHMgZm9yIG1vZGVsIHdpdGhvdXQgR0lNUg0KY2F0KCJcbk1vZGVsIFJlc3VsdHMgV0lUSE9VVCBHSU1SOlxuIikNCmNhdChzcHJpbnRmKCIlLSpzICAlMTBzICAlMTBzICAlMTBzICAlNHNcbiIsIG5hbWVfd2lkdGgsICJWYXJpYWJsZSIsICJDb2VmIiwgInQtdmFsdWUiLCAicC12YWx1ZSIsICJzaWciKSkNCmNhdChzcHJpbnRmKCIlLSpzICAlMTBzICAlMTBzICAlMTBzICAlNHNcbiIsIG5hbWVfd2lkdGgsICItLS0tLS0tLS0iLCAiLS0tLSIsICItLS0tLS0tIiwgIi0tLS0tLS0iLCAiLS0tIikpDQoNCmZvciAoaSBpbiAxOmxlbmd0aCh0X3N0YXRzX25vX2dpbXIpKSB7DQogICAgdmFyX25hbWUgPC0gcm93bmFtZXMocm9idXN0X3Rlc3Rfbm9fZ2ltcilbaV0NCiAgICBpZiAobmNoYXIodmFyX25hbWUpID4gbmFtZV93aWR0aCkgew0KICAgICAgICB2YXJfbmFtZSA8LSBwYXN0ZTAoc3Vic3RyKHZhcl9uYW1lLCAxLCBuYW1lX3dpZHRoLTMpLCAiLi4uIikNCiAgICB9DQogICAgY2F0KHNwcmludGYoIiUtKnMgICUxMC40ZiAgJTEwLjRmICAlMTAuNGYgICU0c1xuIiwgDQogICAgICAgICAgICAgICAgbmFtZV93aWR0aCwgdmFyX25hbWUsDQogICAgICAgICAgICAgICAgY29lZmZpY2llbnRzX25vX2dpbXJbaV0sDQogICAgICAgICAgICAgICAgdF9zdGF0c19ub19naW1yW2ldLCANCiAgICAgICAgICAgICAgICBwX3ZhbHVlc19ub19naW1yW2ldLA0KICAgICAgICAgICAgICAgIGdldF9zdGFycyhwX3ZhbHVlc19ub19naW1yW2ldKSkpDQp9DQoNCmNhdCgiXG5TaWduaWZpY2FuY2UgY29kZXM6IDAgJyoqKicgMC4wMSAnKionIDAuMDUgJyonIDAuMSAnLicgMC4xNVxuIikNCg0KDQpgYGANCg==</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("heckman.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
