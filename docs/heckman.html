<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Heckman Selection Model Analysis</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">4th Downs in the NFL</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="heckman.html">Heckman Selection</a>
</li>
<li>
  <a href="xgboost.html">XGBoost Prediction</a>
</li>
<li>
  <a href="attendance_binary.html">Attendance Impact Binary</a>
</li>
<li>
  <a href="thirddown.html">Third Down Analysis</a>
</li>
<li>
  <a href="attempt_ols.html">Attempts OLS</a>
</li>
<li>
  <a href="robustness_checks.html">Robustness Checks</a>
</li>
<li>
  <a href="Writing.html">Writing</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Heckman Selection Model Analysis</h1>

</div>


<pre class="r"><code>library(data.table)
outcome_data &lt;- fread(&quot;predict_outcome.csv.gz&quot;)
select_data &lt;- fread(&quot;predict_select.csv.gz&quot;)</code></pre>
<pre class="r"><code>#&#39; Filter for specific player data (offense or defense)
# filter_specific_player &lt;- function(data, side = &quot;offense&quot;, player = 1) {
#   # Create a copy to avoid modifying the original
#   dt &lt;- copy(data)
#   
#   # Build patterns for columns to keep
#   # We want to keep 3 types of columns:
#   # 1. Regular player column: side_player_number_*
#   # 2. Player present column: side_player_number_present
#   # 3. Starter player column: starter_side_player_number_*
#   
#   # Identify all player-related columns (both normal and starter)
#   all_player_cols &lt;- grep(&quot;player_&quot;, names(dt), value = TRUE)
#   
#   # Create patterns for the 3 types of columns we want to keep
#   player_pattern &lt;- paste0(&quot;^&quot;, side, &quot;_player_&quot;, player, &quot;_&quot;)
#   present_pattern &lt;- paste0(&quot;^&quot;, side, &quot;_player_&quot;, player, &quot;_present$&quot;)
#   starter_pattern &lt;- paste0(&quot;^starter_&quot;, side, &quot;_player_&quot;, player, &quot;_&quot;)
#   
#   # Combine patterns
#   keep_pattern &lt;- paste(player_pattern, present_pattern, starter_pattern, sep = &quot;|&quot;)
#   
#   # Find columns to keep
#   cols_to_keep &lt;- grep(keep_pattern, all_player_cols, value = TRUE)
#   
#   # Find all player columns to remove (all player columns except those to keep)
#   cols_to_remove &lt;- setdiff(all_player_cols, cols_to_keep)
#   
#   # Remove unwanted player columns
#   for (col in cols_to_remove) {
#     dt[, (col) := NULL]
#   }
#   
#   # Return filtered data
#   return(dt)
# }
# 
# # Filter to keep only offense player 1 columns
# outcome_data &lt;- filter_specific_player(outcome_data, side = &quot;offense&quot;, player = 1)
# 
# # Show remaining player columns
# remaining_player_cols &lt;- grep(&quot;player_&quot;, names(outcome_data), value = TRUE)
# print(&quot;Remaining player columns:&quot;)
# print(remaining_player_cols)</code></pre>
<pre class="r"><code>select_data[, attempt := as.numeric(as.character(attempt))]</code></pre>
<pre class="r"><code>library(data.table)
library(xgboost)
library(ROCR)
library(parallel)

# Prepare the XGBoost matrices
xs &lt;- model.matrix(~ . - 1 - attempt - my_id, data = select_data)
y &lt;- as.numeric(as.character(select_data$attempt))


# Create parameter grid
grid &lt;- expand.grid(
  eta = seq(0.001, 0.03, by = 0.01),
  max_depth = seq(5, 5, by = 2),
  min_child_weight = seq(1, 1, by = 1),        
  subsample = seq(1, 1, by = 0.2),
  colsample_bytree = seq(1, 1, by = 0.2),
  lambda = seq(1, 1, by = 1),                
  alpha = seq(0, 0, by = 1),                  
  gamma = seq(0, 0, by = 0.1),               
  nrounds = seq(100, 250, by = 50)
)


# Sample grid points
conf_lev &lt;- .95
num_max &lt;- 5
n &lt;- ceiling(log(1-conf_lev)/log(1-num_max/nrow(grid)))
ind &lt;- sample(nrow(grid), n, replace = FALSE)
rgrid &lt;- grid[ind, ]

# Set up parallel processing
nc &lt;- detectCores() - 1

# Calculate scale_pos_weight for imbalanced dataset
scale_pos_weight &lt;- sum(y == 0) / sum(y == 1)

# Validation phase
#cat(&quot;\nPhase 1: Validation Phase\n&quot;)
n_validations &lt;- 3
validation_results &lt;- matrix(nrow = nrow(rgrid), ncol = n_validations)

for (j in 1:nrow(rgrid)) {
  #cat(&quot;\nTesting parameter set&quot;, j, &quot;of&quot;, nrow(rgrid), &quot;\n&quot;)
  
  for (i in 1:n_validations) {
    #cat(&quot;\nValidation iteration&quot;, i, &quot;of&quot;, n_validations, &quot;\n&quot;)             
    # Create validation split
    idx &lt;- unique(sample(nrow(xs), nrow(xs), TRUE))
    train_x &lt;- xs[idx, ]
    train_y &lt;- y[idx]
    val_x &lt;- xs[-idx, ]
    val_y &lt;- y[-idx]
    
    prm &lt;- list(
      booster = &quot;gbtree&quot;,
      objective = &quot;binary:logistic&quot;,
      max_depth = rgrid[j, &quot;max_depth&quot;],
      eta = rgrid[j, &quot;eta&quot;],
      subsample = rgrid[j, &quot;subsample&quot;],
      colsample_bytree = rgrid[j, &quot;colsample_bytree&quot;],
      gamma = rgrid[j, &quot;gamma&quot;],
      min_child_weight = rgrid[j, &quot;min_child_weight&quot;],
      alpha = rgrid[j, &quot;alpha&quot;],
      lambda = rgrid[j, &quot;lambda&quot;],
      scale_pos_weight = scale_pos_weight,
      nthread = nc
    )
    
    dm_train &lt;- xgb.DMatrix(data = train_x, label = train_y)
    mdl &lt;- xgb.train(
      params = prm,
      data = dm_train,
      nrounds = rgrid[j, &quot;nrounds&quot;],
      verbose = FALSE
    )
    
    p &lt;- predict(mdl, xgb.DMatrix(data = val_x))
    pred &lt;- prediction(p, val_y)
    validation_results[j, i] &lt;- performance(pred, &quot;auc&quot;)@y.values[[1]]
  }
}

# Run 100 tests with best parameters
cat(&quot;\nRunning X test iterations with best parameters...\n&quot;)</code></pre>
<pre><code>## 
## Running X test iterations with best parameters...</code></pre>
<pre class="r"><code>test_aucs &lt;- c()

best_params_idx &lt;- which.max(rowMeans(validation_results))
best_params &lt;- rgrid[best_params_idx,]

# Train final model with best parameters
best_params_list &lt;- as.list(best_params[-which(names(best_params) == &quot;nrounds&quot;)])
best_params_list$booster &lt;- &quot;gbtree&quot;
best_params_list$objective &lt;- &quot;binary:logistic&quot;
best_params_list$scale_pos_weight &lt;- scale_pos_weight
best_params_list$nthread &lt;- nc

for(i in 1:20) {
  # Create test split
  idx &lt;- unique(sample(nrow(xs), nrow(xs), T))
  train_x &lt;- xs[idx, ]
  train_y &lt;- y[idx]
  test_x &lt;- xs[-idx, ]
  test_y &lt;- y[-idx]
  
  # Train model on full unbalanced dataset
  dm_train &lt;- xgb.DMatrix(data = train_x, label = train_y)
  mdl &lt;- xgb.train(
    params = best_params_list,
    data = dm_train,
    nrounds = best_params[[&quot;nrounds&quot;]],
    verbose = FALSE
  )
  
  # Test on unbalanced test set
  p &lt;- predict(mdl, xgb.DMatrix(data = test_x))
  pred &lt;- prediction(p, test_y)
  test_aucs[i] &lt;- performance(pred, &quot;auc&quot;)@y.values[[1]]
}
# Print results
cat(&quot;\nTest Results over 100 iterations:\n&quot;)</code></pre>
<pre><code>## 
## Test Results over 100 iterations:</code></pre>
<pre class="r"><code>cat(&quot;Mean AUC:&quot;, mean(test_aucs), &quot;\n&quot;)</code></pre>
<pre><code>## Mean AUC: 0.8864024</code></pre>
<pre class="r"><code>cat(&quot;SD AUC:&quot;, sd(test_aucs), &quot;\n&quot;)</code></pre>
<pre><code>## SD AUC: 0.004051968</code></pre>
<pre class="r"><code>cat(&quot;95% CI:&quot;, mean(test_aucs) - 1.96 * sd(test_aucs), 
    &quot;to&quot;, mean(test_aucs) + 1.96 * sd(test_aucs), &quot;\n&quot;)</code></pre>
<pre><code>## 95% CI: 0.8784605 to 0.8943442</code></pre>
<pre class="r"><code># Plotting AUC distribution
plot(test_aucs, col=&quot;red&quot;, pch=20,
     main=&quot;AUC Test Distribution&quot;,
     xlab=&quot;Iteration&quot;, ylab=&quot;AUC&quot;)
abline(h=mean(test_aucs), col=&quot;blue&quot;, lwd=2, lty=2)  # Add this line to show mean
abline(h=mean(test_aucs) - 1.96 * sd(test_aucs), col=&quot;green&quot;, lwd=2, lty=3)
abline(h=mean(test_aucs) + 1.96 * sd(test_aucs), col=&quot;green&quot;, lwd=2, lty=3)
legend(&quot;bottomright&quot;, 
       legend=c(&quot;AUC Values&quot;, &quot;Mean&quot;, &quot;95% CI Bounds&quot;),
       col=c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;),
       lty=c(NA, 2, 3),
       pch=c(20, NA, NA))</code></pre>
<p><img src="heckman_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code># Now train final model on full data for z scores
dm_full &lt;- xgb.DMatrix(data = xs, label = y)
final_model &lt;- xgb.train(
  params = best_params_list,
  data = dm_full,
  nrounds = best_params[[&quot;nrounds&quot;]],
  verbose = FALSE
)

# Get probability predictions (z) for ALL data
z &lt;- predict(final_model, xgb.DMatrix(data = xs))</code></pre>
<pre class="r"><code># Calculate residuals for XGBoost predictions
y &lt;- as.numeric(as.character(select_data$attempt))
residuals &lt;- y - z

# Histogram of residuals
hist(residuals, main=&quot;Distribution of XGBoost Model Residuals&quot;, xlab=&quot;Residual&quot;, breaks=100)</code></pre>
<p><img src="heckman_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code># plot out the z values\
plot(density(z), 
     main = &quot;Density of Z Predictions&quot;,
     xlab = &quot;Predicted Probability of Attempt&quot;,
     ylab = &quot;Density&quot;)</code></pre>
<p><img src="heckman_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code># Calculate GIMR (lambda) This is Generalized inverse mills ratio
GIMR &lt;- dnorm(qnorm(z)) / (1 - pnorm(qnorm(z)))

# Add GIMR to the data
select_data[, GIMR := GIMR]

# Print variable importa</code></pre>
<pre class="r"><code># Create a data.table with just my_id and GIMR from select_data
GIMR_dt &lt;- data.table(my_id = select_data$my_id, GIMR = GIMR)

# Add GIMR to outcome_data by matching on my_id
outcome_data[GIMR_dt, GIMR := i.GIMR, on = &quot;my_id&quot;]</code></pre>
<pre class="r"><code># # Existing code
# outcome_data &lt;- outcome_data[, my_id := NULL]
# outcome_data[, yardline_31_40 := NULL]
# outcome_data[, year2022_team_CLE := NULL] # tied for most attempts with 31

# Remove all columns with &quot;_present&quot; in the name
present_cols &lt;- grep(&quot;_present&quot;, names(outcome_data), value = TRUE)
for (col in present_cols) {
  outcome_data[, (col) := NULL]
}</code></pre>
<pre class="r"><code># Create copies of outcome_data for different models
outcome_data_player &lt;- copy(outcome_data)
outcome_data_starter &lt;- copy(outcome_data)

# Remove specific columns as in original code
for (dt in list(outcome_data_player, outcome_data_starter)) {
  dt[, my_id := NULL]
  dt[, yardline_31_40 := NULL]
  dt[, year2022_team_CLE := NULL] # tied for most attempts with 31
  
  # Remove attendance variables
  dt[, attendance_pct := NULL]
  dt[, attendance_raw := NULL]
  dt[, vegas_wp_posteam := NULL]
}

# For player models, remove starter columns
player_cols &lt;- grep(&quot;^starter_&quot;, names(outcome_data_player), value = TRUE)
for (col in player_cols) {
  outcome_data_player[, (col) := NULL]
}

# For starter models, remove player columns
starter_cols &lt;- grep(&quot;^(offense|defense)_player_&quot;, names(outcome_data_starter), value = TRUE)
for (col in starter_cols) {
  outcome_data_starter[, (col) := NULL]
}

# Ensure conversion is numeric
for (dt in list(outcome_data_player, outcome_data_starter)) {
  dt[, conversion := as.numeric(as.character(conversion))]
}

# MODEL 1: Player model with GIMR
ols_model_player &lt;- lm(conversion ~ ., data = outcome_data_player)

# MODEL 2: Starter model with GIMR
ols_model_starter &lt;- lm(conversion ~ ., data = outcome_data_starter)

# Function to analyze and print model results
analyze_model &lt;- function(model, model_name) {
  library(sandwich)
  library(lmtest)
  
  # Get HC0-adjusted t-values and p-values
  robust_test &lt;- coeftest(model, vcov = vcovHC(model, type = &quot;HC0&quot;))
  t_stats &lt;- robust_test[, &quot;t value&quot;]
  p_values &lt;- robust_test[, &quot;Pr(&gt;|t|)&quot;]
  
  # Function to add significance stars
  get_stars &lt;- function(p) {
    if (p &lt;= 0.01) return(&quot;***&quot;)
    if (p &lt;= 0.05) return(&quot;**&quot;)
    if (p &lt;= 0.1) return(&quot;*&quot;)
    if (p &lt;= 0.15) return(&quot;.&quot;)
    return(&quot;&quot;)
  }
  
  # Maximum width for variable names
  name_width &lt;- 60
  
  # Print model name and header
  cat(&quot;\n\n&quot;, paste(rep(&quot;=&quot;, 80), collapse=&quot;&quot;), &quot;\n&quot;)
  cat(&quot;MODEL:&quot;, model_name, &quot;\n&quot;)
  cat(paste(rep(&quot;=&quot;, 80), collapse=&quot;&quot;), &quot;\n\n&quot;)
  
  # Print header with alignment
  cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;Variable&quot;, &quot;t-value&quot;, &quot;p-value&quot;, &quot;sig&quot;))
  cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;---------&quot;, &quot;-------&quot;, &quot;-------&quot;, &quot;----&quot;))
  
  # Loop through and print values
  for (i in 1:length(t_stats)) {
    var_name &lt;- rownames(robust_test)[i]
    # Truncate name if too long
    if (nchar(var_name) &gt; name_width) {
      var_name &lt;- paste0(substr(var_name, 1, name_width-3), &quot;...&quot;)
    }
    cat(sprintf(&quot;%-*s  %10.4f  %10.4f  %4s\n&quot;, 
                name_width, var_name, 
                t_stats[i], p_values[i],
                get_stars(p_values[i])))
  }
  
  cat(&quot;\nSignificance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15\n&quot;)
  
  # Print R-squared
  r_squared &lt;- summary(model)$adj.r.squared
  cat(&quot;\nAdjusted R-squared:&quot;, r_squared, &quot;\n&quot;)
  
  # Calculate VIFs
  library(car)
  vifs &lt;- vif(model)
  
  # Filter to show only VIFs over 5
  high_vifs &lt;- vifs[vifs &gt; 5]
  if(length(high_vifs) &gt; 0) {
    cat(&quot;\nVariables with VIF &gt; 5:\n&quot;)
    print(high_vifs)
  } else {
    cat(&quot;\nNo variables with VIF &gt; 5 found in this model\n&quot;)
  }
  
  return(r_squared)
}

# Analyze models with GIMR only
r2_player &lt;- analyze_model(ols_model_player, &quot;Player Model with GIMR&quot;)</code></pre>
<pre><code>## 
## 
##  ================================================================================ 
## MODEL: Player Model with GIMR 
## ================================================================================ 
## 
## Variable                                                         t-value     p-value   sig
## ---------                                                        -------     -------  ----
## (Intercept)                                                       3.0761      0.0021   ***
## ydstogo                                                         -12.4688      0.0000   ***
## posteam_timeouts_remaining                                        1.1122      0.2661      
## defteam_timeouts_remaining                                        0.9200      0.3576      
## rush_attempt                                                      7.1563      0.0000   ***
## week                                                              1.0320      0.3021      
## temp                                                             -1.0768      0.2817      
## wind                                                              0.8028      0.4222      
## vegas_wp                                                          1.2359      0.2166      
## total_line                                                        1.6454      0.1000     *
## prep_days                                                         1.1192      0.2631      
## overall_win_pct                                                   0.3688      0.7123      
## team_win_pct                                                      1.5993      0.1099     .
## prev_win_pct                                                     -2.9156      0.0036   ***
## prev_shotgun_rate                                                 0.4491      0.6534      
## prev_singleback_rate                                              0.7242      0.4690      
## prev_empty_rate                                                   0.8264      0.4087      
## prev_iform_rate                                                   0.4443      0.6569      
## prev_shotgun_success                                              0.2397      0.8106      
## prev_singleback_success                                           0.7730      0.4395      
## prev_empty_success                                                0.3063      0.7594      
## prev_iform_success                                                2.3529      0.0187    **
## prev_stop_rate_run                                                0.4230      0.6723      
## prev_stop_rate_pass                                              -4.0002      0.0001   ***
## shotgun_rate                                                      0.8463      0.3974      
## singleback_rate                                                   0.3258      0.7446      
## empty_rate                                                       -0.2687      0.7882      
## iform_rate                                                       -1.7234      0.0849     *
## shotgun_success                                                  -2.0883      0.0368    **
## singleback_success                                               -0.6826      0.4949      
## empty_success                                                    -0.4579      0.6471      
## iform_success                                                    -1.3853      0.1660      
## def_stop_rate_run                                                 2.2892      0.0221    **
## def_stop_rate_pass                                               -0.8673      0.3858      
## avg_pass_rushers                                                 -0.3697      0.7116      
## avg_box_defenders                                                -0.8364      0.4030      
## cover0_rate                                                      -0.6472      0.5175      
## cover1_rate                                                      -0.3072      0.7587      
## cover2_rate                                                      -0.3356      0.7372      
## cover3_rate                                                       1.6479      0.0995     *
## cover4_rate                                                       0.9136      0.3610      
## cover6_rate                                                      -0.3144      0.7532      
## two_man_rate                                                      1.5412      0.1234     .
## prevent_rate                                                      2.2545      0.0242    **
## roof_outdoors                                                    -0.5283      0.5973      
## posteam_type_home                                                -1.3249      0.1853      
## offense_formation_EMPTY                                           0.6605      0.5090      
## offense_formation_SHOTGUN                                         0.1251      0.9005      
## offense_formation_SINGLEBACK                                     -0.0302      0.9759      
## offense_formation_I_FORM                                         -0.1437      0.8857      
## offense_player_1_passing_depth_short_grades_pass_12w              2.1972      0.0281    **
## offense_player_1_passing_depth_medium_grades_pass_12w            -0.4382      0.6613      
## offense_player_1_passing_depth_deep_grades_pass_12w              -1.1542      0.2485      
## offense_player_1_rushing_grades_grades_run_12w                   -0.0591      0.9529      
## offense_player_4_rushing_grades_first_downs_12w                   1.2058      0.2280      
## offense_player_4_receiving_vs_scheme_zone_grades_pass_rou...      0.4449      0.6564      
## offense_player_4_pass_blocking_true_pass_set_grades_pass_...      0.1037      0.9174      
## offense_player_4_rushing_grades_yards_after_contact_2w           -0.2876      0.7736      
## offense_player_8_receiving_depth_short_avg_depth_of_targe...     -1.0331      0.3016      
## offense_player_8_blocking_grades_block_percent_12w               -0.6908      0.4897      
## offense_player_8_receiving_grades_targets_12w                     1.1421      0.2535      
## offense_player_8_receiving_grades_yards_per_reception_12w        -0.2408      0.8097      
## offense_player_9_receiving_depth_short_avg_depth_of_targe...      1.1344      0.2567      
## offense_player_9_blocking_grades_block_percent_12w               -0.7792      0.4359      
## offense_player_9_receiving_grades_targets_12w                    -0.9044      0.3658      
## offense_player_9_receiving_grades_yards_per_reception_12w        -1.0159      0.3097      
## offense_player_10_receiving_depth_short_avg_depth_of_targ...      1.2086      0.2269      
## offense_player_10_blocking_grades_block_percent_12w              -0.2464      0.8054      
## offense_player_10_receiving_grades_targets_12w                    0.6374      0.5239      
## offense_player_10_receiving_grades_yards_per_reception_12w        0.3526      0.7244      
## offense_player_14_blocking_grades_snap_counts_block_2w            2.2245      0.0262    **
## offense_player_14_receiving_vs_scheme_zone_caught_percent...      0.6956      0.4867      
## offense_player_14_receiving_depth_center_short_pass_plays...     -1.6236      0.1046     .
## offense_player_14_receiving_concept_slot_targets_12w              1.0809      0.2798      
## offense_player_17_run_blocking_snap_counts_run_block_12w          1.2632      0.2066      
## offense_player_17_blocking_grades_grades_offense_12w              0.9750      0.3296      
## offense_player_17_blocking_grades_pbe_2w                         -0.1807      0.8566      
## offense_player_18_run_blocking_snap_counts_run_block_12w         -2.3507      0.0188    **
## offense_player_18_blocking_grades_grades_offense_12w             -0.6051      0.5451      
## offense_player_18_blocking_grades_pbe_2w                          1.8337      0.0668     *
## offense_player_19_run_blocking_snap_counts_run_block_12w         -0.8015      0.4229      
## offense_player_19_blocking_grades_grades_offense_12w             -0.2657      0.7905      
## offense_player_19_blocking_grades_pbe_2w                          0.9534      0.3404      
## offense_player_20_run_blocking_snap_counts_run_block_12w         -0.3182      0.7504      
## offense_player_20_blocking_grades_grades_offense_12w              0.1806      0.8567      
## offense_player_20_blocking_grades_pbe_2w                          0.4680      0.6398      
## offense_player_21_run_blocking_snap_counts_run_block_12w         -1.3060      0.1916      
## offense_player_21_blocking_grades_grades_offense_12w             -0.1453      0.8845      
## offense_player_21_blocking_grades_pbe_2w                          1.4510      0.1469     .
## defense_player_1_pass_rushing_productivity_prp_12w               -0.3570      0.7211      
## defense_player_1_pass_rushing_productivity_hurries_12w           -0.2884      0.7731      
## defense_player_1_defensive_grades_grades_defense_penalty_12w     -1.0215      0.3071      
## defense_player_1_run_defense_grades_stops_12w                    -0.8976      0.3695      
## defense_player_1_run_defense_grades_tackles_12w                   0.7466      0.4553      
## defense_player_2_pass_rushing_productivity_prp_12w               -0.4535      0.6502      
## defense_player_2_pass_rushing_productivity_hurries_12w           -0.0767      0.9389      
## defense_player_2_defensive_grades_grades_defense_penalty_12w      0.6875      0.4918      
## defense_player_2_run_defense_grades_stops_12w                     0.5719      0.5674      
## defense_player_2_run_defense_grades_tackles_12w                  -0.3997      0.6894      
## defense_player_3_pass_rushing_productivity_prp_12w               -0.5843      0.5590      
## defense_player_3_pass_rushing_productivity_hurries_12w           -0.7156      0.4743      
## defense_player_3_defensive_grades_grades_defense_penalty_12w      1.5648      0.1177     .
## defense_player_3_run_defense_grades_stops_12w                    -0.8738      0.3823      
## defense_player_3_run_defense_grades_tackles_12w                   1.0446      0.2963      
## defense_player_4_pass_rushing_productivity_prp_12w               -1.5927      0.1113     .
## defense_player_4_pass_rushing_productivity_hurries_12w           -0.2949      0.7681      
## defense_player_4_defensive_grades_grades_defense_penalty_12w     -0.5734      0.5664      
## defense_player_4_run_defense_grades_stops_12w                    -3.2658      0.0011   ***
## defense_player_4_run_defense_grades_tackles_12w                   3.1408      0.0017   ***
## defense_player_9_pass_rushing_productivity_prp_12w               -0.5602      0.5753      
## defense_player_9_pass_rushing_productivity_hurries_12w           -0.4800      0.6312      
## defense_player_9_defensive_grades_grades_defense_penalty_12w      0.6167      0.5375      
## defense_player_9_run_defense_grades_stops_12w                    -1.6621      0.0966     *
## defense_player_9_run_defense_grades_tackles_12w                   1.0810      0.2798      
## defense_player_9_defensive_grades_snap_counts_coverage_12w        0.2509      0.8019      
## defense_player_9_coverage_schemes_zone_stops_12w                 -0.1484      0.8821      
## defense_player_10_pass_rushing_productivity_prp_12w               0.0613      0.9511      
## defense_player_10_pass_rushing_productivity_hurries_12w          -2.1915      0.0285    **
## defense_player_10_defensive_grades_grades_defense_penalty...      1.3248      0.1853      
## defense_player_10_run_defense_grades_stops_12w                   -0.1576      0.8748      
## defense_player_10_run_defense_grades_tackles_12w                 -0.2879      0.7734      
## defense_player_10_defensive_grades_snap_counts_coverage_12w      -0.5195      0.6034      
## defense_player_10_coverage_schemes_zone_stops_12w                 0.8809      0.3784      
## defense_player_11_pass_rushing_productivity_prp_12w              -1.1874      0.2351      
## defense_player_11_pass_rushing_productivity_hurries_12w           2.0881      0.0369    **
## defense_player_11_defensive_grades_grades_defense_penalty...     -0.6986      0.4848      
## defense_player_11_run_defense_grades_stops_12w                   -0.0161      0.9871      
## defense_player_11_run_defense_grades_tackles_12w                 -0.6042      0.5458      
## defense_player_11_defensive_grades_snap_counts_coverage_12w       1.9128      0.0559     *
## defense_player_11_coverage_schemes_zone_stops_12w                -0.4891      0.6248      
## defense_player_12_pass_rushing_productivity_prp_12w              -0.5225      0.6014      
## defense_player_12_pass_rushing_productivity_hurries_12w           1.9623      0.0498    **
## defense_player_12_defensive_grades_grades_defense_penalty...     -1.0624      0.2881      
## defense_player_12_run_defense_grades_stops_12w                    0.8203      0.4121      
## defense_player_12_run_defense_grades_tackles_12w                 -1.3138      0.1890      
## defense_player_12_defensive_grades_snap_counts_coverage_12w       2.5640      0.0104    **
## defense_player_12_coverage_schemes_zone_stops_12w                -0.8908      0.3731      
## defense_player_15_defensive_grades_grades_defense_penalty...     -1.2234      0.2213      
## defense_player_15_run_defense_grades_tackles_12w                  0.4568      0.6478      
## defense_player_15_coverage_schemes_man_coverage_snaps_per...      1.4692      0.1419     .
## defense_player_15_coverage_grades_stops_12w                       0.3904      0.6962      
## defense_player_15_slot_coverage_targets_12w                       0.9837      0.3253      
## defense_player_15_defensive_grades_missed_tackle_rate_2w         -0.8319      0.4055      
## defense_player_16_defensive_grades_grades_defense_penalty...     -1.6294      0.1033     .
## defense_player_16_run_defense_grades_tackles_12w                  1.4895      0.1364     .
## defense_player_16_coverage_schemes_man_coverage_snaps_per...      1.0391      0.2988      
## defense_player_16_coverage_grades_stops_12w                      -0.3262      0.7443      
## defense_player_16_slot_coverage_targets_12w                       1.4217      0.1552      
## defense_player_16_defensive_grades_missed_tackle_rate_2w         -0.8587      0.3906      
## defense_player_17_defensive_grades_grades_defense_penalty...      1.9825      0.0475    **
## defense_player_17_run_defense_grades_tackles_12w                 -1.6357      0.1020     .
## defense_player_17_coverage_schemes_man_coverage_snaps_per...     -1.5008      0.1335     .
## defense_player_17_coverage_grades_stops_12w                       0.4705      0.6380      
## defense_player_17_slot_coverage_targets_12w                      -0.2866      0.7745      
## defense_player_17_defensive_grades_missed_tackle_rate_2w         -0.7872      0.4312      
## defense_player_20_defensive_grades_grades_defense_penalty...      0.1695      0.8654      
## defense_player_20_run_defense_grades_tackles_12w                  0.2604      0.7946      
## defense_player_20_coverage_grades_stops_12w                      -0.4347      0.6638      
## defense_player_20_slot_coverage_targets_12w                       1.4648      0.1431     .
## defense_player_20_defensive_grades_missed_tackle_rate_2w         -0.2690      0.7879      
## defense_player_21_defensive_grades_grades_defense_penalty...     -1.6775      0.0935     *
## defense_player_21_run_defense_grades_tackles_12w                  1.9982      0.0458    **
## defense_player_21_coverage_grades_stops_12w                      -1.0917      0.2750      
## defense_player_21_slot_coverage_targets_12w                       1.5700      0.1165     .
## defense_player_21_defensive_grades_missed_tackle_rate_2w          1.4628      0.1436     .
## defense_player_22_defensive_grades_grades_defense_penalty...      1.6204      0.1052     .
## defense_player_22_run_defense_grades_tackles_12w                  0.0824      0.9344      
## defense_player_22_coverage_grades_stops_12w                       0.0807      0.9357      
## defense_player_22_slot_coverage_targets_12w                      -1.5293      0.1263     .
## defense_player_22_defensive_grades_missed_tackle_rate_2w         -0.4452      0.6562      
## yardline_1_10                                                    -2.2877      0.0222    **
## yardline_11_20                                                    0.2503      0.8023      
## yardline_21_30                                                    0.0905      0.9279      
## yardline_41_50                                                    1.8466      0.0649     *
## yardline_51_60                                                    0.4866      0.6265      
## yardline_61_70                                                    1.4783      0.1394     .
## yardline_71_80                                                    1.8557      0.0636     *
## yardline_81_90                                                    2.2271      0.0260    **
## yardline_91_100                                                   1.1884      0.2348      
## year2017_team_ARI                                                 0.5891      0.5558      
## year2017_team_BUF                                                -0.5498      0.5825      
## year2017_team_CHI                                                 0.1875      0.8512      
## year2017_team_CLE                                                 0.7560      0.4497      
## year2017_team_DAL                                                -0.6241      0.5326      
## year2017_team_DET                                                -0.0523      0.9583      
## year2017_team_GB                                                  2.0039      0.0452    **
## year2017_team_HOU                                                 1.8781      0.0604     *
## year2017_team_MIA                                                -0.8448      0.3983      
## year2017_team_MIN                                                -0.1080      0.9140      
## year2017_team_NE                                                  0.1135      0.9096      
## year2017_team_SF                                                  2.0260      0.0428    **
## year2017_team_BAL                                                -0.0661      0.9473      
## year2017_team_DEN                                                 0.2736      0.7844      
## year2017_team_LA                                                  0.6648      0.5062      
## year2017_team_NYG                                                 0.0176      0.9860      
## year2017_team_OAK                                                -0.1954      0.8451      
## year2017_team_SEA                                                 0.8487      0.3961      
## year2017_team_CAR                                                 0.7205      0.4713      
## year2017_team_CIN                                                 0.5624      0.5739      
## year2017_team_IND                                                 1.0651      0.2869      
## year2017_team_NO                                                  0.6954      0.4869      
## year2017_team_PHI                                                 0.6253      0.5318      
## year2017_team_PIT                                                -0.2790      0.7802      
## year2017_team_TEN                                                 0.4669      0.6406      
## year2017_team_WAS                                                 0.6532      0.5136      
## year2017_team_KC                                                  1.9307      0.0536     *
## year2017_team_LAC                                                 0.2891      0.7725      
## year2017_team_NYJ                                                 0.9859      0.3243      
## year2017_team_TB                                                  0.0981      0.9219      
## year2017_team_ATL                                                -0.0160      0.9872      
## year2017_team_JAX                                                 1.0339      0.3013      
## year2018_team_ARI                                                 0.6401      0.5222      
## year2018_team_BAL                                                 0.4262      0.6700      
## year2018_team_CAR                                                 0.5723      0.5672      
## year2018_team_CLE                                                -0.4265      0.6698      
## year2018_team_DET                                                 0.9832      0.3256      
## year2018_team_HOU                                                 1.3843      0.1663      
## year2018_team_IND                                                -0.5182      0.6043      
## year2018_team_KC                                                  1.0123      0.3115      
## year2018_team_NYG                                                 0.3863      0.6993      
## year2018_team_OAK                                                -0.5735      0.5664      
## year2018_team_PHI                                                 1.0964      0.2730      
## year2018_team_SEA                                                 0.0700      0.9442      
## year2018_team_BUF                                                -0.3994      0.6896      
## year2018_team_CHI                                                 0.0279      0.9777      
## year2018_team_CIN                                                -0.3435      0.7312      
## year2018_team_DAL                                                -0.1801      0.8571      
## year2018_team_DEN                                                 0.3109      0.7559      
## year2018_team_GB                                                  0.3411      0.7330      
## year2018_team_LAC                                                 0.3026      0.7622      
## year2018_team_NE                                                 -0.3047      0.7606      
## year2018_team_NO                                                  0.9891      0.3227      
## year2018_team_PIT                                                 1.0327      0.3018      
## year2018_team_SF                                                  0.7846      0.4327      
## year2018_team_MIA                                                 0.6842      0.4939      
## year2018_team_MIN                                                 0.5771      0.5639      
## year2018_team_NYJ                                                 1.1359      0.2561      
## year2018_team_TB                                                  0.3510      0.7256      
## year2018_team_ATL                                                 0.8439      0.3988      
## year2018_team_JAX                                                 0.5976      0.5501      
## year2018_team_LA                                                 -0.7428      0.4577      
## year2018_team_TEN                                                 0.6710      0.5023      
## year2018_team_WAS                                                -0.0631      0.9497      
## year2019_team_ARI                                                -0.6140      0.5392      
## year2019_team_BUF                                                -0.6232      0.5332      
## year2019_team_CHI                                                 0.5236      0.6006      
## year2019_team_CLE                                                 0.8215      0.4114      
## year2019_team_DAL                                                 0.1743      0.8616      
## year2019_team_IND                                                -0.0098      0.9922      
## year2019_team_JAX                                                 0.5969      0.5506      
## year2019_team_KC                                                 -0.2168      0.8284      
## year2019_team_LAC                                                -0.5397      0.5894      
## year2019_team_MIN                                                -0.0581      0.9537      
## year2019_team_NE                                                  0.1485      0.8820      
## year2019_team_NO                                                 -0.8214      0.4115      
## year2019_team_PHI                                                 0.6270      0.5307      
## year2019_team_SEA                                                 0.4909      0.6236      
## year2019_team_SF                                                  0.1678      0.8667      
## year2019_team_TB                                                 -0.6306      0.5283      
## year2019_team_BAL                                                 0.4048      0.6857      
## year2019_team_CAR                                                -0.2203      0.8256      
## year2019_team_DEN                                                 1.0764      0.2818      
## year2019_team_DET                                                -0.7274      0.4670      
## year2019_team_HOU                                                 0.1638      0.8699      
## year2019_team_LA                                                 -0.2042      0.8382      
## year2019_team_MIA                                                -1.8132      0.0699     *
## year2019_team_NYG                                                -0.8345      0.4041      
## year2019_team_NYJ                                                -1.8187      0.0690     *
## year2019_team_OAK                                                 0.1415      0.8875      
## year2019_team_PIT                                                -1.8267      0.0678     *
## year2019_team_TEN                                                -1.0798      0.2803      
## year2019_team_CIN                                                 0.6889      0.4909      
## year2019_team_WAS                                                -0.0087      0.9931      
## year2019_team_ATL                                                -0.0070      0.9944      
## year2019_team_GB                                                 -0.1708      0.8644      
## year2020_team_ATL                                                 0.3484      0.7276      
## year2020_team_BAL                                                 0.8645      0.3874      
## year2020_team_BUF                                                 0.1186      0.9056      
## year2020_team_CAR                                                 0.9339      0.3504      
## year2020_team_CIN                                                 0.8678      0.3855      
## year2020_team_DEN                                                -0.3910      0.6958      
## year2020_team_DET                                                -0.8899      0.3736      
## year2020_team_JAX                                                -0.6937      0.4879      
## year2020_team_KC                                                  0.6483      0.5168      
## year2020_team_LA                                                 -0.7420      0.4581      
## year2020_team_MIN                                                 0.8061      0.4202      
## year2020_team_NE                                                  0.1032      0.9178      
## year2020_team_NO                                                  0.3826      0.7020      
## year2020_team_NYG                                                 0.1938      0.8464      
## year2020_team_SF                                                  0.5568      0.5777      
## year2020_team_WAS                                                 0.2642      0.7917      
## year2020_team_CHI                                                 0.5737      0.5662      
## year2020_team_DAL                                                 0.0646      0.9485      
## year2020_team_GB                                                  0.3420      0.7324      
## year2020_team_HOU                                                -0.2817      0.7782      
## year2020_team_MIA                                                -0.4495      0.6531      
## year2020_team_NYJ                                                 0.2774      0.7815      
## year2020_team_TB                                                  0.4343      0.6641      
## year2020_team_TEN                                                -0.8039      0.4215      
## year2020_team_ARI                                                 0.6051      0.5452      
## year2020_team_CLE                                                -1.0465      0.2954      
## year2020_team_IND                                                -0.6497      0.5159      
## year2020_team_LAC                                                 0.4773      0.6331      
## year2020_team_PHI                                                 1.0090      0.3130      
## year2020_team_SEA                                                 0.0790      0.9370      
## year2020_team_LV                                                  0.9657      0.3343      
## year2020_team_PIT                                                -0.4812      0.6304      
## year2021_team_ATL                                                -1.3671      0.1717      
## year2021_team_BUF                                                 0.7766      0.4374      
## year2021_team_CIN                                                -1.5342      0.1251     .
## year2021_team_DAL                                                -0.2075      0.8356      
## year2021_team_DEN                                                 0.4566      0.6480      
## year2021_team_DET                                                -0.6334      0.5265      
## year2021_team_KC                                                  0.2539      0.7996      
## year2021_team_LA                                                  0.0501      0.9601      
## year2021_team_LV                                                  0.9150      0.3603      
## year2021_team_MIN                                                -0.2770      0.7818      
## year2021_team_NE                                                  0.7179      0.4729      
## year2021_team_NO                                                  0.2514      0.8015      
## year2021_team_NYG                                                 0.4790      0.6320      
## year2021_team_SF                                                 -0.0632      0.9496      
## year2021_team_TEN                                                -0.3568      0.7213      
## year2021_team_ARI                                                 1.2734      0.2030      
## year2021_team_BAL                                                 0.7854      0.4323      
## year2021_team_CAR                                                -0.0167      0.9867      
## year2021_team_CHI                                                -1.1205      0.2626      
## year2021_team_GB                                                  1.0556      0.2912      
## year2021_team_IND                                                 0.0370      0.9705      
## year2021_team_LAC                                                 0.7388      0.4601      
## year2021_team_MIA                                                 0.5563      0.5781      
## year2021_team_NYJ                                                 0.2179      0.8275      
## year2021_team_PHI                                                -1.0982      0.2722      
## year2021_team_SEA                                                -1.1219      0.2620      
## year2021_team_TB                                                  0.6931      0.4883      
## year2021_team_WAS                                                -0.6527      0.5140      
## year2021_team_CLE                                                -0.6389      0.5229      
## year2021_team_HOU                                                -0.2560      0.7980      
## year2021_team_JAX                                                 0.0908      0.9276      
## year2021_team_PIT                                                 0.4260      0.6701      
## year2022_team_ARI                                                -0.8509      0.3949      
## year2022_team_ATL                                                -1.7794      0.0753     *
## year2022_team_CAR                                                 1.0054      0.3148      
## year2022_team_CHI                                                -0.3940      0.6936      
## year2022_team_CIN                                                -0.4051      0.6854      
## year2022_team_HOU                                                -0.1429      0.8864      
## year2022_team_IND                                                -0.3629      0.7167      
## year2022_team_LAC                                                -0.4260      0.6701      
## year2022_team_MIA                                                -1.3264      0.1848      
## year2022_team_SEA                                                 0.3225      0.7471      
## year2022_team_TB                                                  0.4482      0.6540      
## year2022_team_TEN                                                 1.5242      0.1275     .
## year2022_team_WAS                                                 0.1678      0.8668      
## year2022_team_BAL                                                -1.1889      0.2345      
## year2022_team_BUF                                                 0.5479      0.5838      
## year2022_team_DAL                                                 0.5363      0.5918      
## year2022_team_DET                                                -0.7843      0.4329      
## year2022_team_GB                                                 -0.5514      0.5814      
## year2022_team_JAX                                                -0.7429      0.4576      
## year2022_team_KC                                                 -0.9740      0.3301      
## year2022_team_LA                                                  1.2930      0.1961      
## year2022_team_LV                                                  0.9020      0.3671      
## year2022_team_NO                                                 -0.1610      0.8721      
## year2022_team_PHI                                                 0.9372      0.3487      
## year2022_team_PIT                                                 1.4780      0.1395     .
## year2022_team_DEN                                                 0.3705      0.7110      
## year2022_team_MIN                                                -0.6357      0.5250      
## year2022_team_NE                                                  0.3531      0.7240      
## year2022_team_NYJ                                                -0.7220      0.4703      
## year2022_team_NYG                                                 0.1114      0.9113      
## year2022_team_SF                                                 -1.1093      0.2674      
## year2023_team_BAL                                                -0.3326      0.7394      
## year2023_team_CHI                                                -0.8338      0.4045      
## year2023_team_CLE                                                -0.9692      0.3325      
## year2023_team_GB                                                  0.4483      0.6539      
## year2023_team_IND                                                 0.5021      0.6156      
## year2023_team_KC                                                  0.1562      0.8759      
## year2023_team_LAC                                                 0.7772      0.4371      
## year2023_team_LV                                                 -0.0970      0.9228      
## year2023_team_MIA                                                 0.4063      0.6846      
## year2023_team_MIN                                                 1.6332      0.1025     .
## year2023_team_NO                                                 -0.5283      0.5973      
## year2023_team_NYG                                                 0.6171      0.5372      
## year2023_team_SEA                                                -1.5093      0.1313     .
## year2023_team_SF                                                  0.7390      0.4600      
## year2023_team_WAS                                                 1.8095      0.0705     *
## year2023_team_ATL                                                -0.6826      0.4949      
## year2023_team_BUF                                                -0.1448      0.8848      
## year2023_team_CAR                                                 0.7251      0.4685      
## year2023_team_DAL                                                 0.9122      0.3617      
## year2023_team_DEN                                                 0.0980      0.9219      
## year2023_team_HOU                                                 0.0888      0.9293      
## year2023_team_LA                                                  0.3710      0.7106      
## year2023_team_NE                                                  0.3287      0.7424      
## year2023_team_PHI                                                 0.4749      0.6349      
## year2023_team_PIT                                                 0.4884      0.6253      
## year2023_team_TEN                                                 0.4469      0.6550      
## year2023_team_ARI                                                -0.8371      0.4026      
## year2023_team_CIN                                                -0.8732      0.3826      
## year2023_team_DET                                                 0.7616      0.4464      
## year2023_team_TB                                                  0.9142      0.3607      
## year2023_team_JAX                                                -0.9683      0.3330      
## year2023_team_NYJ                                                 1.5524      0.1207     .
## is_first_half                                                    -1.0065      0.3142      
## time_in_half                                                      1.6214      0.1050     .
## home_attendance                                                  -0.2820      0.7779      
## GIMR                                                              1.7231      0.0850     *
## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15
## 
## Adjusted R-squared: 0.1117411 
## 
## Variables with VIF &gt; 5:
##                                           prev_shotgun_rate 
##                                                   10.269903 
##                                        prev_singleback_rate 
##                                                    5.993881 
##                                                 cover1_rate 
##                                                    7.289006 
##                                                 cover3_rate 
##                                                    8.037883 
##                                   offense_formation_SHOTGUN 
##                                                    7.263658 
##               defense_player_1_run_defense_grades_stops_12w 
##                                                   10.272394 
##             defense_player_1_run_defense_grades_tackles_12w 
##                                                   10.029796 
##               defense_player_2_run_defense_grades_stops_12w 
##                                                   11.789057 
##             defense_player_2_run_defense_grades_tackles_12w 
##                                                   12.321424 
##          defense_player_3_pass_rushing_productivity_prp_12w 
##                                                    5.050624 
##               defense_player_3_run_defense_grades_stops_12w 
##                                                   16.088646 
##             defense_player_3_run_defense_grades_tackles_12w 
##                                                   17.438576 
##               defense_player_4_run_defense_grades_stops_12w 
##                                                   16.259001 
##             defense_player_4_run_defense_grades_tackles_12w 
##                                                   18.005050 
##               defense_player_9_run_defense_grades_stops_12w 
##                                                    6.759034 
##             defense_player_9_run_defense_grades_tackles_12w 
##                                                    8.546921 
##              defense_player_10_run_defense_grades_stops_12w 
##                                                    9.536391 
##            defense_player_10_run_defense_grades_tackles_12w 
##                                                   12.338505 
## defense_player_10_defensive_grades_snap_counts_coverage_12w 
##                                                    5.613438 
##              defense_player_11_run_defense_grades_stops_12w 
##                                                   13.852236 
##            defense_player_11_run_defense_grades_tackles_12w 
##                                                   18.182219 
##              defense_player_12_run_defense_grades_stops_12w 
##                                                   16.565139 
##            defense_player_12_run_defense_grades_tackles_12w 
##                                                   20.058494 
##                                             home_attendance 
##                                                   14.377599</code></pre>
<pre class="r"><code>r2_starter &lt;- analyze_model(ols_model_starter, &quot;Starter Model with GIMR&quot;)</code></pre>
<pre><code>## 
## 
##  ================================================================================ 
## MODEL: Starter Model with GIMR 
## ================================================================================ 
## 
## Variable                                                         t-value     p-value   sig
## ---------                                                        -------     -------  ----
## (Intercept)                                                       2.9430      0.0033   ***
## ydstogo                                                         -13.0233      0.0000   ***
## posteam_timeouts_remaining                                        0.8656      0.3868      
## defteam_timeouts_remaining                                        0.9336      0.3506      
## rush_attempt                                                      7.0735      0.0000   ***
## week                                                             -0.0551      0.9561      
## temp                                                             -0.8216      0.4113      
## wind                                                              0.7245      0.4688      
## vegas_wp                                                          1.2939      0.1958      
## total_line                                                        1.8235      0.0683     *
## prep_days                                                         1.1453      0.2521      
## overall_win_pct                                                   0.6736      0.5006      
## team_win_pct                                                      1.1585      0.2467      
## prev_win_pct                                                     -2.9724      0.0030   ***
## prev_shotgun_rate                                                 0.1730      0.8627      
## prev_singleback_rate                                              0.5357      0.5922      
## prev_empty_rate                                                   0.9715      0.3314      
## prev_iform_rate                                                  -0.0029      0.9977      
## prev_shotgun_success                                              0.9131      0.3613      
## prev_singleback_success                                           0.0169      0.9865      
## prev_empty_success                                               -0.0675      0.9461      
## prev_iform_success                                                2.7834      0.0054   ***
## prev_stop_rate_run                                               -0.4150      0.6782      
## prev_stop_rate_pass                                              -3.5955      0.0003   ***
## shotgun_rate                                                      1.1033      0.2700      
## singleback_rate                                                   0.2047      0.8378      
## empty_rate                                                       -0.1702      0.8648      
## iform_rate                                                       -1.5595      0.1190     .
## shotgun_success                                                  -2.3371      0.0195    **
## singleback_success                                               -1.6465      0.0998     *
## empty_success                                                    -1.0303      0.3030      
## iform_success                                                    -1.3314      0.1831      
## def_stop_rate_run                                                 1.6084      0.1078     .
## def_stop_rate_pass                                               -1.3933      0.1636      
## avg_pass_rushers                                                 -0.8661      0.3865      
## avg_box_defenders                                                -0.6142      0.5391      
## cover0_rate                                                      -0.2351      0.8141      
## cover1_rate                                                      -0.5865      0.5576      
## cover2_rate                                                      -0.5977      0.5501      
## cover3_rate                                                       0.9789      0.3277      
## cover4_rate                                                       0.4489      0.6535      
## cover6_rate                                                      -0.7124      0.4763      
## two_man_rate                                                      1.5166      0.1295     .
## prevent_rate                                                      2.8009      0.0051   ***
## roof_outdoors                                                    -0.0837      0.9333      
## posteam_type_home                                                -1.5161      0.1296     .
## offense_formation_EMPTY                                           0.1276      0.8985      
## offense_formation_SHOTGUN                                        -0.3237      0.7462      
## offense_formation_SINGLEBACK                                     -0.9695      0.3324      
## offense_formation_I_FORM                                         -0.8497      0.3955      
## starter_offense_player_1_passing_depth_short_grades_pass_12w      2.0189      0.0436    **
## starter_offense_player_1_passing_depth_medium_grades_pass...     -1.1872      0.2352      
## starter_offense_player_1_passing_depth_deep_grades_pass_12w      -0.5878      0.5567      
## starter_offense_player_1_rushing_grades_grades_run_12w           -1.4175      0.1564      
## starter_offense_player_4_rushing_grades_first_downs_12w           0.3971      0.6913      
## starter_offense_player_4_receiving_vs_scheme_zone_grades_...     -1.4266      0.1538      
## starter_offense_player_4_pass_blocking_true_pass_set_grad...     -0.6433      0.5201      
## starter_offense_player_4_rushing_grades_yards_after_conta...      0.4983      0.6183      
## starter_offense_player_8_receiving_depth_short_avg_depth_...     -0.1095      0.9128      
## starter_offense_player_8_blocking_grades_block_percent_12w        0.0818      0.9348      
## starter_offense_player_8_receiving_grades_targets_12w             1.5747      0.1154     .
## starter_offense_player_8_receiving_grades_yards_per_recep...      0.7594      0.4476      
## starter_offense_player_9_receiving_depth_short_avg_depth_...     -0.2628      0.7927      
## starter_offense_player_9_blocking_grades_block_percent_12w       -0.3576      0.7207      
## starter_offense_player_9_receiving_grades_targets_12w            -0.0030      0.9976      
## starter_offense_player_9_receiving_grades_yards_per_recep...      2.3656      0.0181    **
## starter_offense_player_10_receiving_depth_short_avg_depth...      1.5533      0.1204     .
## starter_offense_player_10_blocking_grades_block_percent_12w      -0.3992      0.6897      
## starter_offense_player_10_receiving_grades_targets_12w           -0.7631      0.4455      
## starter_offense_player_10_receiving_grades_yards_per_rece...      0.0610      0.9514      
## starter_offense_player_14_blocking_grades_snap_counts_blo...      0.2893      0.7723      
## starter_offense_player_14_receiving_vs_scheme_zone_caught...     -0.9148      0.3604      
## starter_offense_player_14_receiving_depth_center_short_pa...     -2.2032      0.0276    **
## starter_offense_player_14_receiving_concept_slot_targets_12w      1.2076      0.2273      
## starter_offense_player_17_run_blocking_snap_counts_run_bl...     -1.4942      0.1352     .
## starter_offense_player_17_blocking_grades_grades_offense_12w      2.1763      0.0296    **
## starter_offense_player_17_blocking_grades_pbe_2w                  0.9023      0.3669      
## starter_offense_player_18_run_blocking_snap_counts_run_bl...      1.1743      0.2404      
## starter_offense_player_18_blocking_grades_grades_offense_12w     -1.5765      0.1150     .
## starter_offense_player_18_blocking_grades_pbe_2w                  1.2668      0.2053      
## starter_offense_player_19_run_blocking_snap_counts_run_bl...     -1.3276      0.1844      
## starter_offense_player_19_blocking_grades_grades_offense_12w      0.2107      0.8331      
## starter_offense_player_19_blocking_grades_pbe_2w                 -0.4631      0.6433      
## starter_offense_player_20_run_blocking_snap_counts_run_bl...     -0.1037      0.9174      
## starter_offense_player_20_blocking_grades_grades_offense_12w      1.1809      0.2377      
## starter_offense_player_20_blocking_grades_pbe_2w                 -1.0823      0.2792      
## starter_offense_player_21_run_blocking_snap_counts_run_bl...      1.3167      0.1880      
## starter_offense_player_21_blocking_grades_grades_offense_12w     -1.6814      0.0928     *
## starter_offense_player_21_blocking_grades_pbe_2w                  0.2599      0.7949      
## starter_defense_player_1_pass_rushing_productivity_prp_12w        0.9137      0.3609      
## starter_defense_player_1_pass_rushing_productivity_hurrie...     -2.0563      0.0398    **
## starter_defense_player_1_defensive_grades_grades_defense_...      0.4081      0.6832      
## starter_defense_player_1_run_defense_grades_stops_12w             1.2794      0.2008      
## starter_defense_player_1_run_defense_grades_tackles_12w          -1.9091      0.0563     *
## starter_defense_player_2_pass_rushing_productivity_prp_12w        0.2945      0.7684      
## starter_defense_player_2_pass_rushing_productivity_hurrie...      0.1300      0.8965      
## starter_defense_player_2_defensive_grades_grades_defense_...     -2.3473      0.0190    **
## starter_defense_player_2_run_defense_grades_stops_12w            -0.4602      0.6454      
## starter_defense_player_2_run_defense_grades_tackles_12w           0.7280      0.4667      
## starter_defense_player_3_pass_rushing_productivity_prp_12w        1.8557      0.0636     *
## starter_defense_player_3_pass_rushing_productivity_hurrie...     -1.5900      0.1119     .
## starter_defense_player_3_defensive_grades_grades_defense_...     -0.2642      0.7917      
## starter_defense_player_3_run_defense_grades_stops_12w             0.3392      0.7345      
## starter_defense_player_3_run_defense_grades_tackles_12w          -0.2016      0.8403      
## starter_defense_player_4_pass_rushing_productivity_prp_12w       -0.3752      0.7076      
## starter_defense_player_4_pass_rushing_productivity_hurrie...     -0.3025      0.7623      
## starter_defense_player_4_defensive_grades_grades_defense_...     -0.1390      0.8894      
## starter_defense_player_4_run_defense_grades_stops_12w            -0.8941      0.3713      
## starter_defense_player_4_run_defense_grades_tackles_12w           0.9484      0.3430      
## starter_defense_player_9_pass_rushing_productivity_prp_12w       -0.2108      0.8330      
## starter_defense_player_9_pass_rushing_productivity_hurrie...      0.2698      0.7873      
## starter_defense_player_9_defensive_grades_grades_defense_...      0.3771      0.7061      
## starter_defense_player_9_run_defense_grades_stops_12w             0.7423      0.4579      
## starter_defense_player_9_run_defense_grades_tackles_12w          -1.6825      0.0926     *
## starter_defense_player_9_defensive_grades_snap_counts_cov...     -1.1212      0.2623      
## starter_defense_player_9_coverage_schemes_zone_stops_12w          0.0963      0.9233      
## starter_defense_player_10_pass_rushing_productivity_prp_12w      -0.0065      0.9948      
## starter_defense_player_10_pass_rushing_productivity_hurri...      0.5040      0.6143      
## starter_defense_player_10_defensive_grades_grades_defense...      1.2772      0.2016      
## starter_defense_player_10_run_defense_grades_stops_12w            0.3794      0.7044      
## starter_defense_player_10_run_defense_grades_tackles_12w         -0.9409      0.3468      
## starter_defense_player_10_defensive_grades_snap_counts_co...      0.7630      0.4455      
## starter_defense_player_10_coverage_schemes_zone_stops_12w        -0.0978      0.9221      
## starter_defense_player_11_pass_rushing_productivity_prp_12w       0.5151      0.6065      
## starter_defense_player_11_pass_rushing_productivity_hurri...      1.3549      0.1755      
## starter_defense_player_11_defensive_grades_grades_defense...     -1.2133      0.2251      
## starter_defense_player_11_run_defense_grades_stops_12w            0.1608      0.8722      
## starter_defense_player_11_run_defense_grades_tackles_12w         -0.7172      0.4733      
## starter_defense_player_11_defensive_grades_snap_counts_co...      0.5570      0.5776      
## starter_defense_player_11_coverage_schemes_zone_stops_12w        -1.1013      0.2708      
## starter_defense_player_12_pass_rushing_productivity_prp_12w       1.0605      0.2890      
## starter_defense_player_12_pass_rushing_productivity_hurri...     -0.3482      0.7277      
## starter_defense_player_12_defensive_grades_grades_defense...      1.0286      0.3038      
## starter_defense_player_12_run_defense_grades_stops_12w           -0.0978      0.9221      
## starter_defense_player_12_run_defense_grades_tackles_12w          0.0002      0.9999      
## starter_defense_player_12_defensive_grades_snap_counts_co...      1.0360      0.3002      
## starter_defense_player_12_coverage_schemes_zone_stops_12w        -0.8576      0.3912      
## starter_defense_player_15_defensive_grades_grades_defense...     -0.3935      0.6940      
## starter_defense_player_15_run_defense_grades_tackles_12w         -0.1441      0.8855      
## starter_defense_player_15_coverage_schemes_man_coverage_s...     -1.2737      0.2028      
## starter_defense_player_15_coverage_grades_stops_12w               0.0989      0.9212      
## starter_defense_player_15_slot_coverage_targets_12w               2.2433      0.0249    **
## starter_defense_player_15_defensive_grades_missed_tackle_...     -0.5033      0.6148      
## starter_defense_player_16_defensive_grades_grades_defense...     -0.2772      0.7816      
## starter_defense_player_16_run_defense_grades_tackles_12w         -1.8549      0.0637     *
## starter_defense_player_16_coverage_schemes_man_coverage_s...      1.2913      0.1967      
## starter_defense_player_16_coverage_grades_stops_12w              -1.0886      0.2764      
## starter_defense_player_16_slot_coverage_targets_12w              -1.5922      0.1114     .
## starter_defense_player_16_defensive_grades_missed_tackle_...      1.3881      0.1652      
## starter_defense_player_17_defensive_grades_grades_defense...     -0.2568      0.7973      
## starter_defense_player_17_run_defense_grades_tackles_12w          0.5409      0.5886      
## starter_defense_player_17_coverage_schemes_man_coverage_s...     -1.4599      0.1444     .
## starter_defense_player_17_coverage_grades_stops_12w              -0.0503      0.9599      
## starter_defense_player_17_slot_coverage_targets_12w               0.1349      0.8927      
## starter_defense_player_17_defensive_grades_missed_tackle_...     -0.6578      0.5107      
## starter_defense_player_20_defensive_grades_grades_defense...     -1.6266      0.1039     .
## starter_defense_player_20_run_defense_grades_tackles_12w          0.6075      0.5435      
## starter_defense_player_20_coverage_grades_stops_12w              -0.1293      0.8971      
## starter_defense_player_20_slot_coverage_targets_12w               1.0760      0.2820      
## starter_defense_player_20_defensive_grades_missed_tackle_...     -1.4585      0.1448     .
## starter_defense_player_21_defensive_grades_grades_defense...      3.2640      0.0011   ***
## starter_defense_player_21_run_defense_grades_tackles_12w         -1.3854      0.1660      
## starter_defense_player_21_coverage_grades_stops_12w               0.4207      0.6740      
## starter_defense_player_21_slot_coverage_targets_12w              -1.6941      0.0903     *
## starter_defense_player_21_defensive_grades_missed_tackle_...     -0.0985      0.9216      
## starter_defense_player_22_defensive_grades_grades_defense...     -0.1481      0.8823      
## starter_defense_player_22_run_defense_grades_tackles_12w          0.0801      0.9362      
## starter_defense_player_22_coverage_grades_stops_12w              -1.5144      0.1300     .
## starter_defense_player_22_slot_coverage_targets_12w               0.8358      0.4033      
## starter_defense_player_22_defensive_grades_missed_tackle_...     -0.0524      0.9582      
## yardline_1_10                                                    -2.7676      0.0057   ***
## yardline_11_20                                                    0.0066      0.9947      
## yardline_21_30                                                    0.1772      0.8593      
## yardline_41_50                                                    1.7802      0.0751     *
## yardline_51_60                                                    0.6534      0.5136      
## yardline_61_70                                                    1.4527      0.1464     .
## yardline_71_80                                                    1.6748      0.0941     *
## yardline_81_90                                                    1.9931      0.0463    **
## yardline_91_100                                                   1.0966      0.2729      
## year2017_team_ARI                                                 0.6073      0.5437      
## year2017_team_BUF                                                -0.6060      0.5445      
## year2017_team_CHI                                                -0.0584      0.9534      
## year2017_team_CLE                                                 0.6345      0.5258      
## year2017_team_DAL                                                -0.8070      0.4197      
## year2017_team_DET                                                -0.4180      0.6760      
## year2017_team_GB                                                  2.1777      0.0295    **
## year2017_team_HOU                                                 1.6083      0.1079     .
## year2017_team_MIA                                                -0.9256      0.3547      
## year2017_team_MIN                                                -0.4467      0.6552      
## year2017_team_NE                                                 -0.2001      0.8414      
## year2017_team_SF                                                  1.6821      0.0926     *
## year2017_team_BAL                                                 0.1188      0.9055      
## year2017_team_DEN                                                -0.0403      0.9678      
## year2017_team_LA                                                  0.5209      0.6024      
## year2017_team_NYG                                                -0.2230      0.8235      
## year2017_team_OAK                                                -0.7179      0.4729      
## year2017_team_SEA                                                 0.5460      0.5851      
## year2017_team_CAR                                                 0.3944      0.6933      
## year2017_team_CIN                                                 0.8421      0.3998      
## year2017_team_IND                                                 0.9518      0.3413      
## year2017_team_NO                                                  0.5664      0.5712      
## year2017_team_PHI                                                 0.1573      0.8751      
## year2017_team_PIT                                                -0.6650      0.5061      
## year2017_team_TEN                                                 0.4223      0.6728      
## year2017_team_WAS                                                 0.2936      0.7691      
## year2017_team_KC                                                  1.5828      0.1135     .
## year2017_team_LAC                                                 0.0077      0.9939      
## year2017_team_NYJ                                                 0.5911      0.5545      
## year2017_team_TB                                                 -0.1085      0.9136      
## year2017_team_ATL                                                -0.2788      0.7804      
## year2017_team_JAX                                                 0.3677      0.7131      
## year2018_team_ARI                                                 0.7125      0.4762      
## year2018_team_BAL                                                 0.6903      0.4901      
## year2018_team_CAR                                                 0.8733      0.3825      
## year2018_team_CLE                                                -0.1461      0.8839      
## year2018_team_DET                                                 0.8330      0.4049      
## year2018_team_HOU                                                 0.9006      0.3679      
## year2018_team_IND                                                -0.3662      0.7142      
## year2018_team_KC                                                  1.0705      0.2845      
## year2018_team_NYG                                                 0.6246      0.5323      
## year2018_team_OAK                                                -0.3145      0.7531      
## year2018_team_PHI                                                 0.3619      0.7174      
## year2018_team_SEA                                                 0.1060      0.9156      
## year2018_team_BUF                                                -0.3124      0.7547      
## year2018_team_CHI                                                 0.1987      0.8425      
## year2018_team_CIN                                                -0.2921      0.7702      
## year2018_team_DAL                                                 0.5023      0.6155      
## year2018_team_DEN                                                 0.0883      0.9296      
## year2018_team_GB                                                  0.2625      0.7929      
## year2018_team_LAC                                                 0.7003      0.4838      
## year2018_team_NE                                                 -0.6229      0.5334      
## year2018_team_NO                                                  1.0082      0.3134      
## year2018_team_PIT                                                 0.7117      0.4767      
## year2018_team_SF                                                  0.3440      0.7308      
## year2018_team_MIA                                                 1.1495      0.2504      
## year2018_team_MIN                                                 0.8902      0.3734      
## year2018_team_NYJ                                                 0.4513      0.6518      
## year2018_team_TB                                                 -0.2778      0.7812      
## year2018_team_ATL                                                 0.6320      0.5274      
## year2018_team_JAX                                                 0.5641      0.5727      
## year2018_team_LA                                                 -0.4280      0.6687      
## year2018_team_TEN                                                 1.3147      0.1887      
## year2018_team_WAS                                                 0.4455      0.6560      
## year2019_team_ARI                                                -0.4629      0.6435      
## year2019_team_BUF                                                -0.4213      0.6736      
## year2019_team_CHI                                                 0.6295      0.5291      
## year2019_team_CLE                                                 0.6658      0.5056      
## year2019_team_DAL                                                 0.1165      0.9073      
## year2019_team_IND                                                -0.4617      0.6443      
## year2019_team_JAX                                                 0.8225      0.4108      
## year2019_team_KC                                                  0.2559      0.7981      
## year2019_team_LAC                                                -0.5599      0.5756      
## year2019_team_MIN                                                -0.4942      0.6212      
## year2019_team_NE                                                 -0.0334      0.9733      
## year2019_team_NO                                                 -0.8810      0.3784      
## year2019_team_PHI                                                 0.4196      0.6748      
## year2019_team_SEA                                                 0.2928      0.7697      
## year2019_team_SF                                                  0.2264      0.8209      
## year2019_team_TB                                                 -0.9834      0.3255      
## year2019_team_BAL                                                 0.0492      0.9607      
## year2019_team_CAR                                                -0.7999      0.4238      
## year2019_team_DEN                                                 1.0230      0.3064      
## year2019_team_DET                                                -0.6311      0.5280      
## year2019_team_HOU                                                -0.1058      0.9157      
## year2019_team_LA                                                 -0.9114      0.3622      
## year2019_team_MIA                                                -1.4917      0.1359     .
## year2019_team_NYG                                                -0.6520      0.5144      
## year2019_team_NYJ                                                -1.2315      0.2182      
## year2019_team_OAK                                                 0.1410      0.8878      
## year2019_team_PIT                                                -2.5488      0.0109    **
## year2019_team_TEN                                                -0.9533      0.3405      
## year2019_team_CIN                                                -0.1076      0.9143      
## year2019_team_WAS                                                 0.2305      0.8177      
## year2019_team_ATL                                                 0.2715      0.7861      
## year2019_team_GB                                                 -0.3972      0.6913      
## year2020_team_ATL                                                 0.6097      0.5421      
## year2020_team_BAL                                                 1.0407      0.2981      
## year2020_team_BUF                                                 0.2353      0.8140      
## year2020_team_CAR                                                 1.0562      0.2910      
## year2020_team_CIN                                                 0.5498      0.5825      
## year2020_team_DEN                                                 0.2928      0.7697      
## year2020_team_DET                                                -0.3146      0.7531      
## year2020_team_JAX                                                -0.0987      0.9214      
## year2020_team_KC                                                  0.0736      0.9414      
## year2020_team_LA                                                 -0.7531      0.4514      
## year2020_team_MIN                                                 1.2915      0.1966      
## year2020_team_NE                                                  0.2663      0.7900      
## year2020_team_NO                                                  0.5647      0.5723      
## year2020_team_NYG                                                 0.3193      0.7495      
## year2020_team_SF                                                  0.6755      0.4994      
## year2020_team_WAS                                                 0.4310      0.6665      
## year2020_team_CHI                                                 0.7111      0.4771      
## year2020_team_DAL                                                 0.3296      0.7417      
## year2020_team_GB                                                  0.5126      0.6082      
## year2020_team_HOU                                                -0.7669      0.4432      
## year2020_team_MIA                                                -0.7177      0.4730      
## year2020_team_NYJ                                                 0.1471      0.8831      
## year2020_team_TB                                                  0.6488      0.5165      
## year2020_team_TEN                                                 0.0332      0.9735      
## year2020_team_ARI                                                 0.7654      0.4441      
## year2020_team_CLE                                                -1.0583      0.2900      
## year2020_team_IND                                                -0.4207      0.6740      
## year2020_team_LAC                                                 0.0776      0.9382      
## year2020_team_PHI                                                 1.2596      0.2079      
## year2020_team_SEA                                                -0.1264      0.8994      
## year2020_team_LV                                                  0.7597      0.4475      
## year2020_team_PIT                                                -0.1244      0.9010      
## year2021_team_ATL                                                -1.6725      0.0945     *
## year2021_team_BUF                                                 0.4655      0.6416      
## year2021_team_CIN                                                -1.3009      0.1934      
## year2021_team_DAL                                                -0.3761      0.7069      
## year2021_team_DEN                                                 1.4979      0.1343     .
## year2021_team_DET                                                -0.4088      0.6827      
## year2021_team_KC                                                  0.8029      0.4221      
## year2021_team_LA                                                  0.0762      0.9393      
## year2021_team_LV                                                  0.4979      0.6186      
## year2021_team_MIN                                                -0.3548      0.7227      
## year2021_team_NE                                                  0.6964      0.4862      
## year2021_team_NO                                                  0.3460      0.7294      
## year2021_team_NYG                                                -0.2635      0.7922      
## year2021_team_SF                                                  0.5984      0.5496      
## year2021_team_TEN                                                -0.3607      0.7183      
## year2021_team_ARI                                                 0.9882      0.3231      
## year2021_team_BAL                                                 0.9947      0.3200      
## year2021_team_CAR                                                -0.2537      0.7997      
## year2021_team_CHI                                                -1.4509      0.1469     .
## year2021_team_GB                                                  1.4099      0.1587      
## year2021_team_IND                                                 0.1599      0.8730      
## year2021_team_LAC                                                 0.1132      0.9099      
## year2021_team_MIA                                                 0.1803      0.8569      
## year2021_team_NYJ                                                -0.1746      0.8614      
## year2021_team_PHI                                                -1.5978      0.1102     .
## year2021_team_SEA                                                -0.8304      0.4064      
## year2021_team_TB                                                  0.2177      0.8277      
## year2021_team_WAS                                                -0.4557      0.6486      
## year2021_team_CLE                                                -0.7189      0.4722      
## year2021_team_HOU                                                -1.0493      0.2941      
## year2021_team_JAX                                                 0.2883      0.7731      
## year2021_team_PIT                                                 0.5541      0.5796      
## year2022_team_ARI                                                -0.7869      0.4314      
## year2022_team_ATL                                                -1.9333      0.0533     *
## year2022_team_CAR                                                 1.2661      0.2055      
## year2022_team_CHI                                                 0.1160      0.9076      
## year2022_team_CIN                                                -0.4063      0.6845      
## year2022_team_HOU                                                -0.3396      0.7342      
## year2022_team_IND                                                -0.4752      0.6347      
## year2022_team_LAC                                                -0.5975      0.5502      
## year2022_team_MIA                                                -1.0020      0.3164      
## year2022_team_SEA                                                -0.1266      0.8993      
## year2022_team_TB                                                  0.4547      0.6494      
## year2022_team_TEN                                                 1.5994      0.1098     .
## year2022_team_WAS                                                 0.2535      0.7999      
## year2022_team_BAL                                                -1.0618      0.2884      
## year2022_team_BUF                                                 1.2023      0.2293      
## year2022_team_DAL                                                 0.1456      0.8842      
## year2022_team_DET                                                 0.1344      0.8931      
## year2022_team_GB                                                 -0.5567      0.5778      
## year2022_team_JAX                                                -0.7272      0.4671      
## year2022_team_KC                                                 -0.2199      0.8260      
## year2022_team_LA                                                  1.5652      0.1176     .
## year2022_team_LV                                                  1.2962      0.1950      
## year2022_team_NO                                                 -0.2931      0.7695      
## year2022_team_PHI                                                 0.7966      0.4257      
## year2022_team_PIT                                                 2.4749      0.0134    **
## year2022_team_DEN                                                 0.6670      0.5048      
## year2022_team_MIN                                                -0.8312      0.4059      
## year2022_team_NE                                                  0.3902      0.6964      
## year2022_team_NYJ                                                -0.9935      0.3205      
## year2022_team_NYG                                                -0.7514      0.4525      
## year2022_team_SF                                                 -0.9133      0.3611      
## year2023_team_BAL                                                 0.3144      0.7532      
## year2023_team_CHI                                                -0.6796      0.4968      
## year2023_team_CLE                                                -0.7422      0.4580      
## year2023_team_GB                                                  0.8551      0.3926      
## year2023_team_IND                                                 1.4095      0.1588      
## year2023_team_KC                                                  0.7559      0.4498      
## year2023_team_LAC                                                 0.6848      0.4935      
## year2023_team_LV                                                  0.5845      0.5589      
## year2023_team_MIA                                                 0.3465      0.7290      
## year2023_team_MIN                                                 2.1929      0.0284    **
## year2023_team_NO                                                 -0.5220      0.6017      
## year2023_team_NYG                                                 0.8455      0.3979      
## year2023_team_SEA                                                -1.6637      0.0963     *
## year2023_team_SF                                                  0.7337      0.4632      
## year2023_team_WAS                                                 1.5163      0.1295     .
## year2023_team_ATL                                                -0.5362      0.5919      
## year2023_team_BUF                                                -0.0377      0.9699      
## year2023_team_CAR                                                 1.1720      0.2413      
## year2023_team_DAL                                                 0.8052      0.4208      
## year2023_team_DEN                                                 0.0929      0.9260      
## year2023_team_HOU                                                 0.1482      0.8822      
## year2023_team_LA                                                  0.2981      0.7657      
## year2023_team_NE                                                  0.2875      0.7738      
## year2023_team_PHI                                                 0.0952      0.9241      
## year2023_team_PIT                                                 0.0783      0.9376      
## year2023_team_TEN                                                 0.3131      0.7542      
## year2023_team_ARI                                                -1.1537      0.2487      
## year2023_team_CIN                                                -1.1133      0.2657      
## year2023_team_DET                                                 0.7574      0.4488      
## year2023_team_TB                                                  1.2780      0.2013      
## year2023_team_JAX                                                -0.4806      0.6309      
## year2023_team_NYJ                                                 2.1064      0.0352    **
## is_first_half                                                    -0.3170      0.7512      
## time_in_half                                                      1.9445      0.0519     *
## home_attendance                                                  -0.1392      0.8893      
## GIMR                                                              2.4202      0.0156    **
## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15
## 
## Adjusted R-squared: 0.1147314 
## 
## Variables with VIF &gt; 5:
##                                                      prev_shotgun_rate 
##                                                              10.497295 
##                                                   prev_singleback_rate 
##                                                               6.041328 
##                                                        prev_iform_rate 
##                                                               5.327314 
##                                                            cover1_rate 
##                                                               6.427617 
##                                                            cover3_rate 
##                                                               6.672515 
##                                              offense_formation_SHOTGUN 
##                                                               5.715239 
##           starter_offense_player_1_passing_depth_short_grades_pass_12w 
##                                                              19.133947 
##          starter_offense_player_1_passing_depth_medium_grades_pass_12w 
##                                                               9.066474 
##            starter_offense_player_1_passing_depth_deep_grades_pass_12w 
##                                                               7.942974 
##                 starter_offense_player_1_rushing_grades_grades_run_12w 
##                                                              10.101481 
## starter_offense_player_8_receiving_depth_short_avg_depth_of_target_12w 
##                                                               6.162307 
##             starter_offense_player_8_blocking_grades_block_percent_12w 
##                                                               8.228135 
##             starter_offense_player_9_blocking_grades_block_percent_12w 
##                                                               5.932491 
##       starter_offense_player_17_run_blocking_snap_counts_run_block_12w 
##                                                               5.595184 
##           starter_offense_player_17_blocking_grades_grades_offense_12w 
##                                                              15.924770 
##                       starter_offense_player_17_blocking_grades_pbe_2w 
##                                                             209.445395 
##       starter_offense_player_18_run_blocking_snap_counts_run_block_12w 
##                                                               6.798477 
##           starter_offense_player_18_blocking_grades_grades_offense_12w 
##                                                              15.575436 
##                       starter_offense_player_18_blocking_grades_pbe_2w 
##                                                             204.676551 
##       starter_offense_player_19_run_blocking_snap_counts_run_block_12w 
##                                                               5.873465 
##           starter_offense_player_19_blocking_grades_grades_offense_12w 
##                                                              13.601348 
##                       starter_offense_player_19_blocking_grades_pbe_2w 
##                                                             220.572758 
##       starter_offense_player_20_run_blocking_snap_counts_run_block_12w 
##                                                               5.936462 
##           starter_offense_player_20_blocking_grades_grades_offense_12w 
##                                                              14.659812 
##                       starter_offense_player_20_blocking_grades_pbe_2w 
##                                                             209.114401 
##           starter_offense_player_21_blocking_grades_grades_offense_12w 
##                                                              13.332709 
##                       starter_offense_player_21_blocking_grades_pbe_2w 
##                                                             146.949982 
##             starter_defense_player_1_pass_rushing_productivity_prp_12w 
##                                                               5.435090 
##                  starter_defense_player_1_run_defense_grades_stops_12w 
##                                                              13.072944 
##                starter_defense_player_1_run_defense_grades_tackles_12w 
##                                                              13.908557 
##             starter_defense_player_2_pass_rushing_productivity_prp_12w 
##                                                               5.632804 
##         starter_defense_player_2_pass_rushing_productivity_hurries_12w 
##                                                               5.100049 
##   starter_defense_player_2_defensive_grades_grades_defense_penalty_12w 
##                                                               6.420078 
##                  starter_defense_player_2_run_defense_grades_stops_12w 
##                                                              13.340874 
##                starter_defense_player_2_run_defense_grades_tackles_12w 
##                                                              14.234737 
##   starter_defense_player_3_defensive_grades_grades_defense_penalty_12w 
##                                                               6.703327 
##                  starter_defense_player_3_run_defense_grades_stops_12w 
##                                                              11.393510 
##                starter_defense_player_3_run_defense_grades_tackles_12w 
##                                                              11.466506 
##   starter_defense_player_4_defensive_grades_grades_defense_penalty_12w 
##                                                               6.635800 
##                  starter_defense_player_4_run_defense_grades_stops_12w 
##                                                              12.428234 
##                starter_defense_player_4_run_defense_grades_tackles_12w 
##                                                              13.030182 
##   starter_defense_player_9_defensive_grades_grades_defense_penalty_12w 
##                                                               9.175723 
##                  starter_defense_player_9_run_defense_grades_stops_12w 
##                                                               8.294338 
##                starter_defense_player_9_run_defense_grades_tackles_12w 
##                                                              10.068212 
##  starter_defense_player_10_defensive_grades_grades_defense_penalty_12w 
##                                                               7.954073 
##                 starter_defense_player_10_run_defense_grades_stops_12w 
##                                                               9.780833 
##               starter_defense_player_10_run_defense_grades_tackles_12w 
##                                                              12.601303 
##    starter_defense_player_10_defensive_grades_snap_counts_coverage_12w 
##                                                               5.513962 
##  starter_defense_player_11_defensive_grades_grades_defense_penalty_12w 
##                                                               7.612715 
##                 starter_defense_player_11_run_defense_grades_stops_12w 
##                                                               9.088049 
##               starter_defense_player_11_run_defense_grades_tackles_12w 
##                                                              11.224192 
##                 starter_defense_player_12_run_defense_grades_stops_12w 
##                                                               9.209206 
##               starter_defense_player_12_run_defense_grades_tackles_12w 
##                                                              11.515015 
##  starter_defense_player_15_defensive_grades_grades_defense_penalty_12w 
##                                                              15.536786 
##  starter_defense_player_16_defensive_grades_grades_defense_penalty_12w 
##                                                               8.385478 
##  starter_defense_player_17_defensive_grades_grades_defense_penalty_12w 
##                                                               5.426239 
##  starter_defense_player_20_defensive_grades_grades_defense_penalty_12w 
##                                                              12.146719 
##  starter_defense_player_21_defensive_grades_grades_defense_penalty_12w 
##                                                               7.784291 
##                                                        home_attendance 
##                                                              14.530995</code></pre>
<pre class="r"><code># Compare R-squared values
cat(&quot;\n\n&quot;, paste(rep(&quot;=&quot;, 80), collapse=&quot;&quot;), &quot;\n&quot;)</code></pre>
<pre><code>## 
## 
##  ================================================================================</code></pre>
<pre class="r"><code>cat(&quot;MODEL COMPARISON - Adjusted R-squared values\n&quot;)</code></pre>
<pre><code>## MODEL COMPARISON - Adjusted R-squared values</code></pre>
<pre class="r"><code>cat(paste(rep(&quot;=&quot;, 80), collapse=&quot;&quot;), &quot;\n\n&quot;)</code></pre>
<pre><code>## ================================================================================</code></pre>
<pre class="r"><code>cat(&quot;Player Model with GIMR:&quot;, r2_player, &quot;\n&quot;)</code></pre>
<pre><code>## Player Model with GIMR: 0.1117411</code></pre>
<pre class="r"><code>cat(&quot;Starter Model with GIMR:&quot;, r2_starter, &quot;\n&quot;)</code></pre>
<pre><code>## Starter Model with GIMR: 0.1147314</code></pre>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIkhlY2ttYW4gU2VsZWN0aW9uIE1vZGVsIEFuYWx5c2lzIg0Kb3V0cHV0OiBodG1sX2RvY3VtZW50DQotLS0NCg0KYGBge3Igb3B0aW9ucywgaW5jbHVkZT1GQUxTRX0NCm9wdGlvbnMobWF4LnByaW50PTEwMDAwKQ0KYGBgDQoNCmBgYHtyfQ0KbGlicmFyeShkYXRhLnRhYmxlKQ0Kb3V0Y29tZV9kYXRhIDwtIGZyZWFkKCJwcmVkaWN0X291dGNvbWUuY3N2Lmd6IikNCnNlbGVjdF9kYXRhIDwtIGZyZWFkKCJwcmVkaWN0X3NlbGVjdC5jc3YuZ3oiKQ0KYGBgDQoNCmBgYHtyfQ0KIycgRmlsdGVyIGZvciBzcGVjaWZpYyBwbGF5ZXIgZGF0YSAob2ZmZW5zZSBvciBkZWZlbnNlKQ0KIyBmaWx0ZXJfc3BlY2lmaWNfcGxheWVyIDwtIGZ1bmN0aW9uKGRhdGEsIHNpZGUgPSAib2ZmZW5zZSIsIHBsYXllciA9IDEpIHsNCiMgICAjIENyZWF0ZSBhIGNvcHkgdG8gYXZvaWQgbW9kaWZ5aW5nIHRoZSBvcmlnaW5hbA0KIyAgIGR0IDwtIGNvcHkoZGF0YSkNCiMgICANCiMgICAjIEJ1aWxkIHBhdHRlcm5zIGZvciBjb2x1bW5zIHRvIGtlZXANCiMgICAjIFdlIHdhbnQgdG8ga2VlcCAzIHR5cGVzIG9mIGNvbHVtbnM6DQojICAgIyAxLiBSZWd1bGFyIHBsYXllciBjb2x1bW46IHNpZGVfcGxheWVyX251bWJlcl8qDQojICAgIyAyLiBQbGF5ZXIgcHJlc2VudCBjb2x1bW46IHNpZGVfcGxheWVyX251bWJlcl9wcmVzZW50DQojICAgIyAzLiBTdGFydGVyIHBsYXllciBjb2x1bW46IHN0YXJ0ZXJfc2lkZV9wbGF5ZXJfbnVtYmVyXyoNCiMgICANCiMgICAjIElkZW50aWZ5IGFsbCBwbGF5ZXItcmVsYXRlZCBjb2x1bW5zIChib3RoIG5vcm1hbCBhbmQgc3RhcnRlcikNCiMgICBhbGxfcGxheWVyX2NvbHMgPC0gZ3JlcCgicGxheWVyXyIsIG5hbWVzKGR0KSwgdmFsdWUgPSBUUlVFKQ0KIyAgIA0KIyAgICMgQ3JlYXRlIHBhdHRlcm5zIGZvciB0aGUgMyB0eXBlcyBvZiBjb2x1bW5zIHdlIHdhbnQgdG8ga2VlcA0KIyAgIHBsYXllcl9wYXR0ZXJuIDwtIHBhc3RlMCgiXiIsIHNpZGUsICJfcGxheWVyXyIsIHBsYXllciwgIl8iKQ0KIyAgIHByZXNlbnRfcGF0dGVybiA8LSBwYXN0ZTAoIl4iLCBzaWRlLCAiX3BsYXllcl8iLCBwbGF5ZXIsICJfcHJlc2VudCQiKQ0KIyAgIHN0YXJ0ZXJfcGF0dGVybiA8LSBwYXN0ZTAoIl5zdGFydGVyXyIsIHNpZGUsICJfcGxheWVyXyIsIHBsYXllciwgIl8iKQ0KIyAgIA0KIyAgICMgQ29tYmluZSBwYXR0ZXJucw0KIyAgIGtlZXBfcGF0dGVybiA8LSBwYXN0ZShwbGF5ZXJfcGF0dGVybiwgcHJlc2VudF9wYXR0ZXJuLCBzdGFydGVyX3BhdHRlcm4sIHNlcCA9ICJ8IikNCiMgICANCiMgICAjIEZpbmQgY29sdW1ucyB0byBrZWVwDQojICAgY29sc190b19rZWVwIDwtIGdyZXAoa2VlcF9wYXR0ZXJuLCBhbGxfcGxheWVyX2NvbHMsIHZhbHVlID0gVFJVRSkNCiMgICANCiMgICAjIEZpbmQgYWxsIHBsYXllciBjb2x1bW5zIHRvIHJlbW92ZSAoYWxsIHBsYXllciBjb2x1bW5zIGV4Y2VwdCB0aG9zZSB0byBrZWVwKQ0KIyAgIGNvbHNfdG9fcmVtb3ZlIDwtIHNldGRpZmYoYWxsX3BsYXllcl9jb2xzLCBjb2xzX3RvX2tlZXApDQojICAgDQojICAgIyBSZW1vdmUgdW53YW50ZWQgcGxheWVyIGNvbHVtbnMNCiMgICBmb3IgKGNvbCBpbiBjb2xzX3RvX3JlbW92ZSkgew0KIyAgICAgZHRbLCAoY29sKSA6PSBOVUxMXQ0KIyAgIH0NCiMgICANCiMgICAjIFJldHVybiBmaWx0ZXJlZCBkYXRhDQojICAgcmV0dXJuKGR0KQ0KIyB9DQojIA0KIyAjIEZpbHRlciB0byBrZWVwIG9ubHkgb2ZmZW5zZSBwbGF5ZXIgMSBjb2x1bW5zDQojIG91dGNvbWVfZGF0YSA8LSBmaWx0ZXJfc3BlY2lmaWNfcGxheWVyKG91dGNvbWVfZGF0YSwgc2lkZSA9ICJvZmZlbnNlIiwgcGxheWVyID0gMSkNCiMgDQojICMgU2hvdyByZW1haW5pbmcgcGxheWVyIGNvbHVtbnMNCiMgcmVtYWluaW5nX3BsYXllcl9jb2xzIDwtIGdyZXAoInBsYXllcl8iLCBuYW1lcyhvdXRjb21lX2RhdGEpLCB2YWx1ZSA9IFRSVUUpDQojIHByaW50KCJSZW1haW5pbmcgcGxheWVyIGNvbHVtbnM6IikNCiMgcHJpbnQocmVtYWluaW5nX3BsYXllcl9jb2xzKQ0KYGBgDQoNCg0KYGBge3J9DQpzZWxlY3RfZGF0YVssIGF0dGVtcHQgOj0gYXMubnVtZXJpYyhhcy5jaGFyYWN0ZXIoYXR0ZW1wdCkpXQ0KYGBgDQoNCmBgYHtyfQ0KbGlicmFyeShkYXRhLnRhYmxlKQ0KbGlicmFyeSh4Z2Jvb3N0KQ0KbGlicmFyeShST0NSKQ0KbGlicmFyeShwYXJhbGxlbCkNCg0KIyBQcmVwYXJlIHRoZSBYR0Jvb3N0IG1hdHJpY2VzDQp4cyA8LSBtb2RlbC5tYXRyaXgofiAuIC0gMSAtIGF0dGVtcHQgLSBteV9pZCwgZGF0YSA9IHNlbGVjdF9kYXRhKQ0KeSA8LSBhcy5udW1lcmljKGFzLmNoYXJhY3RlcihzZWxlY3RfZGF0YSRhdHRlbXB0KSkNCg0KDQojIENyZWF0ZSBwYXJhbWV0ZXIgZ3JpZA0KZ3JpZCA8LSBleHBhbmQuZ3JpZCgNCiAgZXRhID0gc2VxKDAuMDAxLCAwLjAzLCBieSA9IDAuMDEpLA0KICBtYXhfZGVwdGggPSBzZXEoNSwgNSwgYnkgPSAyKSwNCiAgbWluX2NoaWxkX3dlaWdodCA9IHNlcSgxLCAxLCBieSA9IDEpLCAgICAgICAgDQogIHN1YnNhbXBsZSA9IHNlcSgxLCAxLCBieSA9IDAuMiksDQogIGNvbHNhbXBsZV9ieXRyZWUgPSBzZXEoMSwgMSwgYnkgPSAwLjIpLA0KICBsYW1iZGEgPSBzZXEoMSwgMSwgYnkgPSAxKSwgICAgICAgICAgICAgICAgDQogIGFscGhhID0gc2VxKDAsIDAsIGJ5ID0gMSksICAgICAgICAgICAgICAgICAgDQogIGdhbW1hID0gc2VxKDAsIDAsIGJ5ID0gMC4xKSwgICAgICAgICAgICAgICANCiAgbnJvdW5kcyA9IHNlcSgxMDAsIDI1MCwgYnkgPSA1MCkNCikNCg0KDQojIFNhbXBsZSBncmlkIHBvaW50cw0KY29uZl9sZXYgPC0gLjk1DQpudW1fbWF4IDwtIDUNCm4gPC0gY2VpbGluZyhsb2coMS1jb25mX2xldikvbG9nKDEtbnVtX21heC9ucm93KGdyaWQpKSkNCmluZCA8LSBzYW1wbGUobnJvdyhncmlkKSwgbiwgcmVwbGFjZSA9IEZBTFNFKQ0KcmdyaWQgPC0gZ3JpZFtpbmQsIF0NCg0KIyBTZXQgdXAgcGFyYWxsZWwgcHJvY2Vzc2luZw0KbmMgPC0gZGV0ZWN0Q29yZXMoKSAtIDENCg0KIyBDYWxjdWxhdGUgc2NhbGVfcG9zX3dlaWdodCBmb3IgaW1iYWxhbmNlZCBkYXRhc2V0DQpzY2FsZV9wb3Nfd2VpZ2h0IDwtIHN1bSh5ID09IDApIC8gc3VtKHkgPT0gMSkNCg0KIyBWYWxpZGF0aW9uIHBoYXNlDQojY2F0KCJcblBoYXNlIDE6IFZhbGlkYXRpb24gUGhhc2VcbiIpDQpuX3ZhbGlkYXRpb25zIDwtIDMNCnZhbGlkYXRpb25fcmVzdWx0cyA8LSBtYXRyaXgobnJvdyA9IG5yb3cocmdyaWQpLCBuY29sID0gbl92YWxpZGF0aW9ucykNCg0KZm9yIChqIGluIDE6bnJvdyhyZ3JpZCkpIHsNCiAgI2NhdCgiXG5UZXN0aW5nIHBhcmFtZXRlciBzZXQiLCBqLCAib2YiLCBucm93KHJncmlkKSwgIlxuIikNCiAgDQogIGZvciAoaSBpbiAxOm5fdmFsaWRhdGlvbnMpIHsNCiAgICAjY2F0KCJcblZhbGlkYXRpb24gaXRlcmF0aW9uIiwgaSwgIm9mIiwgbl92YWxpZGF0aW9ucywgIlxuIikgICAgICAgICAgICAgDQogICAgIyBDcmVhdGUgdmFsaWRhdGlvbiBzcGxpdA0KICAgIGlkeCA8LSB1bmlxdWUoc2FtcGxlKG5yb3coeHMpLCBucm93KHhzKSwgVFJVRSkpDQogICAgdHJhaW5feCA8LSB4c1tpZHgsIF0NCiAgICB0cmFpbl95IDwtIHlbaWR4XQ0KICAgIHZhbF94IDwtIHhzWy1pZHgsIF0NCiAgICB2YWxfeSA8LSB5Wy1pZHhdDQogICAgDQogICAgcHJtIDwtIGxpc3QoDQogICAgICBib29zdGVyID0gImdidHJlZSIsDQogICAgICBvYmplY3RpdmUgPSAiYmluYXJ5OmxvZ2lzdGljIiwNCiAgICAgIG1heF9kZXB0aCA9IHJncmlkW2osICJtYXhfZGVwdGgiXSwNCiAgICAgIGV0YSA9IHJncmlkW2osICJldGEiXSwNCiAgICAgIHN1YnNhbXBsZSA9IHJncmlkW2osICJzdWJzYW1wbGUiXSwNCiAgICAgIGNvbHNhbXBsZV9ieXRyZWUgPSByZ3JpZFtqLCAiY29sc2FtcGxlX2J5dHJlZSJdLA0KICAgICAgZ2FtbWEgPSByZ3JpZFtqLCAiZ2FtbWEiXSwNCiAgICAgIG1pbl9jaGlsZF93ZWlnaHQgPSByZ3JpZFtqLCAibWluX2NoaWxkX3dlaWdodCJdLA0KICAgICAgYWxwaGEgPSByZ3JpZFtqLCAiYWxwaGEiXSwNCiAgICAgIGxhbWJkYSA9IHJncmlkW2osICJsYW1iZGEiXSwNCiAgICAgIHNjYWxlX3Bvc193ZWlnaHQgPSBzY2FsZV9wb3Nfd2VpZ2h0LA0KICAgICAgbnRocmVhZCA9IG5jDQogICAgKQ0KICAgIA0KICAgIGRtX3RyYWluIDwtIHhnYi5ETWF0cml4KGRhdGEgPSB0cmFpbl94LCBsYWJlbCA9IHRyYWluX3kpDQogICAgbWRsIDwtIHhnYi50cmFpbigNCiAgICAgIHBhcmFtcyA9IHBybSwNCiAgICAgIGRhdGEgPSBkbV90cmFpbiwNCiAgICAgIG5yb3VuZHMgPSByZ3JpZFtqLCAibnJvdW5kcyJdLA0KICAgICAgdmVyYm9zZSA9IEZBTFNFDQogICAgKQ0KICAgIA0KICAgIHAgPC0gcHJlZGljdChtZGwsIHhnYi5ETWF0cml4KGRhdGEgPSB2YWxfeCkpDQogICAgcHJlZCA8LSBwcmVkaWN0aW9uKHAsIHZhbF95KQ0KICAgIHZhbGlkYXRpb25fcmVzdWx0c1tqLCBpXSA8LSBwZXJmb3JtYW5jZShwcmVkLCAiYXVjIilAeS52YWx1ZXNbWzFdXQ0KICB9DQp9DQoNCiMgUnVuIDEwMCB0ZXN0cyB3aXRoIGJlc3QgcGFyYW1ldGVycw0KY2F0KCJcblJ1bm5pbmcgWCB0ZXN0IGl0ZXJhdGlvbnMgd2l0aCBiZXN0IHBhcmFtZXRlcnMuLi5cbiIpDQp0ZXN0X2F1Y3MgPC0gYygpDQoNCmJlc3RfcGFyYW1zX2lkeCA8LSB3aGljaC5tYXgocm93TWVhbnModmFsaWRhdGlvbl9yZXN1bHRzKSkNCmJlc3RfcGFyYW1zIDwtIHJncmlkW2Jlc3RfcGFyYW1zX2lkeCxdDQoNCiMgVHJhaW4gZmluYWwgbW9kZWwgd2l0aCBiZXN0IHBhcmFtZXRlcnMNCmJlc3RfcGFyYW1zX2xpc3QgPC0gYXMubGlzdChiZXN0X3BhcmFtc1std2hpY2gobmFtZXMoYmVzdF9wYXJhbXMpID09ICJucm91bmRzIildKQ0KYmVzdF9wYXJhbXNfbGlzdCRib29zdGVyIDwtICJnYnRyZWUiDQpiZXN0X3BhcmFtc19saXN0JG9iamVjdGl2ZSA8LSAiYmluYXJ5OmxvZ2lzdGljIg0KYmVzdF9wYXJhbXNfbGlzdCRzY2FsZV9wb3Nfd2VpZ2h0IDwtIHNjYWxlX3Bvc193ZWlnaHQNCmJlc3RfcGFyYW1zX2xpc3QkbnRocmVhZCA8LSBuYw0KDQpmb3IoaSBpbiAxOjIwKSB7DQogICMgQ3JlYXRlIHRlc3Qgc3BsaXQNCiAgaWR4IDwtIHVuaXF1ZShzYW1wbGUobnJvdyh4cyksIG5yb3coeHMpLCBUKSkNCiAgdHJhaW5feCA8LSB4c1tpZHgsIF0NCiAgdHJhaW5feSA8LSB5W2lkeF0NCiAgdGVzdF94IDwtIHhzWy1pZHgsIF0NCiAgdGVzdF95IDwtIHlbLWlkeF0NCiAgDQogICMgVHJhaW4gbW9kZWwgb24gZnVsbCB1bmJhbGFuY2VkIGRhdGFzZXQNCiAgZG1fdHJhaW4gPC0geGdiLkRNYXRyaXgoZGF0YSA9IHRyYWluX3gsIGxhYmVsID0gdHJhaW5feSkNCiAgbWRsIDwtIHhnYi50cmFpbigNCiAgICBwYXJhbXMgPSBiZXN0X3BhcmFtc19saXN0LA0KICAgIGRhdGEgPSBkbV90cmFpbiwNCiAgICBucm91bmRzID0gYmVzdF9wYXJhbXNbWyJucm91bmRzIl1dLA0KICAgIHZlcmJvc2UgPSBGQUxTRQ0KICApDQogIA0KICAjIFRlc3Qgb24gdW5iYWxhbmNlZCB0ZXN0IHNldA0KICBwIDwtIHByZWRpY3QobWRsLCB4Z2IuRE1hdHJpeChkYXRhID0gdGVzdF94KSkNCiAgcHJlZCA8LSBwcmVkaWN0aW9uKHAsIHRlc3RfeSkNCiAgdGVzdF9hdWNzW2ldIDwtIHBlcmZvcm1hbmNlKHByZWQsICJhdWMiKUB5LnZhbHVlc1tbMV1dDQp9DQojIFByaW50IHJlc3VsdHMNCmNhdCgiXG5UZXN0IFJlc3VsdHMgb3ZlciAxMDAgaXRlcmF0aW9uczpcbiIpDQpjYXQoIk1lYW4gQVVDOiIsIG1lYW4odGVzdF9hdWNzKSwgIlxuIikNCmNhdCgiU0QgQVVDOiIsIHNkKHRlc3RfYXVjcyksICJcbiIpDQpjYXQoIjk1JSBDSToiLCBtZWFuKHRlc3RfYXVjcykgLSAxLjk2ICogc2QodGVzdF9hdWNzKSwgDQogICAgInRvIiwgbWVhbih0ZXN0X2F1Y3MpICsgMS45NiAqIHNkKHRlc3RfYXVjcyksICJcbiIpDQoNCiMgUGxvdHRpbmcgQVVDIGRpc3RyaWJ1dGlvbg0KcGxvdCh0ZXN0X2F1Y3MsIGNvbD0icmVkIiwgcGNoPTIwLA0KICAgICBtYWluPSJBVUMgVGVzdCBEaXN0cmlidXRpb24iLA0KICAgICB4bGFiPSJJdGVyYXRpb24iLCB5bGFiPSJBVUMiKQ0KYWJsaW5lKGg9bWVhbih0ZXN0X2F1Y3MpLCBjb2w9ImJsdWUiLCBsd2Q9MiwgbHR5PTIpICAjIEFkZCB0aGlzIGxpbmUgdG8gc2hvdyBtZWFuDQphYmxpbmUoaD1tZWFuKHRlc3RfYXVjcykgLSAxLjk2ICogc2QodGVzdF9hdWNzKSwgY29sPSJncmVlbiIsIGx3ZD0yLCBsdHk9MykNCmFibGluZShoPW1lYW4odGVzdF9hdWNzKSArIDEuOTYgKiBzZCh0ZXN0X2F1Y3MpLCBjb2w9ImdyZWVuIiwgbHdkPTIsIGx0eT0zKQ0KbGVnZW5kKCJib3R0b21yaWdodCIsIA0KICAgICAgIGxlZ2VuZD1jKCJBVUMgVmFsdWVzIiwgIk1lYW4iLCAiOTUlIENJIEJvdW5kcyIpLA0KICAgICAgIGNvbD1jKCJyZWQiLCAiYmx1ZSIsICJncmVlbiIpLA0KICAgICAgIGx0eT1jKE5BLCAyLCAzKSwNCiAgICAgICBwY2g9YygyMCwgTkEsIE5BKSkNCg0KIyBOb3cgdHJhaW4gZmluYWwgbW9kZWwgb24gZnVsbCBkYXRhIGZvciB6IHNjb3Jlcw0KZG1fZnVsbCA8LSB4Z2IuRE1hdHJpeChkYXRhID0geHMsIGxhYmVsID0geSkNCmZpbmFsX21vZGVsIDwtIHhnYi50cmFpbigNCiAgcGFyYW1zID0gYmVzdF9wYXJhbXNfbGlzdCwNCiAgZGF0YSA9IGRtX2Z1bGwsDQogIG5yb3VuZHMgPSBiZXN0X3BhcmFtc1tbIm5yb3VuZHMiXV0sDQogIHZlcmJvc2UgPSBGQUxTRQ0KKQ0KDQojIEdldCBwcm9iYWJpbGl0eSBwcmVkaWN0aW9ucyAoeikgZm9yIEFMTCBkYXRhDQp6IDwtIHByZWRpY3QoZmluYWxfbW9kZWwsIHhnYi5ETWF0cml4KGRhdGEgPSB4cykpDQpgYGANCg0KDQpgYGB7cn0NCiMgQ2FsY3VsYXRlIHJlc2lkdWFscyBmb3IgWEdCb29zdCBwcmVkaWN0aW9ucw0KeSA8LSBhcy5udW1lcmljKGFzLmNoYXJhY3RlcihzZWxlY3RfZGF0YSRhdHRlbXB0KSkNCnJlc2lkdWFscyA8LSB5IC0geg0KDQojIEhpc3RvZ3JhbSBvZiByZXNpZHVhbHMNCmhpc3QocmVzaWR1YWxzLCBtYWluPSJEaXN0cmlidXRpb24gb2YgWEdCb29zdCBNb2RlbCBSZXNpZHVhbHMiLCB4bGFiPSJSZXNpZHVhbCIsIGJyZWFrcz0xMDApDQpgYGANCg0KYGBge3J9DQojIHBsb3Qgb3V0IHRoZSB6IHZhbHVlc1wNCnBsb3QoZGVuc2l0eSh6KSwgDQogICAgIG1haW4gPSAiRGVuc2l0eSBvZiBaIFByZWRpY3Rpb25zIiwNCiAgICAgeGxhYiA9ICJQcmVkaWN0ZWQgUHJvYmFiaWxpdHkgb2YgQXR0ZW1wdCIsDQogICAgIHlsYWIgPSAiRGVuc2l0eSIpDQpgYGANCg0KYGBge3J9DQojIENhbGN1bGF0ZSBHSU1SIChsYW1iZGEpIFRoaXMgaXMgR2VuZXJhbGl6ZWQgaW52ZXJzZSBtaWxscyByYXRpbw0KR0lNUiA8LSBkbm9ybShxbm9ybSh6KSkgLyAoMSAtIHBub3JtKHFub3JtKHopKSkNCg0KIyBBZGQgR0lNUiB0byB0aGUgZGF0YQ0Kc2VsZWN0X2RhdGFbLCBHSU1SIDo9IEdJTVJdDQoNCiMgUHJpbnQgdmFyaWFibGUgaW1wb3J0YQ0KYGBgDQoNCmBgYHtyfQ0KIyBDcmVhdGUgYSBkYXRhLnRhYmxlIHdpdGgganVzdCBteV9pZCBhbmQgR0lNUiBmcm9tIHNlbGVjdF9kYXRhDQpHSU1SX2R0IDwtIGRhdGEudGFibGUobXlfaWQgPSBzZWxlY3RfZGF0YSRteV9pZCwgR0lNUiA9IEdJTVIpDQoNCiMgQWRkIEdJTVIgdG8gb3V0Y29tZV9kYXRhIGJ5IG1hdGNoaW5nIG9uIG15X2lkDQpvdXRjb21lX2RhdGFbR0lNUl9kdCwgR0lNUiA6PSBpLkdJTVIsIG9uID0gIm15X2lkIl0NCmBgYA0KDQpgYGB7cn0NCiMgIyBFeGlzdGluZyBjb2RlDQojIG91dGNvbWVfZGF0YSA8LSBvdXRjb21lX2RhdGFbLCBteV9pZCA6PSBOVUxMXQ0KIyBvdXRjb21lX2RhdGFbLCB5YXJkbGluZV8zMV80MCA6PSBOVUxMXQ0KIyBvdXRjb21lX2RhdGFbLCB5ZWFyMjAyMl90ZWFtX0NMRSA6PSBOVUxMXSAjIHRpZWQgZm9yIG1vc3QgYXR0ZW1wdHMgd2l0aCAzMQ0KDQojIFJlbW92ZSBhbGwgY29sdW1ucyB3aXRoICJfcHJlc2VudCIgaW4gdGhlIG5hbWUNCnByZXNlbnRfY29scyA8LSBncmVwKCJfcHJlc2VudCIsIG5hbWVzKG91dGNvbWVfZGF0YSksIHZhbHVlID0gVFJVRSkNCmZvciAoY29sIGluIHByZXNlbnRfY29scykgew0KICBvdXRjb21lX2RhdGFbLCAoY29sKSA6PSBOVUxMXQ0KfQ0KYGBgDQoNCg0KYGBge3J9DQoNCiMgQ3JlYXRlIGNvcGllcyBvZiBvdXRjb21lX2RhdGEgZm9yIGRpZmZlcmVudCBtb2RlbHMNCm91dGNvbWVfZGF0YV9wbGF5ZXIgPC0gY29weShvdXRjb21lX2RhdGEpDQpvdXRjb21lX2RhdGFfc3RhcnRlciA8LSBjb3B5KG91dGNvbWVfZGF0YSkNCg0KIyBSZW1vdmUgc3BlY2lmaWMgY29sdW1ucyBhcyBpbiBvcmlnaW5hbCBjb2RlDQpmb3IgKGR0IGluIGxpc3Qob3V0Y29tZV9kYXRhX3BsYXllciwgb3V0Y29tZV9kYXRhX3N0YXJ0ZXIpKSB7DQogIGR0WywgbXlfaWQgOj0gTlVMTF0NCiAgZHRbLCB5YXJkbGluZV8zMV80MCA6PSBOVUxMXQ0KICBkdFssIHllYXIyMDIyX3RlYW1fQ0xFIDo9IE5VTExdICMgdGllZCBmb3IgbW9zdCBhdHRlbXB0cyB3aXRoIDMxDQogIA0KICAjIFJlbW92ZSBhdHRlbmRhbmNlIHZhcmlhYmxlcw0KICBkdFssIGF0dGVuZGFuY2VfcGN0IDo9IE5VTExdDQogIGR0WywgYXR0ZW5kYW5jZV9yYXcgOj0gTlVMTF0NCiAgZHRbLCB2ZWdhc193cF9wb3N0ZWFtIDo9IE5VTExdDQp9DQoNCiMgRm9yIHBsYXllciBtb2RlbHMsIHJlbW92ZSBzdGFydGVyIGNvbHVtbnMNCnBsYXllcl9jb2xzIDwtIGdyZXAoIl5zdGFydGVyXyIsIG5hbWVzKG91dGNvbWVfZGF0YV9wbGF5ZXIpLCB2YWx1ZSA9IFRSVUUpDQpmb3IgKGNvbCBpbiBwbGF5ZXJfY29scykgew0KICBvdXRjb21lX2RhdGFfcGxheWVyWywgKGNvbCkgOj0gTlVMTF0NCn0NCg0KIyBGb3Igc3RhcnRlciBtb2RlbHMsIHJlbW92ZSBwbGF5ZXIgY29sdW1ucw0Kc3RhcnRlcl9jb2xzIDwtIGdyZXAoIl4ob2ZmZW5zZXxkZWZlbnNlKV9wbGF5ZXJfIiwgbmFtZXMob3V0Y29tZV9kYXRhX3N0YXJ0ZXIpLCB2YWx1ZSA9IFRSVUUpDQpmb3IgKGNvbCBpbiBzdGFydGVyX2NvbHMpIHsNCiAgb3V0Y29tZV9kYXRhX3N0YXJ0ZXJbLCAoY29sKSA6PSBOVUxMXQ0KfQ0KDQojIEVuc3VyZSBjb252ZXJzaW9uIGlzIG51bWVyaWMNCmZvciAoZHQgaW4gbGlzdChvdXRjb21lX2RhdGFfcGxheWVyLCBvdXRjb21lX2RhdGFfc3RhcnRlcikpIHsNCiAgZHRbLCBjb252ZXJzaW9uIDo9IGFzLm51bWVyaWMoYXMuY2hhcmFjdGVyKGNvbnZlcnNpb24pKV0NCn0NCg0KIyBNT0RFTCAxOiBQbGF5ZXIgbW9kZWwgd2l0aCBHSU1SDQpvbHNfbW9kZWxfcGxheWVyIDwtIGxtKGNvbnZlcnNpb24gfiAuLCBkYXRhID0gb3V0Y29tZV9kYXRhX3BsYXllcikNCg0KIyBNT0RFTCAyOiBTdGFydGVyIG1vZGVsIHdpdGggR0lNUg0Kb2xzX21vZGVsX3N0YXJ0ZXIgPC0gbG0oY29udmVyc2lvbiB+IC4sIGRhdGEgPSBvdXRjb21lX2RhdGFfc3RhcnRlcikNCg0KIyBGdW5jdGlvbiB0byBhbmFseXplIGFuZCBwcmludCBtb2RlbCByZXN1bHRzDQphbmFseXplX21vZGVsIDwtIGZ1bmN0aW9uKG1vZGVsLCBtb2RlbF9uYW1lKSB7DQogIGxpYnJhcnkoc2FuZHdpY2gpDQogIGxpYnJhcnkobG10ZXN0KQ0KICANCiAgIyBHZXQgSEMwLWFkanVzdGVkIHQtdmFsdWVzIGFuZCBwLXZhbHVlcw0KICByb2J1c3RfdGVzdCA8LSBjb2VmdGVzdChtb2RlbCwgdmNvdiA9IHZjb3ZIQyhtb2RlbCwgdHlwZSA9ICJIQzAiKSkNCiAgdF9zdGF0cyA8LSByb2J1c3RfdGVzdFssICJ0IHZhbHVlIl0NCiAgcF92YWx1ZXMgPC0gcm9idXN0X3Rlc3RbLCAiUHIoPnx0fCkiXQ0KICANCiAgIyBGdW5jdGlvbiB0byBhZGQgc2lnbmlmaWNhbmNlIHN0YXJzDQogIGdldF9zdGFycyA8LSBmdW5jdGlvbihwKSB7DQogICAgaWYgKHAgPD0gMC4wMSkgcmV0dXJuKCIqKioiKQ0KICAgIGlmIChwIDw9IDAuMDUpIHJldHVybigiKioiKQ0KICAgIGlmIChwIDw9IDAuMSkgcmV0dXJuKCIqIikNCiAgICBpZiAocCA8PSAwLjE1KSByZXR1cm4oIi4iKQ0KICAgIHJldHVybigiIikNCiAgfQ0KICANCiAgIyBNYXhpbXVtIHdpZHRoIGZvciB2YXJpYWJsZSBuYW1lcw0KICBuYW1lX3dpZHRoIDwtIDYwDQogIA0KICAjIFByaW50IG1vZGVsIG5hbWUgYW5kIGhlYWRlcg0KICBjYXQoIlxuXG4iLCBwYXN0ZShyZXAoIj0iLCA4MCksIGNvbGxhcHNlPSIiKSwgIlxuIikNCiAgY2F0KCJNT0RFTDoiLCBtb2RlbF9uYW1lLCAiXG4iKQ0KICBjYXQocGFzdGUocmVwKCI9IiwgODApLCBjb2xsYXBzZT0iIiksICJcblxuIikNCiAgDQogICMgUHJpbnQgaGVhZGVyIHdpdGggYWxpZ25tZW50DQogIGNhdChzcHJpbnRmKCIlLSpzICAlMTBzICAlMTBzICAlNHNcbiIsIG5hbWVfd2lkdGgsICJWYXJpYWJsZSIsICJ0LXZhbHVlIiwgInAtdmFsdWUiLCAic2lnIikpDQogIGNhdChzcHJpbnRmKCIlLSpzICAlMTBzICAlMTBzICAlNHNcbiIsIG5hbWVfd2lkdGgsICItLS0tLS0tLS0iLCAiLS0tLS0tLSIsICItLS0tLS0tIiwgIi0tLS0iKSkNCiAgDQogICMgTG9vcCB0aHJvdWdoIGFuZCBwcmludCB2YWx1ZXMNCiAgZm9yIChpIGluIDE6bGVuZ3RoKHRfc3RhdHMpKSB7DQogICAgdmFyX25hbWUgPC0gcm93bmFtZXMocm9idXN0X3Rlc3QpW2ldDQogICAgIyBUcnVuY2F0ZSBuYW1lIGlmIHRvbyBsb25nDQogICAgaWYgKG5jaGFyKHZhcl9uYW1lKSA+IG5hbWVfd2lkdGgpIHsNCiAgICAgIHZhcl9uYW1lIDwtIHBhc3RlMChzdWJzdHIodmFyX25hbWUsIDEsIG5hbWVfd2lkdGgtMyksICIuLi4iKQ0KICAgIH0NCiAgICBjYXQoc3ByaW50ZigiJS0qcyAgJTEwLjRmICAlMTAuNGYgICU0c1xuIiwgDQogICAgICAgICAgICAgICAgbmFtZV93aWR0aCwgdmFyX25hbWUsIA0KICAgICAgICAgICAgICAgIHRfc3RhdHNbaV0sIHBfdmFsdWVzW2ldLA0KICAgICAgICAgICAgICAgIGdldF9zdGFycyhwX3ZhbHVlc1tpXSkpKQ0KICB9DQogIA0KICBjYXQoIlxuU2lnbmlmaWNhbmNlIGNvZGVzOiAwICcqKionIDAuMDEgJyoqJyAwLjA1ICcqJyAwLjEgJy4nIDAuMTVcbiIpDQogIA0KICAjIFByaW50IFItc3F1YXJlZA0KICByX3NxdWFyZWQgPC0gc3VtbWFyeShtb2RlbCkkYWRqLnIuc3F1YXJlZA0KICBjYXQoIlxuQWRqdXN0ZWQgUi1zcXVhcmVkOiIsIHJfc3F1YXJlZCwgIlxuIikNCiAgDQogICMgQ2FsY3VsYXRlIFZJRnMNCiAgbGlicmFyeShjYXIpDQogIHZpZnMgPC0gdmlmKG1vZGVsKQ0KICANCiAgIyBGaWx0ZXIgdG8gc2hvdyBvbmx5IFZJRnMgb3ZlciA1DQogIGhpZ2hfdmlmcyA8LSB2aWZzW3ZpZnMgPiA1XQ0KICBpZihsZW5ndGgoaGlnaF92aWZzKSA+IDApIHsNCiAgICBjYXQoIlxuVmFyaWFibGVzIHdpdGggVklGID4gNTpcbiIpDQogICAgcHJpbnQoaGlnaF92aWZzKQ0KICB9IGVsc2Ugew0KICAgIGNhdCgiXG5ObyB2YXJpYWJsZXMgd2l0aCBWSUYgPiA1IGZvdW5kIGluIHRoaXMgbW9kZWxcbiIpDQogIH0NCiAgDQogIHJldHVybihyX3NxdWFyZWQpDQp9DQoNCiMgQW5hbHl6ZSBtb2RlbHMgd2l0aCBHSU1SIG9ubHkNCnIyX3BsYXllciA8LSBhbmFseXplX21vZGVsKG9sc19tb2RlbF9wbGF5ZXIsICJQbGF5ZXIgTW9kZWwgd2l0aCBHSU1SIikNCnIyX3N0YXJ0ZXIgPC0gYW5hbHl6ZV9tb2RlbChvbHNfbW9kZWxfc3RhcnRlciwgIlN0YXJ0ZXIgTW9kZWwgd2l0aCBHSU1SIikNCg0KIyBDb21wYXJlIFItc3F1YXJlZCB2YWx1ZXMNCmNhdCgiXG5cbiIsIHBhc3RlKHJlcCgiPSIsIDgwKSwgY29sbGFwc2U9IiIpLCAiXG4iKQ0KY2F0KCJNT0RFTCBDT01QQVJJU09OIC0gQWRqdXN0ZWQgUi1zcXVhcmVkIHZhbHVlc1xuIikNCmNhdChwYXN0ZShyZXAoIj0iLCA4MCksIGNvbGxhcHNlPSIiKSwgIlxuXG4iKQ0KY2F0KCJQbGF5ZXIgTW9kZWwgd2l0aCBHSU1SOiIsIHIyX3BsYXllciwgIlxuIikNCmNhdCgiU3RhcnRlciBNb2RlbCB3aXRoIEdJTVI6IiwgcjJfc3RhcnRlciwgIlxuIikNCg0KYGBgDQoNCg==</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("heckman.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
