<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Third Down Analysis with Regular and Starter Players</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">4th Downs in the NFL</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="heckman.html">Heckman Selection</a>
</li>
<li>
  <a href="xgboost.html">XGBoost Prediction</a>
</li>
<li>
  <a href="attendance_binary.html">Attendance Impact Binary</a>
</li>
<li>
  <a href="thirddown.html">Third Down Analysis</a>
</li>
<li>
  <a href="attempt_ols.html">Attempts OLS</a>
</li>
<li>
  <a href="robustness_checks.html">Robustness Checks</a>
</li>
<li>
  <a href="Writing.html">Writing</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Third Down Analysis with Regular and
Starter Players</h1>

</div>


<pre class="r"><code>library(data.table)             
ctd1 &lt;- fread(&quot;predict_ctd1.csv.gz&quot;)                        </code></pre>
<pre class="r"><code>#kill my_id
ctd1$my_id &lt;- NULL
ctd1[, year2017_team_ARI := NULL]</code></pre>
<pre class="r"><code># Identify player columns
all_cols &lt;- colnames(ctd1)

# Create regex patterns to identify regular and starter player variables
offense_player_pattern &lt;- &quot;^offense_player_\\d+_&quot;
defense_player_pattern &lt;- &quot;^defense_player_\\d+_&quot;
starter_offense_pattern &lt;- &quot;^starter_offense_player_\\d+_&quot;
starter_defense_pattern &lt;- &quot;^starter_defense_player_\\d+_&quot;

# Get columns for each type
offense_player_cols &lt;- grep(offense_player_pattern, all_cols, value = TRUE)
defense_player_cols &lt;- grep(defense_player_pattern, all_cols, value = TRUE)
starter_offense_cols &lt;- grep(starter_offense_pattern, all_cols, value = TRUE)
starter_defense_cols &lt;- grep(starter_defense_pattern, all_cols, value = TRUE)

# All player columns
regular_player_cols &lt;- c(offense_player_cols, defense_player_cols)
starter_player_cols &lt;- c(starter_offense_cols, starter_defense_cols)
all_player_cols &lt;- c(regular_player_cols, starter_player_cols)

# Non-player columns (common to both datasets)
common_cols &lt;- setdiff(all_cols, all_player_cols)

# Create two datasets
regular_data &lt;- ctd1[, c(common_cols, regular_player_cols), with = FALSE]
starter_data &lt;- ctd1[, c(common_cols, starter_player_cols), with = FALSE]</code></pre>
<pre class="r"><code># Then run OLS with regular players
ols_regular &lt;- lm(conversion ~ ., data = regular_data)</code></pre>
<pre class="r"><code>library(sandwich)
library(lmtest)
# Get HC0-adjusted t-values and p-values
robust_regular_test &lt;- coeftest(ols_regular, vcov = vcovHC(ols_regular, type = &quot;HC0&quot;))
t_stats_regular &lt;- robust_regular_test[, &quot;t value&quot;]
p_values_regular &lt;- robust_regular_test[, &quot;Pr(&gt;|t|)&quot;]
# Function to add significance stars
get_stars &lt;- function(p) {
    if (p &lt;= 0.01) return(&quot;***&quot;)
    if (p &lt;= 0.05) return(&quot;**&quot;)
    if (p &lt;= 0.1) return(&quot;*&quot;)
    if (p &lt;= 0.15) return(&quot;.&quot;)
    return(&quot;&quot;)
}
# Maximum width for variable names
name_width &lt;- 60
# Print header with alignment
cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;Regular Players OLS Variable&quot;, &quot;t-value&quot;, &quot;p-value&quot;, &quot;sig&quot;))</code></pre>
<pre><code>## Regular Players OLS Variable                                     t-value     p-value   sig</code></pre>
<pre class="r"><code>cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;---------&quot;, &quot;-------&quot;, &quot;-------&quot;, &quot;----&quot;))</code></pre>
<pre><code>## ---------                                                        -------     -------  ----</code></pre>
<pre class="r"><code># Loop through and print values
for (i in 1:length(t_stats_regular)) {
    var_name &lt;- rownames(robust_regular_test)[i]
    # Truncate name if too long
    if (nchar(var_name) &gt; name_width) {
        var_name &lt;- paste0(substr(var_name, 1, name_width-3), &quot;...&quot;)
    }
    cat(sprintf(&quot;%-*s  %10.4f  %10.4f  %4s\n&quot;, 
                name_width, var_name, 
                t_stats_regular[i], p_values_regular[i],
                get_stars(p_values_regular[i])))
}</code></pre>
<pre><code>## (Intercept)                                                       6.5027      0.0000   ***
## ydstogo                                                         -70.6972      0.0000   ***
## yardline_100                                                      7.9932      0.0000   ***
## posteam_timeouts_remaining                                        2.5702      0.0102    **
## defteam_timeouts_remaining                                        4.7120      0.0000   ***
## rush_attempt                                                     16.1291      0.0000   ***
## week                                                             -2.4209      0.0155    **
## temp                                                              0.2228      0.8237      
## wind                                                             -1.0125      0.3113      
## vegas_wp                                                         -1.5238      0.1276     .
## total_line                                                        1.5628      0.1181     .
## p_player_26_punting_grades_grades_punter_12w                     -0.7720      0.4401      
## p_player_26_punting_grades_grades_punter_2w                      -1.3562      0.1750      
## k_player_25_field_goals_grades_grades_fgep_kicker_12w             2.1943      0.0282    **
## k_player_25_field_goals_grades_grades_fgep_kicker_2w              1.2009      0.2298      
## score_diff                                                       -2.4982      0.0125    **
## down4_pct                                                        -0.4358      0.6630      
## prep_days                                                        -1.3327      0.1826      
## overall_win_pct                                                   2.0900      0.0366    **
## team_win_pct                                                      5.4765      0.0000   ***
## prev_win_pct                                                      1.0929      0.2744      
## prev_shotgun_rate                                                -0.5650      0.5721      
## prev_singleback_rate                                             -0.9967      0.3189      
## prev_empty_rate                                                  -0.2753      0.7831      
## prev_iform_rate                                                  -0.0242      0.9807      
## prev_shotgun_success                                              1.4631      0.1435     .
## prev_singleback_success                                           0.0758      0.9396      
## prev_empty_success                                                0.0615      0.9510      
## prev_iform_success                                               -0.4354      0.6633      
## prev_stop_rate_run                                                0.1794      0.8577      
## prev_stop_rate_pass                                              -2.1972      0.0280    **
## shotgun_rate                                                      1.3028      0.1926      
## singleback_rate                                                   0.3466      0.7289      
## empty_rate                                                        1.0138      0.3107      
## iform_rate                                                        0.5594      0.5759      
## shotgun_success                                                  -3.1096      0.0019   ***
## singleback_success                                                0.9802      0.3270      
## empty_success                                                    -0.5354      0.5924      
## iform_success                                                    -0.7464      0.4554      
## def_stop_rate_run                                                -0.8856      0.3758      
## def_stop_rate_pass                                               -0.1595      0.8732      
## avg_pass_rushers                                                 -0.8356      0.4034      
## avg_box_defenders                                                 0.2044      0.8381      
## cover0_rate                                                      -3.5174      0.0004   ***
## cover1_rate                                                      -1.3124      0.1894      
## cover2_rate                                                      -1.4372      0.1507      
## cover3_rate                                                      -1.8683      0.0617     *
## cover4_rate                                                      -2.1885      0.0286    **
## cover6_rate                                                      -1.2931      0.1960      
## two_man_rate                                                     -0.1196      0.9048      
## prevent_rate                                                     -0.4672      0.6403      
## home_attendance                                                  -1.4526      0.1463     .
## roof_outdoors                                                    -0.6908      0.4897      
## posteam_type_home                                                 4.2102      0.0000   ***
## offense_formation_EMPTY                                          -0.1399      0.8888      
## offense_formation_SHOTGUN                                        -0.6653      0.5058      
## offense_formation_SINGLEBACK                                     -0.0342      0.9727      
## offense_formation_I_FORM                                          0.6542      0.5130      
## year2017_team_BUF                                                -0.0555      0.9557      
## year2017_team_CHI                                                -0.2222      0.8241      
## year2017_team_CLE                                                 0.7284      0.4664      
## year2017_team_DAL                                                -0.0318      0.9746      
## year2017_team_DET                                                 0.0521      0.9585      
## year2017_team_GB                                                 -0.0715      0.9430      
## year2017_team_HOU                                                -0.6792      0.4970      
## year2017_team_MIA                                                 0.3893      0.6971      
## year2017_team_MIN                                                -1.1878      0.2349      
## year2017_team_NE                                                 -0.4644      0.6424      
## year2017_team_NYJ                                                -0.1683      0.8663      
## year2017_team_PHI                                                 0.0791      0.9370      
## year2017_team_SF                                                 -0.3097      0.7568      
## year2017_team_TEN                                                -0.4614      0.6445      
## year2017_team_WAS                                                -1.0848      0.2780      
## year2017_team_ATL                                                -0.8161      0.4144      
## year2017_team_BAL                                                -0.3916      0.6953      
## year2017_team_CIN                                                -0.2322      0.8164      
## year2017_team_DEN                                                -0.2799      0.7796      
## year2017_team_KC                                                  0.4673      0.6403      
## year2017_team_LA                                                  0.3431      0.7315      
## year2017_team_NO                                                  0.0345      0.9725      
## year2017_team_NYG                                                -1.0906      0.2754      
## year2017_team_OAK                                                -0.8560      0.3920      
## year2017_team_PIT                                                -0.8689      0.3849      
## year2017_team_SEA                                                -0.0488      0.9611      
## year2017_team_TB                                                  1.8053      0.0710     *
## year2017_team_CAR                                                -0.6884      0.4912      
## year2017_team_IND                                                 0.1067      0.9150      
## year2017_team_JAX                                                -0.7225      0.4700      
## year2017_team_LAC                                                -0.4081      0.6832      
## year2018_team_ARI                                                 0.8745      0.3818      
## year2018_team_BAL                                                 0.8471      0.3970      
## year2018_team_CAR                                                 1.6887      0.0913     *
## year2018_team_CLE                                                 0.4311      0.6664      
## year2018_team_DET                                                 0.6599      0.5094      
## year2018_team_HOU                                                 1.8105      0.0702     *
## year2018_team_IND                                                 1.2831      0.1995      
## year2018_team_KC                                                  1.5129      0.1303     .
## year2018_team_LAC                                                 1.4054      0.1599      
## year2018_team_MIA                                                 1.1480      0.2510      
## year2018_team_MIN                                                 0.1237      0.9016      
## year2018_team_NE                                                  0.8108      0.4175      
## year2018_team_NYG                                                 1.6607      0.0968     *
## year2018_team_OAK                                                 1.9423      0.0521     *
## year2018_team_PHI                                                 1.5076      0.1317     .
## year2018_team_SEA                                                 1.5510      0.1209     .
## year2018_team_BUF                                                 0.3452      0.7300      
## year2018_team_CHI                                                 0.6622      0.5079      
## year2018_team_CIN                                                 2.1642      0.0305    **
## year2018_team_DAL                                                 1.3737      0.1696      
## year2018_team_DEN                                                 1.2770      0.2016      
## year2018_team_GB                                                  0.6257      0.5315      
## year2018_team_NO                                                  1.4379      0.1505      
## year2018_team_NYJ                                                 0.8407      0.4005      
## year2018_team_PIT                                                 1.7598      0.0785     *
## year2018_team_SF                                                  1.3503      0.1769      
## year2018_team_TEN                                                 1.5127      0.1304     .
## year2018_team_TB                                                  2.3372      0.0194    **
## year2018_team_ATL                                                 1.9249      0.0543     *
## year2018_team_JAX                                                 1.1762      0.2395      
## year2018_team_LA                                                  0.6731      0.5009      
## year2018_team_WAS                                                 2.3157      0.0206    **
## year2019_team_ARI                                                 1.6739      0.0942     *
## year2019_team_BUF                                                 1.1502      0.2501      
## year2019_team_CHI                                                 1.3933      0.1635      
## year2019_team_CLE                                                 1.3287      0.1840      
## year2019_team_DAL                                                 1.2764      0.2018      
## year2019_team_IND                                                 1.4944      0.1351     .
## year2019_team_JAX                                                 0.9887      0.3228      
## year2019_team_KC                                                  0.6898      0.4903      
## year2019_team_LAC                                                 2.0372      0.0416    **
## year2019_team_MIN                                                 2.3073      0.0210    **
## year2019_team_NE                                                  0.8794      0.3792      
## year2019_team_NO                                                  0.1045      0.9168      
## year2019_team_PHI                                                 2.0561      0.0398    **
## year2019_team_SEA                                                 1.1296      0.2587      
## year2019_team_SF                                                  1.6104      0.1073     .
## year2019_team_TB                                                  1.2469      0.2125      
## year2019_team_ATL                                                 2.2379      0.0252    **
## year2019_team_BAL                                                 1.6611      0.0967     *
## year2019_team_CAR                                                 0.9567      0.3387      
## year2019_team_CIN                                                 1.4212      0.1553      
## year2019_team_DEN                                                 0.4990      0.6178      
## year2019_team_DET                                                 0.8780      0.3799      
## year2019_team_HOU                                                 1.4940      0.1352     .
## year2019_team_LA                                                  0.5868      0.5574      
## year2019_team_MIA                                                 1.2763      0.2018      
## year2019_team_NYG                                                 1.5027      0.1329     .
## year2019_team_NYJ                                                 1.2814      0.2001      
## year2019_team_OAK                                                 1.2706      0.2039      
## year2019_team_PIT                                                 0.5938      0.5526      
## year2019_team_TEN                                                 0.8258      0.4090      
## year2019_team_WAS                                                 0.5939      0.5526      
## year2019_team_GB                                                  0.8805      0.3786      
## year2020_team_ATL                                                 1.2236      0.2211      
## year2020_team_BAL                                                 0.1175      0.9065      
## year2020_team_BUF                                                 1.9851      0.0471    **
## year2020_team_CAR                                                 2.5088      0.0121    **
## year2020_team_CIN                                                 0.3059      0.7597      
## year2020_team_DEN                                                 1.5490      0.1214     .
## year2020_team_DET                                                 1.5005      0.1335     .
## year2020_team_JAX                                                 1.4490      0.1474     .
## year2020_team_KC                                                  1.1948      0.2322      
## year2020_team_LA                                                  1.6431      0.1004     .
## year2020_team_MIN                                                 0.2729      0.7849      
## year2020_team_NE                                                  0.9455      0.3444      
## year2020_team_NO                                                  0.8271      0.4082      
## year2020_team_NYG                                                 0.6611      0.5086      
## year2020_team_SF                                                  0.6821      0.4952      
## year2020_team_WAS                                                 1.1800      0.2380      
## year2020_team_CHI                                                 0.0425      0.9661      
## year2020_team_DAL                                                 0.9223      0.3564      
## year2020_team_GB                                                  0.8285      0.4074      
## year2020_team_HOU                                                 1.7255      0.0844     *
## year2020_team_LV                                                  1.5636      0.1179     .
## year2020_team_MIA                                                 0.2023      0.8397      
## year2020_team_NYJ                                                 0.1881      0.8508      
## year2020_team_TB                                                  0.8065      0.4200      
## year2020_team_TEN                                                 1.2634      0.2065      
## year2020_team_ARI                                                 1.3277      0.1843      
## year2020_team_CLE                                                 1.5705      0.1163     .
## year2020_team_IND                                                 1.2642      0.2062      
## year2020_team_LAC                                                 1.0574      0.2904      
## year2020_team_PHI                                                 1.2017      0.2295      
## year2020_team_SEA                                                 1.0328      0.3017      
## year2020_team_PIT                                                 0.7970      0.4254      
## year2021_team_ATL                                                 1.6672      0.0955     *
## year2021_team_BUF                                                 0.9098      0.3629      
## year2021_team_CIN                                                 1.9783      0.0479    **
## year2021_team_DAL                                                 1.1802      0.2379      
## year2021_team_DEN                                                 1.1580      0.2469      
## year2021_team_DET                                                 1.0026      0.3161      
## year2021_team_HOU                                                 1.2821      0.1998      
## year2021_team_KC                                                  2.5100      0.0121    **
## year2021_team_LA                                                  0.1904      0.8490      
## year2021_team_LV                                                  0.7988      0.4244      
## year2021_team_MIN                                                 0.0795      0.9366      
## year2021_team_NE                                                  0.4401      0.6599      
## year2021_team_NO                                                  0.9622      0.3359      
## year2021_team_NYG                                                 1.4246      0.1543      
## year2021_team_SF                                                  2.1768      0.0295    **
## year2021_team_TEN                                                 0.6077      0.5434      
## year2021_team_ARI                                                 1.0939      0.2740      
## year2021_team_BAL                                                 0.1395      0.8890      
## year2021_team_CAR                                                 0.9787      0.3277      
## year2021_team_CHI                                                 1.1046      0.2693      
## year2021_team_GB                                                  1.1290      0.2589      
## year2021_team_IND                                                 1.0231      0.3063      
## year2021_team_LAC                                                 2.5043      0.0123    **
## year2021_team_MIA                                                 1.3975      0.1623      
## year2021_team_NYJ                                                 2.0271      0.0427    **
## year2021_team_PHI                                                 1.1366      0.2557      
## year2021_team_SEA                                                 0.9572      0.3385      
## year2021_team_TB                                                  2.5286      0.0115    **
## year2021_team_WAS                                                 1.8473      0.0647     *
## year2021_team_CLE                                                 0.7399      0.4594      
## year2021_team_JAX                                                 1.2713      0.2036      
## year2021_team_PIT                                                 1.2039      0.2286      
## year2022_team_ARI                                                 0.9373      0.3486      
## year2022_team_ATL                                                 1.9512      0.0510     *
## year2022_team_CAR                                                 0.6875      0.4918      
## year2022_team_CHI                                                 2.4307      0.0151    **
## year2022_team_CIN                                                 2.4115      0.0159    **
## year2022_team_HOU                                                 1.1338      0.2569      
## year2022_team_IND                                                 0.3007      0.7637      
## year2022_team_LAC                                                 0.9344      0.3501      
## year2022_team_MIA                                                 2.2165      0.0267    **
## year2022_team_MIN                                                 1.4600      0.1443     .
## year2022_team_NE                                                  1.5255      0.1271     .
## year2022_team_NYJ                                                 1.1226      0.2616      
## year2022_team_SEA                                                 1.2639      0.2063      
## year2022_team_TB                                                  0.3810      0.7032      
## year2022_team_TEN                                                 0.6255      0.5317      
## year2022_team_WAS                                                 0.9372      0.3487      
## year2022_team_BAL                                                 1.1131      0.2657      
## year2022_team_BUF                                                 1.5240      0.1275     .
## year2022_team_DAL                                                 0.5823      0.5604      
## year2022_team_DET                                                 0.3659      0.7144      
## year2022_team_GB                                                  0.8880      0.3746      
## year2022_team_JAX                                                 1.5916      0.1115     .
## year2022_team_KC                                                  2.8593      0.0042   ***
## year2022_team_LA                                                  0.9277      0.3536      
## year2022_team_LV                                                  1.4896      0.1363     .
## year2022_team_NO                                                  1.6376      0.1015     .
## year2022_team_PHI                                                 1.6440      0.1002     .
## year2022_team_PIT                                                 1.4597      0.1444     .
## year2022_team_SF                                                  1.4996      0.1337     .
## year2022_team_CLE                                                 0.8966      0.3699      
## year2022_team_DEN                                                -0.1030      0.9180      
## year2022_team_NYG                                                 1.1246      0.2608      
## year2023_team_BAL                                                 1.0201      0.3077      
## year2023_team_CHI                                                 2.6519      0.0080   ***
## year2023_team_CLE                                                 0.8127      0.4164      
## year2023_team_GB                                                  0.2865      0.7745      
## year2023_team_IND                                                 0.5357      0.5922      
## year2023_team_KC                                                  2.1441      0.0320    **
## year2023_team_LAC                                                 1.0754      0.2822      
## year2023_team_LV                                                  0.1791      0.8579      
## year2023_team_MIA                                                 1.7931      0.0730     *
## year2023_team_MIN                                                 1.5765      0.1149     .
## year2023_team_NO                                                  0.8806      0.3785      
## year2023_team_NYG                                                 1.3425      0.1794      
## year2023_team_NYJ                                                -0.1465      0.8836      
## year2023_team_SEA                                                 1.0397      0.2985      
## year2023_team_SF                                                  1.9217      0.0547     *
## year2023_team_WAS                                                 1.5617      0.1184     .
## year2023_team_ATL                                                 0.7911      0.4289      
## year2023_team_BUF                                                 2.6443      0.0082   ***
## year2023_team_CAR                                                 1.1043      0.2695      
## year2023_team_DAL                                                 1.9599      0.0500     *
## year2023_team_DEN                                                 0.4366      0.6624      
## year2023_team_HOU                                                 1.1665      0.2434      
## year2023_team_LA                                                  0.9254      0.3547      
## year2023_team_NE                                                  1.9223      0.0546     *
## year2023_team_PHI                                                 2.7765      0.0055   ***
## year2023_team_PIT                                                 0.8126      0.4165      
## year2023_team_TEN                                                 0.8093      0.4183      
## year2023_team_ARI                                                 2.0468      0.0407    **
## year2023_team_CIN                                                 1.1338      0.2569      
## year2023_team_DET                                                 1.2535      0.2100      
## year2023_team_TB                                                  1.2466      0.2125      
## year2023_team_JAX                                                 0.6294      0.5291      
## is_first_half                                                     3.9430      0.0001   ***
## time_in_half                                                     -1.6826      0.0925     *
## offense_player_1_passing_depth_short_grades_pass_12w              3.1220      0.0018   ***
## offense_player_4_rushing_grades_ypa_12w                           0.7538      0.4510      
## offense_player_8_receiving_depth_short_caught_percent_12w        -1.3812      0.1672      
## offense_player_9_receiving_depth_short_caught_percent_12w         1.5889      0.1121     .
## offense_player_10_receiving_depth_short_caught_percent_12w        0.4479      0.6542      
## offense_player_14_blocking_grades_grades_run_block_12w            0.5266      0.5985      
## offense_player_17_blocking_grades_grades_offense_12w              0.0245      0.9805      
## offense_player_18_blocking_grades_grades_offense_12w             -1.2296      0.2189      
## offense_player_19_blocking_grades_grades_offense_12w              1.6562      0.0977     *
## offense_player_20_blocking_grades_grades_offense_12w              0.8502      0.3952      
## offense_player_21_blocking_grades_grades_offense_12w              0.8401      0.4009      
## defense_player_1_run_defense_grades_run_stop_opp_12w              0.8305      0.4062      
## defense_player_2_run_defense_grades_run_stop_opp_12w             -0.2704      0.7868      
## defense_player_3_run_defense_grades_run_stop_opp_12w             -2.4799      0.0131    **
## defense_player_4_run_defense_grades_run_stop_opp_12w             -1.3117      0.1896      
## defense_player_9_run_defense_grades_run_stop_opp_12w             -0.1601      0.8728      
## defense_player_10_run_defense_grades_run_stop_opp_12w            -0.9376      0.3485      
## defense_player_11_run_defense_grades_run_stop_opp_12w             0.0888      0.9292      
## defense_player_12_run_defense_grades_run_stop_opp_12w            -1.1215      0.2621      
## defense_player_15_coverage_grades_grades_defense_12w             -2.5200      0.0117    **
## defense_player_16_coverage_grades_grades_defense_12w             -1.2187      0.2230      
## defense_player_17_coverage_grades_grades_defense_12w             -1.7191      0.0856     *
## defense_player_20_coverage_schemes_zone_grades_coverage_d...     -1.1497      0.2503      
## defense_player_21_coverage_schemes_zone_grades_coverage_d...     -0.6023      0.5470      
## defense_player_22_coverage_schemes_zone_grades_coverage_d...     -1.1294      0.2587</code></pre>
<pre class="r"><code>cat(&quot;\nSignificance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15&quot;)</code></pre>
<pre><code>## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</code></pre>
<pre class="r"><code># Load the car package which has the vif function
library(car)
# Calculate VIFs for the model with regular players
vifs_regular &lt;- vif(ols_regular)
# Filter to show only VIFs over 5
high_vifs_regular &lt;- vifs_regular[vifs_regular &gt; 5]
if(length(high_vifs_regular) &gt; 0) {
  cat(&quot;\nRegular Players: Variables with VIF &gt; 5:\n&quot;)
  print(high_vifs_regular)
} else {
  cat(&quot;\nNo variables with VIF &gt; 5 found in the Regular Players model\n&quot;)
}</code></pre>
<pre><code>## 
## Regular Players: Variables with VIF &gt; 5:
##                  vegas_wp         prev_shotgun_rate      prev_singleback_rate 
##                  5.588691                  9.894656                  6.109822 
##              shotgun_rate                empty_rate               cover1_rate 
##                 16.266307                 12.567915                  6.910911 
##               cover3_rate           home_attendance   offense_formation_EMPTY 
##                  7.324228                  7.915130                  6.704888 
## offense_formation_SHOTGUN 
##                  9.385279</code></pre>
<pre class="r"><code>library(caret)
# Create the model matrix for regular data (excluding the response variable)
X_regular &lt;- model.matrix(~ . - conversion - 1, data = regular_data)  # -1 removes intercept
# Find columns causing linear dependencies
lin_combos_regular &lt;- findLinearCombos(X_regular)
# Remove problematic columns from the dataset
if (!is.null(lin_combos_regular$remove)) {
  cols_to_remove &lt;- colnames(X_regular)[lin_combos_regular$remove]
  cat(&quot;Removed from regular data:&quot;, paste(cols_to_remove, collapse=&quot;, &quot;), &quot;\n&quot;)
  regular_data &lt;- regular_data[, (cols_to_remove) := NULL, with = FALSE]
}</code></pre>
<pre class="r"><code># Then run OLS with starter players
ols_starter &lt;- lm(conversion ~ ., data = starter_data)</code></pre>
<pre class="r"><code># Get HC0-adjusted t-values and p-values
robust_starter_test &lt;- coeftest(ols_starter, vcov = vcovHC(ols_starter, type = &quot;HC0&quot;))
t_stats_starter &lt;- robust_starter_test[, &quot;t value&quot;]
p_values_starter &lt;- robust_starter_test[, &quot;Pr(&gt;|t|)&quot;]

# Print header with alignment
cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;Starter Players OLS Variable&quot;, &quot;t-value&quot;, &quot;p-value&quot;, &quot;sig&quot;))</code></pre>
<pre><code>## Starter Players OLS Variable                                     t-value     p-value   sig</code></pre>
<pre class="r"><code>cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;---------&quot;, &quot;-------&quot;, &quot;-------&quot;, &quot;----&quot;))</code></pre>
<pre><code>## ---------                                                        -------     -------  ----</code></pre>
<pre class="r"><code># Loop through and print values
for (i in 1:length(t_stats_starter)) {
    var_name &lt;- rownames(robust_starter_test)[i]
    # Truncate name if too long
    if (nchar(var_name) &gt; name_width) {
        var_name &lt;- paste0(substr(var_name, 1, name_width-3), &quot;...&quot;)
    }
    cat(sprintf(&quot;%-*s  %10.4f  %10.4f  %4s\n&quot;, 
                name_width, var_name, 
                t_stats_starter[i], p_values_starter[i],
                get_stars(p_values_starter[i])))
}</code></pre>
<pre><code>## (Intercept)                                                       7.1075      0.0000   ***
## ydstogo                                                         -71.6787      0.0000   ***
## yardline_100                                                      7.9441      0.0000   ***
## posteam_timeouts_remaining                                        2.5061      0.0122    **
## defteam_timeouts_remaining                                        4.6856      0.0000   ***
## rush_attempt                                                     15.9680      0.0000   ***
## week                                                             -1.9288      0.0538     *
## temp                                                              0.2406      0.8099      
## wind                                                             -1.1554      0.2479      
## vegas_wp                                                         -0.8417      0.4000      
## total_line                                                        2.0264      0.0427    **
## p_player_26_punting_grades_grades_punter_12w                     -0.6120      0.5405      
## p_player_26_punting_grades_grades_punter_2w                      -1.4951      0.1349     .
## k_player_25_field_goals_grades_grades_fgep_kicker_12w             2.3534      0.0186    **
## k_player_25_field_goals_grades_grades_fgep_kicker_2w              1.0962      0.2730      
## score_diff                                                       -3.1431      0.0017   ***
## down4_pct                                                        -0.6263      0.5311      
## prep_days                                                        -0.6595      0.5096      
## overall_win_pct                                                   2.3721      0.0177    **
## team_win_pct                                                      5.4713      0.0000   ***
## prev_win_pct                                                      0.9538      0.3402      
## prev_shotgun_rate                                                -0.4244      0.6713      
## prev_singleback_rate                                             -0.8949      0.3708      
## prev_empty_rate                                                  -0.3210      0.7482      
## prev_iform_rate                                                  -0.1654      0.8687      
## prev_shotgun_success                                              1.5161      0.1295     .
## prev_singleback_success                                           0.0897      0.9285      
## prev_empty_success                                                0.1143      0.9090      
## prev_iform_success                                               -0.4206      0.6740      
## prev_stop_rate_run                                                0.6280      0.5300      
## prev_stop_rate_pass                                              -2.2092      0.0272    **
## shotgun_rate                                                      0.9402      0.3471      
## singleback_rate                                                   0.0849      0.9323      
## empty_rate                                                        0.7232      0.4696      
## iform_rate                                                        0.4952      0.6205      
## shotgun_success                                                  -2.8864      0.0039   ***
## singleback_success                                                1.2345      0.2170      
## empty_success                                                    -0.7072      0.4795      
## iform_success                                                    -0.9569      0.3386      
## def_stop_rate_run                                                -1.0104      0.3123      
## def_stop_rate_pass                                               -0.7029      0.4821      
## avg_pass_rushers                                                 -0.8144      0.4154      
## avg_box_defenders                                                -0.0927      0.9261      
## cover0_rate                                                      -3.1538      0.0016   ***
## cover1_rate                                                      -0.6182      0.5365      
## cover2_rate                                                      -1.2448      0.2132      
## cover3_rate                                                      -1.7471      0.0806     *
## cover4_rate                                                      -2.4082      0.0160    **
## cover6_rate                                                      -0.7764      0.4375      
## two_man_rate                                                      0.1870      0.8517      
## prevent_rate                                                     -0.5616      0.5744      
## home_attendance                                                  -1.4886      0.1366     .
## roof_outdoors                                                    -0.5884      0.5562      
## posteam_type_home                                                 3.9869      0.0001   ***
## offense_formation_EMPTY                                          -0.7232      0.4696      
## offense_formation_SHOTGUN                                        -1.2728      0.2031      
## offense_formation_SINGLEBACK                                     -0.7427      0.4577      
## offense_formation_I_FORM                                         -0.0883      0.9297      
## year2017_team_BUF                                                -0.2780      0.7810      
## year2017_team_CHI                                                -0.3266      0.7440      
## year2017_team_CLE                                                 0.5226      0.6012      
## year2017_team_DAL                                                -0.1886      0.8504      
## year2017_team_DET                                                -0.1582      0.8743      
## year2017_team_GB                                                 -0.0298      0.9763      
## year2017_team_HOU                                                -0.7904      0.4293      
## year2017_team_MIA                                                 0.4108      0.6812      
## year2017_team_MIN                                                -1.3714      0.1703      
## year2017_team_NE                                                 -0.4365      0.6625      
## year2017_team_NYJ                                                -0.1230      0.9021      
## year2017_team_PHI                                                -0.1421      0.8870      
## year2017_team_SF                                                 -0.2328      0.8159      
## year2017_team_TEN                                                -0.5642      0.5726      
## year2017_team_WAS                                                -1.1437      0.2528      
## year2017_team_ATL                                                -0.7424      0.4578      
## year2017_team_BAL                                                -0.2601      0.7948      
## year2017_team_CIN                                                -0.3390      0.7346      
## year2017_team_DEN                                                -0.4449      0.6564      
## year2017_team_KC                                                  0.4323      0.6655      
## year2017_team_LA                                                  0.4205      0.6741      
## year2017_team_NO                                                  0.1356      0.8922      
## year2017_team_NYG                                                -1.0771      0.2814      
## year2017_team_OAK                                                -0.9883      0.3230      
## year2017_team_PIT                                                -0.8092      0.4184      
## year2017_team_SEA                                                -0.2944      0.7684      
## year2017_team_TB                                                  1.9590      0.0501     *
## year2017_team_CAR                                                -0.7331      0.4635      
## year2017_team_IND                                                 0.0524      0.9582      
## year2017_team_JAX                                                -0.8100      0.4180      
## year2017_team_LAC                                                -0.4979      0.6186      
## year2018_team_ARI                                                 0.6249      0.5320      
## year2018_team_BAL                                                 0.6495      0.5161      
## year2018_team_CAR                                                 1.4063      0.1596      
## year2018_team_CLE                                                 0.0273      0.9782      
## year2018_team_DET                                                 0.3808      0.7033      
## year2018_team_HOU                                                 1.5563      0.1197     .
## year2018_team_IND                                                 0.9082      0.3638      
## year2018_team_KC                                                  1.1629      0.2449      
## year2018_team_LAC                                                 1.1895      0.2343      
## year2018_team_MIA                                                 0.8377      0.4022      
## year2018_team_MIN                                                -0.2742      0.7839      
## year2018_team_NE                                                  0.4758      0.6342      
## year2018_team_NYG                                                 1.6006      0.1095     .
## year2018_team_OAK                                                 1.3885      0.1650      
## year2018_team_PHI                                                 1.2535      0.2100      
## year2018_team_SEA                                                 1.2603      0.2076      
## year2018_team_BUF                                                 0.1090      0.9132      
## year2018_team_CHI                                                 0.2854      0.7753      
## year2018_team_CIN                                                 1.7308      0.0835     *
## year2018_team_DAL                                                 1.1246      0.2607      
## year2018_team_DEN                                                 1.1315      0.2578      
## year2018_team_GB                                                  0.2528      0.8004      
## year2018_team_NO                                                  1.1723      0.2411      
## year2018_team_NYJ                                                 0.3844      0.7007      
## year2018_team_PIT                                                 1.5547      0.1200     .
## year2018_team_SF                                                  1.2431      0.2138      
## year2018_team_TEN                                                 1.2939      0.1957      
## year2018_team_TB                                                  2.0639      0.0390    **
## year2018_team_ATL                                                 1.6912      0.0908     *
## year2018_team_JAX                                                 0.9321      0.3513      
## year2018_team_LA                                                  0.2219      0.8244      
## year2018_team_WAS                                                 2.2482      0.0246    **
## year2019_team_ARI                                                 1.6440      0.1002     .
## year2019_team_BUF                                                 0.9553      0.3394      
## year2019_team_CHI                                                 1.0277      0.3041      
## year2019_team_CLE                                                 1.1782      0.2387      
## year2019_team_DAL                                                 0.8980      0.3692      
## year2019_team_IND                                                 1.4326      0.1520      
## year2019_team_JAX                                                 0.8558      0.3921      
## year2019_team_KC                                                  0.1678      0.8667      
## year2019_team_LAC                                                 1.7268      0.0842     *
## year2019_team_MIN                                                 2.0470      0.0407    **
## year2019_team_NE                                                  0.6691      0.5034      
## year2019_team_NO                                                 -0.0870      0.9307      
## year2019_team_PHI                                                 1.8439      0.0652     *
## year2019_team_SEA                                                 0.9736      0.3303      
## year2019_team_SF                                                  1.5024      0.1330     .
## year2019_team_TB                                                  1.1845      0.2362      
## year2019_team_ATL                                                 2.1430      0.0321    **
## year2019_team_BAL                                                 1.4258      0.1539      
## year2019_team_CAR                                                 0.8789      0.3794      
## year2019_team_CIN                                                 1.2703      0.2040      
## year2019_team_DEN                                                 0.2729      0.7849      
## year2019_team_DET                                                 0.6541      0.5131      
## year2019_team_HOU                                                 1.3663      0.1718      
## year2019_team_LA                                                  0.4992      0.6176      
## year2019_team_MIA                                                 1.2914      0.1966      
## year2019_team_NYG                                                 1.5364      0.1245     .
## year2019_team_NYJ                                                 1.0830      0.2788      
## year2019_team_OAK                                                 1.0297      0.3031      
## year2019_team_PIT                                                 0.4660      0.6412      
## year2019_team_TEN                                                 0.6473      0.5175      
## year2019_team_WAS                                                 0.7785      0.4363      
## year2019_team_GB                                                  0.5582      0.5767      
## year2020_team_ATL                                                 0.9450      0.3446      
## year2020_team_BAL                                                -0.2368      0.8128      
## year2020_team_BUF                                                 1.7184      0.0857     *
## year2020_team_CAR                                                 2.4703      0.0135    **
## year2020_team_CIN                                                 0.1033      0.9177      
## year2020_team_DEN                                                 1.2770      0.2016      
## year2020_team_DET                                                 1.0945      0.2737      
## year2020_team_JAX                                                 1.2335      0.2174      
## year2020_team_KC                                                  0.8302      0.4064      
## year2020_team_LA                                                  1.4758      0.1400     .
## year2020_team_MIN                                                 0.1450      0.8847      
## year2020_team_NE                                                  0.7632      0.4453      
## year2020_team_NO                                                  0.6671      0.5047      
## year2020_team_NYG                                                 0.3063      0.7593      
## year2020_team_SF                                                  0.5790      0.5626      
## year2020_team_WAS                                                 0.8523      0.3941      
## year2020_team_CHI                                                -0.0293      0.9766      
## year2020_team_DAL                                                 0.7468      0.4552      
## year2020_team_GB                                                  0.5695      0.5690      
## year2020_team_HOU                                                 1.6200      0.1052     .
## year2020_team_LV                                                  1.2924      0.1962      
## year2020_team_MIA                                                -0.0449      0.9642      
## year2020_team_NYJ                                                 0.1427      0.8865      
## year2020_team_TB                                                  0.5503      0.5821      
## year2020_team_TEN                                                 1.1796      0.2382      
## year2020_team_ARI                                                 1.1832      0.2367      
## year2020_team_CLE                                                 1.3710      0.1704      
## year2020_team_IND                                                 1.0168      0.3093      
## year2020_team_LAC                                                 0.6901      0.4902      
## year2020_team_PHI                                                 0.9537      0.3403      
## year2020_team_SEA                                                 0.8520      0.3942      
## year2020_team_PIT                                                 0.6332      0.5266      
## year2021_team_ATL                                                 1.3369      0.1813      
## year2021_team_BUF                                                 0.5531      0.5802      
## year2021_team_CIN                                                 1.6732      0.0943     *
## year2021_team_DAL                                                 0.7607      0.4469      
## year2021_team_DEN                                                 0.8821      0.3777      
## year2021_team_DET                                                 0.9956      0.3194      
## year2021_team_HOU                                                 1.0284      0.3038      
## year2021_team_KC                                                  2.0951      0.0362    **
## year2021_team_LA                                                 -0.1153      0.9082      
## year2021_team_LV                                                  0.6035      0.5462      
## year2021_team_MIN                                                -0.3255      0.7448      
## year2021_team_NE                                                  0.1180      0.9060      
## year2021_team_NO                                                  0.6400      0.5222      
## year2021_team_NYG                                                 1.1687      0.2425      
## year2021_team_SF                                                  1.9681      0.0491    **
## year2021_team_TEN                                                 0.5030      0.6150      
## year2021_team_ARI                                                 0.8297      0.4067      
## year2021_team_BAL                                                -0.0181      0.9855      
## year2021_team_CAR                                                 0.7995      0.4240      
## year2021_team_CHI                                                 0.7834      0.4334      
## year2021_team_GB                                                  0.8483      0.3963      
## year2021_team_IND                                                 0.6965      0.4861      
## year2021_team_LAC                                                 2.3720      0.0177    **
## year2021_team_MIA                                                 0.9657      0.3342      
## year2021_team_NYJ                                                 1.6969      0.0897     *
## year2021_team_PHI                                                 0.8866      0.3753      
## year2021_team_SEA                                                 0.7264      0.4676      
## year2021_team_TB                                                  2.2977      0.0216    **
## year2021_team_WAS                                                 1.5449      0.1224     .
## year2021_team_CLE                                                 0.3247      0.7454      
## year2021_team_JAX                                                 0.9629      0.3356      
## year2021_team_PIT                                                 0.9777      0.3282      
## year2022_team_ARI                                                 0.8335      0.4046      
## year2022_team_ATL                                                 1.8332      0.0668     *
## year2022_team_CAR                                                 0.3666      0.7139      
## year2022_team_CHI                                                 2.3071      0.0211    **
## year2022_team_CIN                                                 2.1472      0.0318    **
## year2022_team_HOU                                                 0.8210      0.4117      
## year2022_team_IND                                                -0.0529      0.9578      
## year2022_team_LAC                                                 0.7819      0.4343      
## year2022_team_MIA                                                 1.9918      0.0464    **
## year2022_team_MIN                                                 1.2944      0.1956      
## year2022_team_NE                                                  1.1583      0.2467      
## year2022_team_NYJ                                                 0.5477      0.5839      
## year2022_team_SEA                                                 1.1465      0.2516      
## year2022_team_TB                                                  0.2109      0.8329      
## year2022_team_TEN                                                 0.4161      0.6774      
## year2022_team_WAS                                                 0.6450      0.5189      
## year2022_team_BAL                                                 0.8502      0.3952      
## year2022_team_BUF                                                 1.3127      0.1893      
## year2022_team_DAL                                                 0.2469      0.8050      
## year2022_team_DET                                                 0.0855      0.9319      
## year2022_team_GB                                                  0.9407      0.3469      
## year2022_team_JAX                                                 1.3606      0.1736      
## year2022_team_KC                                                  2.5742      0.0101    **
## year2022_team_LA                                                  0.6471      0.5176      
## year2022_team_LV                                                  1.1679      0.2429      
## year2022_team_NO                                                  1.4968      0.1345     .
## year2022_team_PHI                                                 1.3566      0.1749      
## year2022_team_PIT                                                 1.2631      0.2065      
## year2022_team_SF                                                  1.3982      0.1621      
## year2022_team_CLE                                                 0.5311      0.5954      
## year2022_team_DEN                                                -0.3737      0.7086      
## year2022_team_NYG                                                 1.0759      0.2820      
## year2023_team_BAL                                                 0.6317      0.5276      
## year2023_team_CHI                                                 2.4314      0.0150    **
## year2023_team_CLE                                                 0.5135      0.6076      
## year2023_team_GB                                                  0.1645      0.8694      
## year2023_team_IND                                                 0.2975      0.7661      
## year2023_team_KC                                                  1.9358      0.0529     *
## year2023_team_LAC                                                 0.6899      0.4902      
## year2023_team_LV                                                 -0.0442      0.9648      
## year2023_team_MIA                                                 1.4701      0.1415     .
## year2023_team_MIN                                                 1.6535      0.0982     *
## year2023_team_NO                                                  0.5630      0.5734      
## year2023_team_NYG                                                 1.5001      0.1336     .
## year2023_team_NYJ                                                -0.4691      0.6390      
## year2023_team_SEA                                                 0.8663      0.3863      
## year2023_team_SF                                                  1.6830      0.0924     *
## year2023_team_WAS                                                 1.4021      0.1609      
## year2023_team_ATL                                                 0.5228      0.6011      
## year2023_team_BUF                                                 2.3128      0.0207    **
## year2023_team_CAR                                                 1.2519      0.2106      
## year2023_team_DAL                                                 1.7209      0.0853     *
## year2023_team_DEN                                                 0.1255      0.9002      
## year2023_team_HOU                                                 1.0654      0.2867      
## year2023_team_LA                                                  1.0045      0.3151      
## year2023_team_NE                                                  1.7947      0.0727     *
## year2023_team_PHI                                                 2.5406      0.0111    **
## year2023_team_PIT                                                 0.5170      0.6052      
## year2023_team_TEN                                                 0.7212      0.4708      
## year2023_team_ARI                                                 2.0737      0.0381    **
## year2023_team_CIN                                                 0.8960      0.3703      
## year2023_team_DET                                                 1.1656      0.2438      
## year2023_team_TB                                                  1.1985      0.2307      
## year2023_team_JAX                                                 0.5085      0.6111      
## is_first_half                                                     4.0782      0.0000   ***
## time_in_half                                                     -1.6729      0.0944     *
## starter_offense_player_1_passing_depth_short_grades_pass_12w      0.3685      0.7125      
## starter_offense_player_4_rushing_grades_ypa_12w                  -0.0763      0.9392      
## starter_offense_player_8_receiving_depth_short_caught_per...     -0.6405      0.5218      
## starter_offense_player_9_receiving_depth_short_caught_per...     -2.1258      0.0335    **
## starter_offense_player_10_receiving_depth_short_caught_pe...     -0.5668      0.5709      
## starter_offense_player_14_blocking_grades_grades_run_bloc...     -0.6655      0.5058      
## starter_offense_player_15_blocking_grades_grades_run_bloc...     -0.1297      0.8968      
## starter_offense_player_17_blocking_grades_grades_offense_12w     -1.5537      0.1203     .
## starter_offense_player_18_blocking_grades_grades_offense_12w      1.1406      0.2541      
## starter_offense_player_19_blocking_grades_grades_offense_12w      1.6343      0.1022     .
## starter_offense_player_20_blocking_grades_grades_offense_12w      0.1393      0.8892      
## starter_offense_player_21_blocking_grades_grades_offense_12w      1.8860      0.0593     *
## starter_defense_player_1_run_defense_grades_run_stop_opp_12w     -0.0407      0.9676      
## starter_defense_player_2_run_defense_grades_run_stop_opp_12w     -0.9519      0.3411      
## starter_defense_player_3_run_defense_grades_run_stop_opp_12w      0.2711      0.7863      
## starter_defense_player_4_run_defense_grades_run_stop_opp_12w     -0.7055      0.4805      
## starter_defense_player_9_run_defense_grades_run_stop_opp_12w     -1.0730      0.2833      
## starter_defense_player_10_run_defense_grades_run_stop_opp...      0.2118      0.8323      
## starter_defense_player_11_run_defense_grades_run_stop_opp...      0.5065      0.6125      
## starter_defense_player_12_run_defense_grades_run_stop_opp...      1.3374      0.1811      
## starter_defense_player_15_coverage_grades_grades_defense_12w     -2.0765      0.0378    **
## starter_defense_player_16_coverage_grades_grades_defense_12w      0.9298      0.3525      
## starter_defense_player_17_coverage_grades_grades_defense_12w     -0.3774      0.7059      
## starter_defense_player_20_coverage_schemes_zone_grades_co...      0.8524      0.3940      
## starter_defense_player_21_coverage_schemes_zone_grades_co...     -0.2424      0.8085      
## starter_defense_player_22_coverage_schemes_zone_grades_co...      1.6210      0.1050     .</code></pre>
<pre class="r"><code>cat(&quot;\nSignificance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15&quot;)</code></pre>
<pre><code>## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</code></pre>
<pre class="r"><code># Calculate VIFs for the model with starter players
vifs_starter &lt;- vif(ols_starter)
# Filter to show only VIFs over 5
high_vifs_starter &lt;- vifs_starter[vifs_starter &gt; 5]
if(length(high_vifs_starter) &gt; 0) {
  cat(&quot;\nStarter Players: Variables with VIF &gt; 5:\n&quot;)
  print(high_vifs_starter)
} else {
  cat(&quot;\nNo variables with VIF &gt; 5 found in the Starter Players model\n&quot;)
}</code></pre>
<pre><code>## 
## Starter Players: Variables with VIF &gt; 5:
##                                                                    vegas_wp 
##                                                                    5.439128 
##                                                           prev_shotgun_rate 
##                                                                    9.872993 
##                                                        prev_singleback_rate 
##                                                                    6.068102 
##                                                                shotgun_rate 
##                                                                   16.271670 
##                                                                  empty_rate 
##                                                                   12.602567 
##                                                                 cover1_rate 
##                                                                    6.610242 
##                                                                 cover3_rate 
##                                                                    7.064365 
##                                                             home_attendance 
##                                                                    7.916115 
##                                                     offense_formation_EMPTY 
##                                                                    6.041856 
##                                                   offense_formation_SHOTGUN 
##                                                                    8.353228 
##                starter_offense_player_1_passing_depth_short_grades_pass_12w 
##                                                                    9.514230 
##              starter_offense_player_14_blocking_grades_grades_run_block_12w 
##                                                                    7.864857 
##              starter_offense_player_15_blocking_grades_grades_run_block_12w 
##                                                                    8.259962 
##                starter_offense_player_17_blocking_grades_grades_offense_12w 
##                                                                    9.907131 
##                starter_offense_player_18_blocking_grades_grades_offense_12w 
##                                                                   10.076647 
##                starter_offense_player_19_blocking_grades_grades_offense_12w 
##                                                                    9.208256 
##                starter_offense_player_20_blocking_grades_grades_offense_12w 
##                                                                    9.026909 
##                starter_offense_player_21_blocking_grades_grades_offense_12w 
##                                                                    8.263972 
##                starter_defense_player_15_coverage_grades_grades_defense_12w 
##                                                                   10.881755 
##                starter_defense_player_16_coverage_grades_grades_defense_12w 
##                                                                    7.105559 
## starter_defense_player_20_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                                   13.397047 
## starter_defense_player_21_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                                    5.280179</code></pre>
<pre class="r"><code># Create the model matrix for starter data (excluding the response variable)
X_starter &lt;- model.matrix(~ . - conversion - 1, data = starter_data)  # -1 removes intercept
# Find columns causing linear dependencies
lin_combos_starter &lt;- findLinearCombos(X_starter)
# Remove problematic columns from the dataset
if (!is.null(lin_combos_starter$remove)) {
  cols_to_remove &lt;- colnames(X_starter)[lin_combos_starter$remove]
  cat(&quot;Removed from starter data:&quot;, paste(cols_to_remove, collapse=&quot;, &quot;), &quot;\n&quot;)
  starter_data &lt;- starter_data[, (cols_to_remove) := NULL, with = FALSE]
}</code></pre>
<pre class="r"><code># Probit model with regular players
probit_regular &lt;- glm(conversion ~ ., data = regular_data, family = binomial(link = &quot;probit&quot;))</code></pre>
<pre class="r"><code># Get HC0-adjusted z-values and p-values for regular probit
robust_probit_regular &lt;- coeftest(probit_regular, vcov = vcovHC(probit_regular, type = &quot;HC0&quot;))
z_stats_regular &lt;- robust_probit_regular[, &quot;z value&quot;]
p_values_regular &lt;- robust_probit_regular[, &quot;Pr(&gt;|z|)&quot;]

# Print header (note &quot;z-value&quot; instead of &quot;t-value&quot;)
cat(sprintf(&quot;\n\n%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;Regular Players Probit Variable&quot;, &quot;z-value&quot;, &quot;p-value&quot;, &quot;sig&quot;))</code></pre>
<pre><code>## 
## 
## Regular Players Probit Variable                                  z-value     p-value   sig</code></pre>
<pre class="r"><code>cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;---------------&quot;, &quot;-------&quot;, &quot;-------&quot;, &quot;----&quot;))</code></pre>
<pre><code>## ---------------                                                  -------     -------  ----</code></pre>
<pre class="r"><code>for (i in 1:length(z_stats_regular)) {
    var_name &lt;- rownames(robust_probit_regular)[i]
    if (nchar(var_name) &gt; name_width) {
        var_name &lt;- paste0(substr(var_name, 1, name_width-3), &quot;...&quot;)
    }
    cat(sprintf(&quot;%-*s  %10.4f  %10.4f  %4s\n&quot;, 
                name_width, var_name, 
                z_stats_regular[i], p_values_regular[i],
                get_stars(p_values_regular[i])))
}</code></pre>
<pre><code>## (Intercept)                                                      -4.0800      0.0000   ***
## ydstogo                                                         -54.7737      0.0000   ***
## yardline_100                                                      7.9693      0.0000   ***
## posteam_timeouts_remaining                                        2.7579      0.0058   ***
## defteam_timeouts_remaining                                        4.0674      0.0000   ***
## rush_attempt                                                     13.9607      0.0000   ***
## week                                                             -2.3874      0.0170    **
## temp                                                              0.1902      0.8492      
## wind                                                             -1.0558      0.2910      
## vegas_wp                                                         -1.5031      0.1328     .
## total_line                                                        1.3958      0.1628      
## p_player_26_punting_grades_grades_punter_12w                     -0.7382      0.4604      
## p_player_26_punting_grades_grades_punter_2w                      -1.3706      0.1705      
## k_player_25_field_goals_grades_grades_fgep_kicker_12w             2.1653      0.0304    **
## k_player_25_field_goals_grades_grades_fgep_kicker_2w              1.2200      0.2225      
## score_diff                                                       -2.0725      0.0382    **
## down4_pct                                                        -0.2985      0.7654      
## prep_days                                                        -1.3249      0.1852      
## overall_win_pct                                                   2.0632      0.0391    **
## team_win_pct                                                      5.4909      0.0000   ***
## prev_win_pct                                                      0.9576      0.3383      
## prev_shotgun_rate                                                -0.7934      0.4276      
## prev_singleback_rate                                             -1.1528      0.2490      
## prev_empty_rate                                                  -0.4241      0.6715      
## prev_iform_rate                                                  -0.0758      0.9396      
## prev_shotgun_success                                              1.5848      0.1130     .
## prev_singleback_success                                          -0.1245      0.9009      
## prev_empty_success                                               -0.1078      0.9142      
## prev_iform_success                                               -0.2322      0.8164      
## prev_stop_rate_run                                                0.0726      0.9422      
## prev_stop_rate_pass                                              -2.2156      0.0267    **
## shotgun_rate                                                      1.2481      0.2120      
## singleback_rate                                                   0.3622      0.7172      
## empty_rate                                                        0.9550      0.3396      
## iform_rate                                                        0.5296      0.5964      
## shotgun_success                                                  -3.1832      0.0015   ***
## singleback_success                                                1.0890      0.2762      
## empty_success                                                    -0.6388      0.5229      
## iform_success                                                    -0.7870      0.4313      
## def_stop_rate_run                                                -0.7744      0.4387      
## def_stop_rate_pass                                               -0.2725      0.7852      
## avg_pass_rushers                                                 -0.6166      0.5375      
## avg_box_defenders                                                 0.2009      0.8407      
## cover0_rate                                                      -3.7709      0.0002   ***
## cover1_rate                                                      -1.4976      0.1342     .
## cover2_rate                                                      -1.3321      0.1828      
## cover3_rate                                                      -2.0632      0.0391    **
## cover4_rate                                                      -2.0944      0.0362    **
## cover6_rate                                                      -1.3417      0.1797      
## two_man_rate                                                     -0.1986      0.8425      
## prevent_rate                                                     -0.4155      0.6778      
## home_attendance                                                  -1.4045      0.1602      
## roof_outdoors                                                    -0.6718      0.5017      
## posteam_type_home                                                 3.9894      0.0001   ***
## offense_formation_EMPTY                                           0.5530      0.5802      
## offense_formation_SHOTGUN                                         0.1176      0.9064      
## offense_formation_SINGLEBACK                                     -0.1420      0.8871      
## offense_formation_I_FORM                                          0.5872      0.5571      
## year2017_team_BUF                                                -0.1063      0.9154      
## year2017_team_CHI                                                -0.2419      0.8089      
## year2017_team_CLE                                                 0.7134      0.4756      
## year2017_team_DAL                                                -0.1022      0.9186      
## year2017_team_DET                                                -0.0685      0.9454      
## year2017_team_GB                                                 -0.2547      0.7989      
## year2017_team_HOU                                                -0.7604      0.4470      
## year2017_team_MIA                                                 0.2424      0.8085      
## year2017_team_MIN                                                -1.2056      0.2280      
## year2017_team_NE                                                 -0.5460      0.5851      
## year2017_team_NYJ                                                -0.1786      0.8583      
## year2017_team_PHI                                                 0.0796      0.9365      
## year2017_team_SF                                                 -0.3894      0.6970      
## year2017_team_TEN                                                -0.5650      0.5721      
## year2017_team_WAS                                                -1.2087      0.2268      
## year2017_team_ATL                                                -1.0065      0.3142      
## year2017_team_BAL                                                -0.5180      0.6045      
## year2017_team_CIN                                                -0.4089      0.6826      
## year2017_team_DEN                                                -0.3291      0.7421      
## year2017_team_KC                                                  0.3688      0.7123      
## year2017_team_LA                                                  0.2768      0.7819      
## year2017_team_NO                                                 -0.1363      0.8916      
## year2017_team_NYG                                                -1.1272      0.2597      
## year2017_team_OAK                                                -0.9817      0.3263      
## year2017_team_PIT                                                -1.0331      0.3016      
## year2017_team_SEA                                                -0.1850      0.8533      
## year2017_team_TB                                                  1.6686      0.0952     *
## year2017_team_CAR                                                -0.7084      0.4787      
## year2017_team_IND                                                 0.0855      0.9319      
## year2017_team_JAX                                                -0.8596      0.3900      
## year2017_team_LAC                                                -0.5912      0.5544      
## year2018_team_ARI                                                 0.7805      0.4351      
## year2018_team_BAL                                                 0.8925      0.3721      
## year2018_team_CAR                                                 1.7709      0.0766     *
## year2018_team_CLE                                                 0.4629      0.6434      
## year2018_team_DET                                                 0.6657      0.5056      
## year2018_team_HOU                                                 1.8103      0.0702     *
## year2018_team_IND                                                 1.2704      0.2039      
## year2018_team_KC                                                  1.6120      0.1070     .
## year2018_team_LAC                                                 1.2971      0.1946      
## year2018_team_MIA                                                 1.1829      0.2368      
## year2018_team_MIN                                                 0.0332      0.9735      
## year2018_team_NE                                                  0.8021      0.4225      
## year2018_team_NYG                                                 1.6915      0.0907     *
## year2018_team_OAK                                                 1.9189      0.0550     *
## year2018_team_PHI                                                 1.4756      0.1400     .
## year2018_team_SEA                                                 1.6060      0.1083     .
## year2018_team_BUF                                                 0.3606      0.7184      
## year2018_team_CHI                                                 0.6754      0.4994      
## year2018_team_CIN                                                 2.1573      0.0310    **
## year2018_team_DAL                                                 1.3631      0.1728      
## year2018_team_DEN                                                 1.2989      0.1940      
## year2018_team_GB                                                  0.5927      0.5534      
## year2018_team_NO                                                  1.4715      0.1412     .
## year2018_team_NYJ                                                 0.8957      0.3704      
## year2018_team_PIT                                                 1.7929      0.0730     *
## year2018_team_SF                                                  1.3270      0.1845      
## year2018_team_TEN                                                 1.4844      0.1377     .
## year2018_team_TB                                                  2.3987      0.0165    **
## year2018_team_ATL                                                 1.8737      0.0610     *
## year2018_team_JAX                                                 1.1624      0.2451      
## year2018_team_LA                                                  0.6226      0.5335      
## year2018_team_WAS                                                 2.3706      0.0178    **
## year2019_team_ARI                                                 1.7410      0.0817     *
## year2019_team_BUF                                                 1.1698      0.2421      
## year2019_team_CHI                                                 1.3966      0.1625      
## year2019_team_CLE                                                 1.3420      0.1796      
## year2019_team_DAL                                                 1.3849      0.1661      
## year2019_team_IND                                                 1.5869      0.1125     .
## year2019_team_JAX                                                 1.0848      0.2780      
## year2019_team_KC                                                  0.8549      0.3926      
## year2019_team_LAC                                                 2.0584      0.0395    **
## year2019_team_MIN                                                 2.2778      0.0227    **
## year2019_team_NE                                                  0.9430      0.3457      
## year2019_team_NO                                                  0.1090      0.9132      
## year2019_team_PHI                                                 2.1519      0.0314    **
## year2019_team_SEA                                                 1.2083      0.2269      
## year2019_team_SF                                                  1.5916      0.1115     .
## year2019_team_TB                                                  1.2596      0.2078      
## year2019_team_ATL                                                 2.2863      0.0222    **
## year2019_team_BAL                                                 1.7407      0.0817     *
## year2019_team_CAR                                                 0.9076      0.3641      
## year2019_team_CIN                                                 1.5415      0.1232     .
## year2019_team_DEN                                                 0.5364      0.5917      
## year2019_team_DET                                                 0.9258      0.3545      
## year2019_team_HOU                                                 1.5644      0.1177     .
## year2019_team_LA                                                  0.6983      0.4850      
## year2019_team_MIA                                                 1.3883      0.1651      
## year2019_team_NYG                                                 1.5285      0.1264     .
## year2019_team_NYJ                                                 1.2373      0.2160      
## year2019_team_OAK                                                 1.2999      0.1936      
## year2019_team_PIT                                                 0.6052      0.5450      
## year2019_team_TEN                                                 0.8343      0.4041      
## year2019_team_WAS                                                 0.6100      0.5419      
## year2019_team_GB                                                  0.9284      0.3532      
## year2020_team_ATL                                                 1.2422      0.2142      
## year2020_team_BAL                                                 0.1245      0.9009      
## year2020_team_BUF                                                 2.0008      0.0454    **
## year2020_team_CAR                                                 2.5039      0.0123    **
## year2020_team_CIN                                                 0.3225      0.7471      
## year2020_team_DEN                                                 1.5264      0.1269     .
## year2020_team_DET                                                 1.5021      0.1331     .
## year2020_team_JAX                                                 1.4077      0.1592      
## year2020_team_KC                                                  1.1803      0.2379      
## year2020_team_LA                                                  1.6688      0.0952     *
## year2020_team_MIN                                                 0.1968      0.8440      
## year2020_team_NE                                                  0.9787      0.3277      
## year2020_team_NO                                                  0.8443      0.3985      
## year2020_team_NYG                                                 0.5435      0.5868      
## year2020_team_SF                                                  0.7454      0.4560      
## year2020_team_WAS                                                 1.2041      0.2285      
## year2020_team_CHI                                                 0.0824      0.9343      
## year2020_team_DAL                                                 0.9860      0.3241      
## year2020_team_GB                                                  0.7337      0.4631      
## year2020_team_HOU                                                 1.6673      0.0955     *
## year2020_team_LV                                                  1.6467      0.0996     *
## year2020_team_MIA                                                 0.3167      0.7515      
## year2020_team_NYJ                                                 0.2840      0.7764      
## year2020_team_TB                                                  0.7469      0.4551      
## year2020_team_TEN                                                 1.2868      0.1982      
## year2020_team_ARI                                                 1.3128      0.1892      
## year2020_team_CLE                                                 1.5428      0.1229     .
## year2020_team_IND                                                 1.3004      0.1935      
## year2020_team_LAC                                                 1.0818      0.2793      
## year2020_team_PHI                                                 1.1709      0.2417      
## year2020_team_SEA                                                 1.0382      0.2992      
## year2020_team_PIT                                                 0.8341      0.4042      
## year2021_team_ATL                                                 1.6140      0.1065     .
## year2021_team_BUF                                                 0.9145      0.3605      
## year2021_team_CIN                                                 1.9205      0.0548     *
## year2021_team_DAL                                                 1.1219      0.2619      
## year2021_team_DEN                                                 1.1286      0.2591      
## year2021_team_DET                                                 0.9501      0.3420      
## year2021_team_HOU                                                 1.2491      0.2116      
## year2021_team_KC                                                  2.4602      0.0139    **
## year2021_team_LA                                                  0.1913      0.8483      
## year2021_team_LV                                                  0.8074      0.4194      
## year2021_team_MIN                                                 0.0289      0.9769      
## year2021_team_NE                                                  0.4374      0.6619      
## year2021_team_NO                                                  0.9445      0.3449      
## year2021_team_NYG                                                 1.4135      0.1575      
## year2021_team_SF                                                  2.1205      0.0340    **
## year2021_team_TEN                                                 0.6012      0.5477      
## year2021_team_ARI                                                 1.1789      0.2384      
## year2021_team_BAL                                                 0.2431      0.8079      
## year2021_team_CAR                                                 0.9593      0.3374      
## year2021_team_CHI                                                 1.0252      0.3053      
## year2021_team_GB                                                  1.0518      0.2929      
## year2021_team_IND                                                 1.0478      0.2948      
## year2021_team_LAC                                                 2.4611      0.0139    **
## year2021_team_MIA                                                 1.3179      0.1875      
## year2021_team_NYJ                                                 2.1147      0.0345    **
## year2021_team_PHI                                                 1.1786      0.2386      
## year2021_team_SEA                                                 0.9736      0.3302      
## year2021_team_TB                                                  2.5383      0.0111    **
## year2021_team_WAS                                                 1.7983      0.0721     *
## year2021_team_CLE                                                 0.7838      0.4332      
## year2021_team_JAX                                                 1.2799      0.2006      
## year2021_team_PIT                                                 1.1889      0.2345      
## year2022_team_ARI                                                 0.8498      0.3954      
## year2022_team_ATL                                                 1.9696      0.0489    **
## year2022_team_CAR                                                 0.7561      0.4496      
## year2022_team_CHI                                                 2.4995      0.0124    **
## year2022_team_CIN                                                 2.4582      0.0140    **
## year2022_team_HOU                                                 1.1522      0.2493      
## year2022_team_IND                                                 0.1624      0.8710      
## year2022_team_LAC                                                 0.8862      0.3755      
## year2022_team_MIA                                                 2.1535      0.0313    **
## year2022_team_MIN                                                 1.5148      0.1298     .
## year2022_team_NE                                                  1.4979      0.1342     .
## year2022_team_NYJ                                                 1.0796      0.2803      
## year2022_team_SEA                                                 1.2595      0.2078      
## year2022_team_TB                                                  0.3548      0.7227      
## year2022_team_TEN                                                 0.5356      0.5922      
## year2022_team_WAS                                                 0.9153      0.3600      
## year2022_team_BAL                                                 1.1529      0.2489      
## year2022_team_BUF                                                 1.5556      0.1198     .
## year2022_team_DAL                                                 0.4966      0.6195      
## year2022_team_DET                                                 0.4127      0.6799      
## year2022_team_GB                                                  0.8726      0.3829      
## year2022_team_JAX                                                 1.5797      0.1142     .
## year2022_team_KC                                                  2.7431      0.0061   ***
## year2022_team_LA                                                  0.9014      0.3674      
## year2022_team_LV                                                  1.4274      0.1535      
## year2022_team_NO                                                  1.6369      0.1016     .
## year2022_team_PHI                                                 1.6160      0.1061     .
## year2022_team_PIT                                                 1.4544      0.1458     .
## year2022_team_SF                                                  1.4086      0.1590      
## year2022_team_CLE                                                 0.8964      0.3700      
## year2022_team_DEN                                                -0.1759      0.8604      
## year2022_team_NYG                                                 1.1237      0.2611      
## year2023_team_BAL                                                 0.8801      0.3788      
## year2023_team_CHI                                                 2.6494      0.0081   ***
## year2023_team_CLE                                                 0.7449      0.4563      
## year2023_team_GB                                                  0.2733      0.7846      
## year2023_team_IND                                                 0.5707      0.5682      
## year2023_team_KC                                                  2.1459      0.0319    **
## year2023_team_LAC                                                 1.1715      0.2414      
## year2023_team_LV                                                  0.0633      0.9495      
## year2023_team_MIA                                                 1.7454      0.0809     *
## year2023_team_MIN                                                 1.4733      0.1407     .
## year2023_team_NO                                                  0.8896      0.3737      
## year2023_team_NYG                                                 1.2614      0.2072      
## year2023_team_NYJ                                                -0.2958      0.7674      
## year2023_team_SEA                                                 0.9753      0.3294      
## year2023_team_SF                                                  1.8925      0.0584     *
## year2023_team_WAS                                                 1.5114      0.1307     .
## year2023_team_ATL                                                 0.6446      0.5192      
## year2023_team_BUF                                                 2.6164      0.0089   ***
## year2023_team_CAR                                                 0.9837      0.3252      
## year2023_team_DAL                                                 1.9189      0.0550     *
## year2023_team_DEN                                                 0.4298      0.6674      
## year2023_team_HOU                                                 1.1695      0.2422      
## year2023_team_LA                                                  0.8935      0.3716      
## year2023_team_NE                                                  1.9321      0.0534     *
## year2023_team_PHI                                                 2.7737      0.0055   ***
## year2023_team_PIT                                                 0.7604      0.4470      
## year2023_team_TEN                                                 0.7759      0.4378      
## year2023_team_ARI                                                 2.0047      0.0450    **
## year2023_team_CIN                                                 1.1247      0.2607      
## year2023_team_DET                                                 1.2783      0.2011      
## year2023_team_TB                                                  1.2811      0.2002      
## year2023_team_JAX                                                 0.5462      0.5849      
## is_first_half                                                     3.6672      0.0002   ***
## time_in_half                                                     -1.7455      0.0809     *
## offense_player_1_passing_depth_short_grades_pass_12w              2.9041      0.0037   ***
## offense_player_4_rushing_grades_ypa_12w                           0.6563      0.5116      
## offense_player_8_receiving_depth_short_caught_percent_12w        -1.3374      0.1811      
## offense_player_9_receiving_depth_short_caught_percent_12w         1.6024      0.1091     .
## offense_player_10_receiving_depth_short_caught_percent_12w        0.7381      0.4605      
## offense_player_14_blocking_grades_grades_run_block_12w            0.3199      0.7490      
## offense_player_17_blocking_grades_grades_offense_12w             -0.0140      0.9888      
## offense_player_18_blocking_grades_grades_offense_12w             -1.2201      0.2224      
## offense_player_19_blocking_grades_grades_offense_12w              1.4780      0.1394     .
## offense_player_20_blocking_grades_grades_offense_12w              1.0179      0.3087      
## offense_player_21_blocking_grades_grades_offense_12w              0.8437      0.3988      
## defense_player_1_run_defense_grades_run_stop_opp_12w              1.1250      0.2606      
## defense_player_2_run_defense_grades_run_stop_opp_12w             -0.5381      0.5905      
## defense_player_3_run_defense_grades_run_stop_opp_12w             -2.9294      0.0034   ***
## defense_player_4_run_defense_grades_run_stop_opp_12w             -1.8897      0.0588     *
## defense_player_9_run_defense_grades_run_stop_opp_12w             -0.2076      0.8355      
## defense_player_10_run_defense_grades_run_stop_opp_12w            -1.2884      0.1976      
## defense_player_11_run_defense_grades_run_stop_opp_12w            -0.3133      0.7540      
## defense_player_12_run_defense_grades_run_stop_opp_12w            -1.3854      0.1659      
## defense_player_15_coverage_grades_grades_defense_12w             -2.5080      0.0121    **
## defense_player_16_coverage_grades_grades_defense_12w             -1.2176      0.2234      
## defense_player_17_coverage_grades_grades_defense_12w             -1.2066      0.2276      
## defense_player_20_coverage_schemes_zone_grades_coverage_d...     -1.2026      0.2291      
## defense_player_21_coverage_schemes_zone_grades_coverage_d...     -0.4553      0.6489      
## defense_player_22_coverage_schemes_zone_grades_coverage_d...     -0.6710      0.5022</code></pre>
<pre class="r"><code>cat(&quot;\nSignificance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15&quot;)</code></pre>
<pre><code>## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</code></pre>
<pre class="r"><code># Probit model with starter players
probit_starter &lt;- glm(conversion ~ ., data = starter_data, family = binomial(link = &quot;probit&quot;))</code></pre>
<pre class="r"><code># Get HC0-adjusted z-values and p-values for starter probit
robust_probit_starter &lt;- coeftest(probit_starter, vcov = vcovHC(probit_starter, type = &quot;HC0&quot;))
z_stats_starter &lt;- robust_probit_starter[, &quot;z value&quot;]
p_values_starter &lt;- robust_probit_starter[, &quot;Pr(&gt;|z|)&quot;]

# Print header (note &quot;z-value&quot; instead of &quot;t-value&quot;)
cat(sprintf(&quot;\n\n%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;Starter Players Probit Variable&quot;, &quot;z-value&quot;, &quot;p-value&quot;, &quot;sig&quot;))</code></pre>
<pre><code>## 
## 
## Starter Players Probit Variable                                  z-value     p-value   sig</code></pre>
<pre class="r"><code>cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;---------------&quot;, &quot;-------&quot;, &quot;-------&quot;, &quot;----&quot;))</code></pre>
<pre><code>## ---------------                                                  -------     -------  ----</code></pre>
<pre class="r"><code>for (i in 1:length(z_stats_starter)) {
    var_name &lt;- rownames(robust_probit_starter)[i]
    if (nchar(var_name) &gt; name_width) {
        var_name &lt;- paste0(substr(var_name, 1, name_width-3), &quot;...&quot;)
    }
    cat(sprintf(&quot;%-*s  %10.4f  %10.4f  %4s\n&quot;, 
                name_width, var_name, 
                z_stats_starter[i], p_values_starter[i],
                get_stars(p_values_starter[i])))
}</code></pre>
<pre><code>## (Intercept)                                                      -3.7540      0.0002   ***
## ydstogo                                                         -55.8439      0.0000   ***
## yardline_100                                                      8.0249      0.0000   ***
## posteam_timeouts_remaining                                        2.6751      0.0075   ***
## defteam_timeouts_remaining                                        4.0941      0.0000   ***
## rush_attempt                                                     13.6032      0.0000   ***
## week                                                             -1.8282      0.0675     *
## temp                                                              0.2095      0.8340      
## wind                                                             -1.2150      0.2244      
## vegas_wp                                                         -0.9188      0.3582      
## total_line                                                        1.9336      0.0532     *
## p_player_26_punting_grades_grades_punter_12w                     -0.5829      0.5600      
## p_player_26_punting_grades_grades_punter_2w                      -1.5139      0.1301     .
## k_player_25_field_goals_grades_grades_fgep_kicker_12w             2.3338      0.0196    **
## k_player_25_field_goals_grades_grades_fgep_kicker_2w              1.0972      0.2726      
## score_diff                                                       -2.6804      0.0074   ***
## down4_pct                                                        -0.5390      0.5899      
## prep_days                                                        -0.7682      0.4424      
## overall_win_pct                                                   2.2809      0.0226    **
## team_win_pct                                                      5.5641      0.0000   ***
## prev_win_pct                                                      0.8114      0.4171      
## prev_shotgun_rate                                                -0.5910      0.5545      
## prev_singleback_rate                                             -0.9838      0.3252      
## prev_empty_rate                                                  -0.4028      0.6871      
## prev_iform_rate                                                  -0.1574      0.8750      
## prev_shotgun_success                                              1.5961      0.1105     .
## prev_singleback_success                                          -0.1126      0.9104      
## prev_empty_success                                               -0.0378      0.9698      
## prev_iform_success                                               -0.2007      0.8410      
## prev_stop_rate_run                                                0.5592      0.5760      
## prev_stop_rate_pass                                              -2.1319      0.0330    **
## shotgun_rate                                                      0.8979      0.3692      
## singleback_rate                                                   0.0948      0.9245      
## empty_rate                                                        0.6976      0.4854      
## iform_rate                                                        0.4838      0.6286      
## shotgun_success                                                  -2.9938      0.0028   ***
## singleback_success                                                1.3065      0.1914      
## empty_success                                                    -0.8392      0.4014      
## iform_success                                                    -0.9962      0.3191      
## def_stop_rate_run                                                -0.9057      0.3651      
## def_stop_rate_pass                                               -0.7616      0.4463      
## avg_pass_rushers                                                 -0.7346      0.4626      
## avg_box_defenders                                                -0.1955      0.8450      
## cover0_rate                                                      -3.2497      0.0012   ***
## cover1_rate                                                      -0.7460      0.4557      
## cover2_rate                                                      -1.1648      0.2441      
## cover3_rate                                                      -1.8845      0.0595     *
## cover4_rate                                                      -2.4005      0.0164    **
## cover6_rate                                                      -0.8667      0.3861      
## two_man_rate                                                      0.1905      0.8489      
## prevent_rate                                                     -0.5263      0.5987      
## home_attendance                                                  -1.4203      0.1555      
## roof_outdoors                                                    -0.5425      0.5875      
## posteam_type_home                                                 3.7708      0.0002   ***
## offense_formation_EMPTY                                           0.2209      0.8252      
## offense_formation_SHOTGUN                                        -0.2090      0.8345      
## offense_formation_SINGLEBACK                                     -0.8461      0.3975      
## offense_formation_I_FORM                                         -0.2883      0.7731      
## year2017_team_BUF                                                -0.3419      0.7324      
## year2017_team_CHI                                                -0.3512      0.7254      
## year2017_team_CLE                                                 0.5058      0.6130      
## year2017_team_DAL                                                -0.2487      0.8036      
## year2017_team_DET                                                -0.2475      0.8045      
## year2017_team_GB                                                 -0.1962      0.8444      
## year2017_team_HOU                                                -0.8386      0.4017      
## year2017_team_MIA                                                 0.2814      0.7784      
## year2017_team_MIN                                                -1.4293      0.1529      
## year2017_team_NE                                                 -0.4873      0.6261      
## year2017_team_NYJ                                                -0.1145      0.9088      
## year2017_team_PHI                                                -0.1636      0.8701      
## year2017_team_SF                                                 -0.2957      0.7675      
## year2017_team_TEN                                                -0.6731      0.5009      
## year2017_team_WAS                                                -1.2681      0.2048      
## year2017_team_ATL                                                -0.9227      0.3562      
## year2017_team_BAL                                                -0.3850      0.7002      
## year2017_team_CIN                                                -0.5380      0.5906      
## year2017_team_DEN                                                -0.4544      0.6496      
## year2017_team_KC                                                  0.3685      0.7125      
## year2017_team_LA                                                  0.3503      0.7261      
## year2017_team_NO                                                 -0.0393      0.9687      
## year2017_team_NYG                                                -1.1434      0.2529      
## year2017_team_OAK                                                -1.0938      0.2740      
## year2017_team_PIT                                                -0.9627      0.3357      
## year2017_team_SEA                                                -0.4494      0.6532      
## year2017_team_TB                                                  1.7984      0.0721     *
## year2017_team_CAR                                                -0.7592      0.4477      
## year2017_team_IND                                                 0.0297      0.9763      
## year2017_team_JAX                                                -0.9640      0.3350      
## year2017_team_LAC                                                -0.6679      0.5042      
## year2018_team_ARI                                                 0.5528      0.5804      
## year2018_team_BAL                                                 0.6601      0.5092      
## year2018_team_CAR                                                 1.4135      0.1575      
## year2018_team_CLE                                                -0.0083      0.9934      
## year2018_team_DET                                                 0.3413      0.7329      
## year2018_team_HOU                                                 1.5123      0.1305     .
## year2018_team_IND                                                 0.8538      0.3932      
## year2018_team_KC                                                  1.2256      0.2204      
## year2018_team_LAC                                                 1.0978      0.2723      
## year2018_team_MIA                                                 0.8319      0.4055      
## year2018_team_MIN                                                -0.4034      0.6867      
## year2018_team_NE                                                  0.4274      0.6691      
## year2018_team_NYG                                                 1.5811      0.1139     .
## year2018_team_OAK                                                 1.3183      0.1874      
## year2018_team_PHI                                                 1.1606      0.2458      
## year2018_team_SEA                                                 1.2973      0.1945      
## year2018_team_BUF                                                 0.0743      0.9408      
## year2018_team_CHI                                                 0.2377      0.8121      
## year2018_team_CIN                                                 1.6840      0.0922     *
## year2018_team_DAL                                                 1.0434      0.2968      
## year2018_team_DEN                                                 1.1121      0.2661      
## year2018_team_GB                                                  0.1959      0.8447      
## year2018_team_NO                                                  1.1460      0.2518      
## year2018_team_NYJ                                                 0.4202      0.6743      
## year2018_team_PIT                                                 1.5438      0.1226     .
## year2018_team_SF                                                  1.1769      0.2392      
## year2018_team_TEN                                                 1.2393      0.2153      
## year2018_team_TB                                                  2.0640      0.0390    **
## year2018_team_ATL                                                 1.5899      0.1119     .
## year2018_team_JAX                                                 0.8496      0.3956      
## year2018_team_LA                                                  0.1556      0.8764      
## year2018_team_WAS                                                 2.2471      0.0246    **
## year2019_team_ARI                                                 1.6533      0.0983     *
## year2019_team_BUF                                                 0.9134      0.3610      
## year2019_team_CHI                                                 0.9953      0.3196      
## year2019_team_CLE                                                 1.1566      0.2474      
## year2019_team_DAL                                                 0.9311      0.3518      
## year2019_team_IND                                                 1.4478      0.1477     .
## year2019_team_JAX                                                 0.8995      0.3684      
## year2019_team_KC                                                  0.2707      0.7866      
## year2019_team_LAC                                                 1.6973      0.0896     *
## year2019_team_MIN                                                 1.9649      0.0494    **
## year2019_team_NE                                                  0.6813      0.4957      
## year2019_team_NO                                                 -0.1231      0.9021      
## year2019_team_PHI                                                 1.8906      0.0587     *
## year2019_team_SEA                                                 0.9902      0.3221      
## year2019_team_SF                                                  1.4251      0.1541      
## year2019_team_TB                                                  1.1376      0.2553      
## year2019_team_ATL                                                 2.1270      0.0334    **
## year2019_team_BAL                                                 1.4612      0.1440     .
## year2019_team_CAR                                                 0.7884      0.4305      
## year2019_team_CIN                                                 1.3480      0.1777      
## year2019_team_DEN                                                 0.2717      0.7859      
## year2019_team_DET                                                 0.6167      0.5374      
## year2019_team_HOU                                                 1.4121      0.1579      
## year2019_team_LA                                                  0.5747      0.5655      
## year2019_team_MIA                                                 1.3181      0.1875      
## year2019_team_NYG                                                 1.5145      0.1299     .
## year2019_team_NYJ                                                 1.0087      0.3131      
## year2019_team_OAK                                                 1.0176      0.3089      
## year2019_team_PIT                                                 0.4188      0.6753      
## year2019_team_TEN                                                 0.6330      0.5268      
## year2019_team_WAS                                                 0.7543      0.4506      
## year2019_team_GB                                                  0.5772      0.5638      
## year2020_team_ATL                                                 0.9210      0.3570      
## year2020_team_BAL                                                -0.2252      0.8218      
## year2020_team_BUF                                                 1.6949      0.0901     *
## year2020_team_CAR                                                 2.4604      0.0139    **
## year2020_team_CIN                                                 0.0879      0.9300      
## year2020_team_DEN                                                 1.2176      0.2234      
## year2020_team_DET                                                 1.0420      0.2974      
## year2020_team_JAX                                                 1.1741      0.2404      
## year2020_team_KC                                                  0.8127      0.4164      
## year2020_team_LA                                                  1.5078      0.1316     .
## year2020_team_MIN                                                 0.0373      0.9703      
## year2020_team_NE                                                  0.7999      0.4238      
## year2020_team_NO                                                  0.6441      0.5195      
## year2020_team_NYG                                                 0.1939      0.8463      
## year2020_team_SF                                                  0.6343      0.5259      
## year2020_team_WAS                                                 0.8357      0.4033      
## year2020_team_CHI                                                 0.0079      0.9937      
## year2020_team_DAL                                                 0.7737      0.4391      
## year2020_team_GB                                                  0.4911      0.6233      
## year2020_team_HOU                                                 1.5631      0.1180     .
## year2020_team_LV                                                  1.3418      0.1797      
## year2020_team_MIA                                                 0.0283      0.9774      
## year2020_team_NYJ                                                 0.1871      0.8516      
## year2020_team_TB                                                  0.4530      0.6505      
## year2020_team_TEN                                                 1.1957      0.2318      
## year2020_team_ARI                                                 1.1544      0.2484      
## year2020_team_CLE                                                 1.3059      0.1916      
## year2020_team_IND                                                 1.0129      0.3111      
## year2020_team_LAC                                                 0.6704      0.5026      
## year2020_team_PHI                                                 0.8795      0.3791      
## year2020_team_SEA                                                 0.8207      0.4118      
## year2020_team_PIT                                                 0.6537      0.5133      
## year2021_team_ATL                                                 1.2790      0.2009      
## year2021_team_BUF                                                 0.5458      0.5852      
## year2021_team_CIN                                                 1.6117      0.1070     .
## year2021_team_DAL                                                 0.6868      0.4922      
## year2021_team_DEN                                                 0.8444      0.3984      
## year2021_team_DET                                                 0.9491      0.3425      
## year2021_team_HOU                                                 0.9562      0.3390      
## year2021_team_KC                                                  2.0140      0.0440    **
## year2021_team_LA                                                 -0.1313      0.8955      
## year2021_team_LV                                                  0.6201      0.5352      
## year2021_team_MIN                                                -0.3566      0.7214      
## year2021_team_NE                                                  0.0864      0.9311      
## year2021_team_NO                                                  0.5965      0.5509      
## year2021_team_NYG                                                 1.1377      0.2553      
## year2021_team_SF                                                  1.8686      0.0617     *
## year2021_team_TEN                                                 0.4781      0.6326      
## year2021_team_ARI                                                 0.8999      0.3682      
## year2021_team_BAL                                                 0.0924      0.9264      
## year2021_team_CAR                                                 0.7432      0.4574      
## year2021_team_CHI                                                 0.6997      0.4841      
## year2021_team_GB                                                  0.7741      0.4389      
## year2021_team_IND                                                 0.6954      0.4868      
## year2021_team_LAC                                                 2.3146      0.0206    **
## year2021_team_MIA                                                 0.9013      0.3674      
## year2021_team_NYJ                                                 1.7211      0.0852     *
## year2021_team_PHI                                                 0.8930      0.3718      
## year2021_team_SEA                                                 0.6998      0.4840      
## year2021_team_TB                                                  2.2736      0.0230    **
## year2021_team_WAS                                                 1.4614      0.1439     .
## year2021_team_CLE                                                 0.3578      0.7205      
## year2021_team_JAX                                                 0.9452      0.3446      
## year2021_team_PIT                                                 0.9707      0.3317      
## year2022_team_ARI                                                 0.7511      0.4526      
## year2022_team_ATL                                                 1.8218      0.0685     *
## year2022_team_CAR                                                 0.3730      0.7092      
## year2022_team_CHI                                                 2.3477      0.0189    **
## year2022_team_CIN                                                 2.1617      0.0306    **
## year2022_team_HOU                                                 0.7869      0.4313      
## year2022_team_IND                                                -0.2172      0.8281      
## year2022_team_LAC                                                 0.7079      0.4790      
## year2022_team_MIA                                                 1.9237      0.0544     *
## year2022_team_MIN                                                 1.3266      0.1846      
## year2022_team_NE                                                  1.1461      0.2518      
## year2022_team_NYJ                                                 0.4942      0.6212      
## year2022_team_SEA                                                 1.1332      0.2571      
## year2022_team_TB                                                  0.1690      0.8658      
## year2022_team_TEN                                                 0.3455      0.7297      
## year2022_team_WAS                                                 0.5877      0.5568      
## year2022_team_BAL                                                 0.8459      0.3976      
## year2022_team_BUF                                                 1.3177      0.1876      
## year2022_team_DAL                                                 0.1657      0.8684      
## year2022_team_DET                                                 0.1388      0.8896      
## year2022_team_GB                                                  0.9096      0.3630      
## year2022_team_JAX                                                 1.3188      0.1872      
## year2022_team_KC                                                  2.4425      0.0146    **
## year2022_team_LA                                                  0.6112      0.5411      
## year2022_team_LV                                                  1.0935      0.2742      
## year2022_team_NO                                                  1.4659      0.1427     .
## year2022_team_PHI                                                 1.3067      0.1913      
## year2022_team_PIT                                                 1.2229      0.2214      
## year2022_team_SF                                                  1.3032      0.1925      
## year2022_team_CLE                                                 0.4991      0.6177      
## year2022_team_DEN                                                -0.4664      0.6409      
## year2022_team_NYG                                                 1.1026      0.2702      
## year2023_team_BAL                                                 0.5022      0.6155      
## year2023_team_CHI                                                 2.3799      0.0173    **
## year2023_team_CLE                                                 0.4504      0.6524      
## year2023_team_GB                                                  0.1758      0.8605      
## year2023_team_IND                                                 0.2774      0.7815      
## year2023_team_KC                                                  1.9514      0.0510     *
## year2023_team_LAC                                                 0.7602      0.4471      
## year2023_team_LV                                                 -0.1509      0.8800      
## year2023_team_MIA                                                 1.3981      0.1621      
## year2023_team_MIN                                                 1.5744      0.1154     .
## year2023_team_NO                                                  0.5769      0.5640      
## year2023_team_NYG                                                 1.4198      0.1557      
## year2023_team_NYJ                                                -0.5575      0.5772      
## year2023_team_SEA                                                 0.7930      0.4278      
## year2023_team_SF                                                  1.6466      0.0996     *
## year2023_team_WAS                                                 1.3323      0.1828      
## year2023_team_ATL                                                 0.4258      0.6703      
## year2023_team_BUF                                                 2.2671      0.0234    **
## year2023_team_CAR                                                 1.1559      0.2477      
## year2023_team_DAL                                                 1.6974      0.0896     *
## year2023_team_DEN                                                 0.1102      0.9122      
## year2023_team_HOU                                                 1.0541      0.2918      
## year2023_team_LA                                                  0.9676      0.3333      
## year2023_team_NE                                                  1.8186      0.0690     *
## year2023_team_PHI                                                 2.4842      0.0130    **
## year2023_team_PIT                                                 0.4507      0.6522      
## year2023_team_TEN                                                 0.6943      0.4875      
## year2023_team_ARI                                                 2.0628      0.0391    **
## year2023_team_CIN                                                 0.8319      0.4054      
## year2023_team_DET                                                 1.1642      0.2443      
## year2023_team_TB                                                  1.2003      0.2300      
## year2023_team_JAX                                                 0.4069      0.6841      
## is_first_half                                                     3.8172      0.0001   ***
## time_in_half                                                     -1.7516      0.0798     *
## starter_offense_player_1_passing_depth_short_grades_pass_12w      0.3571      0.7210      
## starter_offense_player_4_rushing_grades_ypa_12w                  -0.1873      0.8515      
## starter_offense_player_8_receiving_depth_short_caught_per...     -0.6403      0.5220      
## starter_offense_player_9_receiving_depth_short_caught_per...     -2.3179      0.0205    **
## starter_offense_player_10_receiving_depth_short_caught_pe...     -0.4826      0.6294      
## starter_offense_player_14_blocking_grades_grades_run_bloc...     -0.5027      0.6151      
## starter_offense_player_15_blocking_grades_grades_run_bloc...     -0.1902      0.8492      
## starter_offense_player_17_blocking_grades_grades_offense_12w     -1.5726      0.1158     .
## starter_offense_player_18_blocking_grades_grades_offense_12w      1.0428      0.2970      
## starter_offense_player_19_blocking_grades_grades_offense_12w      1.6774      0.0935     *
## starter_offense_player_20_blocking_grades_grades_offense_12w      0.2081      0.8352      
## starter_offense_player_21_blocking_grades_grades_offense_12w      2.0163      0.0438    **
## starter_defense_player_1_run_defense_grades_run_stop_opp_12w     -0.0580      0.9538      
## starter_defense_player_2_run_defense_grades_run_stop_opp_12w     -0.9794      0.3274      
## starter_defense_player_3_run_defense_grades_run_stop_opp_12w      0.2347      0.8145      
## starter_defense_player_4_run_defense_grades_run_stop_opp_12w     -0.8750      0.3816      
## starter_defense_player_9_run_defense_grades_run_stop_opp_12w     -1.0639      0.2874      
## starter_defense_player_10_run_defense_grades_run_stop_opp...      0.2247      0.8222      
## starter_defense_player_11_run_defense_grades_run_stop_opp...      0.5930      0.5532      
## starter_defense_player_12_run_defense_grades_run_stop_opp...      1.3098      0.1903      
## starter_defense_player_15_coverage_grades_grades_defense_12w     -2.0854      0.0370    **
## starter_defense_player_16_coverage_grades_grades_defense_12w      0.8857      0.3758      
## starter_defense_player_17_coverage_grades_grades_defense_12w     -0.3198      0.7491      
## starter_defense_player_20_coverage_schemes_zone_grades_co...      0.8193      0.4126      
## starter_defense_player_21_coverage_schemes_zone_grades_co...     -0.3210      0.7482      
## starter_defense_player_22_coverage_schemes_zone_grades_co...      1.5510      0.1209     .</code></pre>
<pre class="r"><code>cat(&quot;\nSignificance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15&quot;)</code></pre>
<pre><code>## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</code></pre>
<pre class="r"><code># Model comparison summary
cat(&quot;\n\n--- Model Comparison Summary ---\n&quot;)</code></pre>
<pre><code>## 
## 
## --- Model Comparison Summary ---</code></pre>
<pre class="r"><code>cat(&quot;OLS Regular Players R-squared:&quot;, round(summary(ols_regular)$r.squared, 4), &quot;\n&quot;)</code></pre>
<pre><code>## OLS Regular Players R-squared: 0.1247</code></pre>
<pre class="r"><code>cat(&quot;OLS Starter Players R-squared:&quot;, round(summary(ols_starter)$r.squared, 4), &quot;\n&quot;)</code></pre>
<pre><code>## OLS Starter Players R-squared: 0.1243</code></pre>
<pre class="r"><code>cat(&quot;OLS Regular Players Adj R-squared:&quot;, round(summary(ols_regular)$adj.r.squared, 4), &quot;\n&quot;)</code></pre>
<pre><code>## OLS Regular Players Adj R-squared: 0.1183</code></pre>
<pre class="r"><code>cat(&quot;OLS Starter Players Adj R-squared:&quot;, round(summary(ols_starter)$adj.r.squared, 4), &quot;\n\n&quot;)</code></pre>
<pre><code>## OLS Starter Players Adj R-squared: 0.1178</code></pre>
<pre class="r"><code>cat(&quot;Probit Regular Players AIC:&quot;, round(probit_regular$aic, 2), &quot;\n&quot;)</code></pre>
<pre><code>## Probit Regular Players AIC: 51555.97</code></pre>
<pre class="r"><code>cat(&quot;Probit Starter Players AIC:&quot;, round(probit_starter$aic, 2), &quot;\n&quot;)</code></pre>
<pre><code>## Probit Starter Players AIC: 51582.97</code></pre>
<pre class="r"><code>cat(&quot;Probit Regular Players McFadden&#39;s Pseudo R²:&quot;, round(1 - probit_regular$deviance/probit_regular$null.deviance, 4), &quot;\n&quot;)</code></pre>
<pre><code>## Probit Regular Players McFadden&#39;s Pseudo R²: 0.1033</code></pre>
<pre class="r"><code>cat(&quot;Probit Starter Players McFadden&#39;s Pseudo R²:&quot;, round(1 - probit_starter$deviance/probit_starter$null.deviance, 4), &quot;\n&quot;)</code></pre>
<pre><code>## Probit Starter Players McFadden&#39;s Pseudo R²: 0.1028</code></pre>
<pre class="r"><code># Function to get top coefficients by absolute value
get_top_coefficients &lt;- function(model_results, n = 10) {
  coefs &lt;- model_results[, &quot;Estimate&quot;]
  # Remove intercept
  coefs &lt;- coefs[names(coefs) != &quot;(Intercept)&quot;]
  # Sort by absolute value
  sorted_indices &lt;- order(abs(coefs), decreasing = TRUE)
  top_coefs &lt;- coefs[sorted_indices[1:min(n, length(sorted_indices))]]
  return(top_coefs)
}

# Display top coefficients for each model
cat(&quot;\n\nTop 10 Influential Variables by Absolute Coefficient Value\n&quot;)</code></pre>
<pre><code>## 
## 
## Top 10 Influential Variables by Absolute Coefficient Value</code></pre>
<pre class="r"><code>cat(&quot;\nOLS Regular Players:\n&quot;)</code></pre>
<pre><code>## 
## OLS Regular Players:</code></pre>
<pre class="r"><code>print(get_top_coefficients(robust_regular_test))</code></pre>
<pre><code>## year2023_team_PHI year2023_team_BUF  year2022_team_KC year2023_team_CHI 
##         0.1789555         0.1731890         0.1726616         0.1588625 
## year2020_team_CAR  year2021_team_KC year2021_team_LAC           ydstogo 
##         0.1542727         0.1512210         0.1491191        -0.1490586 
##  year2021_team_TB  year2018_team_TB 
##         0.1467041         0.1465873</code></pre>
<pre class="r"><code>cat(&quot;\nOLS Starter Players:\n&quot;)</code></pre>
<pre><code>## 
## OLS Starter Players:</code></pre>
<pre class="r"><code>print(get_top_coefficients(robust_starter_test))</code></pre>
<pre><code>## year2023_team_PHI  year2022_team_KC year2023_team_BUF year2020_team_CAR 
##         0.1625385         0.1535697         0.1504025         0.1502767 
##           ydstogo year2023_team_CHI year2021_team_LAC year2018_team_WAS 
##        -0.1486011         0.1442688         0.1397017         0.1345468 
##  year2021_team_TB year2022_team_CHI 
##         0.1323577         0.1293499</code></pre>
<pre class="r"><code>cat(&quot;\nProbit Regular Players:\n&quot;)</code></pre>
<pre><code>## 
## Probit Regular Players:</code></pre>
<pre class="r"><code>print(get_top_coefficients(robust_probit_regular))</code></pre>
<pre><code>## year2023_team_PHI year2023_team_BUF           ydstogo  year2022_team_KC 
##         0.5120827         0.4878157        -0.4876106         0.4761343 
## year2023_team_CHI year2020_team_CAR  year2018_team_TB  year2021_team_KC 
##         0.4507241         0.4407056         0.4336854         0.4253000 
##  year2021_team_TB year2021_team_LAC 
##         0.4207977         0.4187086</code></pre>
<pre class="r"><code>cat(&quot;\nProbit Starter Players:\n&quot;)</code></pre>
<pre><code>## 
## Probit Starter Players:</code></pre>
<pre class="r"><code>print(get_top_coefficients(robust_probit_starter))</code></pre>
<pre><code>##           ydstogo year2023_team_PHI year2020_team_CAR year2023_team_BUF 
##        -0.4835589         0.4554493         0.4281563         0.4205655 
##  year2022_team_KC year2023_team_CHI year2021_team_LAC year2018_team_WAS 
##         0.4187025         0.4010658         0.3897351         0.3870547 
## year2022_team_CHI  year2021_team_TB 
##         0.3768508         0.3741573</code></pre>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIlRoaXJkIERvd24gQW5hbHlzaXMgd2l0aCBSZWd1bGFyIGFuZCBTdGFydGVyIFBsYXllcnMiDQpvdXRwdXQ6IGh0bWxfZG9jdW1lbnQNCi0tLQ0KDQpgYGB7cn0NCmxpYnJhcnkoZGF0YS50YWJsZSkgICAgICAgICAgICAgDQpjdGQxIDwtIGZyZWFkKCJwcmVkaWN0X2N0ZDEuY3N2Lmd6IikgICAgICAgICAgICAgICAgICAgICAgICANCmBgYA0KDQpgYGB7cn0NCiNraWxsIG15X2lkDQpjdGQxJG15X2lkIDwtIE5VTEwNCmN0ZDFbLCB5ZWFyMjAxN190ZWFtX0FSSSA6PSBOVUxMXQ0KYGBgDQoNCmBgYHtyfQ0KIyBJZGVudGlmeSBwbGF5ZXIgY29sdW1ucw0KYWxsX2NvbHMgPC0gY29sbmFtZXMoY3RkMSkNCg0KIyBDcmVhdGUgcmVnZXggcGF0dGVybnMgdG8gaWRlbnRpZnkgcmVndWxhciBhbmQgc3RhcnRlciBwbGF5ZXIgdmFyaWFibGVzDQpvZmZlbnNlX3BsYXllcl9wYXR0ZXJuIDwtICJeb2ZmZW5zZV9wbGF5ZXJfXFxkK18iDQpkZWZlbnNlX3BsYXllcl9wYXR0ZXJuIDwtICJeZGVmZW5zZV9wbGF5ZXJfXFxkK18iDQpzdGFydGVyX29mZmVuc2VfcGF0dGVybiA8LSAiXnN0YXJ0ZXJfb2ZmZW5zZV9wbGF5ZXJfXFxkK18iDQpzdGFydGVyX2RlZmVuc2VfcGF0dGVybiA8LSAiXnN0YXJ0ZXJfZGVmZW5zZV9wbGF5ZXJfXFxkK18iDQoNCiMgR2V0IGNvbHVtbnMgZm9yIGVhY2ggdHlwZQ0Kb2ZmZW5zZV9wbGF5ZXJfY29scyA8LSBncmVwKG9mZmVuc2VfcGxheWVyX3BhdHRlcm4sIGFsbF9jb2xzLCB2YWx1ZSA9IFRSVUUpDQpkZWZlbnNlX3BsYXllcl9jb2xzIDwtIGdyZXAoZGVmZW5zZV9wbGF5ZXJfcGF0dGVybiwgYWxsX2NvbHMsIHZhbHVlID0gVFJVRSkNCnN0YXJ0ZXJfb2ZmZW5zZV9jb2xzIDwtIGdyZXAoc3RhcnRlcl9vZmZlbnNlX3BhdHRlcm4sIGFsbF9jb2xzLCB2YWx1ZSA9IFRSVUUpDQpzdGFydGVyX2RlZmVuc2VfY29scyA8LSBncmVwKHN0YXJ0ZXJfZGVmZW5zZV9wYXR0ZXJuLCBhbGxfY29scywgdmFsdWUgPSBUUlVFKQ0KDQojIEFsbCBwbGF5ZXIgY29sdW1ucw0KcmVndWxhcl9wbGF5ZXJfY29scyA8LSBjKG9mZmVuc2VfcGxheWVyX2NvbHMsIGRlZmVuc2VfcGxheWVyX2NvbHMpDQpzdGFydGVyX3BsYXllcl9jb2xzIDwtIGMoc3RhcnRlcl9vZmZlbnNlX2NvbHMsIHN0YXJ0ZXJfZGVmZW5zZV9jb2xzKQ0KYWxsX3BsYXllcl9jb2xzIDwtIGMocmVndWxhcl9wbGF5ZXJfY29scywgc3RhcnRlcl9wbGF5ZXJfY29scykNCg0KIyBOb24tcGxheWVyIGNvbHVtbnMgKGNvbW1vbiB0byBib3RoIGRhdGFzZXRzKQ0KY29tbW9uX2NvbHMgPC0gc2V0ZGlmZihhbGxfY29scywgYWxsX3BsYXllcl9jb2xzKQ0KDQojIENyZWF0ZSB0d28gZGF0YXNldHMNCnJlZ3VsYXJfZGF0YSA8LSBjdGQxWywgYyhjb21tb25fY29scywgcmVndWxhcl9wbGF5ZXJfY29scyksIHdpdGggPSBGQUxTRV0NCnN0YXJ0ZXJfZGF0YSA8LSBjdGQxWywgYyhjb21tb25fY29scywgc3RhcnRlcl9wbGF5ZXJfY29scyksIHdpdGggPSBGQUxTRV0NCmBgYA0KDQoNCmBgYHtyfQ0KIyBUaGVuIHJ1biBPTFMgd2l0aCByZWd1bGFyIHBsYXllcnMNCm9sc19yZWd1bGFyIDwtIGxtKGNvbnZlcnNpb24gfiAuLCBkYXRhID0gcmVndWxhcl9kYXRhKQ0KYGBgDQoNCmBgYHtyfQ0KbGlicmFyeShzYW5kd2ljaCkNCmxpYnJhcnkobG10ZXN0KQ0KIyBHZXQgSEMwLWFkanVzdGVkIHQtdmFsdWVzIGFuZCBwLXZhbHVlcw0Kcm9idXN0X3JlZ3VsYXJfdGVzdCA8LSBjb2VmdGVzdChvbHNfcmVndWxhciwgdmNvdiA9IHZjb3ZIQyhvbHNfcmVndWxhciwgdHlwZSA9ICJIQzAiKSkNCnRfc3RhdHNfcmVndWxhciA8LSByb2J1c3RfcmVndWxhcl90ZXN0WywgInQgdmFsdWUiXQ0KcF92YWx1ZXNfcmVndWxhciA8LSByb2J1c3RfcmVndWxhcl90ZXN0WywgIlByKD58dHwpIl0NCiMgRnVuY3Rpb24gdG8gYWRkIHNpZ25pZmljYW5jZSBzdGFycw0KZ2V0X3N0YXJzIDwtIGZ1bmN0aW9uKHApIHsNCiAgICBpZiAocCA8PSAwLjAxKSByZXR1cm4oIioqKiIpDQogICAgaWYgKHAgPD0gMC4wNSkgcmV0dXJuKCIqKiIpDQogICAgaWYgKHAgPD0gMC4xKSByZXR1cm4oIioiKQ0KICAgIGlmIChwIDw9IDAuMTUpIHJldHVybigiLiIpDQogICAgcmV0dXJuKCIiKQ0KfQ0KIyBNYXhpbXVtIHdpZHRoIGZvciB2YXJpYWJsZSBuYW1lcw0KbmFtZV93aWR0aCA8LSA2MA0KIyBQcmludCBoZWFkZXIgd2l0aCBhbGlnbm1lbnQNCmNhdChzcHJpbnRmKCIlLSpzICAlMTBzICAlMTBzICAlNHNcbiIsIG5hbWVfd2lkdGgsICJSZWd1bGFyIFBsYXllcnMgT0xTIFZhcmlhYmxlIiwgInQtdmFsdWUiLCAicC12YWx1ZSIsICJzaWciKSkNCmNhdChzcHJpbnRmKCIlLSpzICAlMTBzICAlMTBzICAlNHNcbiIsIG5hbWVfd2lkdGgsICItLS0tLS0tLS0iLCAiLS0tLS0tLSIsICItLS0tLS0tIiwgIi0tLS0iKSkNCiMgTG9vcCB0aHJvdWdoIGFuZCBwcmludCB2YWx1ZXMNCmZvciAoaSBpbiAxOmxlbmd0aCh0X3N0YXRzX3JlZ3VsYXIpKSB7DQogICAgdmFyX25hbWUgPC0gcm93bmFtZXMocm9idXN0X3JlZ3VsYXJfdGVzdClbaV0NCiAgICAjIFRydW5jYXRlIG5hbWUgaWYgdG9vIGxvbmcNCiAgICBpZiAobmNoYXIodmFyX25hbWUpID4gbmFtZV93aWR0aCkgew0KICAgICAgICB2YXJfbmFtZSA8LSBwYXN0ZTAoc3Vic3RyKHZhcl9uYW1lLCAxLCBuYW1lX3dpZHRoLTMpLCAiLi4uIikNCiAgICB9DQogICAgY2F0KHNwcmludGYoIiUtKnMgICUxMC40ZiAgJTEwLjRmICAlNHNcbiIsIA0KICAgICAgICAgICAgICAgIG5hbWVfd2lkdGgsIHZhcl9uYW1lLCANCiAgICAgICAgICAgICAgICB0X3N0YXRzX3JlZ3VsYXJbaV0sIHBfdmFsdWVzX3JlZ3VsYXJbaV0sDQogICAgICAgICAgICAgICAgZ2V0X3N0YXJzKHBfdmFsdWVzX3JlZ3VsYXJbaV0pKSkNCn0NCmNhdCgiXG5TaWduaWZpY2FuY2UgY29kZXM6IDAgJyoqKicgMC4wMSAnKionIDAuMDUgJyonIDAuMSAnLicgMC4xNSIpDQpgYGANCg0KYGBge3J9DQojIExvYWQgdGhlIGNhciBwYWNrYWdlIHdoaWNoIGhhcyB0aGUgdmlmIGZ1bmN0aW9uDQpsaWJyYXJ5KGNhcikNCiMgQ2FsY3VsYXRlIFZJRnMgZm9yIHRoZSBtb2RlbCB3aXRoIHJlZ3VsYXIgcGxheWVycw0Kdmlmc19yZWd1bGFyIDwtIHZpZihvbHNfcmVndWxhcikNCiMgRmlsdGVyIHRvIHNob3cgb25seSBWSUZzIG92ZXIgNQ0KaGlnaF92aWZzX3JlZ3VsYXIgPC0gdmlmc19yZWd1bGFyW3ZpZnNfcmVndWxhciA+IDVdDQppZihsZW5ndGgoaGlnaF92aWZzX3JlZ3VsYXIpID4gMCkgew0KICBjYXQoIlxuUmVndWxhciBQbGF5ZXJzOiBWYXJpYWJsZXMgd2l0aCBWSUYgPiA1OlxuIikNCiAgcHJpbnQoaGlnaF92aWZzX3JlZ3VsYXIpDQp9IGVsc2Ugew0KICBjYXQoIlxuTm8gdmFyaWFibGVzIHdpdGggVklGID4gNSBmb3VuZCBpbiB0aGUgUmVndWxhciBQbGF5ZXJzIG1vZGVsXG4iKQ0KfQ0KYGBgDQoNCmBgYHtyfQ0KbGlicmFyeShjYXJldCkNCiMgQ3JlYXRlIHRoZSBtb2RlbCBtYXRyaXggZm9yIHJlZ3VsYXIgZGF0YSAoZXhjbHVkaW5nIHRoZSByZXNwb25zZSB2YXJpYWJsZSkNClhfcmVndWxhciA8LSBtb2RlbC5tYXRyaXgofiAuIC0gY29udmVyc2lvbiAtIDEsIGRhdGEgPSByZWd1bGFyX2RhdGEpICAjIC0xIHJlbW92ZXMgaW50ZXJjZXB0DQojIEZpbmQgY29sdW1ucyBjYXVzaW5nIGxpbmVhciBkZXBlbmRlbmNpZXMNCmxpbl9jb21ib3NfcmVndWxhciA8LSBmaW5kTGluZWFyQ29tYm9zKFhfcmVndWxhcikNCiMgUmVtb3ZlIHByb2JsZW1hdGljIGNvbHVtbnMgZnJvbSB0aGUgZGF0YXNldA0KaWYgKCFpcy5udWxsKGxpbl9jb21ib3NfcmVndWxhciRyZW1vdmUpKSB7DQogIGNvbHNfdG9fcmVtb3ZlIDwtIGNvbG5hbWVzKFhfcmVndWxhcilbbGluX2NvbWJvc19yZWd1bGFyJHJlbW92ZV0NCiAgY2F0KCJSZW1vdmVkIGZyb20gcmVndWxhciBkYXRhOiIsIHBhc3RlKGNvbHNfdG9fcmVtb3ZlLCBjb2xsYXBzZT0iLCAiKSwgIlxuIikNCiAgcmVndWxhcl9kYXRhIDwtIHJlZ3VsYXJfZGF0YVssIChjb2xzX3RvX3JlbW92ZSkgOj0gTlVMTCwgd2l0aCA9IEZBTFNFXQ0KfQ0KYGBgDQoNCg0KYGBge3J9DQojIFRoZW4gcnVuIE9MUyB3aXRoIHN0YXJ0ZXIgcGxheWVycw0Kb2xzX3N0YXJ0ZXIgPC0gbG0oY29udmVyc2lvbiB+IC4sIGRhdGEgPSBzdGFydGVyX2RhdGEpDQpgYGANCg0KYGBge3J9DQojIEdldCBIQzAtYWRqdXN0ZWQgdC12YWx1ZXMgYW5kIHAtdmFsdWVzDQpyb2J1c3Rfc3RhcnRlcl90ZXN0IDwtIGNvZWZ0ZXN0KG9sc19zdGFydGVyLCB2Y292ID0gdmNvdkhDKG9sc19zdGFydGVyLCB0eXBlID0gIkhDMCIpKQ0KdF9zdGF0c19zdGFydGVyIDwtIHJvYnVzdF9zdGFydGVyX3Rlc3RbLCAidCB2YWx1ZSJdDQpwX3ZhbHVlc19zdGFydGVyIDwtIHJvYnVzdF9zdGFydGVyX3Rlc3RbLCAiUHIoPnx0fCkiXQ0KDQojIFByaW50IGhlYWRlciB3aXRoIGFsaWdubWVudA0KY2F0KHNwcmludGYoIiUtKnMgICUxMHMgICUxMHMgICU0c1xuIiwgbmFtZV93aWR0aCwgIlN0YXJ0ZXIgUGxheWVycyBPTFMgVmFyaWFibGUiLCAidC12YWx1ZSIsICJwLXZhbHVlIiwgInNpZyIpKQ0KY2F0KHNwcmludGYoIiUtKnMgICUxMHMgICUxMHMgICU0c1xuIiwgbmFtZV93aWR0aCwgIi0tLS0tLS0tLSIsICItLS0tLS0tIiwgIi0tLS0tLS0iLCAiLS0tLSIpKQ0KIyBMb29wIHRocm91Z2ggYW5kIHByaW50IHZhbHVlcw0KZm9yIChpIGluIDE6bGVuZ3RoKHRfc3RhdHNfc3RhcnRlcikpIHsNCiAgICB2YXJfbmFtZSA8LSByb3duYW1lcyhyb2J1c3Rfc3RhcnRlcl90ZXN0KVtpXQ0KICAgICMgVHJ1bmNhdGUgbmFtZSBpZiB0b28gbG9uZw0KICAgIGlmIChuY2hhcih2YXJfbmFtZSkgPiBuYW1lX3dpZHRoKSB7DQogICAgICAgIHZhcl9uYW1lIDwtIHBhc3RlMChzdWJzdHIodmFyX25hbWUsIDEsIG5hbWVfd2lkdGgtMyksICIuLi4iKQ0KICAgIH0NCiAgICBjYXQoc3ByaW50ZigiJS0qcyAgJTEwLjRmICAlMTAuNGYgICU0c1xuIiwgDQogICAgICAgICAgICAgICAgbmFtZV93aWR0aCwgdmFyX25hbWUsIA0KICAgICAgICAgICAgICAgIHRfc3RhdHNfc3RhcnRlcltpXSwgcF92YWx1ZXNfc3RhcnRlcltpXSwNCiAgICAgICAgICAgICAgICBnZXRfc3RhcnMocF92YWx1ZXNfc3RhcnRlcltpXSkpKQ0KfQ0KY2F0KCJcblNpZ25pZmljYW5jZSBjb2RlczogMCAnKioqJyAwLjAxICcqKicgMC4wNSAnKicgMC4xICcuJyAwLjE1IikNCmBgYA0KDQpgYGB7cn0NCiMgQ2FsY3VsYXRlIFZJRnMgZm9yIHRoZSBtb2RlbCB3aXRoIHN0YXJ0ZXIgcGxheWVycw0Kdmlmc19zdGFydGVyIDwtIHZpZihvbHNfc3RhcnRlcikNCiMgRmlsdGVyIHRvIHNob3cgb25seSBWSUZzIG92ZXIgNQ0KaGlnaF92aWZzX3N0YXJ0ZXIgPC0gdmlmc19zdGFydGVyW3ZpZnNfc3RhcnRlciA+IDVdDQppZihsZW5ndGgoaGlnaF92aWZzX3N0YXJ0ZXIpID4gMCkgew0KICBjYXQoIlxuU3RhcnRlciBQbGF5ZXJzOiBWYXJpYWJsZXMgd2l0aCBWSUYgPiA1OlxuIikNCiAgcHJpbnQoaGlnaF92aWZzX3N0YXJ0ZXIpDQp9IGVsc2Ugew0KICBjYXQoIlxuTm8gdmFyaWFibGVzIHdpdGggVklGID4gNSBmb3VuZCBpbiB0aGUgU3RhcnRlciBQbGF5ZXJzIG1vZGVsXG4iKQ0KfQ0KYGBgDQoNCmBgYHtyfQ0KIyBDcmVhdGUgdGhlIG1vZGVsIG1hdHJpeCBmb3Igc3RhcnRlciBkYXRhIChleGNsdWRpbmcgdGhlIHJlc3BvbnNlIHZhcmlhYmxlKQ0KWF9zdGFydGVyIDwtIG1vZGVsLm1hdHJpeCh+IC4gLSBjb252ZXJzaW9uIC0gMSwgZGF0YSA9IHN0YXJ0ZXJfZGF0YSkgICMgLTEgcmVtb3ZlcyBpbnRlcmNlcHQNCiMgRmluZCBjb2x1bW5zIGNhdXNpbmcgbGluZWFyIGRlcGVuZGVuY2llcw0KbGluX2NvbWJvc19zdGFydGVyIDwtIGZpbmRMaW5lYXJDb21ib3MoWF9zdGFydGVyKQ0KIyBSZW1vdmUgcHJvYmxlbWF0aWMgY29sdW1ucyBmcm9tIHRoZSBkYXRhc2V0DQppZiAoIWlzLm51bGwobGluX2NvbWJvc19zdGFydGVyJHJlbW92ZSkpIHsNCiAgY29sc190b19yZW1vdmUgPC0gY29sbmFtZXMoWF9zdGFydGVyKVtsaW5fY29tYm9zX3N0YXJ0ZXIkcmVtb3ZlXQ0KICBjYXQoIlJlbW92ZWQgZnJvbSBzdGFydGVyIGRhdGE6IiwgcGFzdGUoY29sc190b19yZW1vdmUsIGNvbGxhcHNlPSIsICIpLCAiXG4iKQ0KICBzdGFydGVyX2RhdGEgPC0gc3RhcnRlcl9kYXRhWywgKGNvbHNfdG9fcmVtb3ZlKSA6PSBOVUxMLCB3aXRoID0gRkFMU0VdDQp9DQpgYGANCg0KDQpgYGB7cn0NCiMgUHJvYml0IG1vZGVsIHdpdGggcmVndWxhciBwbGF5ZXJzDQpwcm9iaXRfcmVndWxhciA8LSBnbG0oY29udmVyc2lvbiB+IC4sIGRhdGEgPSByZWd1bGFyX2RhdGEsIGZhbWlseSA9IGJpbm9taWFsKGxpbmsgPSAicHJvYml0IikpDQpgYGANCg0KYGBge3J9DQojIEdldCBIQzAtYWRqdXN0ZWQgei12YWx1ZXMgYW5kIHAtdmFsdWVzIGZvciByZWd1bGFyIHByb2JpdA0Kcm9idXN0X3Byb2JpdF9yZWd1bGFyIDwtIGNvZWZ0ZXN0KHByb2JpdF9yZWd1bGFyLCB2Y292ID0gdmNvdkhDKHByb2JpdF9yZWd1bGFyLCB0eXBlID0gIkhDMCIpKQ0Kel9zdGF0c19yZWd1bGFyIDwtIHJvYnVzdF9wcm9iaXRfcmVndWxhclssICJ6IHZhbHVlIl0NCnBfdmFsdWVzX3JlZ3VsYXIgPC0gcm9idXN0X3Byb2JpdF9yZWd1bGFyWywgIlByKD58enwpIl0NCg0KIyBQcmludCBoZWFkZXIgKG5vdGUgInotdmFsdWUiIGluc3RlYWQgb2YgInQtdmFsdWUiKQ0KY2F0KHNwcmludGYoIlxuXG4lLSpzICAlMTBzICAlMTBzICAlNHNcbiIsIG5hbWVfd2lkdGgsICJSZWd1bGFyIFBsYXllcnMgUHJvYml0IFZhcmlhYmxlIiwgInotdmFsdWUiLCAicC12YWx1ZSIsICJzaWciKSkNCmNhdChzcHJpbnRmKCIlLSpzICAlMTBzICAlMTBzICAlNHNcbiIsIG5hbWVfd2lkdGgsICItLS0tLS0tLS0tLS0tLS0iLCAiLS0tLS0tLSIsICItLS0tLS0tIiwgIi0tLS0iKSkNCmZvciAoaSBpbiAxOmxlbmd0aCh6X3N0YXRzX3JlZ3VsYXIpKSB7DQogICAgdmFyX25hbWUgPC0gcm93bmFtZXMocm9idXN0X3Byb2JpdF9yZWd1bGFyKVtpXQ0KICAgIGlmIChuY2hhcih2YXJfbmFtZSkgPiBuYW1lX3dpZHRoKSB7DQogICAgICAgIHZhcl9uYW1lIDwtIHBhc3RlMChzdWJzdHIodmFyX25hbWUsIDEsIG5hbWVfd2lkdGgtMyksICIuLi4iKQ0KICAgIH0NCiAgICBjYXQoc3ByaW50ZigiJS0qcyAgJTEwLjRmICAlMTAuNGYgICU0c1xuIiwgDQogICAgICAgICAgICAgICAgbmFtZV93aWR0aCwgdmFyX25hbWUsIA0KICAgICAgICAgICAgICAgIHpfc3RhdHNfcmVndWxhcltpXSwgcF92YWx1ZXNfcmVndWxhcltpXSwNCiAgICAgICAgICAgICAgICBnZXRfc3RhcnMocF92YWx1ZXNfcmVndWxhcltpXSkpKQ0KfQ0KY2F0KCJcblNpZ25pZmljYW5jZSBjb2RlczogMCAnKioqJyAwLjAxICcqKicgMC4wNSAnKicgMC4xICcuJyAwLjE1IikNCmBgYA0KDQoNCmBgYHtyfQ0KIyBQcm9iaXQgbW9kZWwgd2l0aCBzdGFydGVyIHBsYXllcnMNCnByb2JpdF9zdGFydGVyIDwtIGdsbShjb252ZXJzaW9uIH4gLiwgZGF0YSA9IHN0YXJ0ZXJfZGF0YSwgZmFtaWx5ID0gYmlub21pYWwobGluayA9ICJwcm9iaXQiKSkNCmBgYA0KDQpgYGB7cn0NCiMgR2V0IEhDMC1hZGp1c3RlZCB6LXZhbHVlcyBhbmQgcC12YWx1ZXMgZm9yIHN0YXJ0ZXIgcHJvYml0DQpyb2J1c3RfcHJvYml0X3N0YXJ0ZXIgPC0gY29lZnRlc3QocHJvYml0X3N0YXJ0ZXIsIHZjb3YgPSB2Y292SEMocHJvYml0X3N0YXJ0ZXIsIHR5cGUgPSAiSEMwIikpDQp6X3N0YXRzX3N0YXJ0ZXIgPC0gcm9idXN0X3Byb2JpdF9zdGFydGVyWywgInogdmFsdWUiXQ0KcF92YWx1ZXNfc3RhcnRlciA8LSByb2J1c3RfcHJvYml0X3N0YXJ0ZXJbLCAiUHIoPnx6fCkiXQ0KDQojIFByaW50IGhlYWRlciAobm90ZSAiei12YWx1ZSIgaW5zdGVhZCBvZiAidC12YWx1ZSIpDQpjYXQoc3ByaW50ZigiXG5cbiUtKnMgICUxMHMgICUxMHMgICU0c1xuIiwgbmFtZV93aWR0aCwgIlN0YXJ0ZXIgUGxheWVycyBQcm9iaXQgVmFyaWFibGUiLCAiei12YWx1ZSIsICJwLXZhbHVlIiwgInNpZyIpKQ0KY2F0KHNwcmludGYoIiUtKnMgICUxMHMgICUxMHMgICU0c1xuIiwgbmFtZV93aWR0aCwgIi0tLS0tLS0tLS0tLS0tLSIsICItLS0tLS0tIiwgIi0tLS0tLS0iLCAiLS0tLSIpKQ0KZm9yIChpIGluIDE6bGVuZ3RoKHpfc3RhdHNfc3RhcnRlcikpIHsNCiAgICB2YXJfbmFtZSA8LSByb3duYW1lcyhyb2J1c3RfcHJvYml0X3N0YXJ0ZXIpW2ldDQogICAgaWYgKG5jaGFyKHZhcl9uYW1lKSA+IG5hbWVfd2lkdGgpIHsNCiAgICAgICAgdmFyX25hbWUgPC0gcGFzdGUwKHN1YnN0cih2YXJfbmFtZSwgMSwgbmFtZV93aWR0aC0zKSwgIi4uLiIpDQogICAgfQ0KICAgIGNhdChzcHJpbnRmKCIlLSpzICAlMTAuNGYgICUxMC40ZiAgJTRzXG4iLCANCiAgICAgICAgICAgICAgICBuYW1lX3dpZHRoLCB2YXJfbmFtZSwgDQogICAgICAgICAgICAgICAgel9zdGF0c19zdGFydGVyW2ldLCBwX3ZhbHVlc19zdGFydGVyW2ldLA0KICAgICAgICAgICAgICAgIGdldF9zdGFycyhwX3ZhbHVlc19zdGFydGVyW2ldKSkpDQp9DQpjYXQoIlxuU2lnbmlmaWNhbmNlIGNvZGVzOiAwICcqKionIDAuMDEgJyoqJyAwLjA1ICcqJyAwLjEgJy4nIDAuMTUiKQ0KYGBgDQoNCg0KYGBge3J9DQojIE1vZGVsIGNvbXBhcmlzb24gc3VtbWFyeQ0KY2F0KCJcblxuLS0tIE1vZGVsIENvbXBhcmlzb24gU3VtbWFyeSAtLS1cbiIpDQpjYXQoIk9MUyBSZWd1bGFyIFBsYXllcnMgUi1zcXVhcmVkOiIsIHJvdW5kKHN1bW1hcnkob2xzX3JlZ3VsYXIpJHIuc3F1YXJlZCwgNCksICJcbiIpDQpjYXQoIk9MUyBTdGFydGVyIFBsYXllcnMgUi1zcXVhcmVkOiIsIHJvdW5kKHN1bW1hcnkob2xzX3N0YXJ0ZXIpJHIuc3F1YXJlZCwgNCksICJcbiIpDQpjYXQoIk9MUyBSZWd1bGFyIFBsYXllcnMgQWRqIFItc3F1YXJlZDoiLCByb3VuZChzdW1tYXJ5KG9sc19yZWd1bGFyKSRhZGouci5zcXVhcmVkLCA0KSwgIlxuIikNCmNhdCgiT0xTIFN0YXJ0ZXIgUGxheWVycyBBZGogUi1zcXVhcmVkOiIsIHJvdW5kKHN1bW1hcnkob2xzX3N0YXJ0ZXIpJGFkai5yLnNxdWFyZWQsIDQpLCAiXG5cbiIpDQoNCmNhdCgiUHJvYml0IFJlZ3VsYXIgUGxheWVycyBBSUM6Iiwgcm91bmQocHJvYml0X3JlZ3VsYXIkYWljLCAyKSwgIlxuIikNCmNhdCgiUHJvYml0IFN0YXJ0ZXIgUGxheWVycyBBSUM6Iiwgcm91bmQocHJvYml0X3N0YXJ0ZXIkYWljLCAyKSwgIlxuIikNCmNhdCgiUHJvYml0IFJlZ3VsYXIgUGxheWVycyBNY0ZhZGRlbidzIFBzZXVkbyBSwrI6Iiwgcm91bmQoMSAtIHByb2JpdF9yZWd1bGFyJGRldmlhbmNlL3Byb2JpdF9yZWd1bGFyJG51bGwuZGV2aWFuY2UsIDQpLCAiXG4iKQ0KY2F0KCJQcm9iaXQgU3RhcnRlciBQbGF5ZXJzIE1jRmFkZGVuJ3MgUHNldWRvIFLCsjoiLCByb3VuZCgxIC0gcHJvYml0X3N0YXJ0ZXIkZGV2aWFuY2UvcHJvYml0X3N0YXJ0ZXIkbnVsbC5kZXZpYW5jZSwgNCksICJcbiIpDQpgYGANCg0KDQpgYGB7cn0NCiMgRnVuY3Rpb24gdG8gZ2V0IHRvcCBjb2VmZmljaWVudHMgYnkgYWJzb2x1dGUgdmFsdWUNCmdldF90b3BfY29lZmZpY2llbnRzIDwtIGZ1bmN0aW9uKG1vZGVsX3Jlc3VsdHMsIG4gPSAxMCkgew0KICBjb2VmcyA8LSBtb2RlbF9yZXN1bHRzWywgIkVzdGltYXRlIl0NCiAgIyBSZW1vdmUgaW50ZXJjZXB0DQogIGNvZWZzIDwtIGNvZWZzW25hbWVzKGNvZWZzKSAhPSAiKEludGVyY2VwdCkiXQ0KICAjIFNvcnQgYnkgYWJzb2x1dGUgdmFsdWUNCiAgc29ydGVkX2luZGljZXMgPC0gb3JkZXIoYWJzKGNvZWZzKSwgZGVjcmVhc2luZyA9IFRSVUUpDQogIHRvcF9jb2VmcyA8LSBjb2Vmc1tzb3J0ZWRfaW5kaWNlc1sxOm1pbihuLCBsZW5ndGgoc29ydGVkX2luZGljZXMpKV1dDQogIHJldHVybih0b3BfY29lZnMpDQp9DQoNCiMgRGlzcGxheSB0b3AgY29lZmZpY2llbnRzIGZvciBlYWNoIG1vZGVsDQpjYXQoIlxuXG5Ub3AgMTAgSW5mbHVlbnRpYWwgVmFyaWFibGVzIGJ5IEFic29sdXRlIENvZWZmaWNpZW50IFZhbHVlXG4iKQ0KDQpjYXQoIlxuT0xTIFJlZ3VsYXIgUGxheWVyczpcbiIpDQpwcmludChnZXRfdG9wX2NvZWZmaWNpZW50cyhyb2J1c3RfcmVndWxhcl90ZXN0KSkNCg0KY2F0KCJcbk9MUyBTdGFydGVyIFBsYXllcnM6XG4iKQ0KcHJpbnQoZ2V0X3RvcF9jb2VmZmljaWVudHMocm9idXN0X3N0YXJ0ZXJfdGVzdCkpDQoNCmNhdCgiXG5Qcm9iaXQgUmVndWxhciBQbGF5ZXJzOlxuIikNCnByaW50KGdldF90b3BfY29lZmZpY2llbnRzKHJvYnVzdF9wcm9iaXRfcmVndWxhcikpDQoNCmNhdCgiXG5Qcm9iaXQgU3RhcnRlciBQbGF5ZXJzOlxuIikNCnByaW50KGdldF90b3BfY29lZmZpY2llbnRzKHJvYnVzdF9wcm9iaXRfc3RhcnRlcikpDQpgYGA=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("thirddown.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
