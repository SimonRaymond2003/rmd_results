<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Third Down Analysis with Regular and Starter Players</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">4th Downs in the NFL</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="heckman.html">Heckman Selection</a>
</li>
<li>
  <a href="xgboost.html">XGBoost Prediction</a>
</li>
<li>
  <a href="attendance_binary.html">Attendance Impact Binary</a>
</li>
<li>
  <a href="thirddown.html">Third Down Analysis</a>
</li>
<li>
  <a href="attempt_ols.html">Attempts OLS</a>
</li>
<li>
  <a href="robustness_checks.html">Robustness Checks</a>
</li>
<li>
  <a href="Writing.html">Writing</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Third Down Analysis with Regular and
Starter Players</h1>

</div>


<pre class="r"><code>library(data.table)             
ctd1 &lt;- fread(&quot;predict_ctd1.csv.gz&quot;)                        </code></pre>
<pre class="r"><code>#kill my_id
ctd1$my_id &lt;- NULL
ctd1[, year2017_team_ARI := NULL]</code></pre>
<pre class="r"><code># Identify player columns
all_cols &lt;- colnames(ctd1)

# Create regex patterns to identify regular and starter player variables
offense_player_pattern &lt;- &quot;^offense_player_\\d+_&quot;
defense_player_pattern &lt;- &quot;^defense_player_\\d+_&quot;
starter_offense_pattern &lt;- &quot;^starter_offense_player_\\d+_&quot;
starter_defense_pattern &lt;- &quot;^starter_defense_player_\\d+_&quot;

# Get columns for each type
offense_player_cols &lt;- grep(offense_player_pattern, all_cols, value = TRUE)
defense_player_cols &lt;- grep(defense_player_pattern, all_cols, value = TRUE)
starter_offense_cols &lt;- grep(starter_offense_pattern, all_cols, value = TRUE)
starter_defense_cols &lt;- grep(starter_defense_pattern, all_cols, value = TRUE)

# All player columns
regular_player_cols &lt;- c(offense_player_cols, defense_player_cols)
starter_player_cols &lt;- c(starter_offense_cols, starter_defense_cols)
all_player_cols &lt;- c(regular_player_cols, starter_player_cols)

# Non-player columns (common to both datasets)
common_cols &lt;- setdiff(all_cols, all_player_cols)

# Create two datasets
regular_data &lt;- ctd1[, c(common_cols, regular_player_cols), with = FALSE]
starter_data &lt;- ctd1[, c(common_cols, starter_player_cols), with = FALSE]</code></pre>
<pre class="r"><code># Then run OLS with regular players
ols_regular &lt;- lm(conversion ~ ., data = regular_data)</code></pre>
<pre class="r"><code>library(sandwich)
library(lmtest)
# Get HC0-adjusted t-values and p-values
robust_regular_test &lt;- coeftest(ols_regular, vcov = vcovHC(ols_regular, type = &quot;HC0&quot;))
t_stats_regular &lt;- robust_regular_test[, &quot;t value&quot;]
p_values_regular &lt;- robust_regular_test[, &quot;Pr(&gt;|t|)&quot;]
# Function to add significance stars
get_stars &lt;- function(p) {
    if (p &lt;= 0.01) return(&quot;***&quot;)
    if (p &lt;= 0.05) return(&quot;**&quot;)
    if (p &lt;= 0.1) return(&quot;*&quot;)
    if (p &lt;= 0.15) return(&quot;.&quot;)
    return(&quot;&quot;)
}
# Maximum width for variable names
name_width &lt;- 60
# Print header with alignment
cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;Regular Players OLS Variable&quot;, &quot;t-value&quot;, &quot;p-value&quot;, &quot;sig&quot;))</code></pre>
<pre><code>## Regular Players OLS Variable                                     t-value     p-value   sig</code></pre>
<pre class="r"><code>cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;---------&quot;, &quot;-------&quot;, &quot;-------&quot;, &quot;----&quot;))</code></pre>
<pre><code>## ---------                                                        -------     -------  ----</code></pre>
<pre class="r"><code># Loop through and print values
for (i in 1:length(t_stats_regular)) {
    var_name &lt;- rownames(robust_regular_test)[i]
    # Truncate name if too long
    if (nchar(var_name) &gt; name_width) {
        var_name &lt;- paste0(substr(var_name, 1, name_width-3), &quot;...&quot;)
    }
    cat(sprintf(&quot;%-*s  %10.4f  %10.4f  %4s\n&quot;, 
                name_width, var_name, 
                t_stats_regular[i], p_values_regular[i],
                get_stars(p_values_regular[i])))
}</code></pre>
<pre><code>## (Intercept)                                                       6.6371      0.0000   ***
## ydstogo                                                         -70.5560      0.0000   ***
## yardline_100                                                      7.9051      0.0000   ***
## posteam_timeouts_remaining                                        2.5954      0.0095   ***
## defteam_timeouts_remaining                                        4.6558      0.0000   ***
## rush_attempt                                                     16.1211      0.0000   ***
## week                                                             -2.2362      0.0253    **
## temp                                                              0.1367      0.8913      
## wind                                                             -0.9710      0.3316      
## vegas_wp                                                         -1.6957      0.0899     *
## total_line                                                        1.6977      0.0896     *
## p_player_26_punting_grades_grades_punter_12w                     -0.8283      0.4075      
## p_player_26_punting_grades_grades_punter_2w                      -1.3389      0.1806      
## k_player_25_field_goals_grades_grades_fgep_kicker_12w             2.2527      0.0243    **
## k_player_25_field_goals_grades_grades_fgep_kicker_2w              1.1231      0.2614      
## score_diff                                                       -2.3294      0.0198    **
## down4_pct                                                        -0.5707      0.5682      
## prep_days                                                        -1.1568      0.2474      
## overall_win_pct                                                   2.1608      0.0307    **
## team_win_pct                                                      5.4687      0.0000   ***
## prev_win_pct                                                      1.1543      0.2484      
## prev_shotgun_rate                                                -0.5430      0.5871      
## prev_singleback_rate                                             -0.9812      0.3265      
## prev_empty_rate                                                  -0.2136      0.8308      
## prev_iform_rate                                                  -0.0020      0.9984      
## prev_shotgun_success                                              1.3957      0.1628      
## prev_singleback_success                                           0.0773      0.9384      
## prev_empty_success                                               -0.0017      0.9986      
## prev_iform_success                                               -0.4043      0.6860      
## prev_stop_rate_run                                                0.3644      0.7156      
## prev_stop_rate_pass                                              -1.8499      0.0643     *
## shotgun_rate                                                      1.2307      0.2184      
## singleback_rate                                                   0.2704      0.7868      
## empty_rate                                                        0.9720      0.3310      
## iform_rate                                                        0.5404      0.5889      
## shotgun_success                                                  -3.0847      0.0020   ***
## singleback_success                                                0.7931      0.4277      
## empty_success                                                    -0.5616      0.5744      
## iform_success                                                    -0.6410      0.5215      
## def_stop_rate_run                                                -0.7949      0.4267      
## def_stop_rate_pass                                                0.2045      0.8380      
## avg_pass_rushers                                                 -0.6444      0.5193      
## avg_box_defenders                                                -0.0203      0.9838      
## cover0_rate                                                      -3.5204      0.0004   ***
## cover1_rate                                                      -1.0876      0.2768      
## cover2_rate                                                      -1.1855      0.2358      
## cover3_rate                                                      -1.5353      0.1247     .
## cover4_rate                                                      -2.0041      0.0451    **
## cover6_rate                                                      -1.2481      0.2120      
## two_man_rate                                                     -0.1921      0.8477      
## prevent_rate                                                     -0.5224      0.6014      
## home_attendance                                                  -1.4279      0.1533      
## roof_outdoors                                                    -0.8735      0.3824      
## posteam_type_home                                                 4.2884      0.0000   ***
## offense_formation_EMPTY                                          -0.5471      0.5843      
## offense_formation_SHOTGUN                                        -1.1042      0.2695      
## offense_formation_SINGLEBACK                                     -0.2009      0.8408      
## offense_formation_I_FORM                                          0.9583      0.3379      
## year2017_team_BUF                                                -0.1601      0.8728      
## year2017_team_CHI                                                -0.1590      0.8737      
## year2017_team_CLE                                                 0.6739      0.5004      
## year2017_team_DAL                                                -0.0654      0.9479      
## year2017_team_DET                                                 0.0666      0.9469      
## year2017_team_GB                                                 -0.0351      0.9720      
## year2017_team_HOU                                                -0.5730      0.5666      
## year2017_team_MIA                                                 0.4452      0.6562      
## year2017_team_MIN                                                -1.1315      0.2578      
## year2017_team_NE                                                 -0.4535      0.6502      
## year2017_team_NYJ                                                -0.1804      0.8568      
## year2017_team_PHI                                                 0.1891      0.8500      
## year2017_team_SF                                                 -0.2384      0.8116      
## year2017_team_TEN                                                -0.3050      0.7604      
## year2017_team_WAS                                                -1.0069      0.3140      
## year2017_team_ATL                                                -0.8542      0.3930      
## year2017_team_BAL                                                -0.3250      0.7452      
## year2017_team_CIN                                                -0.2602      0.7947      
## year2017_team_DEN                                                -0.2030      0.8391      
## year2017_team_KC                                                  0.4857      0.6272      
## year2017_team_LA                                                  0.4297      0.6674      
## year2017_team_NO                                                  0.1232      0.9020      
## year2017_team_NYG                                                -1.2098      0.2264      
## year2017_team_OAK                                                -0.8442      0.3985      
## year2017_team_PIT                                                -0.8354      0.4035      
## year2017_team_SEA                                                 0.0791      0.9369      
## year2017_team_TB                                                  1.8231      0.0683     *
## year2017_team_CAR                                                -0.5865      0.5576      
## year2017_team_IND                                                 0.1553      0.8766      
## year2017_team_JAX                                                -0.5687      0.5695      
## year2017_team_LAC                                                -0.3333      0.7389      
## year2018_team_ARI                                                 0.7819      0.4343      
## year2018_team_BAL                                                 0.8052      0.4207      
## year2018_team_CAR                                                 1.5508      0.1210     .
## year2018_team_CLE                                                 0.2576      0.7968      
## year2018_team_DET                                                 0.4893      0.6246      
## year2018_team_HOU                                                 1.7160      0.0862     *
## year2018_team_IND                                                 1.2050      0.2282      
## year2018_team_KC                                                  1.4866      0.1371     .
## year2018_team_LAC                                                 1.3344      0.1821      
## year2018_team_MIA                                                 1.0153      0.3100      
## year2018_team_MIN                                                 0.0891      0.9290      
## year2018_team_NE                                                  0.6897      0.4904      
## year2018_team_NYG                                                 1.4747      0.1403     .
## year2018_team_OAK                                                 1.9168      0.0553     *
## year2018_team_PHI                                                 1.4506      0.1469     .
## year2018_team_SEA                                                 1.4341      0.1516      
## year2018_team_BUF                                                 0.1897      0.8496      
## year2018_team_CHI                                                 0.5071      0.6121      
## year2018_team_CIN                                                 1.9471      0.0515     *
## year2018_team_DAL                                                 1.2920      0.1964      
## year2018_team_DEN                                                 1.1481      0.2509      
## year2018_team_GB                                                  0.6001      0.5484      
## year2018_team_NO                                                  1.4043      0.1602      
## year2018_team_NYJ                                                 0.6592      0.5098      
## year2018_team_PIT                                                 1.6158      0.1062     .
## year2018_team_SF                                                  1.2739      0.2027      
## year2018_team_TEN                                                 1.4103      0.1585      
## year2018_team_TB                                                  2.1794      0.0293    **
## year2018_team_ATL                                                 1.8014      0.0717     *
## year2018_team_JAX                                                 1.1751      0.2399      
## year2018_team_LA                                                  0.6623      0.5078      
## year2018_team_WAS                                                 2.2931      0.0218    **
## year2019_team_ARI                                                 1.6525      0.0984     *
## year2019_team_BUF                                                 1.0196      0.3079      
## year2019_team_CHI                                                 1.3627      0.1730      
## year2019_team_CLE                                                 1.2095      0.2265      
## year2019_team_DAL                                                 1.1933      0.2328      
## year2019_team_IND                                                 1.4586      0.1447     .
## year2019_team_JAX                                                 0.9262      0.3544      
## year2019_team_KC                                                  0.6199      0.5353      
## year2019_team_LAC                                                 1.9631      0.0496    **
## year2019_team_MIN                                                 2.2877      0.0222    **
## year2019_team_NE                                                  0.8164      0.4142      
## year2019_team_NO                                                  0.1530      0.8784      
## year2019_team_PHI                                                 1.9067      0.0566     *
## year2019_team_SEA                                                 1.1105      0.2668      
## year2019_team_SF                                                  1.5072      0.1318     .
## year2019_team_TB                                                  1.1529      0.2489      
## year2019_team_ATL                                                 2.2191      0.0265    **
## year2019_team_BAL                                                 1.5405      0.1234     .
## year2019_team_CAR                                                 0.8295      0.4068      
## year2019_team_CIN                                                 1.3404      0.1801      
## year2019_team_DEN                                                 0.4016      0.6880      
## year2019_team_DET                                                 0.8188      0.4129      
## year2019_team_HOU                                                 1.4589      0.1446     .
## year2019_team_LA                                                  0.6029      0.5466      
## year2019_team_MIA                                                 1.0361      0.3001      
## year2019_team_NYG                                                 1.4216      0.1551      
## year2019_team_NYJ                                                 1.0950      0.2735      
## year2019_team_OAK                                                 1.2281      0.2194      
## year2019_team_PIT                                                 0.6121      0.5405      
## year2019_team_TEN                                                 0.7751      0.4383      
## year2019_team_WAS                                                 0.4755      0.6345      
## year2019_team_GB                                                  0.8605      0.3895      
## year2020_team_ATL                                                 1.2346      0.2170      
## year2020_team_BAL                                                 0.0326      0.9740      
## year2020_team_BUF                                                 1.8298      0.0673     *
## year2020_team_CAR                                                 2.4164      0.0157    **
## year2020_team_CIN                                                 0.2418      0.8090      
## year2020_team_DEN                                                 1.4693      0.1418     .
## year2020_team_DET                                                 1.5018      0.1332     .
## year2020_team_JAX                                                 1.2408      0.2147      
## year2020_team_KC                                                  1.0882      0.2765      
## year2020_team_LA                                                  1.5030      0.1329     .
## year2020_team_MIN                                                 0.2411      0.8094      
## year2020_team_NE                                                  0.7926      0.4280      
## year2020_team_NO                                                  0.8291      0.4071      
## year2020_team_NYG                                                 0.6165      0.5376      
## year2020_team_SF                                                  0.6168      0.5374      
## year2020_team_WAS                                                 1.0967      0.2728      
## year2020_team_CHI                                                 0.1635      0.8701      
## year2020_team_DAL                                                 0.7738      0.4390      
## year2020_team_GB                                                  0.7864      0.4317      
## year2020_team_HOU                                                 1.6711      0.0947     *
## year2020_team_LV                                                  1.4525      0.1464     .
## year2020_team_MIA                                                 0.1167      0.9071      
## year2020_team_NYJ                                                 0.1131      0.9099      
## year2020_team_TB                                                  0.6932      0.4882      
## year2020_team_TEN                                                 1.1775      0.2390      
## year2020_team_ARI                                                 1.2461      0.2127      
## year2020_team_CLE                                                 1.4994      0.1338     .
## year2020_team_IND                                                 1.2876      0.1979      
## year2020_team_LAC                                                 0.8190      0.4128      
## year2020_team_PHI                                                 1.0951      0.2735      
## year2020_team_SEA                                                 0.8782      0.3798      
## year2020_team_PIT                                                 0.8143      0.4155      
## year2021_team_ATL                                                 1.7175      0.0859     *
## year2021_team_BUF                                                 0.9761      0.3290      
## year2021_team_CIN                                                 1.9723      0.0486    **
## year2021_team_DAL                                                 1.1312      0.2580      
## year2021_team_DEN                                                 1.1183      0.2634      
## year2021_team_DET                                                 1.1342      0.2567      
## year2021_team_HOU                                                 1.4262      0.1538      
## year2021_team_KC                                                  2.4652      0.0137    **
## year2021_team_LA                                                  0.1505      0.8804      
## year2021_team_LV                                                  0.8548      0.3927      
## year2021_team_MIN                                                 0.1103      0.9122      
## year2021_team_NE                                                  0.4077      0.6835      
## year2021_team_NO                                                  0.9358      0.3494      
## year2021_team_NYG                                                 1.3347      0.1820      
## year2021_team_SF                                                  2.1019      0.0356    **
## year2021_team_TEN                                                 0.5797      0.5621      
## year2021_team_ARI                                                 1.1702      0.2419      
## year2021_team_BAL                                                 0.1801      0.8571      
## year2021_team_CAR                                                 0.9563      0.3389      
## year2021_team_CHI                                                 1.1546      0.2483      
## year2021_team_GB                                                  1.1363      0.2558      
## year2021_team_IND                                                 1.1096      0.2672      
## year2021_team_LAC                                                 2.4638      0.0138    **
## year2021_team_MIA                                                 1.4323      0.1521      
## year2021_team_NYJ                                                 2.0313      0.0422    **
## year2021_team_PHI                                                 1.1359      0.2560      
## year2021_team_SEA                                                 0.9058      0.3650      
## year2021_team_TB                                                  2.5080      0.0121    **
## year2021_team_WAS                                                 1.8082      0.0706     *
## year2021_team_CLE                                                 0.8130      0.4162      
## year2021_team_JAX                                                 1.1137      0.2654      
## year2021_team_PIT                                                 1.1590      0.2465      
## year2022_team_ARI                                                 0.9313      0.3517      
## year2022_team_ATL                                                 1.9606      0.0499    **
## year2022_team_CAR                                                 0.5524      0.5807      
## year2022_team_CHI                                                 2.2559      0.0241    **
## year2022_team_CIN                                                 2.3832      0.0172    **
## year2022_team_HOU                                                 1.0162      0.3096      
## year2022_team_IND                                                 0.2417      0.8090      
## year2022_team_LAC                                                 0.9227      0.3562      
## year2022_team_MIA                                                 2.1770      0.0295    **
## year2022_team_MIN                                                 1.4170      0.1565      
## year2022_team_NE                                                  1.4669      0.1424     .
## year2022_team_NYJ                                                 1.1696      0.2422      
## year2022_team_SEA                                                 1.2567      0.2089      
## year2022_team_TB                                                  0.3682      0.7127      
## year2022_team_TEN                                                 0.6384      0.5232      
## year2022_team_WAS                                                 0.8041      0.4213      
## year2022_team_BAL                                                 1.1038      0.2697      
## year2022_team_BUF                                                 1.4552      0.1456     .
## year2022_team_DAL                                                 0.4946      0.6209      
## year2022_team_DET                                                 0.4056      0.6851      
## year2022_team_GB                                                  0.8881      0.3745      
## year2022_team_JAX                                                 1.6081      0.1078     .
## year2022_team_KC                                                  2.8721      0.0041   ***
## year2022_team_LA                                                  0.9260      0.3545      
## year2022_team_LV                                                  1.4216      0.1552      
## year2022_team_NO                                                  1.6365      0.1017     .
## year2022_team_PHI                                                 1.5842      0.1132     .
## year2022_team_PIT                                                 1.3604      0.1737      
## year2022_team_SF                                                  1.4887      0.1366     .
## year2022_team_CLE                                                 0.9069      0.3645      
## year2022_team_DEN                                                -0.0949      0.9244      
## year2022_team_NYG                                                 1.0668      0.2861      
## year2023_team_BAL                                                 0.8896      0.3737      
## year2023_team_CHI                                                 2.5733      0.0101    **
## year2023_team_CLE                                                 0.8018      0.4227      
## year2023_team_GB                                                  0.1810      0.8564      
## year2023_team_IND                                                 0.4360      0.6629      
## year2023_team_KC                                                  2.0473      0.0406    **
## year2023_team_LAC                                                 0.9037      0.3662      
## year2023_team_LV                                                  0.1298      0.8967      
## year2023_team_MIA                                                 1.7220      0.0851     *
## year2023_team_MIN                                                 1.4915      0.1358     .
## year2023_team_NO                                                  0.7667      0.4433      
## year2023_team_NYG                                                 1.3312      0.1831      
## year2023_team_NYJ                                                -0.3182      0.7503      
## year2023_team_SEA                                                 0.9632      0.3355      
## year2023_team_SF                                                  1.8052      0.0710     *
## year2023_team_WAS                                                 1.5446      0.1225     .
## year2023_team_ATL                                                 0.7764      0.4375      
## year2023_team_BUF                                                 2.5589      0.0105    **
## year2023_team_CAR                                                 1.1590      0.2465      
## year2023_team_DAL                                                 1.9581      0.0502     *
## year2023_team_DEN                                                 0.4353      0.6633      
## year2023_team_HOU                                                 1.1693      0.2423      
## year2023_team_LA                                                  0.8872      0.3750      
## year2023_team_NE                                                  1.7203      0.0854     *
## year2023_team_PHI                                                 2.6647      0.0077   ***
## year2023_team_PIT                                                 0.8249      0.4094      
## year2023_team_TEN                                                 0.7226      0.4699      
## year2023_team_ARI                                                 2.0178      0.0436    **
## year2023_team_CIN                                                 1.0216      0.3070      
## year2023_team_DET                                                 1.1775      0.2390      
## year2023_team_TB                                                  1.2536      0.2100      
## year2023_team_JAX                                                 0.5934      0.5529      
## is_first_half                                                     3.9973      0.0001   ***
## time_in_half                                                     -1.6594      0.0970     *
## offense_player_1_rushing_grades_grades_run_12w                   -0.0865      0.9311      
## offense_player_1_passing_depth_short_grades_pass_12w              2.4815      0.0131    **
## offense_player_4_rushing_grades_ypa_12w                           0.7429      0.4575      
## offense_player_8_receiving_depth_short_caught_percent_12w        -1.5390      0.1238     .
## offense_player_8_run_blocking_gap_grades_run_block_12w           -0.4493      0.6532      
## offense_player_9_receiving_depth_short_caught_percent_12w        -0.7232      0.4696      
## offense_player_9_run_blocking_gap_grades_run_block_12w            3.3150      0.0009   ***
## offense_player_10_receiving_depth_short_caught_percent_12w       -0.4832      0.6289      
## offense_player_10_run_blocking_gap_grades_run_block_12w           0.7878      0.4308      
## offense_player_14_blocking_grades_grades_run_block_2w             1.2264      0.2200      
## offense_player_17_blocking_grades_grades_offense_12w              0.0111      0.9911      
## offense_player_18_blocking_grades_grades_offense_12w             -1.2905      0.1969      
## offense_player_19_blocking_grades_grades_offense_12w              1.5661      0.1173     .
## offense_player_20_blocking_grades_grades_offense_12w              0.9554      0.3394      
## offense_player_21_blocking_grades_grades_offense_12w              0.8240      0.4099      
## defense_player_1_pass_rush_grades_grades_pass_rush_defens...     -0.9192      0.3580      
## defense_player_1_run_defense_grades_run_stop_opp_12w              1.1622      0.2452      
## defense_player_2_pass_rush_grades_grades_pass_rush_defens...     -0.3536      0.7237      
## defense_player_2_run_defense_grades_run_stop_opp_12w             -0.2629      0.7926      
## defense_player_3_pass_rush_grades_grades_pass_rush_defens...      0.7739      0.4390      
## defense_player_3_run_defense_grades_run_stop_opp_12w             -2.1797      0.0293    **
## defense_player_4_pass_rush_grades_grades_pass_rush_defens...     -1.1453      0.2521      
## defense_player_4_run_defense_grades_run_stop_opp_12w              0.1727      0.8629      
## defense_player_9_pass_rush_grades_grades_pass_rush_defens...     -1.0257      0.3050      
## defense_player_9_run_defense_grades_run_stop_opp_12w              0.0829      0.9339      
## defense_player_9_coverage_grades_grades_coverage_defense_12w     -0.7014      0.4831      
## defense_player_10_pass_rush_grades_grades_pass_rush_defen...     -3.2815      0.0010   ***
## defense_player_10_run_defense_grades_run_stop_opp_12w             0.2981      0.7656      
## defense_player_10_coverage_grades_grades_coverage_defense...      2.3171      0.0205    **
## defense_player_11_pass_rush_grades_grades_pass_rush_defen...      0.0757      0.9396      
## defense_player_11_run_defense_grades_run_stop_opp_12w            -0.7357      0.4619      
## defense_player_11_coverage_grades_grades_coverage_defense...      0.8552      0.3924      
## defense_player_12_pass_rush_grades_grades_pass_rush_defen...     -0.6009      0.5479      
## defense_player_12_run_defense_grades_run_stop_opp_12w             0.7093      0.4782      
## defense_player_12_coverage_grades_grades_coverage_defense...     -0.4842      0.6282      
## defense_player_15_coverage_grades_grades_defense_12w             -2.4116      0.0159    **
## defense_player_15_defensive_grades_grades_defense_penalty...      0.3208      0.7484      
## defense_player_16_coverage_grades_grades_defense_12w             -1.4752      0.1402     .
## defense_player_16_defensive_grades_grades_defense_penalty...      0.6973      0.4856      
## defense_player_17_coverage_grades_grades_defense_12w             -0.0610      0.9513      
## defense_player_17_defensive_grades_grades_defense_penalty...     -0.7126      0.4761      
## defense_player_20_coverage_schemes_zone_grades_coverage_d...     -0.5170      0.6052      
## defense_player_20_coverage_grades_grades_defense_penalty_12w     -0.9407      0.3469      
## defense_player_21_coverage_schemes_zone_grades_coverage_d...      0.0998      0.9205      
## defense_player_21_coverage_grades_grades_defense_penalty_12w     -0.3861      0.6994      
## defense_player_22_coverage_schemes_zone_grades_coverage_d...     -0.6109      0.5413      
## defense_player_22_coverage_grades_grades_defense_penalty_12w      0.3434      0.7313</code></pre>
<pre class="r"><code>cat(&quot;\nSignificance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15&quot;)</code></pre>
<pre><code>## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</code></pre>
<pre class="r"><code># Load the car package which has the vif function
library(car)
# Calculate VIFs for the model with regular players
vifs_regular &lt;- vif(ols_regular)
# Filter to show only VIFs over 5
high_vifs_regular &lt;- vifs_regular[vifs_regular &gt; 5]
if(length(high_vifs_regular) &gt; 0) {
  cat(&quot;\nRegular Players: Variables with VIF &gt; 5:\n&quot;)
  print(high_vifs_regular)
} else {
  cat(&quot;\nNo variables with VIF &gt; 5 found in the Regular Players model\n&quot;)
}</code></pre>
<pre><code>## 
## Regular Players: Variables with VIF &gt; 5:
##                                                            vegas_wp 
##                                                            5.663140 
##                                                   prev_shotgun_rate 
##                                                            9.998132 
##                                                prev_singleback_rate 
##                                                            6.173586 
##                                                        shotgun_rate 
##                                                           16.445129 
##                                                          empty_rate 
##                                                           12.704981 
##                                                         cover1_rate 
##                                                            7.114898 
##                                                         cover3_rate 
##                                                            7.630314 
##                                                     home_attendance 
##                                                            8.024084 
##                                             offense_formation_EMPTY 
##                                                            7.097524 
##                                           offense_formation_SHOTGUN 
##                                                           10.020488 
##      defense_player_3_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                            6.027499 
##      defense_player_4_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                            6.413475 
##     defense_player_10_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                            6.508244 
##       defense_player_10_coverage_grades_grades_coverage_defense_12w 
##                                                            6.058853 
##     defense_player_11_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                           13.730136 
##       defense_player_11_coverage_grades_grades_coverage_defense_12w 
##                                                           12.934683 
##     defense_player_12_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                           15.576145 
##       defense_player_12_coverage_grades_grades_coverage_defense_12w 
##                                                           14.763297 
##                defense_player_17_coverage_grades_grades_defense_12w 
##                                                           13.750409 
##       defense_player_17_defensive_grades_grades_defense_penalty_12w 
##                                                           13.928157 
## defense_player_21_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                            7.985350 
##        defense_player_21_coverage_grades_grades_defense_penalty_12w 
##                                                            8.148701 
## defense_player_22_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                           43.328930 
##        defense_player_22_coverage_grades_grades_defense_penalty_12w 
##                                                           43.518933</code></pre>
<pre class="r"><code>library(caret)
# Create the model matrix for regular data (excluding the response variable)
X_regular &lt;- model.matrix(~ . - conversion - 1, data = regular_data)  # -1 removes intercept
# Find columns causing linear dependencies
lin_combos_regular &lt;- findLinearCombos(X_regular)
# Remove problematic columns from the dataset
if (!is.null(lin_combos_regular$remove)) {
  cols_to_remove &lt;- colnames(X_regular)[lin_combos_regular$remove]
  cat(&quot;Removed from regular data:&quot;, paste(cols_to_remove, collapse=&quot;, &quot;), &quot;\n&quot;)
  regular_data &lt;- regular_data[, (cols_to_remove) := NULL, with = FALSE]
}</code></pre>
<pre class="r"><code># Then run OLS with starter players
ols_starter &lt;- lm(conversion ~ ., data = starter_data)</code></pre>
<pre class="r"><code># Get HC0-adjusted t-values and p-values
robust_starter_test &lt;- coeftest(ols_starter, vcov = vcovHC(ols_starter, type = &quot;HC0&quot;))
t_stats_starter &lt;- robust_starter_test[, &quot;t value&quot;]
p_values_starter &lt;- robust_starter_test[, &quot;Pr(&gt;|t|)&quot;]

# Print header with alignment
cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;Starter Players OLS Variable&quot;, &quot;t-value&quot;, &quot;p-value&quot;, &quot;sig&quot;))</code></pre>
<pre><code>## Starter Players OLS Variable                                     t-value     p-value   sig</code></pre>
<pre class="r"><code>cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;---------&quot;, &quot;-------&quot;, &quot;-------&quot;, &quot;----&quot;))</code></pre>
<pre><code>## ---------                                                        -------     -------  ----</code></pre>
<pre class="r"><code># Loop through and print values
for (i in 1:length(t_stats_starter)) {
    var_name &lt;- rownames(robust_starter_test)[i]
    # Truncate name if too long
    if (nchar(var_name) &gt; name_width) {
        var_name &lt;- paste0(substr(var_name, 1, name_width-3), &quot;...&quot;)
    }
    cat(sprintf(&quot;%-*s  %10.4f  %10.4f  %4s\n&quot;, 
                name_width, var_name, 
                t_stats_starter[i], p_values_starter[i],
                get_stars(p_values_starter[i])))
}</code></pre>
<pre><code>## (Intercept)                                                       7.0426      0.0000   ***
## ydstogo                                                         -71.6723      0.0000   ***
## yardline_100                                                      7.9741      0.0000   ***
## posteam_timeouts_remaining                                        2.5091      0.0121    **
## defteam_timeouts_remaining                                        4.6542      0.0000   ***
## rush_attempt                                                     15.9726      0.0000   ***
## week                                                             -1.8002      0.0718     *
## temp                                                              0.2146      0.8301      
## wind                                                             -1.0901      0.2757      
## vegas_wp                                                         -0.7770      0.4371      
## total_line                                                        1.9770      0.0480    **
## p_player_26_punting_grades_grades_punter_12w                     -0.6249      0.5321      
## p_player_26_punting_grades_grades_punter_2w                      -1.5439      0.1226     .
## k_player_25_field_goals_grades_grades_fgep_kicker_12w             2.3711      0.0177    **
## k_player_25_field_goals_grades_grades_fgep_kicker_2w              1.0702      0.2845      
## score_diff                                                       -3.2112      0.0013   ***
## down4_pct                                                        -0.6021      0.5471      
## prep_days                                                        -0.5472      0.5843      
## overall_win_pct                                                   2.5127      0.0120    **
## team_win_pct                                                      5.5381      0.0000   ***
## prev_win_pct                                                      1.0456      0.2958      
## prev_shotgun_rate                                                -0.4632      0.6432      
## prev_singleback_rate                                             -0.9287      0.3531      
## prev_empty_rate                                                  -0.3287      0.7424      
## prev_iform_rate                                                  -0.2159      0.8290      
## prev_shotgun_success                                              1.5756      0.1151     .
## prev_singleback_success                                           0.0363      0.9710      
## prev_empty_success                                                0.0239      0.9810      
## prev_iform_success                                               -0.4148      0.6783      
## prev_stop_rate_run                                                0.5833      0.5597      
## prev_stop_rate_pass                                              -2.1496      0.0316    **
## shotgun_rate                                                      1.0490      0.2942      
## singleback_rate                                                   0.1007      0.9198      
## empty_rate                                                        0.7810      0.4348      
## iform_rate                                                        0.6681      0.5041      
## shotgun_success                                                  -2.9928      0.0028   ***
## singleback_success                                                1.1963      0.2316      
## empty_success                                                    -0.7528      0.4516      
## iform_success                                                    -0.9447      0.3448      
## def_stop_rate_run                                                -1.0537      0.2920      
## def_stop_rate_pass                                               -0.7309      0.4649      
## avg_pass_rushers                                                 -0.7793      0.4358      
## avg_box_defenders                                                -0.1651      0.8688      
## cover0_rate                                                      -3.1029      0.0019   ***
## cover1_rate                                                      -0.5821      0.5605      
## cover2_rate                                                      -1.1619      0.2453      
## cover3_rate                                                      -1.6477      0.0994     *
## cover4_rate                                                      -2.3180      0.0205    **
## cover6_rate                                                      -0.7788      0.4361      
## two_man_rate                                                      0.2085      0.8348      
## prevent_rate                                                     -0.5076      0.6118      
## home_attendance                                                  -1.5338      0.1251     .
## roof_outdoors                                                    -0.6898      0.4903      
## posteam_type_home                                                 3.8992      0.0001   ***
## offense_formation_EMPTY                                          -0.7105      0.4774      
## offense_formation_SHOTGUN                                        -1.2611      0.2073      
## offense_formation_SINGLEBACK                                     -0.7309      0.4648      
## offense_formation_I_FORM                                         -0.0865      0.9311      
## year2017_team_BUF                                                -0.2571      0.7971      
## year2017_team_CHI                                                -0.2786      0.7806      
## year2017_team_CLE                                                 0.5421      0.5877      
## year2017_team_DAL                                                -0.1830      0.8548      
## year2017_team_DET                                                -0.1138      0.9094      
## year2017_team_GB                                                  0.0475      0.9621      
## year2017_team_HOU                                                -0.6910      0.4896      
## year2017_team_MIA                                                 0.4188      0.6753      
## year2017_team_MIN                                                -1.2917      0.1965      
## year2017_team_NE                                                 -0.4222      0.6729      
## year2017_team_NYJ                                                -0.0314      0.9750      
## year2017_team_PHI                                                -0.0879      0.9300      
## year2017_team_SF                                                 -0.2193      0.8264      
## year2017_team_TEN                                                -0.5483      0.5835      
## year2017_team_WAS                                                -1.0916      0.2750      
## year2017_team_ATL                                                -0.7274      0.4670      
## year2017_team_BAL                                                -0.2299      0.8181      
## year2017_team_CIN                                                -0.3824      0.7022      
## year2017_team_DEN                                                -0.4316      0.6660      
## year2017_team_KC                                                  0.4675      0.6401      
## year2017_team_LA                                                  0.4411      0.6592      
## year2017_team_NO                                                  0.1085      0.9136      
## year2017_team_NYG                                                -1.0428      0.2971      
## year2017_team_OAK                                                -1.0217      0.3069      
## year2017_team_PIT                                                -0.8804      0.3786      
## year2017_team_SEA                                                -0.2355      0.8138      
## year2017_team_TB                                                  2.0277      0.0426    **
## year2017_team_CAR                                                -0.6582      0.5104      
## year2017_team_IND                                                 0.0445      0.9645      
## year2017_team_JAX                                                -0.8120      0.4168      
## year2017_team_LAC                                                -0.5403      0.5890      
## year2018_team_ARI                                                 0.6467      0.5178      
## year2018_team_BAL                                                 0.6257      0.5315      
## year2018_team_CAR                                                 1.4556      0.1455     .
## year2018_team_CLE                                                 0.0179      0.9857      
## year2018_team_DET                                                 0.3844      0.7007      
## year2018_team_HOU                                                 1.5514      0.1208     .
## year2018_team_IND                                                 0.9679      0.3331      
## year2018_team_KC                                                  1.1448      0.2523      
## year2018_team_LAC                                                 1.1458      0.2519      
## year2018_team_MIA                                                 0.8675      0.3857      
## year2018_team_MIN                                                -0.2608      0.7942      
## year2018_team_NE                                                  0.4788      0.6321      
## year2018_team_NYG                                                 1.5746      0.1154     .
## year2018_team_OAK                                                 1.4083      0.1590      
## year2018_team_PHI                                                 1.2552      0.2094      
## year2018_team_SEA                                                 1.2694      0.2043      
## year2018_team_BUF                                                 0.0284      0.9774      
## year2018_team_CHI                                                 0.2663      0.7900      
## year2018_team_CIN                                                 1.7482      0.0804     *
## year2018_team_DAL                                                 1.0935      0.2742      
## year2018_team_DEN                                                 1.1588      0.2465      
## year2018_team_GB                                                  0.2676      0.7890      
## year2018_team_NO                                                  1.2116      0.2257      
## year2018_team_NYJ                                                 0.3597      0.7191      
## year2018_team_PIT                                                 1.5184      0.1289     .
## year2018_team_SF                                                  1.1533      0.2488      
## year2018_team_TEN                                                 1.2139      0.2248      
## year2018_team_TB                                                  2.0433      0.0410    **
## year2018_team_ATL                                                 1.7419      0.0815     *
## year2018_team_JAX                                                 0.8608      0.3893      
## year2018_team_LA                                                  0.2142      0.8304      
## year2018_team_WAS                                                 2.2542      0.0242    **
## year2019_team_ARI                                                 1.7154      0.0863     *
## year2019_team_BUF                                                 0.9637      0.3352      
## year2019_team_CHI                                                 0.9970      0.3188      
## year2019_team_CLE                                                 1.1369      0.2556      
## year2019_team_DAL                                                 0.9749      0.3296      
## year2019_team_IND                                                 1.4814      0.1385     .
## year2019_team_JAX                                                 0.8488      0.3960      
## year2019_team_KC                                                  0.1977      0.8433      
## year2019_team_LAC                                                 1.6892      0.0912     *
## year2019_team_MIN                                                 2.0527      0.0401    **
## year2019_team_NE                                                  0.6968      0.4859      
## year2019_team_NO                                                 -0.1085      0.9136      
## year2019_team_PHI                                                 1.8759      0.0607     *
## year2019_team_SEA                                                 0.9684      0.3329      
## year2019_team_SF                                                  1.5058      0.1321     .
## year2019_team_TB                                                  1.1972      0.2312      
## year2019_team_ATL                                                 2.1314      0.0331    **
## year2019_team_BAL                                                 1.4104      0.1584      
## year2019_team_CAR                                                 0.8476      0.3966      
## year2019_team_CIN                                                 1.2996      0.1937      
## year2019_team_DEN                                                 0.2504      0.8023      
## year2019_team_DET                                                 0.6607      0.5088      
## year2019_team_HOU                                                 1.3882      0.1651      
## year2019_team_LA                                                  0.4717      0.6371      
## year2019_team_MIA                                                 1.2950      0.1953      
## year2019_team_NYG                                                 1.5603      0.1187     .
## year2019_team_NYJ                                                 1.0708      0.2843      
## year2019_team_OAK                                                 0.9905      0.3219      
## year2019_team_PIT                                                 0.5187      0.6040      
## year2019_team_TEN                                                 0.6214      0.5343      
## year2019_team_WAS                                                 0.8027      0.4222      
## year2019_team_GB                                                  0.5049      0.6136      
## year2020_team_ATL                                                 0.9430      0.3457      
## year2020_team_BAL                                                -0.2750      0.7833      
## year2020_team_BUF                                                 1.7551      0.0792     *
## year2020_team_CAR                                                 2.4610      0.0139    **
## year2020_team_CIN                                                 0.1597      0.8731      
## year2020_team_DEN                                                 1.2460      0.2128      
## year2020_team_DET                                                 1.1077      0.2680      
## year2020_team_JAX                                                 1.2764      0.2018      
## year2020_team_KC                                                  0.7516      0.4523      
## year2020_team_LA                                                  1.4037      0.1604      
## year2020_team_MIN                                                 0.1827      0.8550      
## year2020_team_NE                                                  0.8036      0.4216      
## year2020_team_NO                                                  0.6550      0.5125      
## year2020_team_NYG                                                 0.2858      0.7750      
## year2020_team_SF                                                  0.5935      0.5529      
## year2020_team_WAS                                                 0.8667      0.3861      
## year2020_team_CHI                                                -0.0017      0.9986      
## year2020_team_DAL                                                 0.6995      0.4843      
## year2020_team_GB                                                  0.5484      0.5834      
## year2020_team_HOU                                                 1.6678      0.0954     *
## year2020_team_LV                                                  1.2346      0.2170      
## year2020_team_MIA                                                -0.0795      0.9366      
## year2020_team_NYJ                                                 0.1029      0.9181      
## year2020_team_TB                                                  0.5373      0.5911      
## year2020_team_TEN                                                 1.1774      0.2390      
## year2020_team_ARI                                                 1.1822      0.2371      
## year2020_team_CLE                                                 1.3617      0.1733      
## year2020_team_IND                                                 0.9630      0.3355      
## year2020_team_LAC                                                 0.6049      0.5452      
## year2020_team_PHI                                                 0.9406      0.3469      
## year2020_team_SEA                                                 0.7879      0.4308      
## year2020_team_PIT                                                 0.6084      0.5429      
## year2021_team_ATL                                                 1.3448      0.1787      
## year2021_team_BUF                                                 0.5616      0.5744      
## year2021_team_CIN                                                 1.6491      0.0991     *
## year2021_team_DAL                                                 0.7516      0.4523      
## year2021_team_DEN                                                 0.9521      0.3411      
## year2021_team_DET                                                 0.9965      0.3190      
## year2021_team_HOU                                                 1.0335      0.3014      
## year2021_team_KC                                                  2.0904      0.0366    **
## year2021_team_LA                                                 -0.0922      0.9266      
## year2021_team_LV                                                  0.5384      0.5903      
## year2021_team_MIN                                                -0.2861      0.7748      
## year2021_team_NE                                                  0.1044      0.9168      
## year2021_team_NO                                                  0.6238      0.5328      
## year2021_team_NYG                                                 1.2077      0.2272      
## year2021_team_SF                                                  1.9560      0.0505     *
## year2021_team_TEN                                                 0.5779      0.5633      
## year2021_team_ARI                                                 0.8721      0.3831      
## year2021_team_BAL                                                 0.0177      0.9859      
## year2021_team_CAR                                                 0.8445      0.3984      
## year2021_team_CHI                                                 0.7635      0.4452      
## year2021_team_GB                                                  0.7880      0.4307      
## year2021_team_IND                                                 0.6857      0.4929      
## year2021_team_LAC                                                 2.3342      0.0196    **
## year2021_team_MIA                                                 0.9925      0.3209      
## year2021_team_NYJ                                                 1.7417      0.0816     *
## year2021_team_PHI                                                 0.9629      0.3356      
## year2021_team_SEA                                                 0.7712      0.4406      
## year2021_team_TB                                                  2.2904      0.0220    **
## year2021_team_WAS                                                 1.5602      0.1187     .
## year2021_team_CLE                                                 0.2954      0.7677      
## year2021_team_JAX                                                 0.9852      0.3245      
## year2021_team_PIT                                                 1.0136      0.3108      
## year2022_team_ARI                                                 0.8492      0.3958      
## year2022_team_ATL                                                 1.8460      0.0649     *
## year2022_team_CAR                                                 0.3518      0.7250      
## year2022_team_CHI                                                 2.3273      0.0200    **
## year2022_team_CIN                                                 2.1475      0.0318    **
## year2022_team_HOU                                                 0.8387      0.4017      
## year2022_team_IND                                                -0.1014      0.9192      
## year2022_team_LAC                                                 0.8152      0.4149      
## year2022_team_MIA                                                 2.0486      0.0405    **
## year2022_team_MIN                                                 1.3769      0.1685      
## year2022_team_NE                                                  1.1862      0.2355      
## year2022_team_NYJ                                                 0.6675      0.5045      
## year2022_team_SEA                                                 1.1345      0.2566      
## year2022_team_TB                                                  0.1861      0.8523      
## year2022_team_TEN                                                 0.4246      0.6712      
## year2022_team_WAS                                                 0.6173      0.5370      
## year2022_team_BAL                                                 0.8773      0.3803      
## year2022_team_BUF                                                 1.4372      0.1507      
## year2022_team_DAL                                                 0.2393      0.8109      
## year2022_team_DET                                                 0.1156      0.9080      
## year2022_team_GB                                                  0.9820      0.3261      
## year2022_team_JAX                                                 1.4005      0.1614      
## year2022_team_KC                                                  2.5651      0.0103    **
## year2022_team_LA                                                  0.6584      0.5103      
## year2022_team_LV                                                  1.2070      0.2274      
## year2022_team_NO                                                  1.4152      0.1570      
## year2022_team_PHI                                                 1.3921      0.1639      
## year2022_team_PIT                                                 1.3194      0.1870      
## year2022_team_SF                                                  1.3772      0.1685      
## year2022_team_CLE                                                 0.5577      0.5771      
## year2022_team_DEN                                                -0.3401      0.7338      
## year2022_team_NYG                                                 1.0699      0.2847      
## year2023_team_BAL                                                 0.6717      0.5018      
## year2023_team_CHI                                                 2.5266      0.0115    **
## year2023_team_CLE                                                 0.5857      0.5581      
## year2023_team_GB                                                  0.2301      0.8181      
## year2023_team_IND                                                 0.3529      0.7242      
## year2023_team_KC                                                  2.0229      0.0431    **
## year2023_team_LAC                                                 0.8897      0.3736      
## year2023_team_LV                                                  0.0867      0.9309      
## year2023_team_MIA                                                 1.5753      0.1152     .
## year2023_team_MIN                                                 1.7669      0.0772     *
## year2023_team_NO                                                  0.5535      0.5799      
## year2023_team_NYG                                                 1.4764      0.1398     .
## year2023_team_NYJ                                                -0.4143      0.6787      
## year2023_team_SEA                                                 0.8908      0.3731      
## year2023_team_SF                                                  1.6607      0.0968     *
## year2023_team_WAS                                                 1.4570      0.1451     .
## year2023_team_ATL                                                 0.5834      0.5596      
## year2023_team_BUF                                                 2.3484      0.0189    **
## year2023_team_CAR                                                 1.2357      0.2166      
## year2023_team_DAL                                                 1.7226      0.0850     *
## year2023_team_DEN                                                 0.2096      0.8340      
## year2023_team_HOU                                                 1.1220      0.2619      
## year2023_team_LA                                                  1.0437      0.2966      
## year2023_team_NE                                                  1.8122      0.0700     *
## year2023_team_PHI                                                 2.5832      0.0098   ***
## year2023_team_PIT                                                 0.5797      0.5621      
## year2023_team_TEN                                                 0.7517      0.4523      
## year2023_team_ARI                                                 2.1670      0.0302    **
## year2023_team_CIN                                                 0.9344      0.3501      
## year2023_team_DET                                                 1.1830      0.2368      
## year2023_team_TB                                                  1.2356      0.2166      
## year2023_team_JAX                                                 0.5353      0.5925      
## is_first_half                                                     4.0879      0.0000   ***
## time_in_half                                                     -1.6666      0.0956     *
## starter_offense_player_1_rushing_grades_grades_run_12w           -0.7079      0.4790      
## starter_offense_player_1_passing_depth_short_grades_pass_12w      0.5077      0.6117      
## starter_offense_player_4_rushing_grades_ypa_12w                  -0.1162      0.9075      
## starter_offense_player_8_receiving_depth_short_caught_per...     -0.6174      0.5370      
## starter_offense_player_8_run_blocking_gap_grades_run_bloc...     -0.3470      0.7286      
## starter_offense_player_9_receiving_depth_short_caught_per...     -2.1849      0.0289    **
## starter_offense_player_9_run_blocking_gap_grades_run_bloc...      0.7796      0.4356      
## starter_offense_player_10_receiving_depth_short_caught_pe...     -0.6759      0.4991      
## starter_offense_player_10_run_blocking_gap_grades_run_blo...      1.4978      0.1342     .
## starter_offense_player_14_blocking_grades_grades_run_bloc...     -0.5074      0.6119      
## starter_offense_player_15_blocking_grades_grades_run_bloc...      0.7357      0.4619      
## starter_offense_player_17_blocking_grades_grades_offense_12w     -1.6901      0.0910     *
## starter_offense_player_18_blocking_grades_grades_offense_12w      0.9839      0.3252      
## starter_offense_player_19_blocking_grades_grades_offense_12w      1.3693      0.1709      
## starter_offense_player_20_blocking_grades_grades_offense_12w      0.0775      0.9382      
## starter_offense_player_21_blocking_grades_grades_offense_12w      1.7999      0.0719     *
## starter_defense_player_1_pass_rush_grades_grades_pass_rus...     -0.7099      0.4778      
## starter_defense_player_1_run_defense_grades_run_stop_opp_12w      0.0877      0.9301      
## starter_defense_player_2_pass_rush_grades_grades_pass_rus...      0.0556      0.9557      
## starter_defense_player_2_run_defense_grades_run_stop_opp_12w     -1.0565      0.2908      
## starter_defense_player_3_pass_rush_grades_grades_pass_rus...     -0.3120      0.7551      
## starter_defense_player_3_run_defense_grades_run_stop_opp_12w      0.2639      0.7919      
## starter_defense_player_4_pass_rush_grades_grades_pass_rus...     -0.5247      0.5998      
## starter_defense_player_4_run_defense_grades_run_stop_opp_12w     -0.7095      0.4780      
## starter_defense_player_9_pass_rush_grades_grades_pass_rus...     -0.6876      0.4917      
## starter_defense_player_9_run_defense_grades_run_stop_opp_12w     -1.2873      0.1980      
## starter_defense_player_9_coverage_grades_grades_coverage_...      0.2636      0.7921      
## starter_defense_player_10_pass_rush_grades_grades_pass_ru...     -0.1056      0.9159      
## starter_defense_player_10_run_defense_grades_run_stop_opp...      0.1563      0.8758      
## starter_defense_player_10_coverage_grades_grades_coverage...     -0.4527      0.6507      
## starter_defense_player_11_pass_rush_grades_grades_pass_ru...     -0.1725      0.8631      
## starter_defense_player_11_run_defense_grades_run_stop_opp...      0.3426      0.7319      
## starter_defense_player_11_coverage_grades_grades_coverage...      1.5298      0.1261     .
## starter_defense_player_12_pass_rush_grades_grades_pass_ru...      0.2509      0.8019      
## starter_defense_player_12_run_defense_grades_run_stop_opp...      0.9610      0.3366      
## starter_defense_player_12_coverage_grades_grades_coverage...     -0.0325      0.9740      
## starter_defense_player_15_coverage_grades_grades_defense_12w     -1.9171      0.0552     *
## starter_defense_player_15_defensive_grades_grades_defense...     -0.1387      0.8897      
## starter_defense_player_16_coverage_grades_grades_defense_12w      0.8901      0.3734      
## starter_defense_player_16_defensive_grades_grades_defense...     -0.2177      0.8277      
## starter_defense_player_17_coverage_grades_grades_defense_12w     -0.9492      0.3425      
## starter_defense_player_17_defensive_grades_grades_defense...      0.9734      0.3304      
## starter_defense_player_20_coverage_schemes_zone_grades_co...      0.6700      0.5028      
## starter_defense_player_20_coverage_grades_grades_defense_...     -0.5315      0.5951      
## starter_defense_player_21_coverage_schemes_zone_grades_co...     -0.6756      0.4993      
## starter_defense_player_21_coverage_grades_grades_defense_...      0.9912      0.3216      
## starter_defense_player_22_coverage_schemes_zone_grades_co...      1.3260      0.1848      
## starter_defense_player_22_coverage_grades_grades_defense_...     -0.5256      0.5991</code></pre>
<pre class="r"><code>cat(&quot;\nSignificance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15&quot;)</code></pre>
<pre><code>## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</code></pre>
<pre class="r"><code># Calculate VIFs for the model with starter players
vifs_starter &lt;- vif(ols_starter)
# Filter to show only VIFs over 5
high_vifs_starter &lt;- vifs_starter[vifs_starter &gt; 5]
if(length(high_vifs_starter) &gt; 0) {
  cat(&quot;\nStarter Players: Variables with VIF &gt; 5:\n&quot;)
  print(high_vifs_starter)
} else {
  cat(&quot;\nNo variables with VIF &gt; 5 found in the Starter Players model\n&quot;)
}</code></pre>
<pre><code>## 
## Starter Players: Variables with VIF &gt; 5:
##                                                                    vegas_wp 
##                                                                    5.474157 
##                                                           prev_shotgun_rate 
##                                                                    9.982700 
##                                                        prev_singleback_rate 
##                                                                    6.144625 
##                                                                shotgun_rate 
##                                                                   16.610176 
##                                                                  empty_rate 
##                                                                   12.828508 
##                                                                 cover1_rate 
##                                                                    6.689574 
##                                                                 cover3_rate 
##                                                                    7.159278 
##                                                             home_attendance 
##                                                                    7.984422 
##                                                     offense_formation_EMPTY 
##                                                                    6.047686 
##                                                   offense_formation_SHOTGUN 
##                                                                    8.361812 
##                      starter_offense_player_1_rushing_grades_grades_run_12w 
##                                                                    7.514240 
##                starter_offense_player_1_passing_depth_short_grades_pass_12w 
##                                                                   11.198930 
##              starter_offense_player_8_run_blocking_gap_grades_run_block_12w 
##                                                                   34.429248 
##              starter_offense_player_9_run_blocking_gap_grades_run_block_12w 
##                                                                   33.504632 
##             starter_offense_player_10_run_blocking_gap_grades_run_block_12w 
##                                                                   14.431734 
##                starter_offense_player_17_blocking_grades_grades_offense_12w 
##                                                                   10.633100 
##                starter_offense_player_18_blocking_grades_grades_offense_12w 
##                                                                   10.460885 
##                starter_offense_player_19_blocking_grades_grades_offense_12w 
##                                                                    9.656179 
##                starter_offense_player_20_blocking_grades_grades_offense_12w 
##                                                                    9.232008 
##                starter_offense_player_21_blocking_grades_grades_offense_12w 
##                                                                    8.435814 
##      starter_defense_player_1_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   10.189760 
##      starter_defense_player_2_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   11.731579 
##      starter_defense_player_3_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   13.125492 
##      starter_defense_player_4_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   12.181944 
##      starter_defense_player_9_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   14.487711 
##        starter_defense_player_9_coverage_grades_grades_coverage_defense_12w 
##                                                                    9.833006 
##     starter_defense_player_10_pass_rush_grades_grades_pass_rush_defense_12w 
##                                                                   10.451919 
##       starter_defense_player_10_coverage_grades_grades_coverage_defense_12w 
##                                                                    9.629787 
##                starter_defense_player_15_coverage_grades_grades_defense_12w 
##                                                                   12.415383 
##       starter_defense_player_15_defensive_grades_grades_defense_penalty_12w 
##                                                                   11.067827 
##                starter_defense_player_16_coverage_grades_grades_defense_12w 
##                                                                    8.748266 
##       starter_defense_player_16_defensive_grades_grades_defense_penalty_12w 
##                                                                    8.427204 
##                starter_defense_player_17_coverage_grades_grades_defense_12w 
##                                                                    6.640509 
##       starter_defense_player_17_defensive_grades_grades_defense_penalty_12w 
##                                                                    7.675330 
## starter_defense_player_20_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                                   15.135052 
##        starter_defense_player_20_coverage_grades_grades_defense_penalty_12w 
##                                                                    8.734699 
## starter_defense_player_21_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                                    7.864201 
##        starter_defense_player_21_coverage_grades_grades_defense_penalty_12w 
##                                                                    7.289155 
## starter_defense_player_22_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                                    5.447003 
##        starter_defense_player_22_coverage_grades_grades_defense_penalty_12w 
##                                                                    5.986587</code></pre>
<pre class="r"><code># Create the model matrix for starter data (excluding the response variable)
X_starter &lt;- model.matrix(~ . - conversion - 1, data = starter_data)  # -1 removes intercept
# Find columns causing linear dependencies
lin_combos_starter &lt;- findLinearCombos(X_starter)
# Remove problematic columns from the dataset
if (!is.null(lin_combos_starter$remove)) {
  cols_to_remove &lt;- colnames(X_starter)[lin_combos_starter$remove]
  cat(&quot;Removed from starter data:&quot;, paste(cols_to_remove, collapse=&quot;, &quot;), &quot;\n&quot;)
  starter_data &lt;- starter_data[, (cols_to_remove) := NULL, with = FALSE]
}</code></pre>
<pre class="r"><code># Probit model with regular players
probit_regular &lt;- glm(conversion ~ ., data = regular_data, family = binomial(link = &quot;probit&quot;))</code></pre>
<pre class="r"><code># Get HC0-adjusted z-values and p-values for regular probit
robust_probit_regular &lt;- coeftest(probit_regular, vcov = vcovHC(probit_regular, type = &quot;HC0&quot;))
z_stats_regular &lt;- robust_probit_regular[, &quot;z value&quot;]
p_values_regular &lt;- robust_probit_regular[, &quot;Pr(&gt;|z|)&quot;]

# Print header (note &quot;z-value&quot; instead of &quot;t-value&quot;)
cat(sprintf(&quot;\n\n%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;Regular Players Probit Variable&quot;, &quot;z-value&quot;, &quot;p-value&quot;, &quot;sig&quot;))</code></pre>
<pre><code>## 
## 
## Regular Players Probit Variable                                  z-value     p-value   sig</code></pre>
<pre class="r"><code>cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;---------------&quot;, &quot;-------&quot;, &quot;-------&quot;, &quot;----&quot;))</code></pre>
<pre><code>## ---------------                                                  -------     -------  ----</code></pre>
<pre class="r"><code>for (i in 1:length(z_stats_regular)) {
    var_name &lt;- rownames(robust_probit_regular)[i]
    if (nchar(var_name) &gt; name_width) {
        var_name &lt;- paste0(substr(var_name, 1, name_width-3), &quot;...&quot;)
    }
    cat(sprintf(&quot;%-*s  %10.4f  %10.4f  %4s\n&quot;, 
                name_width, var_name, 
                z_stats_regular[i], p_values_regular[i],
                get_stars(p_values_regular[i])))
}</code></pre>
<pre><code>## (Intercept)                                                      -3.7977      0.0001   ***
## ydstogo                                                         -54.6427      0.0000   ***
## yardline_100                                                      7.8389      0.0000   ***
## posteam_timeouts_remaining                                        2.7701      0.0056   ***
## defteam_timeouts_remaining                                        4.0210      0.0001   ***
## rush_attempt                                                     13.9690      0.0000   ***
## week                                                             -2.1715      0.0299    **
## temp                                                              0.1005      0.9199      
## wind                                                             -0.9927      0.3209      
## vegas_wp                                                         -1.6897      0.0911     *
## total_line                                                        1.5589      0.1190     .
## p_player_26_punting_grades_grades_punter_12w                     -0.7858      0.4320      
## p_player_26_punting_grades_grades_punter_2w                      -1.3553      0.1753      
## k_player_25_field_goals_grades_grades_fgep_kicker_12w             2.2280      0.0259    **
## k_player_25_field_goals_grades_grades_fgep_kicker_2w              1.1266      0.2599      
## score_diff                                                       -1.8879      0.0590     *
## down4_pct                                                        -0.4262      0.6699      
## prep_days                                                        -1.1366      0.2557      
## overall_win_pct                                                   2.1265      0.0335    **
## team_win_pct                                                      5.4757      0.0000   ***
## prev_win_pct                                                      1.0387      0.2989      
## prev_shotgun_rate                                                -0.7457      0.4558      
## prev_singleback_rate                                             -1.1212      0.2622      
## prev_empty_rate                                                  -0.3279      0.7430      
## prev_iform_rate                                                  -0.0312      0.9751      
## prev_shotgun_success                                              1.4976      0.1342     .
## prev_singleback_success                                          -0.1215      0.9033      
## prev_empty_success                                               -0.1860      0.8525      
## prev_iform_success                                               -0.2063      0.8366      
## prev_stop_rate_run                                                0.2606      0.7944      
## prev_stop_rate_pass                                              -1.8452      0.0650     *
## shotgun_rate                                                      1.1526      0.2491      
## singleback_rate                                                   0.2656      0.7906      
## empty_rate                                                        0.8950      0.3708      
## iform_rate                                                        0.5116      0.6089      
## shotgun_success                                                  -3.1616      0.0016   ***
## singleback_success                                                0.8833      0.3771      
## empty_success                                                    -0.6666      0.5050      
## iform_success                                                    -0.6757      0.4992      
## def_stop_rate_run                                                -0.6643      0.5065      
## def_stop_rate_pass                                                0.1513      0.8797      
## avg_pass_rushers                                                 -0.4022      0.6875      
## avg_box_defenders                                                -0.0266      0.9788      
## cover0_rate                                                      -3.7648      0.0002   ***
## cover1_rate                                                      -1.2557      0.2092      
## cover2_rate                                                      -1.0280      0.3040      
## cover3_rate                                                      -1.6509      0.0988     *
## cover4_rate                                                      -1.8646      0.0622     *
## cover6_rate                                                      -1.2640      0.2062      
## two_man_rate                                                     -0.2653      0.7907      
## prevent_rate                                                     -0.4696      0.6386      
## home_attendance                                                  -1.3284      0.1840      
## roof_outdoors                                                    -0.8711      0.3837      
## posteam_type_home                                                 4.0765      0.0000   ***
## offense_formation_EMPTY                                           0.0498      0.9603      
## offense_formation_SHOTGUN                                        -0.4330      0.6650      
## offense_formation_SINGLEBACK                                     -0.3757      0.7072      
## offense_formation_I_FORM                                          0.8684      0.3852      
## year2017_team_BUF                                                -0.2199      0.8260      
## year2017_team_CHI                                                -0.1877      0.8511      
## year2017_team_CLE                                                 0.6600      0.5092      
## year2017_team_DAL                                                -0.1464      0.8836      
## year2017_team_DET                                                -0.0725      0.9422      
## year2017_team_GB                                                 -0.2406      0.8098      
## year2017_team_HOU                                                -0.6834      0.4943      
## year2017_team_MIA                                                 0.3118      0.7552      
## year2017_team_MIN                                                -1.1668      0.2433      
## year2017_team_NE                                                 -0.5448      0.5859      
## year2017_team_NYJ                                                -0.2059      0.8369      
## year2017_team_PHI                                                 0.1831      0.8547      
## year2017_team_SF                                                 -0.3368      0.7363      
## year2017_team_TEN                                                -0.4241      0.6715      
## year2017_team_WAS                                                -1.1380      0.2551      
## year2017_team_ATL                                                -1.0578      0.2901      
## year2017_team_BAL                                                -0.4636      0.6429      
## year2017_team_CIN                                                -0.4378      0.6615      
## year2017_team_DEN                                                -0.2608      0.7942      
## year2017_team_KC                                                  0.3669      0.7137      
## year2017_team_LA                                                  0.3656      0.7147      
## year2017_team_NO                                                 -0.0410      0.9673      
## year2017_team_NYG                                                -1.2491      0.2116      
## year2017_team_OAK                                                -0.9902      0.3221      
## year2017_team_PIT                                                -1.0155      0.3099      
## year2017_team_SEA                                                -0.0737      0.9413      
## year2017_team_TB                                                  1.6657      0.0958     *
## year2017_team_CAR                                                -0.6147      0.5388      
## year2017_team_IND                                                 0.1295      0.8969      
## year2017_team_JAX                                                -0.7080      0.4790      
## year2017_team_LAC                                                -0.5342      0.5932      
## year2018_team_ARI                                                 0.6728      0.5011      
## year2018_team_BAL                                                 0.8009      0.4232      
## year2018_team_CAR                                                 1.5893      0.1120     .
## year2018_team_CLE                                                 0.2443      0.8070      
## year2018_team_DET                                                 0.4410      0.6592      
## year2018_team_HOU                                                 1.6680      0.0953     *
## year2018_team_IND                                                 1.1410      0.2539      
## year2018_team_KC                                                  1.5522      0.1206     .
## year2018_team_LAC                                                 1.1921      0.2332      
## year2018_team_MIA                                                 1.0070      0.3140      
## year2018_team_MIN                                                -0.0290      0.9769      
## year2018_team_NE                                                  0.6409      0.5216      
## year2018_team_NYG                                                 1.4586      0.1447     .
## year2018_team_OAK                                                 1.8576      0.0632     *
## year2018_team_PHI                                                 1.3568      0.1748      
## year2018_team_SEA                                                 1.4539      0.1460     .
## year2018_team_BUF                                                 0.1723      0.8632      
## year2018_team_CHI                                                 0.4977      0.6187      
## year2018_team_CIN                                                 1.8878      0.0591     *
## year2018_team_DAL                                                 1.2464      0.2126      
## year2018_team_DEN                                                 1.1205      0.2625      
## year2018_team_GB                                                  0.5240      0.6003      
## year2018_team_NO                                                  1.3955      0.1629      
## year2018_team_NYJ                                                 0.6806      0.4961      
## year2018_team_PIT                                                 1.6056      0.1084     .
## year2018_team_SF                                                  1.2063      0.2277      
## year2018_team_TEN                                                 1.3398      0.1803      
## year2018_team_TB                                                  2.2000      0.0278    **
## year2018_team_ATL                                                 1.7245      0.0846     *
## year2018_team_JAX                                                 1.1123      0.2660      
## year2018_team_LA                                                  0.5712      0.5679      
## year2018_team_WAS                                                 2.3130      0.0207    **
## year2019_team_ARI                                                 1.6646      0.0960     *
## year2019_team_BUF                                                 1.0037      0.3155      
## year2019_team_CHI                                                 1.3354      0.1817      
## year2019_team_CLE                                                 1.1862      0.2355      
## year2019_team_DAL                                                 1.2748      0.2024      
## year2019_team_IND                                                 1.4847      0.1376     .
## year2019_team_JAX                                                 0.9736      0.3302      
## year2019_team_KC                                                  0.7287      0.4662      
## year2019_team_LAC                                                 1.9298      0.0536     *
## year2019_team_MIN                                                 2.2116      0.0270    **
## year2019_team_NE                                                  0.8469      0.3970      
## year2019_team_NO                                                  0.1071      0.9147      
## year2019_team_PHI                                                 1.9420      0.0521     *
## year2019_team_SEA                                                 1.1463      0.2517      
## year2019_team_SF                                                  1.4471      0.1479     .
## year2019_team_TB                                                  1.1055      0.2689      
## year2019_team_ATL                                                 2.2168      0.0266    **
## year2019_team_BAL                                                 1.5820      0.1136     .
## year2019_team_CAR                                                 0.7213      0.4707      
## year2019_team_CIN                                                 1.3944      0.1632      
## year2019_team_DEN                                                 0.3807      0.7034      
## year2019_team_DET                                                 0.8178      0.4135      
## year2019_team_HOU                                                 1.4921      0.1357     .
## year2019_team_LA                                                  0.6492      0.5162      
## year2019_team_MIA                                                 1.1051      0.2691      
## year2019_team_NYG                                                 1.3972      0.1624      
## year2019_team_NYJ                                                 1.0289      0.3035      
## year2019_team_OAK                                                 1.2199      0.2225      
## year2019_team_PIT                                                 0.5782      0.5632      
## year2019_team_TEN                                                 0.7460      0.4556      
## year2019_team_WAS                                                 0.4430      0.6577      
## year2019_team_GB                                                  0.8602      0.3897      
## year2020_team_ATL                                                 1.2296      0.2188      
## year2020_team_BAL                                                 0.0193      0.9846      
## year2020_team_BUF                                                 1.8214      0.0685     *
## year2020_team_CAR                                                 2.3778      0.0174    **
## year2020_team_CIN                                                 0.2306      0.8176      
## year2020_team_DEN                                                 1.4099      0.1586      
## year2020_team_DET                                                 1.4726      0.1409     .
## year2020_team_JAX                                                 1.1646      0.2442      
## year2020_team_KC                                                  1.0446      0.2962      
## year2020_team_LA                                                  1.4994      0.1338     .
## year2020_team_MIN                                                 0.1446      0.8850      
## year2020_team_NE                                                  0.7810      0.4348      
## year2020_team_NO                                                  0.8089      0.4186      
## year2020_team_NYG                                                 0.4503      0.6525      
## year2020_team_SF                                                  0.6354      0.5252      
## year2020_team_WAS                                                 1.0886      0.2763      
## year2020_team_CHI                                                 0.1718      0.8636      
## year2020_team_DAL                                                 0.7926      0.4280      
## year2020_team_GB                                                  0.6728      0.5011      
## year2020_team_HOU                                                 1.5873      0.1124     .
## year2020_team_LV                                                  1.5044      0.1325     .
## year2020_team_MIA                                                 0.1982      0.8429      
## year2020_team_NYJ                                                 0.1748      0.8612      
## year2020_team_TB                                                  0.6073      0.5437      
## year2020_team_TEN                                                 1.1729      0.2408      
## year2020_team_ARI                                                 1.1923      0.2331      
## year2020_team_CLE                                                 1.4530      0.1462     .
## year2020_team_IND                                                 1.3065      0.1914      
## year2020_team_LAC                                                 0.8082      0.4190      
## year2020_team_PHI                                                 1.0161      0.3096      
## year2020_team_SEA                                                 0.8605      0.3895      
## year2020_team_PIT                                                 0.8278      0.4078      
## year2021_team_ATL                                                 1.6188      0.1055     .
## year2021_team_BUF                                                 0.9565      0.3388      
## year2021_team_CIN                                                 1.8751      0.0608     *
## year2021_team_DAL                                                 1.0408      0.2980      
## year2021_team_DEN                                                 1.0427      0.2971      
## year2021_team_DET                                                 1.0418      0.2975      
## year2021_team_HOU                                                 1.3621      0.1732      
## year2021_team_KC                                                  2.3834      0.0172    **
## year2021_team_LA                                                  0.1100      0.9124      
## year2021_team_LV                                                  0.8328      0.4050      
## year2021_team_MIN                                                 0.0221      0.9824      
## year2021_team_NE                                                  0.3817      0.7027      
## year2021_team_NO                                                  0.8786      0.3796      
## year2021_team_NYG                                                 1.2851      0.1988      
## year2021_team_SF                                                  1.9993      0.0456    **
## year2021_team_TEN                                                 0.5293      0.5966      
## year2021_team_ARI                                                 1.2164      0.2238      
## year2021_team_BAL                                                 0.2392      0.8109      
## year2021_team_CAR                                                 0.9052      0.3654      
## year2021_team_CHI                                                 1.0349      0.3007      
## year2021_team_GB                                                  1.0253      0.3052      
## year2021_team_IND                                                 1.1032      0.2699      
## year2021_team_LAC                                                 2.3955      0.0166    **
## year2021_team_MIA                                                 1.3322      0.1828      
## year2021_team_NYJ                                                 2.0752      0.0380    **
## year2021_team_PHI                                                 1.1422      0.2534      
## year2021_team_SEA                                                 0.8856      0.3759      
## year2021_team_TB                                                  2.4790      0.0132    **
## year2021_team_WAS                                                 1.7102      0.0872     *
## year2021_team_CLE                                                 0.8262      0.4087      
## year2021_team_JAX                                                 1.0931      0.2744      
## year2021_team_PIT                                                 1.1053      0.2690      
## year2022_team_ARI                                                 0.7968      0.4256      
## year2022_team_ATL                                                 1.9381      0.0526     *
## year2022_team_CAR                                                 0.5560      0.5782      
## year2022_team_CHI                                                 2.2757      0.0229    **
## year2022_team_CIN                                                 2.3770      0.0175    **
## year2022_team_HOU                                                 0.9793      0.3274      
## year2022_team_IND                                                 0.0477      0.9620      
## year2022_team_LAC                                                 0.8420      0.3998      
## year2022_team_MIA                                                 2.0850      0.0371    **
## year2022_team_MIN                                                 1.4205      0.1555      
## year2022_team_NE                                                  1.4018      0.1610      
## year2022_team_NYJ                                                 1.0890      0.2762      
## year2022_team_SEA                                                 1.2040      0.2286      
## year2022_team_TB                                                  0.3015      0.7630      
## year2022_team_TEN                                                 0.5096      0.6103      
## year2022_team_WAS                                                 0.7396      0.4595      
## year2022_team_BAL                                                 1.1020      0.2705      
## year2022_team_BUF                                                 1.4571      0.1451     .
## year2022_team_DAL                                                 0.3800      0.7040      
## year2022_team_DET                                                 0.4179      0.6760      
## year2022_team_GB                                                  0.8352      0.4036      
## year2022_team_JAX                                                 1.5518      0.1207     .
## year2022_team_KC                                                  2.7067      0.0068   ***
## year2022_team_LA                                                  0.8522      0.3941      
## year2022_team_LV                                                  1.2972      0.1946      
## year2022_team_NO                                                  1.5904      0.1118     .
## year2022_team_PHI                                                 1.5214      0.1282     .
## year2022_team_PIT                                                 1.3149      0.1885      
## year2022_team_SF                                                  1.3614      0.1734      
## year2022_team_CLE                                                 0.8717      0.3834      
## year2022_team_DEN                                                -0.2145      0.8302      
## year2022_team_NYG                                                 1.0204      0.3075      
## year2023_team_BAL                                                 0.7284      0.4664      
## year2023_team_CHI                                                 2.5331      0.0113    **
## year2023_team_CLE                                                 0.7141      0.4751      
## year2023_team_GB                                                  0.1253      0.9003      
## year2023_team_IND                                                 0.4105      0.6815      
## year2023_team_KC                                                  2.0097      0.0445    **
## year2023_team_LAC                                                 0.9752      0.3295      
## year2023_team_LV                                                 -0.0262      0.9791      
## year2023_team_MIA                                                 1.6404      0.1009     .
## year2023_team_MIN                                                 1.3578      0.1745      
## year2023_team_NO                                                  0.7327      0.4638      
## year2023_team_NYG                                                 1.2045      0.2284      
## year2023_team_NYJ                                                -0.4868      0.6264      
## year2023_team_SEA                                                 0.8798      0.3790      
## year2023_team_SF                                                  1.7451      0.0810     *
## year2023_team_WAS                                                 1.4528      0.1463     .
## year2023_team_ATL                                                 0.5975      0.5502      
## year2023_team_BUF                                                 2.5111      0.0120    **
## year2023_team_CAR                                                 1.0086      0.3132      
## year2023_team_DAL                                                 1.9110      0.0560     *
## year2023_team_DEN                                                 0.3894      0.6970      
## year2023_team_HOU                                                 1.1506      0.2499      
## year2023_team_LA                                                  0.8173      0.4137      
## year2023_team_NE                                                  1.6916      0.0907     *
## year2023_team_PHI                                                 2.6261      0.0086   ***
## year2023_team_PIT                                                 0.7347      0.4625      
## year2023_team_TEN                                                 0.6391      0.5228      
## year2023_team_ARI                                                 1.9372      0.0527     *
## year2023_team_CIN                                                 0.9781      0.3280      
## year2023_team_DET                                                 1.1785      0.2386      
## year2023_team_TB                                                  1.2566      0.2089      
## year2023_team_JAX                                                 0.4824      0.6295      
## is_first_half                                                     3.7323      0.0002   ***
## time_in_half                                                     -1.7205      0.0853     *
## offense_player_1_rushing_grades_grades_run_12w                   -0.0660      0.9474      
## offense_player_1_passing_depth_short_grades_pass_12w              2.3413      0.0192    **
## offense_player_4_rushing_grades_ypa_12w                           0.6601      0.5092      
## offense_player_8_receiving_depth_short_caught_percent_12w        -1.6290      0.1033     .
## offense_player_8_run_blocking_gap_grades_run_block_12w           -0.2190      0.8266      
## offense_player_9_receiving_depth_short_caught_percent_12w        -0.8474      0.3967      
## offense_player_9_run_blocking_gap_grades_run_block_12w            3.4125      0.0006   ***
## offense_player_10_receiving_depth_short_caught_percent_12w       -0.3201      0.7489      
## offense_player_10_run_blocking_gap_grades_run_block_12w           0.8041      0.4213      
## offense_player_14_blocking_grades_grades_run_block_2w             1.0464      0.2954      
## offense_player_17_blocking_grades_grades_offense_12w             -0.0264      0.9789      
## offense_player_18_blocking_grades_grades_offense_12w             -1.3088      0.1906      
## offense_player_19_blocking_grades_grades_offense_12w              1.3845      0.1662      
## offense_player_20_blocking_grades_grades_offense_12w              1.1148      0.2649      
## offense_player_21_blocking_grades_grades_offense_12w              0.8211      0.4116      
## defense_player_1_pass_rush_grades_grades_pass_rush_defens...     -0.9031      0.3665      
## defense_player_1_run_defense_grades_run_stop_opp_12w              1.3903      0.1644      
## defense_player_2_pass_rush_grades_grades_pass_rush_defens...     -0.5608      0.5749      
## defense_player_2_run_defense_grades_run_stop_opp_12w             -0.3633      0.7164      
## defense_player_3_pass_rush_grades_grades_pass_rush_defens...      0.5221      0.6016      
## defense_player_3_run_defense_grades_run_stop_opp_12w             -2.3899      0.0169    **
## defense_player_4_pass_rush_grades_grades_pass_rush_defens...     -1.2735      0.2029      
## defense_player_4_run_defense_grades_run_stop_opp_12w             -0.2065      0.8364      
## defense_player_9_pass_rush_grades_grades_pass_rush_defens...     -1.2182      0.2232      
## defense_player_9_run_defense_grades_run_stop_opp_12w              0.0274      0.9781      
## defense_player_9_coverage_grades_grades_coverage_defense_12w     -0.5559      0.5783      
## defense_player_10_pass_rush_grades_grades_pass_rush_defen...     -3.3641      0.0008   ***
## defense_player_10_run_defense_grades_run_stop_opp_12w             0.2395      0.8107      
## defense_player_10_coverage_grades_grades_coverage_defense...      2.1471      0.0318    **
## defense_player_11_pass_rush_grades_grades_pass_rush_defen...      0.1158      0.9078      
## defense_player_11_run_defense_grades_run_stop_opp_12w            -0.9379      0.3483      
## defense_player_11_coverage_grades_grades_coverage_defense...      0.6815      0.4956      
## defense_player_12_pass_rush_grades_grades_pass_rush_defen...     -0.5480      0.5837      
## defense_player_12_run_defense_grades_run_stop_opp_12w             0.6824      0.4950      
## defense_player_12_coverage_grades_grades_coverage_defense...     -0.7411      0.4586      
## defense_player_15_coverage_grades_grades_defense_12w             -2.4990      0.0125    **
## defense_player_15_defensive_grades_grades_defense_penalty...      0.4091      0.6824      
## defense_player_16_coverage_grades_grades_defense_12w             -1.5239      0.1275     .
## defense_player_16_defensive_grades_grades_defense_penalty...      0.7148      0.4747      
## defense_player_17_coverage_grades_grades_defense_12w             -0.0855      0.9319      
## defense_player_17_defensive_grades_grades_defense_penalty...     -0.5428      0.5873      
## defense_player_20_coverage_schemes_zone_grades_coverage_d...     -0.6182      0.5365      
## defense_player_20_coverage_grades_grades_defense_penalty_12w     -0.7455      0.4560      
## defense_player_21_coverage_schemes_zone_grades_coverage_d...      0.1022      0.9186      
## defense_player_21_coverage_grades_grades_defense_penalty_12w     -0.3362      0.7367      
## defense_player_22_coverage_schemes_zone_grades_coverage_d...     -0.5627      0.5736      
## defense_player_22_coverage_grades_grades_defense_penalty_12w      0.3494      0.7268</code></pre>
<pre class="r"><code>cat(&quot;\nSignificance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15&quot;)</code></pre>
<pre><code>## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</code></pre>
<pre class="r"><code># Probit model with starter players
probit_starter &lt;- glm(conversion ~ ., data = starter_data, family = binomial(link = &quot;probit&quot;))</code></pre>
<pre class="r"><code># Get HC0-adjusted z-values and p-values for starter probit
robust_probit_starter &lt;- coeftest(probit_starter, vcov = vcovHC(probit_starter, type = &quot;HC0&quot;))
z_stats_starter &lt;- robust_probit_starter[, &quot;z value&quot;]
p_values_starter &lt;- robust_probit_starter[, &quot;Pr(&gt;|z|)&quot;]

# Print header (note &quot;z-value&quot; instead of &quot;t-value&quot;)
cat(sprintf(&quot;\n\n%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;Starter Players Probit Variable&quot;, &quot;z-value&quot;, &quot;p-value&quot;, &quot;sig&quot;))</code></pre>
<pre><code>## 
## 
## Starter Players Probit Variable                                  z-value     p-value   sig</code></pre>
<pre class="r"><code>cat(sprintf(&quot;%-*s  %10s  %10s  %4s\n&quot;, name_width, &quot;---------------&quot;, &quot;-------&quot;, &quot;-------&quot;, &quot;----&quot;))</code></pre>
<pre><code>## ---------------                                                  -------     -------  ----</code></pre>
<pre class="r"><code>for (i in 1:length(z_stats_starter)) {
    var_name &lt;- rownames(robust_probit_starter)[i]
    if (nchar(var_name) &gt; name_width) {
        var_name &lt;- paste0(substr(var_name, 1, name_width-3), &quot;...&quot;)
    }
    cat(sprintf(&quot;%-*s  %10.4f  %10.4f  %4s\n&quot;, 
                name_width, var_name, 
                z_stats_starter[i], p_values_starter[i],
                get_stars(p_values_starter[i])))
}</code></pre>
<pre><code>## (Intercept)                                                      -3.7439      0.0002   ***
## ydstogo                                                         -55.8435      0.0000   ***
## yardline_100                                                      8.0531      0.0000   ***
## posteam_timeouts_remaining                                        2.6820      0.0073   ***
## defteam_timeouts_remaining                                        4.0638      0.0000   ***
## rush_attempt                                                     13.6119      0.0000   ***
## week                                                             -1.6949      0.0901     *
## temp                                                              0.1761      0.8602      
## wind                                                             -1.1511      0.2497      
## vegas_wp                                                         -0.8410      0.4003      
## total_line                                                        1.8841      0.0595     *
## p_player_26_punting_grades_grades_punter_12w                     -0.6018      0.5473      
## p_player_26_punting_grades_grades_punter_2w                      -1.5607      0.1186     .
## k_player_25_field_goals_grades_grades_fgep_kicker_12w             2.3463      0.0190    **
## k_player_25_field_goals_grades_grades_fgep_kicker_2w              1.0749      0.2824      
## score_diff                                                       -2.7585      0.0058   ***
## down4_pct                                                        -0.5011      0.6163      
## prep_days                                                        -0.6286      0.5296      
## overall_win_pct                                                   2.4265      0.0152    **
## team_win_pct                                                      5.6326      0.0000   ***
## prev_win_pct                                                      0.9083      0.3637      
## prev_shotgun_rate                                                -0.6097      0.5420      
## prev_singleback_rate                                             -1.0061      0.3144      
## prev_empty_rate                                                  -0.4115      0.6807      
## prev_iform_rate                                                  -0.1857      0.8527      
## prev_shotgun_success                                              1.6852      0.0920     *
## prev_singleback_success                                          -0.1541      0.8775      
## prev_empty_success                                               -0.1414      0.8876      
## prev_iform_success                                               -0.1885      0.8505      
## prev_stop_rate_run                                                0.5103      0.6098      
## prev_stop_rate_pass                                              -2.0636      0.0391    **
## shotgun_rate                                                      0.9765      0.3288      
## singleback_rate                                                   0.0899      0.9284      
## empty_rate                                                        0.7308      0.4649      
## iform_rate                                                        0.6445      0.5193      
## shotgun_success                                                  -3.1027      0.0019   ***
## singleback_success                                                1.2771      0.2016      
## empty_success                                                    -0.8884      0.3743      
## iform_success                                                    -0.9730      0.3305      
## def_stop_rate_run                                                -0.9357      0.3494      
## def_stop_rate_pass                                               -0.7840      0.4330      
## avg_pass_rushers                                                 -0.7178      0.4729      
## avg_box_defenders                                                -0.2659      0.7904      
## cover0_rate                                                      -3.2047      0.0014   ***
## cover1_rate                                                      -0.6908      0.4897      
## cover2_rate                                                      -1.0707      0.2843      
## cover3_rate                                                      -1.7779      0.0754     *
## cover4_rate                                                      -2.2871      0.0222    **
## cover6_rate                                                      -0.8673      0.3858      
## two_man_rate                                                      0.1980      0.8431      
## prevent_rate                                                     -0.4405      0.6596      
## home_attendance                                                  -1.4393      0.1501      
## roof_outdoors                                                    -0.6418      0.5210      
## posteam_type_home                                                 3.6714      0.0002   ***
## offense_formation_EMPTY                                           0.2322      0.8164      
## offense_formation_SHOTGUN                                        -0.1969      0.8439      
## offense_formation_SINGLEBACK                                     -0.8340      0.4043      
## offense_formation_I_FORM                                         -0.2830      0.7772      
## year2017_team_BUF                                                -0.2996      0.7645      
## year2017_team_CHI                                                -0.2872      0.7739      
## year2017_team_CLE                                                 0.5459      0.5851      
## year2017_team_DAL                                                -0.2337      0.8153      
## year2017_team_DET                                                -0.1865      0.8520      
## year2017_team_GB                                                 -0.0982      0.9218      
## year2017_team_HOU                                                -0.7300      0.4654      
## year2017_team_MIA                                                 0.3050      0.7604      
## year2017_team_MIN                                                -1.3419      0.1796      
## year2017_team_NE                                                 -0.4483      0.6540      
## year2017_team_NYJ                                                -0.0050      0.9960      
## year2017_team_PHI                                                -0.0955      0.9239      
## year2017_team_SF                                                 -0.2795      0.7799      
## year2017_team_TEN                                                -0.6546      0.5127      
## year2017_team_WAS                                                -1.2095      0.2265      
## year2017_team_ATL                                                -0.8874      0.3749      
## year2017_team_BAL                                                -0.3385      0.7350      
## year2017_team_CIN                                                -0.5674      0.5704      
## year2017_team_DEN                                                -0.4353      0.6634      
## year2017_team_KC                                                  0.4213      0.6735      
## year2017_team_LA                                                  0.3883      0.6978      
## year2017_team_NO                                                 -0.0366      0.9708      
## year2017_team_NYG                                                -1.0923      0.2747      
## year2017_team_OAK                                                -1.1022      0.2704      
## year2017_team_PIT                                                -1.0069      0.3140      
## year2017_team_SEA                                                -0.3751      0.7076      
## year2017_team_TB                                                  1.8888      0.0589     *
## year2017_team_CAR                                                -0.6665      0.5051      
## year2017_team_IND                                                 0.0512      0.9592      
## year2017_team_JAX                                                -0.9509      0.3417      
## year2017_team_LAC                                                -0.6974      0.4855      
## year2018_team_ARI                                                 0.5786      0.5629      
## year2018_team_BAL                                                 0.6365      0.5245      
## year2018_team_CAR                                                 1.4780      0.1394     .
## year2018_team_CLE                                                -0.0084      0.9933      
## year2018_team_DET                                                 0.3503      0.7261      
## year2018_team_HOU                                                 1.5082      0.1315     .
## year2018_team_IND                                                 0.9135      0.3610      
## year2018_team_KC                                                  1.2127      0.2253      
## year2018_team_LAC                                                 1.0546      0.2916      
## year2018_team_MIA                                                 0.8724      0.3830      
## year2018_team_MIN                                                -0.3939      0.6937      
## year2018_team_NE                                                  0.4340      0.6643      
## year2018_team_NYG                                                 1.5560      0.1197     .
## year2018_team_OAK                                                 1.3439      0.1790      
## year2018_team_PHI                                                 1.1593      0.2463      
## year2018_team_SEA                                                 1.3142      0.1888      
## year2018_team_BUF                                                 0.0027      0.9979      
## year2018_team_CHI                                                 0.2242      0.8226      
## year2018_team_CIN                                                 1.7027      0.0886     *
## year2018_team_DAL                                                 1.0255      0.3051      
## year2018_team_DEN                                                 1.1418      0.2535      
## year2018_team_GB                                                  0.2212      0.8249      
## year2018_team_NO                                                  1.1889      0.2345      
## year2018_team_NYJ                                                 0.4079      0.6834      
## year2018_team_PIT                                                 1.5026      0.1329     .
## year2018_team_SF                                                  1.1056      0.2689      
## year2018_team_TEN                                                 1.1633      0.2447      
## year2018_team_TB                                                  2.0438      0.0410    **
## year2018_team_ATL                                                 1.6528      0.0984     *
## year2018_team_JAX                                                 0.7857      0.4320      
## year2018_team_LA                                                  0.1556      0.8764      
## year2018_team_WAS                                                 2.2597      0.0238    **
## year2019_team_ARI                                                 1.7348      0.0828     *
## year2019_team_BUF                                                 0.9211      0.3570      
## year2019_team_CHI                                                 0.9641      0.3350      
## year2019_team_CLE                                                 1.1220      0.2619      
## year2019_team_DAL                                                 1.0185      0.3085      
## year2019_team_IND                                                 1.4921      0.1357     .
## year2019_team_JAX                                                 0.9018      0.3672      
## year2019_team_KC                                                  0.2955      0.7676      
## year2019_team_LAC                                                 1.6578      0.0974     *
## year2019_team_MIN                                                 1.9667      0.0492    **
## year2019_team_NE                                                  0.7071      0.4795      
## year2019_team_NO                                                 -0.1380      0.8902      
## year2019_team_PHI                                                 1.9367      0.0528     *
## year2019_team_SEA                                                 0.9819      0.3261      
## year2019_team_SF                                                  1.4269      0.1536      
## year2019_team_TB                                                  1.1523      0.2492      
## year2019_team_ATL                                                 2.1141      0.0345    **
## year2019_team_BAL                                                 1.4510      0.1468     .
## year2019_team_CAR                                                 0.7400      0.4593      
## year2019_team_CIN                                                 1.3756      0.1690      
## year2019_team_DEN                                                 0.2464      0.8054      
## year2019_team_DET                                                 0.6180      0.5366      
## year2019_team_HOU                                                 1.4284      0.1532      
## year2019_team_LA                                                  0.5497      0.5825      
## year2019_team_MIA                                                 1.3115      0.1897      
## year2019_team_NYG                                                 1.5411      0.1233     .
## year2019_team_NYJ                                                 1.0178      0.3088      
## year2019_team_OAK                                                 0.9717      0.3312      
## year2019_team_PIT                                                 0.4795      0.6316      
## year2019_team_TEN                                                 0.6006      0.5481      
## year2019_team_WAS                                                 0.7719      0.4402      
## year2019_team_GB                                                  0.5274      0.5979      
## year2020_team_ATL                                                 0.9138      0.3608      
## year2020_team_BAL                                                -0.2574      0.7969      
## year2020_team_BUF                                                 1.7375      0.0823     *
## year2020_team_CAR                                                 2.4694      0.0135    **
## year2020_team_CIN                                                 0.1537      0.8778      
## year2020_team_DEN                                                 1.2010      0.2297      
## year2020_team_DET                                                 1.0719      0.2838      
## year2020_team_JAX                                                 1.2302      0.2186      
## year2020_team_KC                                                  0.7371      0.4611      
## year2020_team_LA                                                  1.4351      0.1513      
## year2020_team_MIN                                                 0.0956      0.9239      
## year2020_team_NE                                                  0.8419      0.3999      
## year2020_team_NO                                                  0.6254      0.5317      
## year2020_team_NYG                                                 0.1780      0.8587      
## year2020_team_SF                                                  0.6591      0.5098      
## year2020_team_WAS                                                 0.8559      0.3920      
## year2020_team_CHI                                                 0.0475      0.9621      
## year2020_team_DAL                                                 0.7344      0.4627      
## year2020_team_GB                                                  0.4867      0.6265      
## year2020_team_HOU                                                 1.6205      0.1051     .
## year2020_team_LV                                                  1.2902      0.1970      
## year2020_team_MIA                                                 0.0015      0.9988      
## year2020_team_NYJ                                                 0.1608      0.8723      
## year2020_team_TB                                                  0.4547      0.6493      
## year2020_team_TEN                                                 1.2047      0.2283      
## year2020_team_ARI                                                 1.1676      0.2430      
## year2020_team_CLE                                                 1.3174      0.1877      
## year2020_team_IND                                                 0.9715      0.3313      
## year2020_team_LAC                                                 0.5891      0.5558      
## year2020_team_PHI                                                 0.8803      0.3787      
## year2020_team_SEA                                                 0.7709      0.4408      
## year2020_team_PIT                                                 0.6350      0.5254      
## year2021_team_ATL                                                 1.2881      0.1977      
## year2021_team_BUF                                                 0.5467      0.5846      
## year2021_team_CIN                                                 1.5847      0.1130     .
## year2021_team_DAL                                                 0.6879      0.4915      
## year2021_team_DEN                                                 0.9207      0.3572      
## year2021_team_DET                                                 0.9556      0.3393      
## year2021_team_HOU                                                 0.9645      0.3348      
## year2021_team_KC                                                  2.0080      0.0446    **
## year2021_team_LA                                                 -0.1139      0.9093      
## year2021_team_LV                                                  0.5556      0.5785      
## year2021_team_MIN                                                -0.3456      0.7297      
## year2021_team_NE                                                  0.0793      0.9368      
## year2021_team_NO                                                  0.5754      0.5650      
## year2021_team_NYG                                                 1.1809      0.2376      
## year2021_team_SF                                                  1.8676      0.0618     *
## year2021_team_TEN                                                 0.5489      0.5831      
## year2021_team_ARI                                                 0.9471      0.3436      
## year2021_team_BAL                                                 0.1306      0.8961      
## year2021_team_CAR                                                 0.7850      0.4324      
## year2021_team_CHI                                                 0.6807      0.4961      
## year2021_team_GB                                                  0.7082      0.4788      
## year2021_team_IND                                                 0.6867      0.4923      
## year2021_team_LAC                                                 2.2880      0.0221    **
## year2021_team_MIA                                                 0.9239      0.3555      
## year2021_team_NYJ                                                 1.7611      0.0782     *
## year2021_team_PHI                                                 0.9736      0.3302      
## year2021_team_SEA                                                 0.7516      0.4523      
## year2021_team_TB                                                  2.2695      0.0232    **
## year2021_team_WAS                                                 1.4860      0.1373     .
## year2021_team_CLE                                                 0.3368      0.7363      
## year2021_team_JAX                                                 0.9699      0.3321      
## year2021_team_PIT                                                 1.0059      0.3145      
## year2022_team_ARI                                                 0.7726      0.4397      
## year2022_team_ATL                                                 1.8454      0.0650     *
## year2022_team_CAR                                                 0.3581      0.7202      
## year2022_team_CHI                                                 2.3661      0.0180    **
## year2022_team_CIN                                                 2.1619      0.0306    **
## year2022_team_HOU                                                 0.8067      0.4198      
## year2022_team_IND                                                -0.2577      0.7967      
## year2022_team_LAC                                                 0.7442      0.4568      
## year2022_team_MIA                                                 1.9879      0.0468    **
## year2022_team_MIN                                                 1.4209      0.1553      
## year2022_team_NE                                                  1.1771      0.2392      
## year2022_team_NYJ                                                 0.5988      0.5493      
## year2022_team_SEA                                                 1.1213      0.2622      
## year2022_team_TB                                                  0.1572      0.8751      
## year2022_team_TEN                                                 0.3465      0.7290      
## year2022_team_WAS                                                 0.5499      0.5824      
## year2022_team_BAL                                                 0.8745      0.3819      
## year2022_team_BUF                                                 1.4336      0.1517      
## year2022_team_DAL                                                 0.1656      0.8684      
## year2022_team_DET                                                 0.1771      0.8594      
## year2022_team_GB                                                  0.9650      0.3345      
## year2022_team_JAX                                                 1.3577      0.1746      
## year2022_team_KC                                                  2.4428      0.0146    **
## year2022_team_LA                                                  0.6214      0.5343      
## year2022_team_LV                                                  1.1312      0.2580      
## year2022_team_NO                                                  1.3895      0.1647      
## year2022_team_PHI                                                 1.3541      0.1757      
## year2022_team_PIT                                                 1.2820      0.1999      
## year2022_team_SF                                                  1.2815      0.2000      
## year2022_team_CLE                                                 0.5257      0.5991      
## year2022_team_DEN                                                -0.4370      0.6621      
## year2022_team_NYG                                                 1.1101      0.2670      
## year2023_team_BAL                                                 0.5489      0.5831      
## year2023_team_CHI                                                 2.4807      0.0131    **
## year2023_team_CLE                                                 0.5324      0.5944      
## year2023_team_GB                                                  0.2448      0.8066      
## year2023_team_IND                                                 0.3318      0.7401      
## year2023_team_KC                                                  2.0428      0.0411    **
## year2023_team_LAC                                                 0.9594      0.3373      
## year2023_team_LV                                                 -0.0021      0.9984      
## year2023_team_MIA                                                 1.4993      0.1338     .
## year2023_team_MIN                                                 1.7160      0.0862     *
## year2023_team_NO                                                  0.5709      0.5680      
## year2023_team_NYG                                                 1.3983      0.1620      
## year2023_team_NYJ                                                -0.5184      0.6042      
## year2023_team_SEA                                                 0.8268      0.4083      
## year2023_team_SF                                                  1.6319      0.1027     .
## year2023_team_WAS                                                 1.3894      0.1647      
## year2023_team_ATL                                                 0.4847      0.6279      
## year2023_team_BUF                                                 2.3140      0.0207    **
## year2023_team_CAR                                                 1.1556      0.2479      
## year2023_team_DAL                                                 1.7060      0.0880     *
## year2023_team_DEN                                                 0.1986      0.8426      
## year2023_team_HOU                                                 1.1248      0.2607      
## year2023_team_LA                                                  1.0077      0.3136      
## year2023_team_NE                                                  1.8368      0.0662     *
## year2023_team_PHI                                                 2.5295      0.0114    **
## year2023_team_PIT                                                 0.5207      0.6026      
## year2023_team_TEN                                                 0.7338      0.4631      
## year2023_team_ARI                                                 2.1620      0.0306    **
## year2023_team_CIN                                                 0.8776      0.3802      
## year2023_team_DET                                                 1.1777      0.2389      
## year2023_team_TB                                                  1.2317      0.2181      
## year2023_team_JAX                                                 0.4366      0.6624      
## is_first_half                                                     3.8247      0.0001   ***
## time_in_half                                                     -1.7473      0.0806     *
## starter_offense_player_1_rushing_grades_grades_run_12w           -0.6062      0.5444      
## starter_offense_player_1_passing_depth_short_grades_pass_12w      0.4369      0.6622      
## starter_offense_player_4_rushing_grades_ypa_12w                  -0.2465      0.8053      
## starter_offense_player_8_receiving_depth_short_caught_per...     -0.6456      0.5185      
## starter_offense_player_8_run_blocking_gap_grades_run_bloc...     -0.3064      0.7593      
## starter_offense_player_9_receiving_depth_short_caught_per...     -2.3985      0.0165    **
## starter_offense_player_9_run_blocking_gap_grades_run_bloc...      0.9681      0.3330      
## starter_offense_player_10_receiving_depth_short_caught_pe...     -0.6177      0.5368      
## starter_offense_player_10_run_blocking_gap_grades_run_blo...      1.6159      0.1061     .
## starter_offense_player_14_blocking_grades_grades_run_bloc...     -0.4702      0.6382      
## starter_offense_player_15_blocking_grades_grades_run_bloc...      0.5472      0.5842      
## starter_offense_player_17_blocking_grades_grades_offense_12w     -1.7592      0.0785     *
## starter_offense_player_18_blocking_grades_grades_offense_12w      0.8576      0.3911      
## starter_offense_player_19_blocking_grades_grades_offense_12w      1.3998      0.1616      
## starter_offense_player_20_blocking_grades_grades_offense_12w      0.1328      0.8944      
## starter_offense_player_21_blocking_grades_grades_offense_12w      1.9000      0.0574     *
## starter_defense_player_1_pass_rush_grades_grades_pass_rus...     -0.7486      0.4541      
## starter_defense_player_1_run_defense_grades_run_stop_opp_12w      0.0685      0.9454      
## starter_defense_player_2_pass_rush_grades_grades_pass_rus...      0.1328      0.8943      
## starter_defense_player_2_run_defense_grades_run_stop_opp_12w     -1.1024      0.2703      
## starter_defense_player_3_pass_rush_grades_grades_pass_rus...     -0.3775      0.7058      
## starter_defense_player_3_run_defense_grades_run_stop_opp_12w      0.2228      0.8237      
## starter_defense_player_4_pass_rush_grades_grades_pass_rus...     -0.4584      0.6467      
## starter_defense_player_4_run_defense_grades_run_stop_opp_12w     -0.8995      0.3684      
## starter_defense_player_9_pass_rush_grades_grades_pass_rus...     -0.7354      0.4621      
## starter_defense_player_9_run_defense_grades_run_stop_opp_12w     -1.2936      0.1958      
## starter_defense_player_9_coverage_grades_grades_coverage_...      0.0772      0.9385      
## starter_defense_player_10_pass_rush_grades_grades_pass_ru...     -0.1357      0.8921      
## starter_defense_player_10_run_defense_grades_run_stop_opp...      0.1564      0.8757      
## starter_defense_player_10_coverage_grades_grades_coverage...     -0.4270      0.6694      
## starter_defense_player_11_pass_rush_grades_grades_pass_ru...     -0.2385      0.8115      
## starter_defense_player_11_run_defense_grades_run_stop_opp...      0.4341      0.6642      
## starter_defense_player_11_coverage_grades_grades_coverage...      1.4953      0.1348     .
## starter_defense_player_12_pass_rush_grades_grades_pass_ru...      0.3468      0.7287      
## starter_defense_player_12_run_defense_grades_run_stop_opp...      0.8561      0.3920      
## starter_defense_player_12_coverage_grades_grades_coverage...      0.0349      0.9722      
## starter_defense_player_15_coverage_grades_grades_defense_12w     -1.9771      0.0480    **
## starter_defense_player_15_defensive_grades_grades_defense...     -0.0334      0.9733      
## starter_defense_player_16_coverage_grades_grades_defense_12w      0.7984      0.4246      
## starter_defense_player_16_defensive_grades_grades_defense...     -0.0842      0.9329      
## starter_defense_player_17_coverage_grades_grades_defense_12w     -0.8873      0.3749      
## starter_defense_player_17_defensive_grades_grades_defense...      0.9298      0.3525      
## starter_defense_player_20_coverage_schemes_zone_grades_co...      0.5991      0.5491      
## starter_defense_player_20_coverage_grades_grades_defense_...     -0.5572      0.5774      
## starter_defense_player_21_coverage_schemes_zone_grades_co...     -0.7129      0.4759      
## starter_defense_player_21_coverage_grades_grades_defense_...      0.9005      0.3678      
## starter_defense_player_22_coverage_schemes_zone_grades_co...      1.2579      0.2084      
## starter_defense_player_22_coverage_grades_grades_defense_...     -0.4928      0.6221</code></pre>
<pre class="r"><code>cat(&quot;\nSignificance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15&quot;)</code></pre>
<pre><code>## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</code></pre>
<pre class="r"><code># Model comparison summary
cat(&quot;\n\n--- Model Comparison Summary ---\n&quot;)</code></pre>
<pre><code>## 
## 
## --- Model Comparison Summary ---</code></pre>
<pre class="r"><code>cat(&quot;OLS Regular Players R-squared:&quot;, round(summary(ols_regular)$r.squared, 4), &quot;\n&quot;)</code></pre>
<pre><code>## OLS Regular Players R-squared: 0.1255</code></pre>
<pre class="r"><code>cat(&quot;OLS Starter Players R-squared:&quot;, round(summary(ols_starter)$r.squared, 4), &quot;\n&quot;)</code></pre>
<pre><code>## OLS Starter Players R-squared: 0.1245</code></pre>
<pre class="r"><code>cat(&quot;OLS Regular Players Adj R-squared:&quot;, round(summary(ols_regular)$adj.r.squared, 4), &quot;\n&quot;)</code></pre>
<pre><code>## OLS Regular Players Adj R-squared: 0.1186</code></pre>
<pre class="r"><code>cat(&quot;OLS Starter Players Adj R-squared:&quot;, round(summary(ols_starter)$adj.r.squared, 4), &quot;\n\n&quot;)</code></pre>
<pre><code>## OLS Starter Players Adj R-squared: 0.1176</code></pre>
<pre class="r"><code>cat(&quot;Probit Regular Players AIC:&quot;, round(probit_regular$aic, 2), &quot;\n&quot;)</code></pre>
<pre><code>## Probit Regular Players AIC: 51561.24</code></pre>
<pre class="r"><code>cat(&quot;Probit Starter Players AIC:&quot;, round(probit_starter$aic, 2), &quot;\n&quot;)</code></pre>
<pre><code>## Probit Starter Players AIC: 51616.3</code></pre>
<pre class="r"><code>cat(&quot;Probit Regular Players McFadden&#39;s Pseudo R:&quot;, round(1 - probit_regular$deviance/probit_regular$null.deviance, 4), &quot;\n&quot;)</code></pre>
<pre><code>## Probit Regular Players McFadden&#39;s Pseudo R: 0.1039</code></pre>
<pre class="r"><code>cat(&quot;Probit Starter Players McFadden&#39;s Pseudo R:&quot;, round(1 - probit_starter$deviance/probit_starter$null.deviance, 4), &quot;\n&quot;)</code></pre>
<pre><code>## Probit Starter Players McFadden&#39;s Pseudo R: 0.103</code></pre>
<pre class="r"><code># Function to get top coefficients by absolute value
get_top_coefficients &lt;- function(model_results, n = 10) {
  coefs &lt;- model_results[, &quot;Estimate&quot;]
  # Remove intercept
  coefs &lt;- coefs[names(coefs) != &quot;(Intercept)&quot;]
  # Sort by absolute value
  sorted_indices &lt;- order(abs(coefs), decreasing = TRUE)
  top_coefs &lt;- coefs[sorted_indices[1:min(n, length(sorted_indices))]]
  return(top_coefs)
}

# Display top coefficients for each model
cat(&quot;\n\nTop 10 Influential Variables by Absolute Coefficient Value\n&quot;)</code></pre>
<pre><code>## 
## 
## Top 10 Influential Variables by Absolute Coefficient Value</code></pre>
<pre class="r"><code>cat(&quot;\nOLS Regular Players:\n&quot;)</code></pre>
<pre><code>## 
## OLS Regular Players:</code></pre>
<pre class="r"><code>print(get_top_coefficients(robust_regular_test))</code></pre>
<pre><code>##  year2022_team_KC year2023_team_PHI year2023_team_BUF year2023_team_CHI 
##         0.1746172         0.1730723         0.1686872         0.1561385 
## year2020_team_CAR  year2021_team_KC           ydstogo year2021_team_LAC 
##         0.1497445         0.1494181        -0.1493297         0.1478690 
##  year2021_team_TB year2018_team_WAS 
##         0.1465097         0.1404259</code></pre>
<pre class="r"><code>cat(&quot;\nOLS Starter Players:\n&quot;)</code></pre>
<pre><code>## 
## OLS Starter Players:</code></pre>
<pre class="r"><code>print(get_top_coefficients(robust_starter_test))</code></pre>
<pre><code>## year2023_team_PHI  year2022_team_KC year2023_team_BUF year2023_team_CHI 
##         0.1660041         0.1539627         0.1535103         0.1507738 
## year2020_team_CAR           ydstogo year2021_team_LAC year2018_team_WAS 
##         0.1506776        -0.1486241         0.1382555         0.1357661 
##  year2021_team_TB year2022_team_CHI 
##         0.1329000         0.1317934</code></pre>
<pre class="r"><code>cat(&quot;\nProbit Regular Players:\n&quot;)</code></pre>
<pre><code>## 
## Probit Regular Players:</code></pre>
<pre class="r"><code>print(get_top_coefficients(robust_probit_regular))</code></pre>
<pre><code>##           ydstogo year2023_team_PHI  year2022_team_KC year2023_team_BUF 
##        -0.4893292         0.4884835         0.4729319         0.4707403 
## year2023_team_CHI year2020_team_CAR  year2021_team_KC  year2021_team_TB 
##         0.4363972         0.4213394         0.4143461         0.4138290 
## year2021_team_LAC year2018_team_WAS 
##         0.4099174         0.4072596</code></pre>
<pre class="r"><code>cat(&quot;\nProbit Starter Players:\n&quot;)</code></pre>
<pre><code>## 
## Probit Starter Players:</code></pre>
<pre class="r"><code>print(get_top_coefficients(robust_probit_starter))</code></pre>
<pre><code>##           ydstogo year2023_team_PHI year2020_team_CAR year2023_team_BUF 
##        -0.4837610         0.4662219         0.4325267         0.4315002 
##  year2022_team_KC year2023_team_CHI year2018_team_WAS year2021_team_LAC 
##         0.4213053         0.4204870         0.3915696         0.3874477 
## year2022_team_CHI  year2021_team_TB 
##         0.3836715         0.3760852</code></pre>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIlRoaXJkIERvd24gQW5hbHlzaXMgd2l0aCBSZWd1bGFyIGFuZCBTdGFydGVyIFBsYXllcnMiDQpvdXRwdXQ6IGh0bWxfZG9jdW1lbnQNCi0tLQ0KDQpgYGB7cn0NCmxpYnJhcnkoZGF0YS50YWJsZSkgICAgICAgICAgICAgDQpjdGQxIDwtIGZyZWFkKCJwcmVkaWN0X2N0ZDEuY3N2Lmd6IikgICAgICAgICAgICAgICAgICAgICAgICANCmBgYA0KDQpgYGB7cn0NCiNraWxsIG15X2lkDQpjdGQxJG15X2lkIDwtIE5VTEwNCmN0ZDFbLCB5ZWFyMjAxN190ZWFtX0FSSSA6PSBOVUxMXQ0KYGBgDQoNCmBgYHtyfQ0KIyBJZGVudGlmeSBwbGF5ZXIgY29sdW1ucw0KYWxsX2NvbHMgPC0gY29sbmFtZXMoY3RkMSkNCg0KIyBDcmVhdGUgcmVnZXggcGF0dGVybnMgdG8gaWRlbnRpZnkgcmVndWxhciBhbmQgc3RhcnRlciBwbGF5ZXIgdmFyaWFibGVzDQpvZmZlbnNlX3BsYXllcl9wYXR0ZXJuIDwtICJeb2ZmZW5zZV9wbGF5ZXJfXFxkK18iDQpkZWZlbnNlX3BsYXllcl9wYXR0ZXJuIDwtICJeZGVmZW5zZV9wbGF5ZXJfXFxkK18iDQpzdGFydGVyX29mZmVuc2VfcGF0dGVybiA8LSAiXnN0YXJ0ZXJfb2ZmZW5zZV9wbGF5ZXJfXFxkK18iDQpzdGFydGVyX2RlZmVuc2VfcGF0dGVybiA8LSAiXnN0YXJ0ZXJfZGVmZW5zZV9wbGF5ZXJfXFxkK18iDQoNCiMgR2V0IGNvbHVtbnMgZm9yIGVhY2ggdHlwZQ0Kb2ZmZW5zZV9wbGF5ZXJfY29scyA8LSBncmVwKG9mZmVuc2VfcGxheWVyX3BhdHRlcm4sIGFsbF9jb2xzLCB2YWx1ZSA9IFRSVUUpDQpkZWZlbnNlX3BsYXllcl9jb2xzIDwtIGdyZXAoZGVmZW5zZV9wbGF5ZXJfcGF0dGVybiwgYWxsX2NvbHMsIHZhbHVlID0gVFJVRSkNCnN0YXJ0ZXJfb2ZmZW5zZV9jb2xzIDwtIGdyZXAoc3RhcnRlcl9vZmZlbnNlX3BhdHRlcm4sIGFsbF9jb2xzLCB2YWx1ZSA9IFRSVUUpDQpzdGFydGVyX2RlZmVuc2VfY29scyA8LSBncmVwKHN0YXJ0ZXJfZGVmZW5zZV9wYXR0ZXJuLCBhbGxfY29scywgdmFsdWUgPSBUUlVFKQ0KDQojIEFsbCBwbGF5ZXIgY29sdW1ucw0KcmVndWxhcl9wbGF5ZXJfY29scyA8LSBjKG9mZmVuc2VfcGxheWVyX2NvbHMsIGRlZmVuc2VfcGxheWVyX2NvbHMpDQpzdGFydGVyX3BsYXllcl9jb2xzIDwtIGMoc3RhcnRlcl9vZmZlbnNlX2NvbHMsIHN0YXJ0ZXJfZGVmZW5zZV9jb2xzKQ0KYWxsX3BsYXllcl9jb2xzIDwtIGMocmVndWxhcl9wbGF5ZXJfY29scywgc3RhcnRlcl9wbGF5ZXJfY29scykNCg0KIyBOb24tcGxheWVyIGNvbHVtbnMgKGNvbW1vbiB0byBib3RoIGRhdGFzZXRzKQ0KY29tbW9uX2NvbHMgPC0gc2V0ZGlmZihhbGxfY29scywgYWxsX3BsYXllcl9jb2xzKQ0KDQojIENyZWF0ZSB0d28gZGF0YXNldHMNCnJlZ3VsYXJfZGF0YSA8LSBjdGQxWywgYyhjb21tb25fY29scywgcmVndWxhcl9wbGF5ZXJfY29scyksIHdpdGggPSBGQUxTRV0NCnN0YXJ0ZXJfZGF0YSA8LSBjdGQxWywgYyhjb21tb25fY29scywgc3RhcnRlcl9wbGF5ZXJfY29scyksIHdpdGggPSBGQUxTRV0NCmBgYA0KDQoNCmBgYHtyfQ0KIyBUaGVuIHJ1biBPTFMgd2l0aCByZWd1bGFyIHBsYXllcnMNCm9sc19yZWd1bGFyIDwtIGxtKGNvbnZlcnNpb24gfiAuLCBkYXRhID0gcmVndWxhcl9kYXRhKQ0KYGBgDQoNCmBgYHtyfQ0KbGlicmFyeShzYW5kd2ljaCkNCmxpYnJhcnkobG10ZXN0KQ0KIyBHZXQgSEMwLWFkanVzdGVkIHQtdmFsdWVzIGFuZCBwLXZhbHVlcw0Kcm9idXN0X3JlZ3VsYXJfdGVzdCA8LSBjb2VmdGVzdChvbHNfcmVndWxhciwgdmNvdiA9IHZjb3ZIQyhvbHNfcmVndWxhciwgdHlwZSA9ICJIQzAiKSkNCnRfc3RhdHNfcmVndWxhciA8LSByb2J1c3RfcmVndWxhcl90ZXN0WywgInQgdmFsdWUiXQ0KcF92YWx1ZXNfcmVndWxhciA8LSByb2J1c3RfcmVndWxhcl90ZXN0WywgIlByKD58dHwpIl0NCiMgRnVuY3Rpb24gdG8gYWRkIHNpZ25pZmljYW5jZSBzdGFycw0KZ2V0X3N0YXJzIDwtIGZ1bmN0aW9uKHApIHsNCiAgICBpZiAocCA8PSAwLjAxKSByZXR1cm4oIioqKiIpDQogICAgaWYgKHAgPD0gMC4wNSkgcmV0dXJuKCIqKiIpDQogICAgaWYgKHAgPD0gMC4xKSByZXR1cm4oIioiKQ0KICAgIGlmIChwIDw9IDAuMTUpIHJldHVybigiLiIpDQogICAgcmV0dXJuKCIiKQ0KfQ0KIyBNYXhpbXVtIHdpZHRoIGZvciB2YXJpYWJsZSBuYW1lcw0KbmFtZV93aWR0aCA8LSA2MA0KIyBQcmludCBoZWFkZXIgd2l0aCBhbGlnbm1lbnQNCmNhdChzcHJpbnRmKCIlLSpzICAlMTBzICAlMTBzICAlNHNcbiIsIG5hbWVfd2lkdGgsICJSZWd1bGFyIFBsYXllcnMgT0xTIFZhcmlhYmxlIiwgInQtdmFsdWUiLCAicC12YWx1ZSIsICJzaWciKSkNCmNhdChzcHJpbnRmKCIlLSpzICAlMTBzICAlMTBzICAlNHNcbiIsIG5hbWVfd2lkdGgsICItLS0tLS0tLS0iLCAiLS0tLS0tLSIsICItLS0tLS0tIiwgIi0tLS0iKSkNCiMgTG9vcCB0aHJvdWdoIGFuZCBwcmludCB2YWx1ZXMNCmZvciAoaSBpbiAxOmxlbmd0aCh0X3N0YXRzX3JlZ3VsYXIpKSB7DQogICAgdmFyX25hbWUgPC0gcm93bmFtZXMocm9idXN0X3JlZ3VsYXJfdGVzdClbaV0NCiAgICAjIFRydW5jYXRlIG5hbWUgaWYgdG9vIGxvbmcNCiAgICBpZiAobmNoYXIodmFyX25hbWUpID4gbmFtZV93aWR0aCkgew0KICAgICAgICB2YXJfbmFtZSA8LSBwYXN0ZTAoc3Vic3RyKHZhcl9uYW1lLCAxLCBuYW1lX3dpZHRoLTMpLCAiLi4uIikNCiAgICB9DQogICAgY2F0KHNwcmludGYoIiUtKnMgICUxMC40ZiAgJTEwLjRmICAlNHNcbiIsIA0KICAgICAgICAgICAgICAgIG5hbWVfd2lkdGgsIHZhcl9uYW1lLCANCiAgICAgICAgICAgICAgICB0X3N0YXRzX3JlZ3VsYXJbaV0sIHBfdmFsdWVzX3JlZ3VsYXJbaV0sDQogICAgICAgICAgICAgICAgZ2V0X3N0YXJzKHBfdmFsdWVzX3JlZ3VsYXJbaV0pKSkNCn0NCmNhdCgiXG5TaWduaWZpY2FuY2UgY29kZXM6IDAgJyoqKicgMC4wMSAnKionIDAuMDUgJyonIDAuMSAnLicgMC4xNSIpDQpgYGANCg0KYGBge3J9DQojIExvYWQgdGhlIGNhciBwYWNrYWdlIHdoaWNoIGhhcyB0aGUgdmlmIGZ1bmN0aW9uDQpsaWJyYXJ5KGNhcikNCiMgQ2FsY3VsYXRlIFZJRnMgZm9yIHRoZSBtb2RlbCB3aXRoIHJlZ3VsYXIgcGxheWVycw0Kdmlmc19yZWd1bGFyIDwtIHZpZihvbHNfcmVndWxhcikNCiMgRmlsdGVyIHRvIHNob3cgb25seSBWSUZzIG92ZXIgNQ0KaGlnaF92aWZzX3JlZ3VsYXIgPC0gdmlmc19yZWd1bGFyW3ZpZnNfcmVndWxhciA+IDVdDQppZihsZW5ndGgoaGlnaF92aWZzX3JlZ3VsYXIpID4gMCkgew0KICBjYXQoIlxuUmVndWxhciBQbGF5ZXJzOiBWYXJpYWJsZXMgd2l0aCBWSUYgPiA1OlxuIikNCiAgcHJpbnQoaGlnaF92aWZzX3JlZ3VsYXIpDQp9IGVsc2Ugew0KICBjYXQoIlxuTm8gdmFyaWFibGVzIHdpdGggVklGID4gNSBmb3VuZCBpbiB0aGUgUmVndWxhciBQbGF5ZXJzIG1vZGVsXG4iKQ0KfQ0KYGBgDQoNCmBgYHtyfQ0KbGlicmFyeShjYXJldCkNCiMgQ3JlYXRlIHRoZSBtb2RlbCBtYXRyaXggZm9yIHJlZ3VsYXIgZGF0YSAoZXhjbHVkaW5nIHRoZSByZXNwb25zZSB2YXJpYWJsZSkNClhfcmVndWxhciA8LSBtb2RlbC5tYXRyaXgofiAuIC0gY29udmVyc2lvbiAtIDEsIGRhdGEgPSByZWd1bGFyX2RhdGEpICAjIC0xIHJlbW92ZXMgaW50ZXJjZXB0DQojIEZpbmQgY29sdW1ucyBjYXVzaW5nIGxpbmVhciBkZXBlbmRlbmNpZXMNCmxpbl9jb21ib3NfcmVndWxhciA8LSBmaW5kTGluZWFyQ29tYm9zKFhfcmVndWxhcikNCiMgUmVtb3ZlIHByb2JsZW1hdGljIGNvbHVtbnMgZnJvbSB0aGUgZGF0YXNldA0KaWYgKCFpcy5udWxsKGxpbl9jb21ib3NfcmVndWxhciRyZW1vdmUpKSB7DQogIGNvbHNfdG9fcmVtb3ZlIDwtIGNvbG5hbWVzKFhfcmVndWxhcilbbGluX2NvbWJvc19yZWd1bGFyJHJlbW92ZV0NCiAgY2F0KCJSZW1vdmVkIGZyb20gcmVndWxhciBkYXRhOiIsIHBhc3RlKGNvbHNfdG9fcmVtb3ZlLCBjb2xsYXBzZT0iLCAiKSwgIlxuIikNCiAgcmVndWxhcl9kYXRhIDwtIHJlZ3VsYXJfZGF0YVssIChjb2xzX3RvX3JlbW92ZSkgOj0gTlVMTCwgd2l0aCA9IEZBTFNFXQ0KfQ0KYGBgDQoNCg0KYGBge3J9DQojIFRoZW4gcnVuIE9MUyB3aXRoIHN0YXJ0ZXIgcGxheWVycw0Kb2xzX3N0YXJ0ZXIgPC0gbG0oY29udmVyc2lvbiB+IC4sIGRhdGEgPSBzdGFydGVyX2RhdGEpDQpgYGANCg0KYGBge3J9DQojIEdldCBIQzAtYWRqdXN0ZWQgdC12YWx1ZXMgYW5kIHAtdmFsdWVzDQpyb2J1c3Rfc3RhcnRlcl90ZXN0IDwtIGNvZWZ0ZXN0KG9sc19zdGFydGVyLCB2Y292ID0gdmNvdkhDKG9sc19zdGFydGVyLCB0eXBlID0gIkhDMCIpKQ0KdF9zdGF0c19zdGFydGVyIDwtIHJvYnVzdF9zdGFydGVyX3Rlc3RbLCAidCB2YWx1ZSJdDQpwX3ZhbHVlc19zdGFydGVyIDwtIHJvYnVzdF9zdGFydGVyX3Rlc3RbLCAiUHIoPnx0fCkiXQ0KDQojIFByaW50IGhlYWRlciB3aXRoIGFsaWdubWVudA0KY2F0KHNwcmludGYoIiUtKnMgICUxMHMgICUxMHMgICU0c1xuIiwgbmFtZV93aWR0aCwgIlN0YXJ0ZXIgUGxheWVycyBPTFMgVmFyaWFibGUiLCAidC12YWx1ZSIsICJwLXZhbHVlIiwgInNpZyIpKQ0KY2F0KHNwcmludGYoIiUtKnMgICUxMHMgICUxMHMgICU0c1xuIiwgbmFtZV93aWR0aCwgIi0tLS0tLS0tLSIsICItLS0tLS0tIiwgIi0tLS0tLS0iLCAiLS0tLSIpKQ0KIyBMb29wIHRocm91Z2ggYW5kIHByaW50IHZhbHVlcw0KZm9yIChpIGluIDE6bGVuZ3RoKHRfc3RhdHNfc3RhcnRlcikpIHsNCiAgICB2YXJfbmFtZSA8LSByb3duYW1lcyhyb2J1c3Rfc3RhcnRlcl90ZXN0KVtpXQ0KICAgICMgVHJ1bmNhdGUgbmFtZSBpZiB0b28gbG9uZw0KICAgIGlmIChuY2hhcih2YXJfbmFtZSkgPiBuYW1lX3dpZHRoKSB7DQogICAgICAgIHZhcl9uYW1lIDwtIHBhc3RlMChzdWJzdHIodmFyX25hbWUsIDEsIG5hbWVfd2lkdGgtMyksICIuLi4iKQ0KICAgIH0NCiAgICBjYXQoc3ByaW50ZigiJS0qcyAgJTEwLjRmICAlMTAuNGYgICU0c1xuIiwgDQogICAgICAgICAgICAgICAgbmFtZV93aWR0aCwgdmFyX25hbWUsIA0KICAgICAgICAgICAgICAgIHRfc3RhdHNfc3RhcnRlcltpXSwgcF92YWx1ZXNfc3RhcnRlcltpXSwNCiAgICAgICAgICAgICAgICBnZXRfc3RhcnMocF92YWx1ZXNfc3RhcnRlcltpXSkpKQ0KfQ0KY2F0KCJcblNpZ25pZmljYW5jZSBjb2RlczogMCAnKioqJyAwLjAxICcqKicgMC4wNSAnKicgMC4xICcuJyAwLjE1IikNCmBgYA0KDQpgYGB7cn0NCiMgQ2FsY3VsYXRlIFZJRnMgZm9yIHRoZSBtb2RlbCB3aXRoIHN0YXJ0ZXIgcGxheWVycw0Kdmlmc19zdGFydGVyIDwtIHZpZihvbHNfc3RhcnRlcikNCiMgRmlsdGVyIHRvIHNob3cgb25seSBWSUZzIG92ZXIgNQ0KaGlnaF92aWZzX3N0YXJ0ZXIgPC0gdmlmc19zdGFydGVyW3ZpZnNfc3RhcnRlciA+IDVdDQppZihsZW5ndGgoaGlnaF92aWZzX3N0YXJ0ZXIpID4gMCkgew0KICBjYXQoIlxuU3RhcnRlciBQbGF5ZXJzOiBWYXJpYWJsZXMgd2l0aCBWSUYgPiA1OlxuIikNCiAgcHJpbnQoaGlnaF92aWZzX3N0YXJ0ZXIpDQp9IGVsc2Ugew0KICBjYXQoIlxuTm8gdmFyaWFibGVzIHdpdGggVklGID4gNSBmb3VuZCBpbiB0aGUgU3RhcnRlciBQbGF5ZXJzIG1vZGVsXG4iKQ0KfQ0KYGBgDQoNCmBgYHtyfQ0KIyBDcmVhdGUgdGhlIG1vZGVsIG1hdHJpeCBmb3Igc3RhcnRlciBkYXRhIChleGNsdWRpbmcgdGhlIHJlc3BvbnNlIHZhcmlhYmxlKQ0KWF9zdGFydGVyIDwtIG1vZGVsLm1hdHJpeCh+IC4gLSBjb252ZXJzaW9uIC0gMSwgZGF0YSA9IHN0YXJ0ZXJfZGF0YSkgICMgLTEgcmVtb3ZlcyBpbnRlcmNlcHQNCiMgRmluZCBjb2x1bW5zIGNhdXNpbmcgbGluZWFyIGRlcGVuZGVuY2llcw0KbGluX2NvbWJvc19zdGFydGVyIDwtIGZpbmRMaW5lYXJDb21ib3MoWF9zdGFydGVyKQ0KIyBSZW1vdmUgcHJvYmxlbWF0aWMgY29sdW1ucyBmcm9tIHRoZSBkYXRhc2V0DQppZiAoIWlzLm51bGwobGluX2NvbWJvc19zdGFydGVyJHJlbW92ZSkpIHsNCiAgY29sc190b19yZW1vdmUgPC0gY29sbmFtZXMoWF9zdGFydGVyKVtsaW5fY29tYm9zX3N0YXJ0ZXIkcmVtb3ZlXQ0KICBjYXQoIlJlbW92ZWQgZnJvbSBzdGFydGVyIGRhdGE6IiwgcGFzdGUoY29sc190b19yZW1vdmUsIGNvbGxhcHNlPSIsICIpLCAiXG4iKQ0KICBzdGFydGVyX2RhdGEgPC0gc3RhcnRlcl9kYXRhWywgKGNvbHNfdG9fcmVtb3ZlKSA6PSBOVUxMLCB3aXRoID0gRkFMU0VdDQp9DQpgYGANCg0KDQpgYGB7cn0NCiMgUHJvYml0IG1vZGVsIHdpdGggcmVndWxhciBwbGF5ZXJzDQpwcm9iaXRfcmVndWxhciA8LSBnbG0oY29udmVyc2lvbiB+IC4sIGRhdGEgPSByZWd1bGFyX2RhdGEsIGZhbWlseSA9IGJpbm9taWFsKGxpbmsgPSAicHJvYml0IikpDQpgYGANCg0KYGBge3J9DQojIEdldCBIQzAtYWRqdXN0ZWQgei12YWx1ZXMgYW5kIHAtdmFsdWVzIGZvciByZWd1bGFyIHByb2JpdA0Kcm9idXN0X3Byb2JpdF9yZWd1bGFyIDwtIGNvZWZ0ZXN0KHByb2JpdF9yZWd1bGFyLCB2Y292ID0gdmNvdkhDKHByb2JpdF9yZWd1bGFyLCB0eXBlID0gIkhDMCIpKQ0Kel9zdGF0c19yZWd1bGFyIDwtIHJvYnVzdF9wcm9iaXRfcmVndWxhclssICJ6IHZhbHVlIl0NCnBfdmFsdWVzX3JlZ3VsYXIgPC0gcm9idXN0X3Byb2JpdF9yZWd1bGFyWywgIlByKD58enwpIl0NCg0KIyBQcmludCBoZWFkZXIgKG5vdGUgInotdmFsdWUiIGluc3RlYWQgb2YgInQtdmFsdWUiKQ0KY2F0KHNwcmludGYoIlxuXG4lLSpzICAlMTBzICAlMTBzICAlNHNcbiIsIG5hbWVfd2lkdGgsICJSZWd1bGFyIFBsYXllcnMgUHJvYml0IFZhcmlhYmxlIiwgInotdmFsdWUiLCAicC12YWx1ZSIsICJzaWciKSkNCmNhdChzcHJpbnRmKCIlLSpzICAlMTBzICAlMTBzICAlNHNcbiIsIG5hbWVfd2lkdGgsICItLS0tLS0tLS0tLS0tLS0iLCAiLS0tLS0tLSIsICItLS0tLS0tIiwgIi0tLS0iKSkNCmZvciAoaSBpbiAxOmxlbmd0aCh6X3N0YXRzX3JlZ3VsYXIpKSB7DQogICAgdmFyX25hbWUgPC0gcm93bmFtZXMocm9idXN0X3Byb2JpdF9yZWd1bGFyKVtpXQ0KICAgIGlmIChuY2hhcih2YXJfbmFtZSkgPiBuYW1lX3dpZHRoKSB7DQogICAgICAgIHZhcl9uYW1lIDwtIHBhc3RlMChzdWJzdHIodmFyX25hbWUsIDEsIG5hbWVfd2lkdGgtMyksICIuLi4iKQ0KICAgIH0NCiAgICBjYXQoc3ByaW50ZigiJS0qcyAgJTEwLjRmICAlMTAuNGYgICU0c1xuIiwgDQogICAgICAgICAgICAgICAgbmFtZV93aWR0aCwgdmFyX25hbWUsIA0KICAgICAgICAgICAgICAgIHpfc3RhdHNfcmVndWxhcltpXSwgcF92YWx1ZXNfcmVndWxhcltpXSwNCiAgICAgICAgICAgICAgICBnZXRfc3RhcnMocF92YWx1ZXNfcmVndWxhcltpXSkpKQ0KfQ0KY2F0KCJcblNpZ25pZmljYW5jZSBjb2RlczogMCAnKioqJyAwLjAxICcqKicgMC4wNSAnKicgMC4xICcuJyAwLjE1IikNCmBgYA0KDQoNCmBgYHtyfQ0KIyBQcm9iaXQgbW9kZWwgd2l0aCBzdGFydGVyIHBsYXllcnMNCnByb2JpdF9zdGFydGVyIDwtIGdsbShjb252ZXJzaW9uIH4gLiwgZGF0YSA9IHN0YXJ0ZXJfZGF0YSwgZmFtaWx5ID0gYmlub21pYWwobGluayA9ICJwcm9iaXQiKSkNCmBgYA0KDQpgYGB7cn0NCiMgR2V0IEhDMC1hZGp1c3RlZCB6LXZhbHVlcyBhbmQgcC12YWx1ZXMgZm9yIHN0YXJ0ZXIgcHJvYml0DQpyb2J1c3RfcHJvYml0X3N0YXJ0ZXIgPC0gY29lZnRlc3QocHJvYml0X3N0YXJ0ZXIsIHZjb3YgPSB2Y292SEMocHJvYml0X3N0YXJ0ZXIsIHR5cGUgPSAiSEMwIikpDQp6X3N0YXRzX3N0YXJ0ZXIgPC0gcm9idXN0X3Byb2JpdF9zdGFydGVyWywgInogdmFsdWUiXQ0KcF92YWx1ZXNfc3RhcnRlciA8LSByb2J1c3RfcHJvYml0X3N0YXJ0ZXJbLCAiUHIoPnx6fCkiXQ0KDQojIFByaW50IGhlYWRlciAobm90ZSAiei12YWx1ZSIgaW5zdGVhZCBvZiAidC12YWx1ZSIpDQpjYXQoc3ByaW50ZigiXG5cbiUtKnMgICUxMHMgICUxMHMgICU0c1xuIiwgbmFtZV93aWR0aCwgIlN0YXJ0ZXIgUGxheWVycyBQcm9iaXQgVmFyaWFibGUiLCAiei12YWx1ZSIsICJwLXZhbHVlIiwgInNpZyIpKQ0KY2F0KHNwcmludGYoIiUtKnMgICUxMHMgICUxMHMgICU0c1xuIiwgbmFtZV93aWR0aCwgIi0tLS0tLS0tLS0tLS0tLSIsICItLS0tLS0tIiwgIi0tLS0tLS0iLCAiLS0tLSIpKQ0KZm9yIChpIGluIDE6bGVuZ3RoKHpfc3RhdHNfc3RhcnRlcikpIHsNCiAgICB2YXJfbmFtZSA8LSByb3duYW1lcyhyb2J1c3RfcHJvYml0X3N0YXJ0ZXIpW2ldDQogICAgaWYgKG5jaGFyKHZhcl9uYW1lKSA+IG5hbWVfd2lkdGgpIHsNCiAgICAgICAgdmFyX25hbWUgPC0gcGFzdGUwKHN1YnN0cih2YXJfbmFtZSwgMSwgbmFtZV93aWR0aC0zKSwgIi4uLiIpDQogICAgfQ0KICAgIGNhdChzcHJpbnRmKCIlLSpzICAlMTAuNGYgICUxMC40ZiAgJTRzXG4iLCANCiAgICAgICAgICAgICAgICBuYW1lX3dpZHRoLCB2YXJfbmFtZSwgDQogICAgICAgICAgICAgICAgel9zdGF0c19zdGFydGVyW2ldLCBwX3ZhbHVlc19zdGFydGVyW2ldLA0KICAgICAgICAgICAgICAgIGdldF9zdGFycyhwX3ZhbHVlc19zdGFydGVyW2ldKSkpDQp9DQpjYXQoIlxuU2lnbmlmaWNhbmNlIGNvZGVzOiAwICcqKionIDAuMDEgJyoqJyAwLjA1ICcqJyAwLjEgJy4nIDAuMTUiKQ0KYGBgDQoNCg0KYGBge3J9DQojIE1vZGVsIGNvbXBhcmlzb24gc3VtbWFyeQ0KY2F0KCJcblxuLS0tIE1vZGVsIENvbXBhcmlzb24gU3VtbWFyeSAtLS1cbiIpDQpjYXQoIk9MUyBSZWd1bGFyIFBsYXllcnMgUi1zcXVhcmVkOiIsIHJvdW5kKHN1bW1hcnkob2xzX3JlZ3VsYXIpJHIuc3F1YXJlZCwgNCksICJcbiIpDQpjYXQoIk9MUyBTdGFydGVyIFBsYXllcnMgUi1zcXVhcmVkOiIsIHJvdW5kKHN1bW1hcnkob2xzX3N0YXJ0ZXIpJHIuc3F1YXJlZCwgNCksICJcbiIpDQpjYXQoIk9MUyBSZWd1bGFyIFBsYXllcnMgQWRqIFItc3F1YXJlZDoiLCByb3VuZChzdW1tYXJ5KG9sc19yZWd1bGFyKSRhZGouci5zcXVhcmVkLCA0KSwgIlxuIikNCmNhdCgiT0xTIFN0YXJ0ZXIgUGxheWVycyBBZGogUi1zcXVhcmVkOiIsIHJvdW5kKHN1bW1hcnkob2xzX3N0YXJ0ZXIpJGFkai5yLnNxdWFyZWQsIDQpLCAiXG5cbiIpDQoNCmNhdCgiUHJvYml0IFJlZ3VsYXIgUGxheWVycyBBSUM6Iiwgcm91bmQocHJvYml0X3JlZ3VsYXIkYWljLCAyKSwgIlxuIikNCmNhdCgiUHJvYml0IFN0YXJ0ZXIgUGxheWVycyBBSUM6Iiwgcm91bmQocHJvYml0X3N0YXJ0ZXIkYWljLCAyKSwgIlxuIikNCmNhdCgiUHJvYml0IFJlZ3VsYXIgUGxheWVycyBNY0ZhZGRlbidzIFBzZXVkbyBSwrI6Iiwgcm91bmQoMSAtIHByb2JpdF9yZWd1bGFyJGRldmlhbmNlL3Byb2JpdF9yZWd1bGFyJG51bGwuZGV2aWFuY2UsIDQpLCAiXG4iKQ0KY2F0KCJQcm9iaXQgU3RhcnRlciBQbGF5ZXJzIE1jRmFkZGVuJ3MgUHNldWRvIFLCsjoiLCByb3VuZCgxIC0gcHJvYml0X3N0YXJ0ZXIkZGV2aWFuY2UvcHJvYml0X3N0YXJ0ZXIkbnVsbC5kZXZpYW5jZSwgNCksICJcbiIpDQpgYGANCg0KDQpgYGB7cn0NCiMgRnVuY3Rpb24gdG8gZ2V0IHRvcCBjb2VmZmljaWVudHMgYnkgYWJzb2x1dGUgdmFsdWUNCmdldF90b3BfY29lZmZpY2llbnRzIDwtIGZ1bmN0aW9uKG1vZGVsX3Jlc3VsdHMsIG4gPSAxMCkgew0KICBjb2VmcyA8LSBtb2RlbF9yZXN1bHRzWywgIkVzdGltYXRlIl0NCiAgIyBSZW1vdmUgaW50ZXJjZXB0DQogIGNvZWZzIDwtIGNvZWZzW25hbWVzKGNvZWZzKSAhPSAiKEludGVyY2VwdCkiXQ0KICAjIFNvcnQgYnkgYWJzb2x1dGUgdmFsdWUNCiAgc29ydGVkX2luZGljZXMgPC0gb3JkZXIoYWJzKGNvZWZzKSwgZGVjcmVhc2luZyA9IFRSVUUpDQogIHRvcF9jb2VmcyA8LSBjb2Vmc1tzb3J0ZWRfaW5kaWNlc1sxOm1pbihuLCBsZW5ndGgoc29ydGVkX2luZGljZXMpKV1dDQogIHJldHVybih0b3BfY29lZnMpDQp9DQoNCiMgRGlzcGxheSB0b3AgY29lZmZpY2llbnRzIGZvciBlYWNoIG1vZGVsDQpjYXQoIlxuXG5Ub3AgMTAgSW5mbHVlbnRpYWwgVmFyaWFibGVzIGJ5IEFic29sdXRlIENvZWZmaWNpZW50IFZhbHVlXG4iKQ0KDQpjYXQoIlxuT0xTIFJlZ3VsYXIgUGxheWVyczpcbiIpDQpwcmludChnZXRfdG9wX2NvZWZmaWNpZW50cyhyb2J1c3RfcmVndWxhcl90ZXN0KSkNCg0KY2F0KCJcbk9MUyBTdGFydGVyIFBsYXllcnM6XG4iKQ0KcHJpbnQoZ2V0X3RvcF9jb2VmZmljaWVudHMocm9idXN0X3N0YXJ0ZXJfdGVzdCkpDQoNCmNhdCgiXG5Qcm9iaXQgUmVndWxhciBQbGF5ZXJzOlxuIikNCnByaW50KGdldF90b3BfY29lZmZpY2llbnRzKHJvYnVzdF9wcm9iaXRfcmVndWxhcikpDQoNCmNhdCgiXG5Qcm9iaXQgU3RhcnRlciBQbGF5ZXJzOlxuIikNCnByaW50KGdldF90b3BfY29lZmZpY2llbnRzKHJvYnVzdF9wcm9iaXRfc3RhcnRlcikpDQpgYGA=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("thirddown.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
