<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Third Down Analysis with Regular and Starter Players</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">4th Downs in the NFL</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="heckman.html">Heckman Selection</a>
</li>
<li>
  <a href="xgboost.html">XGBoost Prediction</a>
</li>
<li>
  <a href="attendance_binary.html">Attendance Impact Binary</a>
</li>
<li>
  <a href="thirddown.html">Third Down Analysis</a>
</li>
<li>
  <a href="attempt_ols.html">Attempts OLS</a>
</li>
<li>
  <a href="robustness_checks.html">Robustness Checks</a>
</li>
<li>
  <a href="Writing.html">Writing</a>
</li>
<li>
  <a href="kicker_exogenous.html">Proof of Exogeniety</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Third Down Analysis with Regular and
Starter Players</h1>

</div>


<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(data.table)             </span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>ctd1 <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">&quot;predict_ctd1.csv.gz&quot;</span>)                        </span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">#kill my_id</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>ctd1<span class="sc">$</span>my_id <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>ctd1[, year2017_team_ARI <span class="sc">:=</span> <span class="cn">NULL</span>]</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># make score_diff be binary 1 if positive, 0 if negative or = 0</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>ctd1[, score_diff <span class="sc">:=</span> <span class="fu">as.integer</span>(score_diff <span class="sc">&gt;</span> <span class="dv">0</span>)]</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Identify player columns</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>all_cols <span class="ot">&lt;-</span> <span class="fu">colnames</span>(ctd1)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># Create regex patterns to identify regular and starter player variables</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>offense_player_pattern <span class="ot">&lt;-</span> <span class="st">&quot;^offense_player_</span><span class="sc">\\</span><span class="st">d+_&quot;</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>defense_player_pattern <span class="ot">&lt;-</span> <span class="st">&quot;^defense_player_</span><span class="sc">\\</span><span class="st">d+_&quot;</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>starter_offense_pattern <span class="ot">&lt;-</span> <span class="st">&quot;^starter_offense_player_</span><span class="sc">\\</span><span class="st">d+_&quot;</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>starter_defense_pattern <span class="ot">&lt;-</span> <span class="st">&quot;^starter_defense_player_</span><span class="sc">\\</span><span class="st">d+_&quot;</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co"># Get columns for each type</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>offense_player_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(offense_player_pattern, all_cols, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>defense_player_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(defense_player_pattern, all_cols, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>starter_offense_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(starter_offense_pattern, all_cols, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>starter_defense_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(starter_defense_pattern, all_cols, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co"># All player columns</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>regular_player_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(offense_player_cols, defense_player_cols)</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>starter_player_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(starter_offense_cols, starter_defense_cols)</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>all_player_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(regular_player_cols, starter_player_cols)</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co"># Non-player columns (common to both datasets)</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>common_cols <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(all_cols, all_player_cols)</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co"># Create two datasets</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a>regular_data <span class="ot">&lt;-</span> ctd1[, <span class="fu">c</span>(common_cols, regular_player_cols), with <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a>starter_data <span class="ot">&lt;-</span> ctd1[, <span class="fu">c</span>(common_cols, starter_player_cols), with <span class="ot">=</span> <span class="cn">FALSE</span>]</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Then run OLS with regular players</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>ols_regular <span class="ot">&lt;-</span> <span class="fu">lm</span>(conversion <span class="sc">~</span> ., <span class="at">data =</span> regular_data)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co"># Get HC0-adjusted t-values and p-values</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>robust_regular_test <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(ols_regular, <span class="at">vcov =</span> <span class="fu">vcovHC</span>(ols_regular, <span class="at">type =</span> <span class="st">&quot;HC0&quot;</span>))</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>t_stats_regular <span class="ot">&lt;-</span> robust_regular_test[, <span class="st">&quot;t value&quot;</span>]</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>p_values_regular <span class="ot">&lt;-</span> robust_regular_test[, <span class="st">&quot;Pr(&gt;|t|)&quot;</span>]</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co"># Function to add significance stars</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>get_stars <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>    <span class="cf">if</span> (p <span class="sc">&lt;=</span> <span class="fl">0.01</span>) <span class="fu">return</span>(<span class="st">&quot;***&quot;</span>)</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>    <span class="cf">if</span> (p <span class="sc">&lt;=</span> <span class="fl">0.05</span>) <span class="fu">return</span>(<span class="st">&quot;**&quot;</span>)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>    <span class="cf">if</span> (p <span class="sc">&lt;=</span> <span class="fl">0.1</span>) <span class="fu">return</span>(<span class="st">&quot;*&quot;</span>)</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>    <span class="cf">if</span> (p <span class="sc">&lt;=</span> <span class="fl">0.15</span>) <span class="fu">return</span>(<span class="st">&quot;.&quot;</span>)</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>}</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co"># Maximum width for variable names</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>name_width <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co"># Print header with alignment</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10s  %10s  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, name_width, <span class="st">&quot;Regular Players OLS Variable&quot;</span>, <span class="st">&quot;t-value&quot;</span>, <span class="st">&quot;p-value&quot;</span>, <span class="st">&quot;sig&quot;</span>))</span></code></pre></div>
<pre><code>## Regular Players OLS Variable                                     t-value     p-value   sig</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10s  %10s  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, name_width, <span class="st">&quot;---------&quot;</span>, <span class="st">&quot;-------&quot;</span>, <span class="st">&quot;-------&quot;</span>, <span class="st">&quot;----&quot;</span>))</span></code></pre></div>
<pre><code>## ---------                                                        -------     -------  ----</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Loop through and print values</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(t_stats_regular)) {</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>    var_name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(robust_regular_test)[i]</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>    <span class="co"># Truncate name if too long</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nchar</span>(var_name) <span class="sc">&gt;</span> name_width) {</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>        var_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">substr</span>(var_name, <span class="dv">1</span>, name_width<span class="dv">-3</span>), <span class="st">&quot;...&quot;</span>)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>    }</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10.4f  %10.4f  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, </span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>                name_width, var_name, </span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>                t_stats_regular[i], p_values_regular[i],</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>                <span class="fu">get_stars</span>(p_values_regular[i])))</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## (Intercept)                                                       7.5882      0.0000   ***
## ydstogo                                                         -69.2598      0.0000   ***
## posteam_timeouts_remaining                                        2.8341      0.0046   ***
## defteam_timeouts_remaining                                        4.5194      0.0000   ***
## rush_attempt                                                     16.5618      0.0000   ***
## week                                                             -2.4775      0.0132    **
## temp                                                              0.2939      0.7688      
## wind                                                             -1.1373      0.2554      
## vegas_wp                                                         -4.9302      0.0000   ***
## spread_line                                                      -3.0136      0.0026   ***
## total_line                                                        1.6358      0.1019     .
## p_player_26_punting_grades_grades_punter_12w                     -3.5671      0.0004   ***
## k_player_25_field_goals_grades_grades_fgep_kicker_12w             4.1681      0.0000   ***
## score_diff                                                       -0.1993      0.8420      
## down4_pct                                                        -0.6652      0.5059      
## prep_days                                                        -1.7518      0.0798     *
## overall_win_pct                                                   2.6118      0.0090   ***
## team_win_pct                                                      6.0333      0.0000   ***
## prev_win_pct                                                      1.6008      0.1094     .
## prev_shotgun_rate                                                -0.3994      0.6896      
## prev_singleback_rate                                             -0.6874      0.4919      
## prev_empty_rate                                                  -0.6211      0.5346      
## prev_iform_rate                                                   0.1021      0.9187      
## prev_shotgun_success                                              1.2422      0.2142      
## prev_singleback_success                                           0.2165      0.8286      
## prev_empty_success                                                0.4221      0.6730      
## prev_iform_success                                               -0.8137      0.4158      
## prev_stop_rate_run                                                0.3018      0.7628      
## prev_stop_rate_pass                                              -1.8074      0.0707     *
## shotgun_rate                                                      1.4430      0.1490     .
## singleback_rate                                                   0.3342      0.7382      
## empty_rate                                                        1.2428      0.2140      
## iform_rate                                                        0.7442      0.4568      
## shotgun_success                                                  -3.2050      0.0014   ***
## singleback_success                                                0.7875      0.4310      
## empty_success                                                    -0.7178      0.4729      
## iform_success                                                    -0.9111      0.3623      
## def_stop_rate_run                                                -0.9556      0.3393      
## def_stop_rate_pass                                                0.3210      0.7482      
## avg_pass_rushers                                                 -0.8400      0.4009      
## avg_box_defenders                                                 0.2487      0.8036      
## cover0_rate                                                      -3.1848      0.0014   ***
## cover1_rate                                                      -1.2696      0.2042      
## cover2_rate                                                      -1.0406      0.2981      
## cover3_rate                                                      -1.7249      0.0846     *
## cover4_rate                                                      -2.4190      0.0156    **
## cover6_rate                                                      -1.3002      0.1935      
## two_man_rate                                                      0.0208      0.9834      
## prevent_rate                                                     -0.7274      0.4670      
## home_attendance                                                  -1.2579      0.2084      
## roof_outdoors                                                    -0.8570      0.3914      
## posteam_type_home                                                 4.5882      0.0000   ***
## offense_formation_EMPTY                                          -0.7295      0.4657      
## offense_formation_SHOTGUN                                        -1.2791      0.2009      
## offense_formation_SINGLEBACK                                     -0.4578      0.6471      
## offense_formation_I_FORM                                          0.3942      0.6934      
## yardline_1_10                                                    -3.6510      0.0003   ***
## yardline_11_20                                                   -2.3462      0.0190    **
## yardline_21_30                                                   -2.3200      0.0203    **
## yardline_41_50                                                   -0.4151      0.6781      
## yardline_51_60                                                   -0.8858      0.3757      
## yardline_61_70                                                   -3.5843      0.0003   ***
## yardline_71_80                                                   -3.8166      0.0001   ***
## yardline_81_90                                                   -6.1031      0.0000   ***
## yardline_91_100                                                  -8.8430      0.0000   ***
## year2017_team_BUF                                                -0.2875      0.7737      
## year2017_team_CHI                                                -0.0882      0.9297      
## year2017_team_CLE                                                 0.7690      0.4419      
## year2017_team_DAL                                                -0.6041      0.5458      
## year2017_team_DET                                                -0.2104      0.8333      
## year2017_team_GB                                                 -0.0612      0.9512      
## year2017_team_HOU                                                -0.4014      0.6882      
## year2017_team_MIA                                                 0.2987      0.7652      
## year2017_team_MIN                                                -1.7358      0.0826     *
## year2017_team_NE                                                 -1.1271      0.2597      
## year2017_team_NYJ                                                -0.0380      0.9697      
## year2017_team_PHI                                                -0.3615      0.7177      
## year2017_team_SF                                                  0.0299      0.9762      
## year2017_team_TEN                                                -0.7483      0.4543      
## year2017_team_WAS                                                -1.3906      0.1644      
## year2017_team_ATL                                                -1.1932      0.2328      
## year2017_team_BAL                                                -0.6631      0.5073      
## year2017_team_CIN                                                -0.6246      0.5322      
## year2017_team_DEN                                                -0.5898      0.5553      
## year2017_team_KC                                                 -0.0115      0.9908      
## year2017_team_LA                                                 -0.0298      0.9762      
## year2017_team_NO                                                 -0.4345      0.6639      
## year2017_team_NYG                                                -1.2801      0.2005      
## year2017_team_OAK                                                -1.2497      0.2114      
## year2017_team_PIT                                                -1.4703      0.1415     .
## year2017_team_SEA                                                -0.4853      0.6274      
## year2017_team_TB                                                  1.6073      0.1080     .
## year2017_team_CAR                                                -0.9356      0.3495      
## year2017_team_IND                                                 0.1721      0.8634      
## year2017_team_JAX                                                -1.0943      0.2738      
## year2017_team_LAC                                                -0.7433      0.4573      
## year2018_team_ARI                                                 0.9193      0.3579      
## year2018_team_BAL                                                 0.3384      0.7351      
## year2018_team_CAR                                                 1.2854      0.1987      
## year2018_team_CLE                                                 0.0926      0.9262      
## year2018_team_DET                                                 0.3167      0.7515      
## year2018_team_HOU                                                 1.5422      0.1230     .
## year2018_team_IND                                                 1.0128      0.3112      
## year2018_team_KC                                                  0.9124      0.3616      
## year2018_team_LAC                                                 0.8459      0.3976      
## year2018_team_MIA                                                 0.8408      0.4005      
## year2018_team_MIN                                                -0.3613      0.7179      
## year2018_team_NE                                                  0.0488      0.9611      
## year2018_team_NYG                                                 1.5539      0.1202     .
## year2018_team_OAK                                                 1.8804      0.0601     *
## year2018_team_PHI                                                 1.1312      0.2580      
## year2018_team_SEA                                                 1.0720      0.2837      
## year2018_team_BUF                                                 0.2039      0.8384      
## year2018_team_CHI                                                 0.1979      0.8431      
## year2018_team_CIN                                                 1.8304      0.0672     *
## year2018_team_DAL                                                 1.0369      0.2998      
## year2018_team_DEN                                                 0.8873      0.3749      
## year2018_team_GB                                                  0.2144      0.8302      
## year2018_team_NO                                                  0.8278      0.4078      
## year2018_team_NYJ                                                 0.4996      0.6173      
## year2018_team_PIT                                                 1.2162      0.2239      
## year2018_team_SF                                                  1.2256      0.2203      
## year2018_team_TEN                                                 1.3036      0.1924      
## year2018_team_TB                                                  2.0893      0.0367    **
## year2018_team_ATL                                                 1.4423      0.1492     .
## year2018_team_JAX                                                 0.9481      0.3431      
## year2018_team_LA                                                  0.0949      0.9244      
## year2018_team_WAS                                                 2.1613      0.0307    **
## year2019_team_ARI                                                 1.6947      0.0901     *
## year2019_team_BUF                                                 0.7241      0.4690      
## year2019_team_CHI                                                 1.0509      0.2933      
## year2019_team_CLE                                                 0.9794      0.3274      
## year2019_team_DAL                                                 0.5460      0.5851      
## year2019_team_IND                                                 1.1768      0.2393      
## year2019_team_JAX                                                 0.8194      0.4126      
## year2019_team_KC                                                 -0.1431      0.8862      
## year2019_team_LAC                                                 1.5598      0.1188     .
## year2019_team_MIN                                                 2.0189      0.0435    **
## year2019_team_NE                                                  0.0728      0.9420      
## year2019_team_NO                                                 -0.4204      0.6742      
## year2019_team_PHI                                                 1.7118      0.0869     *
## year2019_team_SEA                                                 0.7815      0.4345      
## year2019_team_SF                                                  1.3305      0.1834      
## year2019_team_TB                                                  0.9152      0.3601      
## year2019_team_ATL                                                 2.1279      0.0333    **
## year2019_team_BAL                                                 1.0785      0.2808      
## year2019_team_CAR                                                 0.7563      0.4495      
## year2019_team_CIN                                                 1.2857      0.1986      
## year2019_team_DEN                                                 0.1141      0.9091      
## year2019_team_DET                                                 0.5260      0.5989      
## year2019_team_HOU                                                 1.1282      0.2592      
## year2019_team_LA                                                  0.0555      0.9557      
## year2019_team_MIA                                                 1.1301      0.2584      
## year2019_team_NYG                                                 1.6765      0.0936     *
## year2019_team_NYJ                                                 1.2867      0.1982      
## year2019_team_OAK                                                 1.0897      0.2759      
## year2019_team_PIT                                                 0.3304      0.7411      
## year2019_team_TEN                                                 0.4867      0.6265      
## year2019_team_WAS                                                 0.6563      0.5117      
## year2019_team_GB                                                  0.2462      0.8055      
## year2020_team_ATL                                                 1.0465      0.2953      
## year2020_team_BAL                                                -0.1883      0.8506      
## year2020_team_BUF                                                 1.5972      0.1102     .
## year2020_team_CAR                                                 2.3735      0.0176    **
## year2020_team_CIN                                                 0.4068      0.6841      
## year2020_team_DEN                                                 1.4631      0.1434     .
## year2020_team_DET                                                 1.4391      0.1501      
## year2020_team_JAX                                                 1.4984      0.1340     .
## year2020_team_KC                                                  0.6106      0.5415      
## year2020_team_LA                                                  1.0733      0.2831      
## year2020_team_MIN                                                 0.0726      0.9421      
## year2020_team_NE                                                  0.7138      0.4754      
## year2020_team_NO                                                  0.3716      0.7102      
## year2020_team_NYG                                                 0.6154      0.5383      
## year2020_team_SF                                                  0.5049      0.6137      
## year2020_team_WAS                                                 1.0152      0.3100      
## year2020_team_CHI                                                 0.1663      0.8679      
## year2020_team_DAL                                                 0.6582      0.5104      
## year2020_team_GB                                                  0.4699      0.6384      
## year2020_team_HOU                                                 1.7596      0.0785     *
## year2020_team_LV                                                  1.2500      0.2113      
## year2020_team_MIA                                                 0.0771      0.9386      
## year2020_team_NYJ                                                 0.2979      0.7658      
## year2020_team_TB                                                  0.3984      0.6903      
## year2020_team_TEN                                                 1.1503      0.2500      
## year2020_team_ARI                                                 1.2888      0.1975      
## year2020_team_CLE                                                 1.2588      0.2081      
## year2020_team_IND                                                 1.1063      0.2686      
## year2020_team_LAC                                                 0.9911      0.3217      
## year2020_team_PHI                                                 1.0695      0.2848      
## year2020_team_SEA                                                 0.5773      0.5638      
## year2020_team_PIT                                                 0.4579      0.6470      
## year2021_team_ATL                                                 1.7420      0.0815     *
## year2021_team_BUF                                                 0.3812      0.7031      
## year2021_team_CIN                                                 1.8617      0.0627     *
## year2021_team_DAL                                                 0.7816      0.4344      
## year2021_team_DEN                                                 0.9515      0.3414      
## year2021_team_DET                                                 1.3366      0.1814      
## year2021_team_HOU                                                 1.6068      0.1081     .
## year2021_team_KC                                                  1.9057      0.0567     *
## year2021_team_LA                                                 -0.3047      0.7606      
## year2021_team_LV                                                  0.5886      0.5562      
## year2021_team_MIN                                                -0.0122      0.9902      
## year2021_team_NE                                                  0.0301      0.9760      
## year2021_team_NO                                                  0.6728      0.5011      
## year2021_team_NYG                                                 1.5739      0.1155     .
## year2021_team_SF                                                  1.9655      0.0494    **
## year2021_team_TEN                                                 0.3699      0.7114      
## year2021_team_ARI                                                 0.8159      0.4145      
## year2021_team_BAL                                                -0.0408      0.9674      
## year2021_team_CAR                                                 0.9649      0.3346      
## year2021_team_CHI                                                 1.0092      0.3129      
## year2021_team_GB                                                  0.7358      0.4619      
## year2021_team_IND                                                 0.8852      0.3761      
## year2021_team_LAC                                                 2.2430      0.0249    **
## year2021_team_MIA                                                 1.1963      0.2316      
## year2021_team_NYJ                                                 2.2287      0.0258    **
## year2021_team_PHI                                                 0.9753      0.3294      
## year2021_team_SEA                                                 0.6730      0.5009      
## year2021_team_TB                                                  1.7630      0.0779     *
## year2021_team_WAS                                                 1.6678      0.0954     *
## year2021_team_CLE                                                 0.3946      0.6931      
## year2021_team_JAX                                                 1.1597      0.2462      
## year2021_team_PIT                                                 1.2077      0.2272      
## year2022_team_ARI                                                 0.9207      0.3572      
## year2022_team_ATL                                                 1.9136      0.0557     *
## year2022_team_CAR                                                 0.3964      0.6918      
## year2022_team_CHI                                                 2.4566      0.0140    **
## year2022_team_CIN                                                 1.8194      0.0689     *
## year2022_team_HOU                                                 1.1352      0.2563      
## year2022_team_IND                                                 0.0104      0.9917      
## year2022_team_LAC                                                 0.6173      0.5370      
## year2022_team_MIA                                                 1.8367      0.0663     *
## year2022_team_MIN                                                 1.0349      0.3007      
## year2022_team_NE                                                  1.1329      0.2573      
## year2022_team_NYJ                                                 0.9265      0.3542      
## year2022_team_SEA                                                 0.8587      0.3905      
## year2022_team_TB                                                 -0.0739      0.9411      
## year2022_team_TEN                                                 0.4133      0.6794      
## year2022_team_WAS                                                 0.6978      0.4853      
## year2022_team_BAL                                                 0.7914      0.4287      
## year2022_team_BUF                                                 1.0343      0.3010      
## year2022_team_DAL                                                 0.1028      0.9181      
## year2022_team_DET                                                 0.2219      0.8244      
## year2022_team_GB                                                  0.5464      0.5848      
## year2022_team_JAX                                                 1.4723      0.1409     .
## year2022_team_KC                                                  2.2093      0.0272    **
## year2022_team_LA                                                  0.5879      0.5566      
## year2022_team_LV                                                  0.9225      0.3563      
## year2022_team_NO                                                  1.2458      0.2128      
## year2022_team_PHI                                                 1.0540      0.2919      
## year2022_team_PIT                                                 1.0815      0.2795      
## year2022_team_SF                                                  1.0000      0.3173      
## year2022_team_CLE                                                 0.5912      0.5544      
## year2022_team_DEN                                                -0.3892      0.6971      
## year2022_team_NYG                                                 1.1614      0.2455      
## year2023_team_BAL                                                 0.1288      0.8975      
## year2023_team_CHI                                                 1.9008      0.0573     *
## year2023_team_CLE                                                 0.3725      0.7095      
## year2023_team_GB                                                  0.1979      0.8431      
## year2023_team_IND                                                 0.0869      0.9307      
## year2023_team_KC                                                  1.1871      0.2352      
## year2023_team_LAC                                                 0.9077      0.3641      
## year2023_team_LV                                                  0.1317      0.8952      
## year2023_team_MIA                                                 1.3507      0.1768      
## year2023_team_MIN                                                 0.9527      0.3408      
## year2023_team_NO                                                  0.5192      0.6036      
## year2023_team_NYG                                                 1.6621      0.0965     *
## year2023_team_NYJ                                                 0.6923      0.4888      
## year2023_team_SEA                                                 0.7623      0.4459      
## year2023_team_SF                                                  1.3144      0.1887      
## year2023_team_WAS                                                 1.4489      0.1474     .
## year2023_team_ATL                                                 0.9349      0.3498      
## year2023_team_BUF                                                 2.0429      0.0411    **
## year2023_team_CAR                                                 1.0696      0.2848      
## year2023_team_DAL                                                 1.3385      0.1807      
## year2023_team_DEN                                                 0.0984      0.9216      
## year2023_team_HOU                                                 1.1048      0.2693      
## year2023_team_LA                                                  0.6279      0.5301      
## year2023_team_NE                                                  1.2974      0.1945      
## year2023_team_PHI                                                 2.2766      0.0228    **
## year2023_team_PIT                                                 0.5429      0.5872      
## year2023_team_TEN                                                 0.5331      0.5940      
## year2023_team_ARI                                                 2.2044      0.0275    **
## year2023_team_CIN                                                 1.1820      0.2372      
## year2023_team_DET                                                 0.7832      0.4335      
## year2023_team_TB                                                  1.1202      0.2626      
## year2023_team_JAX                                                 0.0731      0.9417      
## is_first_half                                                     3.2495      0.0012   ***
## time_in_half                                                     -1.9090      0.0563     *
## offense_player_1_passing_depth_short_grades_pass_12w              0.2265      0.8208      
## offense_player_1_passing_depth_medium_grades_pass_12w             2.6343      0.0084   ***
## offense_player_1_passing_depth_deep_grades_pass_12w               1.0658      0.2865      
## offense_player_4_rushing_grades_first_downs_12w                   0.7202      0.4714      
## offense_player_4_rushing_grades_yards_12w                        -0.9168      0.3593      
## offense_player_4_receiving_grades_grades_pass_block_12w          -0.3082      0.7579      
## offense_player_4_receiving_grades_grades_offense_12w              0.9132      0.3611      
## offense_player_8_receiving_depth_short_grades_pass_route_12w     -0.7546      0.4505      
## offense_player_8_receiving_depth_medium_grades_pass_route...     -1.4848      0.1376     .
## offense_player_8_receiving_depth_deep_grades_pass_route_12w       1.2728      0.2031      
## offense_player_9_receiving_depth_short_grades_pass_route_12w     -0.5119      0.6087      
## offense_player_9_receiving_depth_medium_grades_pass_route...      2.2852      0.0223    **
## offense_player_9_receiving_depth_deep_grades_pass_route_12w       0.2683      0.7885      
## offense_player_10_receiving_depth_short_grades_pass_route...     -0.1572      0.8751      
## offense_player_10_receiving_depth_medium_grades_pass_rout...     -0.0914      0.9272      
## offense_player_10_receiving_depth_deep_grades_pass_route_12w      1.4694      0.1417     .
## offense_player_14_receiving_depth_short_grades_pass_route...      0.1158      0.9078      
## offense_player_14_receiving_depth_medium_grades_pass_rout...      0.4689      0.6391      
## offense_player_14_receiving_depth_deep_grades_pass_route_12w      0.0125      0.9900      
## offense_player_17_blocking_grades_grades_pass_block_12w           0.5826      0.5601      
## offense_player_17_blocking_grades_grades_run_block_12w            0.4165      0.6771      
## offense_player_18_blocking_grades_grades_pass_block_12w           0.3079      0.7581      
## offense_player_18_blocking_grades_grades_run_block_12w            0.0624      0.9502      
## offense_player_19_blocking_grades_grades_pass_block_12w           0.0955      0.9239      
## offense_player_19_blocking_grades_grades_run_block_12w           -0.0277      0.9779      
## offense_player_20_blocking_grades_grades_pass_block_12w           1.6878      0.0915     *
## offense_player_20_blocking_grades_grades_run_block_12w           -0.0989      0.9212      
## offense_player_21_blocking_grades_grades_pass_block_12w           2.6549      0.0079   ***
## offense_player_21_blocking_grades_grades_run_block_12w           -1.8799      0.0601     *
## defense_player_1_defensive_grades_grades_run_defense_12w         -1.3048      0.1920      
## defense_player_1_defensive_grades_grades_pass_rush_defens...      0.5834      0.5596      
## defense_player_2_defensive_grades_grades_run_defense_12w         -0.5988      0.5493      
## defense_player_2_defensive_grades_grades_pass_rush_defens...      0.4996      0.6173      
## defense_player_3_defensive_grades_grades_run_defense_12w         -0.1857      0.8527      
## defense_player_3_defensive_grades_grades_pass_rush_defens...     -0.3175      0.7509      
## defense_player_4_defensive_grades_grades_run_defense_12w          1.4841      0.1378     .
## defense_player_4_defensive_grades_grades_pass_rush_defens...     -1.8719      0.0612     *
## defense_player_9_defensive_grades_grades_run_defense_12w          1.0088      0.3131      
## defense_player_9_defensive_grades_grades_pass_rush_defens...     -1.3260      0.1848      
## defense_player_9_coverage_schemes_zone_grades_coverage_de...      1.0043      0.3152      
## defense_player_9_coverage_schemes_man_grades_coverage_def...      0.1853      0.8530      
## defense_player_10_defensive_grades_grades_run_defense_12w         0.8936      0.3715      
## defense_player_10_defensive_grades_grades_pass_rush_defen...     -2.2507      0.0244    **
## defense_player_10_coverage_schemes_zone_grades_coverage_d...      1.1109      0.2666      
## defense_player_10_coverage_schemes_man_grades_coverage_de...     -1.3176      0.1877      
## defense_player_11_defensive_grades_grades_run_defense_12w         2.5699      0.0102    **
## defense_player_11_defensive_grades_grades_pass_rush_defen...     -0.2182      0.8273      
## defense_player_11_coverage_schemes_zone_grades_coverage_d...     -2.4446      0.0145    **
## defense_player_11_coverage_schemes_man_grades_coverage_de...     -0.4829      0.6292      
## defense_player_12_defensive_grades_grades_run_defense_12w        -2.1069      0.0351    **
## defense_player_12_defensive_grades_grades_pass_rush_defen...      0.4121      0.6802      
## defense_player_12_coverage_schemes_zone_grades_coverage_d...      1.8016      0.0716     *
## defense_player_12_coverage_schemes_man_grades_coverage_de...     -0.4148      0.6783      
## defense_player_15_defensive_grades_grades_run_defense_12w         0.3979      0.6907      
## defense_player_15_coverage_schemes_zone_grades_coverage_d...     -1.6792      0.0931     *
## defense_player_15_coverage_schemes_man_grades_coverage_de...      0.1888      0.8503      
## defense_player_16_defensive_grades_grades_run_defense_12w        -1.9528      0.0508     *
## defense_player_16_coverage_schemes_zone_grades_coverage_d...     -0.0834      0.9335      
## defense_player_16_coverage_schemes_man_grades_coverage_de...      0.5832      0.5597      
## defense_player_17_defensive_grades_grades_run_defense_12w        -0.6800      0.4965      
## defense_player_17_coverage_schemes_zone_grades_coverage_d...     -0.2149      0.8298      
## defense_player_17_coverage_schemes_man_grades_coverage_de...      0.0153      0.9878      
## defense_player_20_defensive_grades_grades_run_defense_12w        -1.4434      0.1489     .
## defense_player_20_coverage_schemes_zone_grades_coverage_d...      0.3029      0.7620      
## defense_player_20_coverage_schemes_man_grades_coverage_de...     -0.7033      0.4819      
## defense_player_21_defensive_grades_grades_run_defense_12w        -0.1092      0.9130      
## defense_player_21_coverage_schemes_zone_grades_coverage_d...      0.6773      0.4982      
## defense_player_21_coverage_schemes_man_grades_coverage_de...     -1.0198      0.3078      
## defense_player_22_defensive_grades_grades_run_defense_12w         1.5319      0.1256     .
## defense_player_22_coverage_schemes_zone_grades_coverage_d...     -1.2596      0.2078      
## defense_player_22_coverage_schemes_man_grades_coverage_de...     -0.5390      0.5899</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Load the car package which has the vif function</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co"># Calculate VIFs for the model with regular players</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>vifs_regular <span class="ot">&lt;-</span> <span class="fu">vif</span>(ols_regular)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co"># Filter to show only VIFs over 5</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>high_vifs_regular <span class="ot">&lt;-</span> vifs_regular[vifs_regular <span class="sc">&gt;</span> <span class="dv">5</span>]</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(high_vifs_regular) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Regular Players: Variables with VIF &gt; 5:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  <span class="fu">print</span>(high_vifs_regular)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">No variables with VIF &gt; 5 found in the Regular Players model</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## Regular Players: Variables with VIF &gt; 5:
##                                                   prev_shotgun_rate 
##                                                            9.779605 
##                                                prev_singleback_rate 
##                                                            5.984650 
##                                                        shotgun_rate 
##                                                           16.640148 
##                                                          empty_rate 
##                                                           12.962908 
##                                                         cover1_rate 
##                                                            6.771703 
##                                                         cover3_rate 
##                                                            7.238242 
##                                                     home_attendance 
##                                                            8.022602 
##                                             offense_formation_EMPTY 
##                                                            6.883656 
##                                           offense_formation_SHOTGUN 
##                                                            9.640785 
##                     offense_player_4_rushing_grades_first_downs_12w 
##                                                           10.621635 
##                           offense_player_4_rushing_grades_yards_12w 
##                                                           10.799432 
##            defense_player_2_defensive_grades_grades_run_defense_12w 
##                                                           10.179292 
##      defense_player_2_defensive_grades_grades_pass_rush_defense_12w 
##                                                           10.295844 
##            defense_player_3_defensive_grades_grades_run_defense_12w 
##                                                           33.422091 
##      defense_player_3_defensive_grades_grades_pass_rush_defense_12w 
##                                                           33.705855 
##            defense_player_4_defensive_grades_grades_run_defense_12w 
##                                                           44.378128 
##      defense_player_4_defensive_grades_grades_pass_rush_defense_12w 
##                                                           45.232715 
##           defense_player_10_defensive_grades_grades_run_defense_12w 
##                                                            9.140629 
##     defense_player_10_defensive_grades_grades_pass_rush_defense_12w 
##                                                            7.322191 
## defense_player_10_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                            7.899307 
##           defense_player_11_defensive_grades_grades_run_defense_12w 
##                                                           24.386300 
##     defense_player_11_defensive_grades_grades_pass_rush_defense_12w 
##                                                           20.544834 
## defense_player_11_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                           15.320037 
##  defense_player_11_coverage_schemes_man_grades_coverage_defense_12w 
##                                                            6.517831 
##           defense_player_12_defensive_grades_grades_run_defense_12w 
##                                                           29.683716 
##     defense_player_12_defensive_grades_grades_pass_rush_defense_12w 
##                                                           25.241687 
## defense_player_12_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                           17.313968 
##  defense_player_12_coverage_schemes_man_grades_coverage_defense_12w 
##                                                            5.659342 
##           defense_player_17_defensive_grades_grades_run_defense_12w 
##                                                           12.222766 
## defense_player_17_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                           13.740688 
##  defense_player_17_coverage_schemes_man_grades_coverage_defense_12w 
##                                                           10.719407 
##           defense_player_21_defensive_grades_grades_run_defense_12w 
##                                                           11.180047 
## defense_player_21_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                           10.537302 
##  defense_player_21_coverage_schemes_man_grades_coverage_defense_12w 
##                                                            8.963542 
##           defense_player_22_defensive_grades_grades_run_defense_12w 
##                                                           31.380330 
## defense_player_22_coverage_schemes_zone_grades_coverage_defense_12w 
##                                                           41.354039 
##  defense_player_22_coverage_schemes_man_grades_coverage_defense_12w 
##                                                           30.803002</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co"># Create the model matrix for regular data (excluding the response variable)</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>X_regular <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> . <span class="sc">-</span> conversion <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> regular_data)  <span class="co"># -1 removes intercept</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co"># Find columns causing linear dependencies</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>lin_combos_regular <span class="ot">&lt;-</span> <span class="fu">findLinearCombos</span>(X_regular)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co"># Remove problematic columns from the dataset</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(lin_combos_regular<span class="sc">$</span>remove)) {</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  cols_to_remove <span class="ot">&lt;-</span> <span class="fu">colnames</span>(X_regular)[lin_combos_regular<span class="sc">$</span>remove]</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Removed from regular data:&quot;</span>, <span class="fu">paste</span>(cols_to_remove, <span class="at">collapse=</span><span class="st">&quot;, &quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>  regular_data <span class="ot">&lt;-</span> regular_data[, (cols_to_remove) <span class="sc">:=</span> <span class="cn">NULL</span>, with <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Then run OLS with starter players</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>ols_starter <span class="ot">&lt;-</span> <span class="fu">lm</span>(conversion <span class="sc">~</span> ., <span class="at">data =</span> starter_data)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Get HC0-adjusted t-values and p-values</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>robust_starter_test <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(ols_starter, <span class="at">vcov =</span> <span class="fu">vcovHC</span>(ols_starter, <span class="at">type =</span> <span class="st">&quot;HC0&quot;</span>))</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>t_stats_starter <span class="ot">&lt;-</span> robust_starter_test[, <span class="st">&quot;t value&quot;</span>]</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>p_values_starter <span class="ot">&lt;-</span> robust_starter_test[, <span class="st">&quot;Pr(&gt;|t|)&quot;</span>]</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co"># Print header with alignment</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10s  %10s  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, name_width, <span class="st">&quot;Starter Players OLS Variable&quot;</span>, <span class="st">&quot;t-value&quot;</span>, <span class="st">&quot;p-value&quot;</span>, <span class="st">&quot;sig&quot;</span>))</span></code></pre></div>
<pre><code>## Starter Players OLS Variable                                     t-value     p-value   sig</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10s  %10s  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, name_width, <span class="st">&quot;---------&quot;</span>, <span class="st">&quot;-------&quot;</span>, <span class="st">&quot;-------&quot;</span>, <span class="st">&quot;----&quot;</span>))</span></code></pre></div>
<pre><code>## ---------                                                        -------     -------  ----</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># Loop through and print values</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(t_stats_starter)) {</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>    var_name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(robust_starter_test)[i]</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>    <span class="co"># Truncate name if too long</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nchar</span>(var_name) <span class="sc">&gt;</span> name_width) {</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>        var_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">substr</span>(var_name, <span class="dv">1</span>, name_width<span class="dv">-3</span>), <span class="st">&quot;...&quot;</span>)</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>    }</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10.4f  %10.4f  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, </span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>                name_width, var_name, </span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>                t_stats_starter[i], p_values_starter[i],</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>                <span class="fu">get_stars</span>(p_values_starter[i])))</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## (Intercept)                                                       7.4393      0.0000   ***
## ydstogo                                                         -70.6807      0.0000   ***
## posteam_timeouts_remaining                                        3.0428      0.0023   ***
## defteam_timeouts_remaining                                        4.3885      0.0000   ***
## rush_attempt                                                     16.3347      0.0000   ***
## week                                                             -1.9137      0.0557     *
## temp                                                              0.2794      0.7799      
## wind                                                             -1.3797      0.1677      
## vegas_wp                                                         -4.0639      0.0000   ***
## spread_line                                                      -3.3021      0.0010   ***
## total_line                                                        2.2456      0.0247    **
## p_player_26_punting_grades_grades_punter_12w                     -3.1337      0.0017   ***
## k_player_25_field_goals_grades_grades_fgep_kicker_12w             4.0693      0.0000   ***
## score_diff                                                       -0.7095      0.4780      
## down4_pct                                                        -0.3572      0.7209      
## prep_days                                                        -1.7603      0.0784     *
## overall_win_pct                                                   2.5538      0.0107    **
## team_win_pct                                                      6.3153      0.0000   ***
## prev_win_pct                                                      1.8451      0.0650     *
## prev_shotgun_rate                                                -0.5047      0.6138      
## prev_singleback_rate                                             -0.5918      0.5540      
## prev_empty_rate                                                  -0.9057      0.3651      
## prev_iform_rate                                                   0.0903      0.9280      
## prev_shotgun_success                                              1.4770      0.1397     .
## prev_singleback_success                                           0.3942      0.6934      
## prev_empty_success                                                0.5786      0.5628      
## prev_iform_success                                               -0.4984      0.6182      
## prev_stop_rate_run                                                0.3723      0.7097      
## prev_stop_rate_pass                                              -2.2398      0.0251    **
## shotgun_rate                                                      1.3136      0.1890      
## singleback_rate                                                   0.3379      0.7355      
## empty_rate                                                        1.1331      0.2572      
## iform_rate                                                        0.7964      0.4258      
## shotgun_success                                                  -2.7793      0.0055   ***
## singleback_success                                                1.0005      0.3171      
## empty_success                                                    -0.5793      0.5624      
## iform_success                                                    -0.6656      0.5057      
## def_stop_rate_run                                                -0.8975      0.3694      
## def_stop_rate_pass                                               -0.2454      0.8061      
## avg_pass_rushers                                                 -0.7848      0.4326      
## avg_box_defenders                                                -0.2548      0.7989      
## cover0_rate                                                      -2.4690      0.0136    **
## cover1_rate                                                      -0.9018      0.3672      
## cover2_rate                                                      -1.3498      0.1771      
## cover3_rate                                                      -1.6520      0.0985     *
## cover4_rate                                                      -2.6047      0.0092   ***
## cover6_rate                                                      -0.7153      0.4744      
## two_man_rate                                                      0.2611      0.7940      
## prevent_rate                                                     -0.4279      0.6687      
## home_attendance                                                  -1.1590      0.2465      
## roof_outdoors                                                    -0.2920      0.7703      
## posteam_type_home                                                 4.0811      0.0000   ***
## offense_formation_EMPTY                                          -1.0282      0.3039      
## offense_formation_SHOTGUN                                        -1.5738      0.1155     .
## offense_formation_SINGLEBACK                                     -1.0515      0.2930      
## offense_formation_I_FORM                                         -0.4524      0.6510      
## yardline_1_10                                                    -3.5550      0.0004   ***
## yardline_11_20                                                   -2.3739      0.0176    **
## yardline_21_30                                                   -2.3494      0.0188    **
## yardline_41_50                                                   -0.5808      0.5614      
## yardline_51_60                                                   -0.9286      0.3531      
## yardline_61_70                                                   -3.5736      0.0004   ***
## yardline_71_80                                                   -3.9068      0.0001   ***
## yardline_81_90                                                   -6.2005      0.0000   ***
## yardline_91_100                                                  -8.6776      0.0000   ***
## year2017_team_BUF                                                -0.0765      0.9390      
## year2017_team_CHI                                                 0.2985      0.7653      
## year2017_team_CLE                                                 1.4207      0.1554      
## year2017_team_DAL                                                -0.3849      0.7003      
## year2017_team_DET                                                -0.0781      0.9377      
## year2017_team_GB                                                  0.2489      0.8035      
## year2017_team_HOU                                                -0.0827      0.9341      
## year2017_team_MIA                                                 0.7478      0.4546      
## year2017_team_MIN                                                -1.4259      0.1539      
## year2017_team_NE                                                 -0.7645      0.4446      
## year2017_team_NYJ                                                 0.3550      0.7226      
## year2017_team_PHI                                                -0.1607      0.8723      
## year2017_team_SF                                                  0.2281      0.8196      
## year2017_team_TEN                                                -0.3557      0.7221      
## year2017_team_WAS                                                -0.8789      0.3795      
## year2017_team_ATL                                                -1.0211      0.3072      
## year2017_team_BAL                                                -0.1204      0.9042      
## year2017_team_CIN                                                 0.2748      0.7835      
## year2017_team_DEN                                                -0.1653      0.8687      
## year2017_team_KC                                                  0.4459      0.6557      
## year2017_team_LA                                                  0.3856      0.6998      
## year2017_team_NO                                                 -0.0275      0.9780      
## year2017_team_NYG                                                -0.6863      0.4925      
## year2017_team_OAK                                                -0.8928      0.3720      
## year2017_team_PIT                                                -1.0377      0.2994      
## year2017_team_SEA                                                -0.3665      0.7140      
## year2017_team_TB                                                  2.0692      0.0385    **
## year2017_team_CAR                                                -0.7056      0.4804      
## year2017_team_IND                                                 0.3880      0.6980      
## year2017_team_JAX                                                -0.9870      0.3237      
## year2017_team_LAC                                                -0.4644      0.6424      
## year2018_team_ARI                                                 1.0366      0.2999      
## year2018_team_BAL                                                 0.2989      0.7650      
## year2018_team_CAR                                                 1.4728      0.1408     .
## year2018_team_CLE                                                 0.3117      0.7553      
## year2018_team_DET                                                 0.5886      0.5562      
## year2018_team_HOU                                                 1.6218      0.1048     .
## year2018_team_IND                                                 0.9099      0.3629      
## year2018_team_KC                                                  0.8389      0.4016      
## year2018_team_LAC                                                 0.9630      0.3356      
## year2018_team_MIA                                                 1.0163      0.3095      
## year2018_team_MIN                                                -0.3670      0.7136      
## year2018_team_NE                                                 -0.0514      0.9590      
## year2018_team_NYG                                                 1.8690      0.0616     *
## year2018_team_OAK                                                 1.7124      0.0868     *
## year2018_team_PHI                                                 1.0319      0.3021      
## year2018_team_SEA                                                 1.3865      0.1656      
## year2018_team_BUF                                                 0.2160      0.8290      
## year2018_team_CHI                                                 0.0974      0.9224      
## year2018_team_CIN                                                 1.8925      0.0584     *
## year2018_team_DAL                                                 1.4263      0.1538      
## year2018_team_DEN                                                 1.2774      0.2015      
## year2018_team_GB                                                  0.4212      0.6736      
## year2018_team_NO                                                  0.7627      0.4457      
## year2018_team_NYJ                                                 0.5739      0.5660      
## year2018_team_PIT                                                 1.3522      0.1763      
## year2018_team_SF                                                  1.4091      0.1588      
## year2018_team_TEN                                                 1.4301      0.1527      
## year2018_team_TB                                                  2.1456      0.0319    **
## year2018_team_ATL                                                 1.7073      0.0878     *
## year2018_team_JAX                                                 1.1294      0.2587      
## year2018_team_LA                                                 -0.0767      0.9388      
## year2018_team_WAS                                                 2.6146      0.0089   ***
## year2019_team_ARI                                                 1.9340      0.0531     *
## year2019_team_BUF                                                 1.0014      0.3166      
## year2019_team_CHI                                                 1.0503      0.2936      
## year2019_team_CLE                                                 1.2437      0.2136      
## year2019_team_DAL                                                 0.6465      0.5179      
## year2019_team_IND                                                 1.6776      0.0934     *
## year2019_team_JAX                                                 1.1753      0.2399      
## year2019_team_KC                                                 -0.1905      0.8489      
## year2019_team_LAC                                                 1.7154      0.0863     *
## year2019_team_MIN                                                 2.0542      0.0400    **
## year2019_team_NE                                                  0.1864      0.8521      
## year2019_team_NO                                                 -0.2417      0.8090      
## year2019_team_PHI                                                 1.8314      0.0670     *
## year2019_team_SEA                                                 1.0034      0.3157      
## year2019_team_SF                                                  1.2891      0.1974      
## year2019_team_TB                                                  1.2260      0.2202      
## year2019_team_ATL                                                 2.3711      0.0177    **
## year2019_team_BAL                                                 1.1986      0.2307      
## year2019_team_CAR                                                 1.1356      0.2561      
## year2019_team_CIN                                                 1.4683      0.1420     .
## year2019_team_DEN                                                 0.5629      0.5735      
## year2019_team_DET                                                 0.8162      0.4144      
## year2019_team_HOU                                                 1.4306      0.1525      
## year2019_team_LA                                                  0.2433      0.8078      
## year2019_team_MIA                                                 1.7746      0.0760     *
## year2019_team_NYG                                                 1.7289      0.0838     *
## year2019_team_NYJ                                                 1.2970      0.1946      
## year2019_team_OAK                                                 1.1320      0.2576      
## year2019_team_PIT                                                 0.5050      0.6136      
## year2019_team_TEN                                                 0.7476      0.4547      
## year2019_team_WAS                                                 1.1811      0.2376      
## year2019_team_GB                                                  0.4070      0.6840      
## year2020_team_ATL                                                 0.9884      0.3230      
## year2020_team_BAL                                                -0.2703      0.7869      
## year2020_team_BUF                                                 1.5745      0.1154     .
## year2020_team_CAR                                                 2.5126      0.0120    **
## year2020_team_CIN                                                 0.4447      0.6565      
## year2020_team_DEN                                                 1.8266      0.0678     *
## year2020_team_DET                                                 1.6236      0.1045     .
## year2020_team_JAX                                                 1.6419      0.1006     .
## year2020_team_KC                                                  0.4911      0.6233      
## year2020_team_LA                                                  1.2848      0.1989      
## year2020_team_MIN                                                 0.2837      0.7766      
## year2020_team_NE                                                  0.8483      0.3963      
## year2020_team_NO                                                  0.4976      0.6188      
## year2020_team_NYG                                                 0.6256      0.5316      
## year2020_team_SF                                                  0.5868      0.5573      
## year2020_team_WAS                                                 1.0460      0.2955      
## year2020_team_CHI                                                 0.2834      0.7768      
## year2020_team_DAL                                                 0.9347      0.3500      
## year2020_team_GB                                                  0.4309      0.6665      
## year2020_team_HOU                                                 1.8549      0.0636     *
## year2020_team_LV                                                  1.2571      0.2087      
## year2020_team_MIA                                                -0.0348      0.9723      
## year2020_team_NYJ                                                 0.5772      0.5638      
## year2020_team_TB                                                  0.5616      0.5744      
## year2020_team_TEN                                                 1.1491      0.2505      
## year2020_team_ARI                                                 1.3523      0.1763      
## year2020_team_CLE                                                 1.2505      0.2111      
## year2020_team_IND                                                 0.8450      0.3981      
## year2020_team_LAC                                                 0.6755      0.4994      
## year2020_team_PHI                                                 1.2570      0.2088      
## year2020_team_SEA                                                 0.6985      0.4849      
## year2020_team_PIT                                                 0.4051      0.6854      
## year2021_team_ATL                                                 1.9523      0.0509     *
## year2021_team_BUF                                                 0.2108      0.8331      
## year2021_team_CIN                                                 1.9901      0.0466    **
## year2021_team_DAL                                                 0.9030      0.3665      
## year2021_team_DEN                                                 1.1069      0.2683      
## year2021_team_DET                                                 1.6605      0.0968     *
## year2021_team_HOU                                                 1.6576      0.0974     *
## year2021_team_KC                                                  1.8587      0.0631     *
## year2021_team_LA                                                 -0.1414      0.8875      
## year2021_team_LV                                                  0.6277      0.5302      
## year2021_team_MIN                                                -0.0347      0.9723      
## year2021_team_NE                                                  0.3119      0.7551      
## year2021_team_NO                                                  0.8192      0.4127      
## year2021_team_NYG                                                 1.7726      0.0763     *
## year2021_team_SF                                                  2.2742      0.0230    **
## year2021_team_TEN                                                 0.6444      0.5193      
## year2021_team_ARI                                                 0.9239      0.3555      
## year2021_team_BAL                                                -0.0497      0.9604      
## year2021_team_CAR                                                 1.0831      0.2788      
## year2021_team_CHI                                                 1.1792      0.2383      
## year2021_team_GB                                                  1.0824      0.2791      
## year2021_team_IND                                                 1.0948      0.2736      
## year2021_team_LAC                                                 2.4079      0.0160    **
## year2021_team_MIA                                                 1.1690      0.2424      
## year2021_team_NYJ                                                 2.1783      0.0294    **
## year2021_team_PHI                                                 1.1189      0.2632      
## year2021_team_SEA                                                 1.0739      0.2829      
## year2021_team_TB                                                  2.1112      0.0348    **
## year2021_team_WAS                                                 2.1471      0.0318    **
## year2021_team_CLE                                                 0.3507      0.7258      
## year2021_team_JAX                                                 1.7231      0.0849     *
## year2021_team_PIT                                                 1.3434      0.1791      
## year2022_team_ARI                                                 1.1374      0.2554      
## year2022_team_ATL                                                 2.0178      0.0436    **
## year2022_team_CAR                                                 0.6800      0.4965      
## year2022_team_CHI                                                 2.6869      0.0072   ***
## year2022_team_CIN                                                 2.0818      0.0374    **
## year2022_team_HOU                                                 1.4018      0.1610      
## year2022_team_IND                                                 0.3915      0.6955      
## year2022_team_LAC                                                 0.6688      0.5036      
## year2022_team_MIA                                                 2.0591      0.0395    **
## year2022_team_MIN                                                 1.4154      0.1570      
## year2022_team_NE                                                  1.4486      0.1475     .
## year2022_team_NYJ                                                 0.9303      0.3522      
## year2022_team_SEA                                                 1.1472      0.2513      
## year2022_team_TB                                                  0.2164      0.8287      
## year2022_team_TEN                                                 0.6989      0.4846      
## year2022_team_WAS                                                 1.1080      0.2679      
## year2022_team_BAL                                                 0.8963      0.3701      
## year2022_team_BUF                                                 0.9358      0.3494      
## year2022_team_DAL                                                 0.2543      0.7992      
## year2022_team_DET                                                 0.4255      0.6704      
## year2022_team_GB                                                  1.1976      0.2311      
## year2022_team_JAX                                                 1.7091      0.0874     *
## year2022_team_KC                                                  2.3707      0.0178    **
## year2022_team_LA                                                  1.0334      0.3014      
## year2022_team_LV                                                  1.2883      0.1977      
## year2022_team_NO                                                  1.6285      0.1034     .
## year2022_team_PHI                                                 1.2424      0.2141      
## year2022_team_PIT                                                 1.3983      0.1620      
## year2022_team_SF                                                  1.3069      0.1913      
## year2022_team_CLE                                                 0.7034      0.4818      
## year2022_team_DEN                                                -0.0201      0.9840      
## year2022_team_NYG                                                 1.3873      0.1654      
## year2023_team_BAL                                                 0.4527      0.6507      
## year2023_team_CHI                                                 2.0996      0.0358    **
## year2023_team_CLE                                                 0.6259      0.5314      
## year2023_team_GB                                                  0.7068      0.4797      
## year2023_team_IND                                                 0.9087      0.3635      
## year2023_team_KC                                                  1.6412      0.1008     .
## year2023_team_LAC                                                 1.0412      0.2978      
## year2023_team_LV                                                  0.1714      0.8639      
## year2023_team_MIA                                                 1.3885      0.1650      
## year2023_team_MIN                                                 1.5574      0.1194     .
## year2023_team_NO                                                  0.7755      0.4381      
## year2023_team_NYG                                                 2.0920      0.0364    **
## year2023_team_NYJ                                                 0.6578      0.5107      
## year2023_team_SEA                                                 1.1400      0.2543      
## year2023_team_SF                                                  1.6339      0.1023     .
## year2023_team_WAS                                                 1.6107      0.1073     .
## year2023_team_ATL                                                 1.3280      0.1842      
## year2023_team_BUF                                                 2.0722      0.0382    **
## year2023_team_CAR                                                 1.7154      0.0863     *
## year2023_team_DAL                                                 1.4526      0.1463     .
## year2023_team_DEN                                                 0.3550      0.7226      
## year2023_team_HOU                                                 1.2836      0.1993      
## year2023_team_LA                                                  1.0326      0.3018      
## year2023_team_NE                                                  1.6855      0.0919     *
## year2023_team_PHI                                                 2.3533      0.0186    **
## year2023_team_PIT                                                 0.8281      0.4076      
## year2023_team_TEN                                                 0.8749      0.3816      
## year2023_team_ARI                                                 2.6929      0.0071   ***
## year2023_team_CIN                                                 1.3968      0.1625      
## year2023_team_DET                                                 1.1340      0.2568      
## year2023_team_TB                                                  1.5514      0.1208     .
## year2023_team_JAX                                                 0.3851      0.7002      
## is_first_half                                                     3.5020      0.0005   ***
## time_in_half                                                     -1.9275      0.0539     *
## starter_offense_player_1_passing_depth_short_grades_pass_12w     -0.4409      0.6593      
## starter_offense_player_1_passing_depth_medium_grades_pass...      1.4125      0.1578      
## starter_offense_player_1_passing_depth_deep_grades_pass_12w       0.1624      0.8710      
## starter_offense_player_4_rushing_grades_first_downs_12w           0.1918      0.8479      
## starter_offense_player_4_rushing_grades_yards_12w                -0.2249      0.8221      
## starter_offense_player_4_receiving_grades_grades_pass_blo...      0.5028      0.6151      
## starter_offense_player_4_receiving_grades_grades_offense_12w     -1.5960      0.1105     .
## starter_offense_player_8_receiving_depth_short_grades_pas...     -0.1509      0.8800      
## starter_offense_player_8_receiving_depth_medium_grades_pa...      0.9260      0.3545      
## starter_offense_player_8_receiving_depth_deep_grades_pass...     -0.6860      0.4927      
## starter_offense_player_9_receiving_depth_short_grades_pas...      0.9561      0.3390      
## starter_offense_player_9_receiving_depth_medium_grades_pa...     -1.1763      0.2395      
## starter_offense_player_9_receiving_depth_deep_grades_pass...      0.5575      0.5772      
## starter_offense_player_10_receiving_depth_short_grades_pa...     -1.4954      0.1348     .
## starter_offense_player_10_receiving_depth_medium_grades_p...      1.1399      0.2543      
## starter_offense_player_10_receiving_depth_deep_grades_pas...      1.1802      0.2379      
## starter_offense_player_14_receiving_depth_short_grades_pa...      0.0964      0.9232      
## starter_offense_player_14_receiving_depth_medium_grades_p...     -0.8732      0.3825      
## starter_offense_player_14_receiving_depth_deep_grades_pas...      0.6471      0.5176      
## starter_offense_player_17_blocking_grades_grades_pass_blo...      0.2370      0.8127      
## starter_offense_player_17_blocking_grades_grades_run_bloc...     -3.1740      0.0015   ***
## starter_offense_player_18_blocking_grades_grades_pass_blo...      1.5239      0.1275     .
## starter_offense_player_18_blocking_grades_grades_run_bloc...     -1.2064      0.2277      
## starter_offense_player_19_blocking_grades_grades_pass_blo...      0.5791      0.5625      
## starter_offense_player_19_blocking_grades_grades_run_bloc...      0.3233      0.7465      
## starter_offense_player_20_blocking_grades_grades_pass_blo...      0.1294      0.8970      
## starter_offense_player_20_blocking_grades_grades_run_bloc...      1.0168      0.3093      
## starter_offense_player_21_blocking_grades_grades_pass_blo...      0.6124      0.5403      
## starter_offense_player_21_blocking_grades_grades_run_bloc...      0.9652      0.3344      
## starter_defense_player_1_defensive_grades_grades_run_defe...      1.2480      0.2120      
## starter_defense_player_1_defensive_grades_grades_pass_rus...     -0.2817      0.7781      
## starter_defense_player_2_defensive_grades_grades_run_defe...      0.4436      0.6573      
## starter_defense_player_2_defensive_grades_grades_pass_rus...      0.5354      0.5924      
## starter_defense_player_3_defensive_grades_grades_run_defe...      1.0797      0.2803      
## starter_defense_player_3_defensive_grades_grades_pass_rus...     -1.0814      0.2795      
## starter_defense_player_4_defensive_grades_grades_run_defe...     -0.7740      0.4390      
## starter_defense_player_4_defensive_grades_grades_pass_rus...      0.5763      0.5644      
## starter_defense_player_9_defensive_grades_grades_run_defe...     -1.1743      0.2403      
## starter_defense_player_9_defensive_grades_grades_pass_rus...     -0.5915      0.5542      
## starter_defense_player_9_coverage_schemes_zone_grades_cov...      1.5249      0.1273     .
## starter_defense_player_9_coverage_schemes_man_grades_cove...     -1.5077      0.1316     .
## starter_defense_player_10_defensive_grades_grades_run_def...     -0.4157      0.6776      
## starter_defense_player_10_defensive_grades_grades_pass_ru...     -0.9271      0.3539      
## starter_defense_player_10_coverage_schemes_zone_grades_co...     -1.0529      0.2924      
## starter_defense_player_10_coverage_schemes_man_grades_cov...      0.9882      0.3231      
## starter_defense_player_11_defensive_grades_grades_run_def...     -1.9933      0.0462    **
## starter_defense_player_11_defensive_grades_grades_pass_ru...      0.5912      0.5544      
## starter_defense_player_11_coverage_schemes_zone_grades_co...     -0.1151      0.9084      
## starter_defense_player_11_coverage_schemes_man_grades_cov...      0.7766      0.4374      
## starter_defense_player_12_defensive_grades_grades_run_def...      0.4887      0.6250      
## starter_defense_player_12_defensive_grades_grades_pass_ru...     -0.6846      0.4936      
## starter_defense_player_12_coverage_schemes_zone_grades_co...      0.2160      0.8290      
## starter_defense_player_12_coverage_schemes_man_grades_cov...      1.1487      0.2507      
## starter_defense_player_15_defensive_grades_grades_run_def...     -0.4685      0.6394      
## starter_defense_player_15_coverage_schemes_zone_grades_co...      0.9396      0.3474      
## starter_defense_player_15_coverage_schemes_man_grades_cov...     -0.0992      0.9210      
## starter_defense_player_16_defensive_grades_grades_run_def...     -0.3920      0.6951      
## starter_defense_player_16_coverage_schemes_zone_grades_co...      0.6859      0.4928      
## starter_defense_player_16_coverage_schemes_man_grades_cov...     -0.3143      0.7533      
## starter_defense_player_17_defensive_grades_grades_run_def...      0.9949      0.3198      
## starter_defense_player_17_coverage_schemes_zone_grades_co...      0.6675      0.5044      
## starter_defense_player_17_coverage_schemes_man_grades_cov...     -1.4147      0.1572      
## starter_defense_player_20_defensive_grades_grades_run_def...     -1.1397      0.2544      
## starter_defense_player_20_coverage_schemes_zone_grades_co...      0.6552      0.5124      
## starter_defense_player_20_coverage_schemes_man_grades_cov...      0.1674      0.8670      
## starter_defense_player_21_defensive_grades_grades_run_def...      0.1439      0.8856      
## starter_defense_player_21_coverage_schemes_zone_grades_co...      1.3461      0.1783      
## starter_defense_player_21_coverage_schemes_man_grades_cov...     -1.4078      0.1592      
## starter_defense_player_22_defensive_grades_grades_run_def...     -0.7947      0.4268      
## starter_defense_player_22_coverage_schemes_zone_grades_co...     -0.3655      0.7147      
## starter_defense_player_22_coverage_schemes_man_grades_cov...      0.0928      0.9260</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># Calculate VIFs for the model with starter players</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>vifs_starter <span class="ot">&lt;-</span> <span class="fu">vif</span>(ols_starter)</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="co"># Filter to show only VIFs over 5</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>high_vifs_starter <span class="ot">&lt;-</span> vifs_starter[vifs_starter <span class="sc">&gt;</span> <span class="dv">5</span>]</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(high_vifs_starter) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Starter Players: Variables with VIF &gt; 5:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>  <span class="fu">print</span>(high_vifs_starter)</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">No variables with VIF &gt; 5 found in the Starter Players model</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## Starter Players: Variables with VIF &gt; 5:
##                                       prev_shotgun_rate 
##                                               10.120998 
##                                    prev_singleback_rate 
##                                                6.259694 
##                                            shotgun_rate 
##                                               16.989489 
##                                              empty_rate 
##                                               13.176557 
##                                             cover1_rate 
##                                                6.679671 
##                                             cover3_rate 
##                                                7.172638 
##                                         home_attendance 
##                                                8.154183 
##                                 offense_formation_EMPTY 
##                                                6.028433 
##                               offense_formation_SHOTGUN 
##                                                8.335635 
## starter_offense_player_4_rushing_grades_first_downs_12w 
##                                               11.582967 
##       starter_offense_player_4_rushing_grades_yards_12w 
##                                               11.726171</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># Create the model matrix for starter data (excluding the response variable)</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>X_starter <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> . <span class="sc">-</span> conversion <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> starter_data)  <span class="co"># -1 removes intercept</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="co"># Find columns causing linear dependencies</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>lin_combos_starter <span class="ot">&lt;-</span> <span class="fu">findLinearCombos</span>(X_starter)</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="co"># Remove problematic columns from the dataset</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(lin_combos_starter<span class="sc">$</span>remove)) {</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>  cols_to_remove <span class="ot">&lt;-</span> <span class="fu">colnames</span>(X_starter)[lin_combos_starter<span class="sc">$</span>remove]</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Removed from starter data:&quot;</span>, <span class="fu">paste</span>(cols_to_remove, <span class="at">collapse=</span><span class="st">&quot;, &quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>  starter_data <span class="ot">&lt;-</span> starter_data[, (cols_to_remove) <span class="sc">:=</span> <span class="cn">NULL</span>, with <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co"># Probit model with regular players</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>probit_regular <span class="ot">&lt;-</span> <span class="fu">glm</span>(conversion <span class="sc">~</span> ., <span class="at">data =</span> regular_data, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;probit&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co"># Get HC0-adjusted z-values and p-values for regular probit</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>robust_probit_regular <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(probit_regular, <span class="at">vcov =</span> <span class="fu">vcovHC</span>(probit_regular, <span class="at">type =</span> <span class="st">&quot;HC0&quot;</span>))</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>z_stats_regular <span class="ot">&lt;-</span> robust_probit_regular[, <span class="st">&quot;z value&quot;</span>]</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>p_values_regular <span class="ot">&lt;-</span> robust_probit_regular[, <span class="st">&quot;Pr(&gt;|z|)&quot;</span>]</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a><span class="co"># Print header (note &quot;z-value&quot; instead of &quot;t-value&quot;)</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">%-*s  %10s  %10s  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, name_width, <span class="st">&quot;Regular Players Probit Variable&quot;</span>, <span class="st">&quot;z-value&quot;</span>, <span class="st">&quot;p-value&quot;</span>, <span class="st">&quot;sig&quot;</span>))</span></code></pre></div>
<pre><code>## 
## 
## Regular Players Probit Variable                                  z-value     p-value   sig</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10s  %10s  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, name_width, <span class="st">&quot;---------------&quot;</span>, <span class="st">&quot;-------&quot;</span>, <span class="st">&quot;-------&quot;</span>, <span class="st">&quot;----&quot;</span>))</span></code></pre></div>
<pre><code>## ---------------                                                  -------     -------  ----</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(z_stats_regular)) {</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>    var_name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(robust_probit_regular)[i]</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nchar</span>(var_name) <span class="sc">&gt;</span> name_width) {</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>        var_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">substr</span>(var_name, <span class="dv">1</span>, name_width<span class="dv">-3</span>), <span class="st">&quot;...&quot;</span>)</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>    }</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10.4f  %10.4f  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, </span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>                name_width, var_name, </span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>                z_stats_regular[i], p_values_regular[i],</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>                <span class="fu">get_stars</span>(p_values_regular[i])))</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## (Intercept)                                                      -3.0183      0.0025   ***
## ydstogo                                                         -53.8755      0.0000   ***
## posteam_timeouts_remaining                                        2.9550      0.0031   ***
## defteam_timeouts_remaining                                        3.8940      0.0001   ***
## rush_attempt                                                     14.3272      0.0000   ***
## week                                                             -2.4055      0.0161    **
## temp                                                              0.2234      0.8232      
## wind                                                             -1.1671      0.2432      
## vegas_wp                                                         -4.5770      0.0000   ***
## spread_line                                                      -3.0830      0.0020   ***
## total_line                                                        1.5685      0.1168     .
## p_player_26_punting_grades_grades_punter_12w                     -3.4724      0.0005   ***
## k_player_25_field_goals_grades_grades_fgep_kicker_12w             4.1004      0.0000   ***
## score_diff                                                       -0.0910      0.9275      
## down4_pct                                                        -0.5297      0.5963      
## prep_days                                                        -1.8000      0.0719     *
## overall_win_pct                                                   2.5614      0.0104    **
## team_win_pct                                                      6.0811      0.0000   ***
## prev_win_pct                                                      1.4942      0.1351     .
## prev_shotgun_rate                                                -0.6029      0.5466      
## prev_singleback_rate                                             -0.8292      0.4070      
## prev_empty_rate                                                  -0.7600      0.4472      
## prev_iform_rate                                                   0.0666      0.9469      
## prev_shotgun_success                                              1.2751      0.2023      
## prev_singleback_success                                          -0.0014      0.9989      
## prev_empty_success                                                0.2588      0.7958      
## prev_iform_success                                               -0.6004      0.5482      
## prev_stop_rate_run                                                0.2505      0.8022      
## prev_stop_rate_pass                                              -1.7430      0.0813     *
## shotgun_rate                                                      1.3563      0.1750      
## singleback_rate                                                   0.3497      0.7265      
## empty_rate                                                        1.1674      0.2431      
## iform_rate                                                        0.6930      0.4883      
## shotgun_success                                                  -3.3022      0.0010   ***
## singleback_success                                                0.8686      0.3851      
## empty_success                                                    -0.8219      0.4111      
## iform_success                                                    -0.9294      0.3527      
## def_stop_rate_run                                                -0.7947      0.4268      
## def_stop_rate_pass                                                0.3232      0.7465      
## avg_pass_rushers                                                 -0.6466      0.5179      
## avg_box_defenders                                                 0.2568      0.7974      
## cover0_rate                                                      -3.3476      0.0008   ***
## cover1_rate                                                      -1.3896      0.1647      
## cover2_rate                                                      -0.7631      0.4454      
## cover3_rate                                                      -1.7609      0.0783     *
## cover4_rate                                                      -2.2289      0.0258    **
## cover6_rate                                                      -1.2450      0.2131      
## two_man_rate                                                     -0.0426      0.9660      
## prevent_rate                                                     -0.6100      0.5419      
## home_attendance                                                  -1.1605      0.2458      
## roof_outdoors                                                    -0.8541      0.3931      
## posteam_type_home                                                 4.3747      0.0000   ***
## offense_formation_EMPTY                                          -0.1232      0.9020      
## offense_formation_SHOTGUN                                        -0.5752      0.5652      
## offense_formation_SINGLEBACK                                     -0.6041      0.5458      
## offense_formation_I_FORM                                          0.2877      0.7736      
## yardline_1_10                                                    -3.3564      0.0008   ***
## yardline_11_20                                                   -2.0520      0.0402    **
## yardline_21_30                                                   -1.3476      0.1778      
## yardline_41_50                                                   -0.2377      0.8121      
## yardline_51_60                                                   -0.5713      0.5678      
## yardline_61_70                                                   -3.1741      0.0015   ***
## yardline_71_80                                                   -3.3201      0.0009   ***
## yardline_81_90                                                   -5.1393      0.0000   ***
## yardline_91_100                                                  -9.0984      0.0000   ***
## year2017_team_BUF                                                -0.2696      0.7875      
## year2017_team_CHI                                                -0.0271      0.9784      
## year2017_team_CLE                                                 0.8365      0.4029      
## year2017_team_DAL                                                -0.6531      0.5137      
## year2017_team_DET                                                -0.2700      0.7871      
## year2017_team_GB                                                 -0.2060      0.8368      
## year2017_team_HOU                                                -0.4210      0.6737      
## year2017_team_MIA                                                 0.2397      0.8106      
## year2017_team_MIN                                                -1.6945      0.0902     *
## year2017_team_NE                                                 -1.1989      0.2306      
## year2017_team_NYJ                                                -0.0258      0.9794      
## year2017_team_PHI                                                -0.3338      0.7385      
## year2017_team_SF                                                  0.0276      0.9780      
## year2017_team_TEN                                                -0.7958      0.4262      
## year2017_team_WAS                                                -1.5042      0.1325     .
## year2017_team_ATL                                                -1.3071      0.1912      
## year2017_team_BAL                                                -0.7343      0.4627      
## year2017_team_CIN                                                -0.7129      0.4759      
## year2017_team_DEN                                                -0.5902      0.5551      
## year2017_team_KC                                                 -0.0509      0.9594      
## year2017_team_LA                                                 -0.0469      0.9626      
## year2017_team_NO                                                 -0.5378      0.5907      
## year2017_team_NYG                                                -1.2844      0.1990      
## year2017_team_OAK                                                -1.3238      0.1856      
## year2017_team_PIT                                                -1.5730      0.1157     .
## year2017_team_SEA                                                -0.5399      0.5893      
## year2017_team_TB                                                  1.5095      0.1312     .
## year2017_team_CAR                                                -0.8706      0.3840      
## year2017_team_IND                                                 0.2431      0.8079      
## year2017_team_JAX                                                -1.1579      0.2469      
## year2017_team_LAC                                                -0.8906      0.3731      
## year2018_team_ARI                                                 0.8233      0.4103      
## year2018_team_BAL                                                 0.3077      0.7583      
## year2018_team_CAR                                                 1.3214      0.1864      
## year2018_team_CLE                                                 0.0702      0.9441      
## year2018_team_DET                                                 0.2442      0.8071      
## year2018_team_HOU                                                 1.4573      0.1450     .
## year2018_team_IND                                                 0.9448      0.3448      
## year2018_team_KC                                                  0.9433      0.3455      
## year2018_team_LAC                                                 0.7132      0.4757      
## year2018_team_MIA                                                 0.8162      0.4144      
## year2018_team_MIN                                                -0.4874      0.6260      
## year2018_team_NE                                                 -0.0242      0.9807      
## year2018_team_NYG                                                 1.5247      0.1273     .
## year2018_team_OAK                                                 1.8250      0.0680     *
## year2018_team_PHI                                                 0.9896      0.3224      
## year2018_team_SEA                                                 1.0755      0.2822      
## year2018_team_BUF                                                 0.2032      0.8389      
## year2018_team_CHI                                                 0.1464      0.8836      
## year2018_team_CIN                                                 1.7583      0.0787     *
## year2018_team_DAL                                                 0.9862      0.3240      
## year2018_team_DEN                                                 0.8622      0.3886      
## year2018_team_GB                                                  0.1735      0.8623      
## year2018_team_NO                                                  0.8059      0.4203      
## year2018_team_NYJ                                                 0.5382      0.5904      
## year2018_team_PIT                                                 1.1983      0.2308      
## year2018_team_SF                                                  1.1601      0.2460      
## year2018_team_TEN                                                 1.2415      0.2144      
## year2018_team_TB                                                  2.1019      0.0356    **
## year2018_team_ATL                                                 1.3548      0.1755      
## year2018_team_JAX                                                 0.9011      0.3675      
## year2018_team_LA                                                  0.0026      0.9979      
## year2018_team_WAS                                                 2.1453      0.0319    **
## year2019_team_ARI                                                 1.7112      0.0871     *
## year2019_team_BUF                                                 0.6840      0.4940      
## year2019_team_CHI                                                 0.9696      0.3323      
## year2019_team_CLE                                                 0.9099      0.3629      
## year2019_team_DAL                                                 0.5969      0.5506      
## year2019_team_IND                                                 1.1791      0.2383      
## year2019_team_JAX                                                 0.9027      0.3667      
## year2019_team_KC                                                 -0.0598      0.9523      
## year2019_team_LAC                                                 1.5104      0.1310     .
## year2019_team_MIN                                                 1.9134      0.0557     *
## year2019_team_NE                                                  0.0615      0.9510      
## year2019_team_NO                                                 -0.4515      0.6516      
## year2019_team_PHI                                                 1.7141      0.0865     *
## year2019_team_SEA                                                 0.8216      0.4113      
## year2019_team_SF                                                  1.2332      0.2175      
## year2019_team_TB                                                  0.8701      0.3842      
## year2019_team_ATL                                                 2.1225      0.0338    **
## year2019_team_BAL                                                 1.0938      0.2740      
## year2019_team_CAR                                                 0.6846      0.4936      
## year2019_team_CIN                                                 1.3388      0.1806      
## year2019_team_DEN                                                 0.1141      0.9092      
## year2019_team_DET                                                 0.4989      0.6179      
## year2019_team_HOU                                                 1.1532      0.2488      
## year2019_team_LA                                                  0.1052      0.9162      
## year2019_team_MIA                                                 1.1727      0.2409      
## year2019_team_NYG                                                 1.6463      0.0997     *
## year2019_team_NYJ                                                 1.1939      0.2325      
## year2019_team_OAK                                                 1.0726      0.2834      
## year2019_team_PIT                                                 0.2780      0.7810      
## year2019_team_TEN                                                 0.4540      0.6499      
## year2019_team_WAS                                                 0.6034      0.5463      
## year2019_team_GB                                                  0.2329      0.8159      
## year2020_team_ATL                                                 1.0101      0.3124      
## year2020_team_BAL                                                -0.2250      0.8220      
## year2020_team_BUF                                                 1.5171      0.1292     .
## year2020_team_CAR                                                 2.3087      0.0210    **
## year2020_team_CIN                                                 0.3818      0.7026      
## year2020_team_DEN                                                 1.3917      0.1640      
## year2020_team_DET                                                 1.4022      0.1608      
## year2020_team_JAX                                                 1.4101      0.1585      
## year2020_team_KC                                                  0.5379      0.5906      
## year2020_team_LA                                                  1.0452      0.2959      
## year2020_team_MIN                                                -0.0421      0.9664      
## year2020_team_NE                                                  0.6781      0.4977      
## year2020_team_NO                                                  0.3264      0.7441      
## year2020_team_NYG                                                 0.4261      0.6700      
## year2020_team_SF                                                  0.5597      0.5757      
## year2020_team_WAS                                                 0.9805      0.3269      
## year2020_team_CHI                                                 0.1412      0.8877      
## year2020_team_DAL                                                 0.6976      0.4854      
## year2020_team_GB                                                  0.3418      0.7325      
## year2020_team_HOU                                                 1.6728      0.0944     *
## year2020_team_LV                                                  1.2701      0.2041      
## year2020_team_MIA                                                 0.1268      0.8991      
## year2020_team_NYJ                                                 0.3222      0.7473      
## year2020_team_TB                                                  0.2752      0.7832      
## year2020_team_TEN                                                 1.1175      0.2638      
## year2020_team_ARI                                                 1.2272      0.2197      
## year2020_team_CLE                                                 1.2079      0.2271      
## year2020_team_IND                                                 1.0894      0.2760      
## year2020_team_LAC                                                 0.9717      0.3312      
## year2020_team_PHI                                                 0.9925      0.3210      
## year2020_team_SEA                                                 0.5471      0.5843      
## year2020_team_PIT                                                 0.4326      0.6653      
## year2021_team_ATL                                                 1.6295      0.1032     .
## year2021_team_BUF                                                 0.3076      0.7584      
## year2021_team_CIN                                                 1.6960      0.0899     *
## year2021_team_DAL                                                 0.6292      0.5292      
## year2021_team_DEN                                                 0.8559      0.3920      
## year2021_team_DET                                                 1.2461      0.2127      
## year2021_team_HOU                                                 1.5184      0.1289     .
## year2021_team_KC                                                  1.7483      0.0804     *
## year2021_team_LA                                                 -0.3968      0.6915      
## year2021_team_LV                                                  0.5517      0.5811      
## year2021_team_MIN                                                -0.1325      0.8946      
## year2021_team_NE                                                 -0.0668      0.9467      
## year2021_team_NO                                                  0.5550      0.5789      
## year2021_team_NYG                                                 1.5245      0.1274     .
## year2021_team_SF                                                  1.8307      0.0671     *
## year2021_team_TEN                                                 0.2947      0.7682      
## year2021_team_ARI                                                 0.8375      0.4023      
## year2021_team_BAL                                                 0.0292      0.9767      
## year2021_team_CAR                                                 0.8663      0.3863      
## year2021_team_CHI                                                 0.8854      0.3759      
## year2021_team_GB                                                  0.5826      0.5601      
## year2021_team_IND                                                 0.8818      0.3779      
## year2021_team_LAC                                                 2.1342      0.0328    **
## year2021_team_MIA                                                 1.0635      0.2876      
## year2021_team_NYJ                                                 2.2286      0.0258    **
## year2021_team_PHI                                                 0.9241      0.3554      
## year2021_team_SEA                                                 0.6146      0.5388      
## year2021_team_TB                                                  1.6489      0.0992     *
## year2021_team_WAS                                                 1.5237      0.1276     .
## year2021_team_CLE                                                 0.3813      0.7030      
## year2021_team_JAX                                                 1.1098      0.2671      
## year2021_team_PIT                                                 1.1471      0.2513      
## year2022_team_ARI                                                 0.7958      0.4261      
## year2022_team_ATL                                                 1.8765      0.0606     *
## year2022_team_CAR                                                 0.3743      0.7082      
## year2022_team_CHI                                                 2.4573      0.0140    **
## year2022_team_CIN                                                 1.7812      0.0749     *
## year2022_team_HOU                                                 1.0719      0.2838      
## year2022_team_IND                                                -0.1914      0.8482      
## year2022_team_LAC                                                 0.4688      0.6392      
## year2022_team_MIA                                                 1.7191      0.0856     *
## year2022_team_MIN                                                 1.0167      0.3093      
## year2022_team_NE                                                  1.0610      0.2887      
## year2022_team_NYJ                                                 0.8313      0.4058      
## year2022_team_SEA                                                 0.7575      0.4488      
## year2022_team_TB                                                 -0.1626      0.8708      
## year2022_team_TEN                                                 0.2649      0.7911      
## year2022_team_WAS                                                 0.6049      0.5452      
## year2022_team_BAL                                                 0.7685      0.4422      
## year2022_team_BUF                                                 0.9911      0.3216      
## year2022_team_DAL                                                -0.0663      0.9471      
## year2022_team_DET                                                 0.2418      0.8089      
## year2022_team_GB                                                  0.4721      0.6368      
## year2022_team_JAX                                                 1.3790      0.1679      
## year2022_team_KC                                                  1.9929      0.0463    **
## year2022_team_LA                                                  0.4820      0.6298      
## year2022_team_LV                                                  0.7763      0.4376      
## year2022_team_NO                                                  1.2088      0.2267      
## year2022_team_PHI                                                 0.9693      0.3324      
## year2022_team_PIT                                                 1.0082      0.3133      
## year2022_team_SF                                                  0.8645      0.3873      
## year2022_team_CLE                                                 0.5124      0.6084      
## year2022_team_DEN                                                -0.5306      0.5957      
## year2022_team_NYG                                                 1.1093      0.2673      
## year2023_team_BAL                                                -0.0148      0.9882      
## year2023_team_CHI                                                 1.8613      0.0627     *
## year2023_team_CLE                                                 0.2590      0.7956      
## year2023_team_GB                                                  0.1513      0.8798      
## year2023_team_IND                                                 0.0385      0.9693      
## year2023_team_KC                                                  1.0754      0.2822      
## year2023_team_LAC                                                 0.8996      0.3683      
## year2023_team_LV                                                 -0.0033      0.9973      
## year2023_team_MIA                                                 1.2551      0.2095      
## year2023_team_MIN                                                 0.8038      0.4215      
## year2023_team_NO                                                  0.4750      0.6348      
## year2023_team_NYG                                                 1.5450      0.1223     .
## year2023_team_NYJ                                                 0.5306      0.5957      
## year2023_team_SEA                                                 0.6503      0.5155      
## year2023_team_SF                                                  1.1984      0.2308      
## year2023_team_WAS                                                 1.3325      0.1827      
## year2023_team_ATL                                                 0.7599      0.4473      
## year2023_team_BUF                                                 1.9023      0.0571     *
## year2023_team_CAR                                                 0.9154      0.3600      
## year2023_team_DAL                                                 1.2361      0.2164      
## year2023_team_DEN                                                 0.0037      0.9971      
## year2023_team_HOU                                                 1.0081      0.3134      
## year2023_team_LA                                                  0.5405      0.5888      
## year2023_team_NE                                                  1.2117      0.2256      
## year2023_team_PHI                                                 2.1771      0.0295    **
## year2023_team_PIT                                                 0.4435      0.6574      
## year2023_team_TEN                                                 0.4371      0.6620      
## year2023_team_ARI                                                 2.1000      0.0357    **
## year2023_team_CIN                                                 1.0885      0.2764      
## year2023_team_DET                                                 0.7609      0.4467      
## year2023_team_TB                                                  1.0581      0.2900      
## year2023_team_JAX                                                -0.0583      0.9535      
## is_first_half                                                     3.0229      0.0025   ***
## time_in_half                                                     -1.9459      0.0517     *
## offense_player_1_passing_depth_short_grades_pass_12w              0.1976      0.8434      
## offense_player_1_passing_depth_medium_grades_pass_12w             2.6557      0.0079   ***
## offense_player_1_passing_depth_deep_grades_pass_12w               0.9007      0.3677      
## offense_player_4_rushing_grades_first_downs_12w                   0.8278      0.4078      
## offense_player_4_rushing_grades_yards_12w                        -1.1475      0.2512      
## offense_player_4_receiving_grades_grades_pass_block_12w          -0.2400      0.8103      
## offense_player_4_receiving_grades_grades_offense_12w              0.8709      0.3838      
## offense_player_8_receiving_depth_short_grades_pass_route_12w     -0.7449      0.4563      
## offense_player_8_receiving_depth_medium_grades_pass_route...     -1.4345      0.1514      
## offense_player_8_receiving_depth_deep_grades_pass_route_12w       1.2589      0.2081      
## offense_player_9_receiving_depth_short_grades_pass_route_12w     -0.5897      0.5554      
## offense_player_9_receiving_depth_medium_grades_pass_route...      2.2205      0.0264    **
## offense_player_9_receiving_depth_deep_grades_pass_route_12w       0.4161      0.6773      
## offense_player_10_receiving_depth_short_grades_pass_route...     -0.0893      0.9288      
## offense_player_10_receiving_depth_medium_grades_pass_rout...     -0.1113      0.9114      
## offense_player_10_receiving_depth_deep_grades_pass_route_12w      1.4888      0.1365     .
## offense_player_14_receiving_depth_short_grades_pass_route...     -0.0146      0.9884      
## offense_player_14_receiving_depth_medium_grades_pass_rout...      0.4880      0.6256      
## offense_player_14_receiving_depth_deep_grades_pass_route_12w      0.0103      0.9918      
## offense_player_17_blocking_grades_grades_pass_block_12w           0.5324      0.5945      
## offense_player_17_blocking_grades_grades_run_block_12w            0.3036      0.7614      
## offense_player_18_blocking_grades_grades_pass_block_12w           0.2405      0.8100      
## offense_player_18_blocking_grades_grades_run_block_12w            0.1619      0.8713      
## offense_player_19_blocking_grades_grades_pass_block_12w           0.1273      0.8987      
## offense_player_19_blocking_grades_grades_run_block_12w           -0.0075      0.9940      
## offense_player_20_blocking_grades_grades_pass_block_12w           1.6265      0.1038     .
## offense_player_20_blocking_grades_grades_run_block_12w           -0.1385      0.8898      
## offense_player_21_blocking_grades_grades_pass_block_12w           2.6145      0.0089   ***
## offense_player_21_blocking_grades_grades_run_block_12w           -1.8008      0.0717     *
## defense_player_1_defensive_grades_grades_run_defense_12w         -1.5620      0.1183     .
## defense_player_1_defensive_grades_grades_pass_rush_defens...      0.9334      0.3506      
## defense_player_2_defensive_grades_grades_run_defense_12w         -0.9488      0.3427      
## defense_player_2_defensive_grades_grades_pass_rush_defens...      0.6897      0.4904      
## defense_player_3_defensive_grades_grades_run_defense_12w         -0.3577      0.7205      
## defense_player_3_defensive_grades_grades_pass_rush_defens...     -0.3365      0.7365      
## defense_player_4_defensive_grades_grades_run_defense_12w          1.3115      0.1897      
## defense_player_4_defensive_grades_grades_pass_rush_defens...     -1.8889      0.0589     *
## defense_player_9_defensive_grades_grades_run_defense_12w          1.2197      0.2226      
## defense_player_9_defensive_grades_grades_pass_rush_defens...     -1.4205      0.1555      
## defense_player_9_coverage_schemes_zone_grades_coverage_de...      0.9080      0.3639      
## defense_player_9_coverage_schemes_man_grades_coverage_def...      0.2390      0.8111      
## defense_player_10_defensive_grades_grades_run_defense_12w         0.6910      0.4896      
## defense_player_10_defensive_grades_grades_pass_rush_defen...     -2.3046      0.0212    **
## defense_player_10_coverage_schemes_zone_grades_coverage_d...      1.1171      0.2640      
## defense_player_10_coverage_schemes_man_grades_coverage_de...     -1.3576      0.1746      
## defense_player_11_defensive_grades_grades_run_defense_12w         2.4207      0.0155    **
## defense_player_11_defensive_grades_grades_pass_rush_defen...     -0.2521      0.8010      
## defense_player_11_coverage_schemes_zone_grades_coverage_d...     -2.4145      0.0158    **
## defense_player_11_coverage_schemes_man_grades_coverage_de...     -0.5575      0.5772      
## defense_player_12_defensive_grades_grades_run_defense_12w        -2.3965      0.0166    **
## defense_player_12_defensive_grades_grades_pass_rush_defen...      0.5052      0.6134      
## defense_player_12_coverage_schemes_zone_grades_coverage_d...      1.7079      0.0877     *
## defense_player_12_coverage_schemes_man_grades_coverage_de...     -0.2259      0.8213      
## defense_player_15_defensive_grades_grades_run_defense_12w         0.4850      0.6277      
## defense_player_15_coverage_schemes_zone_grades_coverage_d...     -1.7652      0.0775     *
## defense_player_15_coverage_schemes_man_grades_coverage_de...      0.2479      0.8042      
## defense_player_16_defensive_grades_grades_run_defense_12w        -1.9582      0.0502     *
## defense_player_16_coverage_schemes_zone_grades_coverage_d...     -0.1150      0.9085      
## defense_player_16_coverage_schemes_man_grades_coverage_de...      0.6079      0.5433      
## defense_player_17_defensive_grades_grades_run_defense_12w        -0.4981      0.6184      
## defense_player_17_coverage_schemes_zone_grades_coverage_d...     -0.1911      0.8484      
## defense_player_17_coverage_schemes_man_grades_coverage_de...     -0.0705      0.9438      
## defense_player_20_defensive_grades_grades_run_defense_12w        -1.3725      0.1699      
## defense_player_20_coverage_schemes_zone_grades_coverage_d...      0.3609      0.7182      
## defense_player_20_coverage_schemes_man_grades_coverage_de...     -0.7461      0.4556      
## defense_player_21_defensive_grades_grades_run_defense_12w        -0.0637      0.9492      
## defense_player_21_coverage_schemes_zone_grades_coverage_d...      0.6548      0.5126      
## defense_player_21_coverage_schemes_man_grades_coverage_de...     -1.0070      0.3140      
## defense_player_22_defensive_grades_grades_run_defense_12w         1.6291      0.1033     .
## defense_player_22_coverage_schemes_zone_grades_coverage_d...     -1.4023      0.1608      
## defense_player_22_coverage_schemes_man_grades_coverage_de...     -0.4535      0.6502</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="co"># Probit model with starter players</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>probit_starter <span class="ot">&lt;-</span> <span class="fu">glm</span>(conversion <span class="sc">~</span> ., <span class="at">data =</span> starter_data, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;probit&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="co"># Get HC0-adjusted z-values and p-values for starter probit</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>robust_probit_starter <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(probit_starter, <span class="at">vcov =</span> <span class="fu">vcovHC</span>(probit_starter, <span class="at">type =</span> <span class="st">&quot;HC0&quot;</span>))</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>z_stats_starter <span class="ot">&lt;-</span> robust_probit_starter[, <span class="st">&quot;z value&quot;</span>]</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>p_values_starter <span class="ot">&lt;-</span> robust_probit_starter[, <span class="st">&quot;Pr(&gt;|z|)&quot;</span>]</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a><span class="co"># Print header (note &quot;z-value&quot; instead of &quot;t-value&quot;)</span></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">%-*s  %10s  %10s  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, name_width, <span class="st">&quot;Starter Players Probit Variable&quot;</span>, <span class="st">&quot;z-value&quot;</span>, <span class="st">&quot;p-value&quot;</span>, <span class="st">&quot;sig&quot;</span>))</span></code></pre></div>
<pre><code>## 
## 
## Starter Players Probit Variable                                  z-value     p-value   sig</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10s  %10s  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, name_width, <span class="st">&quot;---------------&quot;</span>, <span class="st">&quot;-------&quot;</span>, <span class="st">&quot;-------&quot;</span>, <span class="st">&quot;----&quot;</span>))</span></code></pre></div>
<pre><code>## ---------------                                                  -------     -------  ----</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(z_stats_starter)) {</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>    var_name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(robust_probit_starter)[i]</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nchar</span>(var_name) <span class="sc">&gt;</span> name_width) {</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>        var_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">substr</span>(var_name, <span class="dv">1</span>, name_width<span class="dv">-3</span>), <span class="st">&quot;...&quot;</span>)</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>    }</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%-*s  %10.4f  %10.4f  %4s</span><span class="sc">\n</span><span class="st">&quot;</span>, </span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>                name_width, var_name, </span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>                z_stats_starter[i], p_values_starter[i],</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>                <span class="fu">get_stars</span>(p_values_starter[i])))</span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## (Intercept)                                                      -3.2662      0.0011   ***
## ydstogo                                                         -55.4246      0.0000   ***
## posteam_timeouts_remaining                                        3.1410      0.0017   ***
## defteam_timeouts_remaining                                        3.8411      0.0001   ***
## rush_attempt                                                     13.8747      0.0000   ***
## week                                                             -1.8266      0.0678     *
## temp                                                              0.1841      0.8539      
## wind                                                             -1.4741      0.1405     .
## vegas_wp                                                         -3.7895      0.0002   ***
## spread_line                                                      -3.3864      0.0007   ***
## total_line                                                        2.1788      0.0293    **
## p_player_26_punting_grades_grades_punter_12w                     -3.0245      0.0025   ***
## k_player_25_field_goals_grades_grades_fgep_kicker_12w             3.9683      0.0001   ***
## score_diff                                                       -0.5801      0.5618      
## down4_pct                                                        -0.2522      0.8009      
## prep_days                                                        -1.7425      0.0814     *
## overall_win_pct                                                   2.4452      0.0145    **
## team_win_pct                                                      6.4130      0.0000   ***
## prev_win_pct                                                      1.7336      0.0830     *
## prev_shotgun_rate                                                -0.6923      0.4888      
## prev_singleback_rate                                             -0.7008      0.4834      
## prev_empty_rate                                                  -1.0405      0.2981      
## prev_iform_rate                                                   0.0337      0.9731      
## prev_shotgun_success                                              1.5326      0.1254     .
## prev_singleback_success                                           0.1600      0.8729      
## prev_empty_success                                                0.4329      0.6651      
## prev_iform_success                                               -0.2533      0.8001      
## prev_stop_rate_run                                                0.3004      0.7638      
## prev_stop_rate_pass                                              -2.0934      0.0363    **
## shotgun_rate                                                      1.2590      0.2080      
## singleback_rate                                                   0.3246      0.7455      
## empty_rate                                                        1.0923      0.2747      
## iform_rate                                                        0.7619      0.4461      
## shotgun_success                                                  -2.8790      0.0040   ***
## singleback_success                                                1.0993      0.2717      
## empty_success                                                    -0.7280      0.4666      
## iform_success                                                    -0.6922      0.4888      
## def_stop_rate_run                                                -0.8513      0.3946      
## def_stop_rate_pass                                               -0.3022      0.7625      
## avg_pass_rushers                                                 -0.6914      0.4893      
## avg_box_defenders                                                -0.3700      0.7114      
## cover0_rate                                                      -2.5991      0.0093   ***
## cover1_rate                                                      -0.9676      0.3333      
## cover2_rate                                                      -1.2147      0.2245      
## cover3_rate                                                      -1.7289      0.0838     *
## cover4_rate                                                      -2.5490      0.0108    **
## cover6_rate                                                      -0.7592      0.4477      
## two_man_rate                                                      0.2101      0.8336      
## prevent_rate                                                     -0.3312      0.7405      
## home_attendance                                                  -1.0580      0.2900      
## roof_outdoors                                                    -0.2369      0.8127      
## posteam_type_home                                                 3.8732      0.0001   ***
## offense_formation_EMPTY                                          -0.1188      0.9054      
## offense_formation_SHOTGUN                                        -0.5516      0.5812      
## offense_formation_SINGLEBACK                                     -1.1791      0.2384      
## offense_formation_I_FORM                                         -0.7052      0.4807      
## yardline_1_10                                                    -3.2548      0.0011   ***
## yardline_11_20                                                   -2.1020      0.0356    **
## yardline_21_30                                                   -1.3405      0.1801      
## yardline_41_50                                                   -0.3783      0.7052      
## yardline_51_60                                                   -0.5772      0.5638      
## yardline_61_70                                                   -3.1721      0.0015   ***
## yardline_71_80                                                   -3.4174      0.0006   ***
## yardline_81_90                                                   -5.2968      0.0000   ***
## yardline_91_100                                                  -9.1069      0.0000   ***
## year2017_team_BUF                                                -0.1289      0.8974      
## year2017_team_CHI                                                 0.2902      0.7717      
## year2017_team_CLE                                                 1.4081      0.1591      
## year2017_team_DAL                                                -0.4516      0.6516      
## year2017_team_DET                                                -0.1697      0.8652      
## year2017_team_GB                                                  0.0778      0.9380      
## year2017_team_HOU                                                -0.1271      0.8989      
## year2017_team_MIA                                                 0.6323      0.5272      
## year2017_team_MIN                                                -1.4894      0.1364     .
## year2017_team_NE                                                 -0.8464      0.3973      
## year2017_team_NYJ                                                 0.3539      0.7234      
## year2017_team_PHI                                                -0.2025      0.8395      
## year2017_team_SF                                                  0.1595      0.8733      
## year2017_team_TEN                                                -0.4496      0.6530      
## year2017_team_WAS                                                -1.0199      0.3078      
## year2017_team_ATL                                                -1.2075      0.2272      
## year2017_team_BAL                                                -0.2466      0.8052      
## year2017_team_CIN                                                 0.1503      0.8805      
## year2017_team_DEN                                                -0.2042      0.8382      
## year2017_team_KC                                                  0.3893      0.6970      
## year2017_team_LA                                                  0.3028      0.7620      
## year2017_team_NO                                                 -0.1951      0.8454      
## year2017_team_NYG                                                -0.7697      0.4415      
## year2017_team_OAK                                                -0.9887      0.3228      
## year2017_team_PIT                                                -1.1831      0.2368      
## year2017_team_SEA                                                -0.5014      0.6161      
## year2017_team_TB                                                  1.9274      0.0539     *
## year2017_team_CAR                                                -0.7317      0.4643      
## year2017_team_IND                                                 0.3872      0.6986      
## year2017_team_JAX                                                -1.1249      0.2606      
## year2017_team_LAC                                                -0.6142      0.5391      
## year2018_team_ARI                                                 0.9360      0.3493      
## year2018_team_BAL                                                 0.2633      0.7923      
## year2018_team_CAR                                                 1.4327      0.1519      
## year2018_team_CLE                                                 0.2427      0.8082      
## year2018_team_DET                                                 0.5030      0.6150      
## year2018_team_HOU                                                 1.5351      0.1248     .
## year2018_team_IND                                                 0.8365      0.4029      
## year2018_team_KC                                                  0.8438      0.3988      
## year2018_team_LAC                                                 0.8348      0.4038      
## year2018_team_MIA                                                 0.9603      0.3369      
## year2018_team_MIN                                                -0.5628      0.5736      
## year2018_team_NE                                                 -0.1286      0.8977      
## year2018_team_NYG                                                 1.7987      0.0721     *
## year2018_team_OAK                                                 1.5992      0.1098     .
## year2018_team_PHI                                                 0.8825      0.3775      
## year2018_team_SEA                                                 1.3861      0.1657      
## year2018_team_BUF                                                 0.1663      0.8679      
## year2018_team_CHI                                                -0.0249      0.9801      
## year2018_team_CIN                                                 1.8094      0.0704     *
## year2018_team_DAL                                                 1.3305      0.1834      
## year2018_team_DEN                                                 1.2390      0.2153      
## year2018_team_GB                                                  0.3609      0.7182      
## year2018_team_NO                                                  0.6985      0.4849      
## year2018_team_NYJ                                                 0.5933      0.5530      
## year2018_team_PIT                                                 1.2977      0.1944      
## year2018_team_SF                                                  1.3083      0.1908      
## year2018_team_TEN                                                 1.3623      0.1731      
## year2018_team_TB                                                  2.1146      0.0345    **
## year2018_team_ATL                                                 1.5768      0.1148     .
## year2018_team_JAX                                                 1.0315      0.3023      
## year2018_team_LA                                                 -0.1910      0.8485      
## year2018_team_WAS                                                 2.5658      0.0103    **
## year2019_team_ARI                                                 1.9283      0.0538     *
## year2019_team_BUF                                                 0.9344      0.3501      
## year2019_team_CHI                                                 0.9479      0.3432      
## year2019_team_CLE                                                 1.1702      0.2419      
## year2019_team_DAL                                                 0.6329      0.5268      
## year2019_team_IND                                                 1.6634      0.0962     *
## year2019_team_JAX                                                 1.2306      0.2185      
## year2019_team_KC                                                 -0.1240      0.9013      
## year2019_team_LAC                                                 1.6551      0.0979     *
## year2019_team_MIN                                                 1.9113      0.0560     *
## year2019_team_NE                                                  0.1819      0.8557      
## year2019_team_NO                                                 -0.3090      0.7574      
## year2019_team_PHI                                                 1.8363      0.0663     *
## year2019_team_SEA                                                 0.9939      0.3203      
## year2019_team_SF                                                  1.1999      0.2302      
## year2019_team_TB                                                  1.1240      0.2610      
## year2019_team_ATL                                                 2.3154      0.0206    **
## year2019_team_BAL                                                 1.1891      0.2344      
## year2019_team_CAR                                                 1.0091      0.3129      
## year2019_team_CIN                                                 1.4908      0.1360     .
## year2019_team_DEN                                                 0.5275      0.5978      
## year2019_team_DET                                                 0.7593      0.4477      
## year2019_team_HOU                                                 1.4380      0.1504      
## year2019_team_LA                                                  0.2788      0.7804      
## year2019_team_MIA                                                 1.7663      0.0774     *
## year2019_team_NYG                                                 1.6928      0.0905     *
## year2019_team_NYJ                                                 1.2062      0.2277      
## year2019_team_OAK                                                 1.0803      0.2800      
## year2019_team_PIT                                                 0.4487      0.6537      
## year2019_team_TEN                                                 0.6893      0.4906      
## year2019_team_WAS                                                 1.1196      0.2629      
## year2019_team_GB                                                  0.3635      0.7162      
## year2020_team_ATL                                                 0.9351      0.3497      
## year2020_team_BAL                                                -0.3143      0.7533      
## year2020_team_BUF                                                 1.5048      0.1324     .
## year2020_team_CAR                                                 2.4653      0.0137    **
## year2020_team_CIN                                                 0.3947      0.6931      
## year2020_team_DEN                                                 1.7423      0.0815     *
## year2020_team_DET                                                 1.5599      0.1188     .
## year2020_team_JAX                                                 1.5504      0.1210     .
## year2020_team_KC                                                  0.4302      0.6670      
## year2020_team_LA                                                  1.2766      0.2018      
## year2020_team_MIN                                                 0.1400      0.8886      
## year2020_team_NE                                                  0.8694      0.3847      
## year2020_team_NO                                                  0.4514      0.6517      
## year2020_team_NYG                                                 0.5006      0.6166      
## year2020_team_SF                                                  0.6081      0.5431      
## year2020_team_WAS                                                 0.9829      0.3256      
## year2020_team_CHI                                                 0.2713      0.7862      
## year2020_team_DAL                                                 0.9404      0.3470      
## year2020_team_GB                                                  0.3430      0.7316      
## year2020_team_HOU                                                 1.7736      0.0761     *
## year2020_team_LV                                                  1.2717      0.2035      
## year2020_team_MIA                                                 0.0053      0.9958      
## year2020_team_NYJ                                                 0.6019      0.5472      
## year2020_team_TB                                                  0.4609      0.6449      
## year2020_team_TEN                                                 1.1069      0.2683      
## year2020_team_ARI                                                 1.3081      0.1908      
## year2020_team_CLE                                                 1.1513      0.2496      
## year2020_team_IND                                                 0.8097      0.4181      
## year2020_team_LAC                                                 0.6396      0.5225      
## year2020_team_PHI                                                 1.1570      0.2473      
## year2020_team_SEA                                                 0.6371      0.5240      
## year2020_team_PIT                                                 0.3742      0.7083      
## year2021_team_ATL                                                 1.8551      0.0636     *
## year2021_team_BUF                                                 0.1518      0.8793      
## year2021_team_CIN                                                 1.8932      0.0583     *
## year2021_team_DAL                                                 0.8070      0.4197      
## year2021_team_DEN                                                 1.0645      0.2871      
## year2021_team_DET                                                 1.6054      0.1084     .
## year2021_team_HOU                                                 1.5405      0.1234     .
## year2021_team_KC                                                  1.7425      0.0814     *
## year2021_team_LA                                                 -0.1997      0.8417      
## year2021_team_LV                                                  0.6053      0.5450      
## year2021_team_MIN                                                -0.1316      0.8953      
## year2021_team_NE                                                  0.2638      0.7920      
## year2021_team_NO                                                  0.7231      0.4696      
## year2021_team_NYG                                                 1.7288      0.0838     *
## year2021_team_SF                                                  2.1505      0.0315    **
## year2021_team_TEN                                                 0.5903      0.5550      
## year2021_team_ARI                                                 0.9460      0.3441      
## year2021_team_BAL                                                 0.0603      0.9519      
## year2021_team_CAR                                                 0.9959      0.3193      
## year2021_team_CHI                                                 1.0466      0.2953      
## year2021_team_GB                                                  0.9706      0.3317      
## year2021_team_IND                                                 1.0859      0.2775      
## year2021_team_LAC                                                 2.3138      0.0207    **
## year2021_team_MIA                                                 1.0673      0.2858      
## year2021_team_NYJ                                                 2.1689      0.0301    **
## year2021_team_PHI                                                 1.0997      0.2715      
## year2021_team_SEA                                                 1.0377      0.2994      
## year2021_team_TB                                                  2.0306      0.0423    **
## year2021_team_WAS                                                 2.0200      0.0434    **
## year2021_team_CLE                                                 0.3616      0.7177      
## year2021_team_JAX                                                 1.7153      0.0863     *
## year2021_team_PIT                                                 1.3028      0.1926      
## year2022_team_ARI                                                 1.0137      0.3107      
## year2022_team_ATL                                                 1.9770      0.0480    **
## year2022_team_CAR                                                 0.6646      0.5063      
## year2022_team_CHI                                                 2.6712      0.0076   ***
## year2022_team_CIN                                                 2.0648      0.0389    **
## year2022_team_HOU                                                 1.3252      0.1851      
## year2022_team_IND                                                 0.1640      0.8697      
## year2022_team_LAC                                                 0.5402      0.5891      
## year2022_team_MIA                                                 1.9611      0.0499    **
## year2022_team_MIN                                                 1.4091      0.1588      
## year2022_team_NE                                                  1.4094      0.1587      
## year2022_team_NYJ                                                 0.8377      0.4022      
## year2022_team_SEA                                                 1.0749      0.2824      
## year2022_team_TB                                                  0.1571      0.8752      
## year2022_team_TEN                                                 0.5745      0.5656      
## year2022_team_WAS                                                 1.0228      0.3064      
## year2022_team_BAL                                                 0.8561      0.3920      
## year2022_team_BUF                                                 0.8840      0.3767      
## year2022_team_DAL                                                 0.1054      0.9161      
## year2022_team_DET                                                 0.4371      0.6621      
## year2022_team_GB                                                  1.1430      0.2531      
## year2022_team_JAX                                                 1.6141      0.1065     .
## year2022_team_KC                                                  2.2076      0.0273    **
## year2022_team_LA                                                  0.9348      0.3499      
## year2022_team_LV                                                  1.1516      0.2495      
## year2022_team_NO                                                  1.5669      0.1171     .
## year2022_team_PHI                                                 1.1625      0.2450      
## year2022_team_PIT                                                 1.3199      0.1869      
## year2022_team_SF                                                  1.1730      0.2408      
## year2022_team_CLE                                                 0.6249      0.5320      
## year2022_team_DEN                                                -0.1558      0.8762      
## year2022_team_NYG                                                 1.3804      0.1675      
## year2023_team_BAL                                                 0.3006      0.7637      
## year2023_team_CHI                                                 2.0277      0.0426    **
## year2023_team_CLE                                                 0.5033      0.6148      
## year2023_team_GB                                                  0.6796      0.4968      
## year2023_team_IND                                                 0.8396      0.4011      
## year2023_team_KC                                                  1.5678      0.1169     .
## year2023_team_LAC                                                 1.0365      0.3000      
## year2023_team_LV                                                  0.0468      0.9627      
## year2023_team_MIA                                                 1.2874      0.1979      
## year2023_team_MIN                                                 1.4410      0.1496     .
## year2023_team_NO                                                  0.7507      0.4528      
## year2023_team_NYG                                                 1.9951      0.0460    **
## year2023_team_NYJ                                                 0.5291      0.5967      
## year2023_team_SEA                                                 1.0427      0.2971      
## year2023_team_SF                                                  1.5379      0.1241     .
## year2023_team_WAS                                                 1.5080      0.1315     .
## year2023_team_ATL                                                 1.1999      0.2302      
## year2023_team_BUF                                                 1.9514      0.0510     *
## year2023_team_CAR                                                 1.5771      0.1148     .
## year2023_team_DAL                                                 1.3665      0.1718      
## year2023_team_DEN                                                 0.3017      0.7629      
## year2023_team_HOU                                                 1.1843      0.2363      
## year2023_team_LA                                                  0.9455      0.3444      
## year2023_team_NE                                                  1.6096      0.1075     .
## year2023_team_PHI                                                 2.2622      0.0237    **
## year2023_team_PIT                                                 0.7319      0.4642      
## year2023_team_TEN                                                 0.8244      0.4097      
## year2023_team_ARI                                                 2.6499      0.0081   ***
## year2023_team_CIN                                                 1.3317      0.1829      
## year2023_team_DET                                                 1.1273      0.2596      
## year2023_team_TB                                                  1.5332      0.1252     .
## year2023_team_JAX                                                 0.2566      0.7975      
## is_first_half                                                     3.3040      0.0010   ***
## time_in_half                                                     -1.9674      0.0491    **
## starter_offense_player_1_passing_depth_short_grades_pass_12w     -0.4971      0.6191      
## starter_offense_player_1_passing_depth_medium_grades_pass...      1.4459      0.1482     .
## starter_offense_player_1_passing_depth_deep_grades_pass_12w       0.1275      0.8986      
## starter_offense_player_4_rushing_grades_first_downs_12w           0.0951      0.9242      
## starter_offense_player_4_rushing_grades_yards_12w                -0.1733      0.8625      
## starter_offense_player_4_receiving_grades_grades_pass_blo...      0.6383      0.5233      
## starter_offense_player_4_receiving_grades_grades_offense_12w     -1.6849      0.0920     *
## starter_offense_player_8_receiving_depth_short_grades_pas...     -0.2669      0.7895      
## starter_offense_player_8_receiving_depth_medium_grades_pa...      1.0852      0.2778      
## starter_offense_player_8_receiving_depth_deep_grades_pass...     -0.6547      0.5127      
## starter_offense_player_9_receiving_depth_short_grades_pas...      1.0035      0.3156      
## starter_offense_player_9_receiving_depth_medium_grades_pa...     -1.1650      0.2440      
## starter_offense_player_9_receiving_depth_deep_grades_pass...      0.4794      0.6317      
## starter_offense_player_10_receiving_depth_short_grades_pa...     -1.4162      0.1567      
## starter_offense_player_10_receiving_depth_medium_grades_p...      1.0137      0.3107      
## starter_offense_player_10_receiving_depth_deep_grades_pas...      1.2165      0.2238      
## starter_offense_player_14_receiving_depth_short_grades_pa...      0.0304      0.9757      
## starter_offense_player_14_receiving_depth_medium_grades_p...     -0.8427      0.3994      
## starter_offense_player_14_receiving_depth_deep_grades_pas...      0.6876      0.4917      
## starter_offense_player_17_blocking_grades_grades_pass_blo...      0.3144      0.7532      
## starter_offense_player_17_blocking_grades_grades_run_bloc...     -3.2067      0.0013   ***
## starter_offense_player_18_blocking_grades_grades_pass_blo...      1.4515      0.1466     .
## starter_offense_player_18_blocking_grades_grades_run_bloc...     -1.1703      0.2419      
## starter_offense_player_19_blocking_grades_grades_pass_blo...      0.4915      0.6231      
## starter_offense_player_19_blocking_grades_grades_run_bloc...      0.4173      0.6765      
## starter_offense_player_20_blocking_grades_grades_pass_blo...      0.0622      0.9504      
## starter_offense_player_20_blocking_grades_grades_run_bloc...      0.9759      0.3291      
## starter_offense_player_21_blocking_grades_grades_pass_blo...      0.6832      0.4945      
## starter_offense_player_21_blocking_grades_grades_run_bloc...      0.9660      0.3340      
## starter_defense_player_1_defensive_grades_grades_run_defe...      1.2516      0.2107      
## starter_defense_player_1_defensive_grades_grades_pass_rus...     -0.3524      0.7245      
## starter_defense_player_2_defensive_grades_grades_run_defe...      0.4063      0.6845      
## starter_defense_player_2_defensive_grades_grades_pass_rus...      0.5161      0.6058      
## starter_defense_player_3_defensive_grades_grades_run_defe...      1.1416      0.2536      
## starter_defense_player_3_defensive_grades_grades_pass_rus...     -1.0172      0.3090      
## starter_defense_player_4_defensive_grades_grades_run_defe...     -1.0266      0.3046      
## starter_defense_player_4_defensive_grades_grades_pass_rus...      0.7272      0.4671      
## starter_defense_player_9_defensive_grades_grades_run_defe...     -1.2534      0.2101      
## starter_defense_player_9_defensive_grades_grades_pass_rus...     -0.6918      0.4891      
## starter_defense_player_9_coverage_schemes_zone_grades_cov...      1.7198      0.0855     *
## starter_defense_player_9_coverage_schemes_man_grades_cove...     -1.4862      0.1372     .
## starter_defense_player_10_defensive_grades_grades_run_def...     -0.3827      0.7019      
## starter_defense_player_10_defensive_grades_grades_pass_ru...     -0.9829      0.3257      
## starter_defense_player_10_coverage_schemes_zone_grades_co...     -1.1102      0.2669      
## starter_defense_player_10_coverage_schemes_man_grades_cov...      1.0938      0.2741      
## starter_defense_player_11_defensive_grades_grades_run_def...     -1.9677      0.0491    **
## starter_defense_player_11_defensive_grades_grades_pass_ru...      0.7006      0.4836      
## starter_defense_player_11_coverage_schemes_zone_grades_co...     -0.2009      0.8408      
## starter_defense_player_11_coverage_schemes_man_grades_cov...      0.7700      0.4413      
## starter_defense_player_12_defensive_grades_grades_run_def...      0.4493      0.6532      
## starter_defense_player_12_defensive_grades_grades_pass_ru...     -0.8583      0.3907      
## starter_defense_player_12_coverage_schemes_zone_grades_co...      0.2009      0.8408      
## starter_defense_player_12_coverage_schemes_man_grades_cov...      1.2841      0.1991      
## starter_defense_player_15_defensive_grades_grades_run_def...     -0.4642      0.6425      
## starter_defense_player_15_coverage_schemes_zone_grades_co...      0.9757      0.3292      
## starter_defense_player_15_coverage_schemes_man_grades_cov...     -0.2779      0.7811      
## starter_defense_player_16_defensive_grades_grades_run_def...     -0.3784      0.7052      
## starter_defense_player_16_coverage_schemes_zone_grades_co...      0.7330      0.4635      
## starter_defense_player_16_coverage_schemes_man_grades_cov...     -0.2151      0.8297      
## starter_defense_player_17_defensive_grades_grades_run_def...      1.1927      0.2330      
## starter_defense_player_17_coverage_schemes_zone_grades_co...      0.5438      0.5866      
## starter_defense_player_17_coverage_schemes_man_grades_cov...     -1.4932      0.1354     .
## starter_defense_player_20_defensive_grades_grades_run_def...     -1.1563      0.2475      
## starter_defense_player_20_coverage_schemes_zone_grades_co...      0.6518      0.5145      
## starter_defense_player_20_coverage_schemes_man_grades_cov...      0.2335      0.8153      
## starter_defense_player_21_defensive_grades_grades_run_def...      0.1823      0.8554      
## starter_defense_player_21_coverage_schemes_zone_grades_co...      1.3255      0.1850      
## starter_defense_player_21_coverage_schemes_man_grades_cov...     -1.4649      0.1429     .
## starter_defense_player_22_defensive_grades_grades_run_def...     -0.7075      0.4793      
## starter_defense_player_22_coverage_schemes_zone_grades_co...     -0.3339      0.7385      
## starter_defense_player_22_coverage_schemes_man_grades_cov...      0.0358      0.9714</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Significance codes: 0 &#39;***&#39; 0.01 &#39;**&#39; 0.05 &#39;*&#39; 0.1 &#39;.&#39; 0.15</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co"># Model comparison summary</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">--- Model Comparison Summary ---</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 
## --- Model Comparison Summary ---</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;OLS Regular Players R-squared:&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(ols_regular)<span class="sc">$</span>r.squared, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## OLS Regular Players R-squared: 0.1274</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;OLS Starter Players R-squared:&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(ols_starter)<span class="sc">$</span>r.squared, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## OLS Starter Players R-squared: 0.1259</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;OLS Regular Players Adj R-squared:&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(ols_regular)<span class="sc">$</span>adj.r.squared, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## OLS Regular Players Adj R-squared: 0.12</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;OLS Starter Players Adj R-squared:&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(ols_starter)<span class="sc">$</span>adj.r.squared, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## OLS Starter Players Adj R-squared: 0.1186</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Probit Regular Players AIC:&quot;</span>, <span class="fu">round</span>(probit_regular<span class="sc">$</span>aic, <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Probit Regular Players AIC: 52906.02</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Probit Starter Players AIC:&quot;</span>, <span class="fu">round</span>(probit_starter<span class="sc">$</span>aic, <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Probit Starter Players AIC: 52980.65</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Probit Regular Players McFadden&#39;s Pseudo R:&quot;</span>, <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">-</span> probit_regular<span class="sc">$</span>deviance<span class="sc">/</span>probit_regular<span class="sc">$</span>null.deviance, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Probit Regular Players McFadden&#39;s Pseudo R: 0.1055</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Probit Starter Players McFadden&#39;s Pseudo R:&quot;</span>, <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">-</span> probit_starter<span class="sc">$</span>deviance<span class="sc">/</span>probit_starter<span class="sc">$</span>null.deviance, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Probit Starter Players McFadden&#39;s Pseudo R: 0.1042</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="co"># Function to get top coefficients by absolute value</span></span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>get_top_coefficients <span class="ot">&lt;-</span> <span class="cf">function</span>(model_results, <span class="at">n =</span> <span class="dv">10</span>) {</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>  coefs <span class="ot">&lt;-</span> model_results[, <span class="st">&quot;Estimate&quot;</span>]</span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a>  <span class="co"># Remove intercept</span></span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a>  coefs <span class="ot">&lt;-</span> coefs[<span class="fu">names</span>(coefs) <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a>  <span class="co"># Sort by absolute value</span></span>
<span id="cb65-7"><a href="#cb65-7" tabindex="-1"></a>  sorted_indices <span class="ot">&lt;-</span> <span class="fu">order</span>(<span class="fu">abs</span>(coefs), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-8"><a href="#cb65-8" tabindex="-1"></a>  top_coefs <span class="ot">&lt;-</span> coefs[sorted_indices[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(n, <span class="fu">length</span>(sorted_indices))]]</span>
<span id="cb65-9"><a href="#cb65-9" tabindex="-1"></a>  <span class="fu">return</span>(top_coefs)</span>
<span id="cb65-10"><a href="#cb65-10" tabindex="-1"></a>}</span>
<span id="cb65-11"><a href="#cb65-11" tabindex="-1"></a></span>
<span id="cb65-12"><a href="#cb65-12" tabindex="-1"></a><span class="co"># Display top coefficients for each model</span></span>
<span id="cb65-13"><a href="#cb65-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">Top 10 Influential Variables by Absolute Coefficient Value</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 
## Top 10 Influential Variables by Absolute Coefficient Value</code></pre>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIlRoaXJkIERvd24gQW5hbHlzaXMgd2l0aCBSZWd1bGFyIGFuZCBTdGFydGVyIFBsYXllcnMiDQpvdXRwdXQ6IGh0bWxfZG9jdW1lbnQNCi0tLQ0KDQpgYGB7cn0NCmxpYnJhcnkoZGF0YS50YWJsZSkgICAgICAgICAgICAgDQpjdGQxIDwtIGZyZWFkKCJwcmVkaWN0X2N0ZDEuY3N2Lmd6IikgICAgICAgICAgICAgICAgICAgICAgICANCmBgYA0KDQpgYGB7cn0NCiNraWxsIG15X2lkDQpjdGQxJG15X2lkIDwtIE5VTEwNCmN0ZDFbLCB5ZWFyMjAxN190ZWFtX0FSSSA6PSBOVUxMXQ0KYGBgDQoNCmBgYHtyfQ0KIyBtYWtlIHNjb3JlX2RpZmYgYmUgYmluYXJ5IDEgaWYgcG9zaXRpdmUsIDAgaWYgbmVnYXRpdmUgb3IgPSAwDQpjdGQxWywgc2NvcmVfZGlmZiA6PSBhcy5pbnRlZ2VyKHNjb3JlX2RpZmYgPiAwKV0NCmBgYA0KDQoNCg0KYGBge3J9DQojIElkZW50aWZ5IHBsYXllciBjb2x1bW5zDQphbGxfY29scyA8LSBjb2xuYW1lcyhjdGQxKQ0KDQojIENyZWF0ZSByZWdleCBwYXR0ZXJucyB0byBpZGVudGlmeSByZWd1bGFyIGFuZCBzdGFydGVyIHBsYXllciB2YXJpYWJsZXMNCm9mZmVuc2VfcGxheWVyX3BhdHRlcm4gPC0gIl5vZmZlbnNlX3BsYXllcl9cXGQrXyINCmRlZmVuc2VfcGxheWVyX3BhdHRlcm4gPC0gIl5kZWZlbnNlX3BsYXllcl9cXGQrXyINCnN0YXJ0ZXJfb2ZmZW5zZV9wYXR0ZXJuIDwtICJec3RhcnRlcl9vZmZlbnNlX3BsYXllcl9cXGQrXyINCnN0YXJ0ZXJfZGVmZW5zZV9wYXR0ZXJuIDwtICJec3RhcnRlcl9kZWZlbnNlX3BsYXllcl9cXGQrXyINCg0KIyBHZXQgY29sdW1ucyBmb3IgZWFjaCB0eXBlDQpvZmZlbnNlX3BsYXllcl9jb2xzIDwtIGdyZXAob2ZmZW5zZV9wbGF5ZXJfcGF0dGVybiwgYWxsX2NvbHMsIHZhbHVlID0gVFJVRSkNCmRlZmVuc2VfcGxheWVyX2NvbHMgPC0gZ3JlcChkZWZlbnNlX3BsYXllcl9wYXR0ZXJuLCBhbGxfY29scywgdmFsdWUgPSBUUlVFKQ0Kc3RhcnRlcl9vZmZlbnNlX2NvbHMgPC0gZ3JlcChzdGFydGVyX29mZmVuc2VfcGF0dGVybiwgYWxsX2NvbHMsIHZhbHVlID0gVFJVRSkNCnN0YXJ0ZXJfZGVmZW5zZV9jb2xzIDwtIGdyZXAoc3RhcnRlcl9kZWZlbnNlX3BhdHRlcm4sIGFsbF9jb2xzLCB2YWx1ZSA9IFRSVUUpDQoNCiMgQWxsIHBsYXllciBjb2x1bW5zDQpyZWd1bGFyX3BsYXllcl9jb2xzIDwtIGMob2ZmZW5zZV9wbGF5ZXJfY29scywgZGVmZW5zZV9wbGF5ZXJfY29scykNCnN0YXJ0ZXJfcGxheWVyX2NvbHMgPC0gYyhzdGFydGVyX29mZmVuc2VfY29scywgc3RhcnRlcl9kZWZlbnNlX2NvbHMpDQphbGxfcGxheWVyX2NvbHMgPC0gYyhyZWd1bGFyX3BsYXllcl9jb2xzLCBzdGFydGVyX3BsYXllcl9jb2xzKQ0KDQojIE5vbi1wbGF5ZXIgY29sdW1ucyAoY29tbW9uIHRvIGJvdGggZGF0YXNldHMpDQpjb21tb25fY29scyA8LSBzZXRkaWZmKGFsbF9jb2xzLCBhbGxfcGxheWVyX2NvbHMpDQoNCiMgQ3JlYXRlIHR3byBkYXRhc2V0cw0KcmVndWxhcl9kYXRhIDwtIGN0ZDFbLCBjKGNvbW1vbl9jb2xzLCByZWd1bGFyX3BsYXllcl9jb2xzKSwgd2l0aCA9IEZBTFNFXQ0Kc3RhcnRlcl9kYXRhIDwtIGN0ZDFbLCBjKGNvbW1vbl9jb2xzLCBzdGFydGVyX3BsYXllcl9jb2xzKSwgd2l0aCA9IEZBTFNFXQ0KYGBgDQoNCg0KYGBge3J9DQojIFRoZW4gcnVuIE9MUyB3aXRoIHJlZ3VsYXIgcGxheWVycw0Kb2xzX3JlZ3VsYXIgPC0gbG0oY29udmVyc2lvbiB+IC4sIGRhdGEgPSByZWd1bGFyX2RhdGEpDQpgYGANCg0KYGBge3J9DQpsaWJyYXJ5KHNhbmR3aWNoKQ0KbGlicmFyeShsbXRlc3QpDQojIEdldCBIQzAtYWRqdXN0ZWQgdC12YWx1ZXMgYW5kIHAtdmFsdWVzDQpyb2J1c3RfcmVndWxhcl90ZXN0IDwtIGNvZWZ0ZXN0KG9sc19yZWd1bGFyLCB2Y292ID0gdmNvdkhDKG9sc19yZWd1bGFyLCB0eXBlID0gIkhDMCIpKQ0KdF9zdGF0c19yZWd1bGFyIDwtIHJvYnVzdF9yZWd1bGFyX3Rlc3RbLCAidCB2YWx1ZSJdDQpwX3ZhbHVlc19yZWd1bGFyIDwtIHJvYnVzdF9yZWd1bGFyX3Rlc3RbLCAiUHIoPnx0fCkiXQ0KIyBGdW5jdGlvbiB0byBhZGQgc2lnbmlmaWNhbmNlIHN0YXJzDQpnZXRfc3RhcnMgPC0gZnVuY3Rpb24ocCkgew0KICAgIGlmIChwIDw9IDAuMDEpIHJldHVybigiKioqIikNCiAgICBpZiAocCA8PSAwLjA1KSByZXR1cm4oIioqIikNCiAgICBpZiAocCA8PSAwLjEpIHJldHVybigiKiIpDQogICAgaWYgKHAgPD0gMC4xNSkgcmV0dXJuKCIuIikNCiAgICByZXR1cm4oIiIpDQp9DQojIE1heGltdW0gd2lkdGggZm9yIHZhcmlhYmxlIG5hbWVzDQpuYW1lX3dpZHRoIDwtIDYwDQojIFByaW50IGhlYWRlciB3aXRoIGFsaWdubWVudA0KY2F0KHNwcmludGYoIiUtKnMgICUxMHMgICUxMHMgICU0c1xuIiwgbmFtZV93aWR0aCwgIlJlZ3VsYXIgUGxheWVycyBPTFMgVmFyaWFibGUiLCAidC12YWx1ZSIsICJwLXZhbHVlIiwgInNpZyIpKQ0KY2F0KHNwcmludGYoIiUtKnMgICUxMHMgICUxMHMgICU0c1xuIiwgbmFtZV93aWR0aCwgIi0tLS0tLS0tLSIsICItLS0tLS0tIiwgIi0tLS0tLS0iLCAiLS0tLSIpKQ0KIyBMb29wIHRocm91Z2ggYW5kIHByaW50IHZhbHVlcw0KZm9yIChpIGluIDE6bGVuZ3RoKHRfc3RhdHNfcmVndWxhcikpIHsNCiAgICB2YXJfbmFtZSA8LSByb3duYW1lcyhyb2J1c3RfcmVndWxhcl90ZXN0KVtpXQ0KICAgICMgVHJ1bmNhdGUgbmFtZSBpZiB0b28gbG9uZw0KICAgIGlmIChuY2hhcih2YXJfbmFtZSkgPiBuYW1lX3dpZHRoKSB7DQogICAgICAgIHZhcl9uYW1lIDwtIHBhc3RlMChzdWJzdHIodmFyX25hbWUsIDEsIG5hbWVfd2lkdGgtMyksICIuLi4iKQ0KICAgIH0NCiAgICBjYXQoc3ByaW50ZigiJS0qcyAgJTEwLjRmICAlMTAuNGYgICU0c1xuIiwgDQogICAgICAgICAgICAgICAgbmFtZV93aWR0aCwgdmFyX25hbWUsIA0KICAgICAgICAgICAgICAgIHRfc3RhdHNfcmVndWxhcltpXSwgcF92YWx1ZXNfcmVndWxhcltpXSwNCiAgICAgICAgICAgICAgICBnZXRfc3RhcnMocF92YWx1ZXNfcmVndWxhcltpXSkpKQ0KfQ0KY2F0KCJcblNpZ25pZmljYW5jZSBjb2RlczogMCAnKioqJyAwLjAxICcqKicgMC4wNSAnKicgMC4xICcuJyAwLjE1IikNCmBgYA0KDQpgYGB7cn0NCiMgTG9hZCB0aGUgY2FyIHBhY2thZ2Ugd2hpY2ggaGFzIHRoZSB2aWYgZnVuY3Rpb24NCmxpYnJhcnkoY2FyKQ0KIyBDYWxjdWxhdGUgVklGcyBmb3IgdGhlIG1vZGVsIHdpdGggcmVndWxhciBwbGF5ZXJzDQp2aWZzX3JlZ3VsYXIgPC0gdmlmKG9sc19yZWd1bGFyKQ0KIyBGaWx0ZXIgdG8gc2hvdyBvbmx5IFZJRnMgb3ZlciA1DQpoaWdoX3ZpZnNfcmVndWxhciA8LSB2aWZzX3JlZ3VsYXJbdmlmc19yZWd1bGFyID4gNV0NCmlmKGxlbmd0aChoaWdoX3ZpZnNfcmVndWxhcikgPiAwKSB7DQogIGNhdCgiXG5SZWd1bGFyIFBsYXllcnM6IFZhcmlhYmxlcyB3aXRoIFZJRiA+IDU6XG4iKQ0KICBwcmludChoaWdoX3ZpZnNfcmVndWxhcikNCn0gZWxzZSB7DQogIGNhdCgiXG5ObyB2YXJpYWJsZXMgd2l0aCBWSUYgPiA1IGZvdW5kIGluIHRoZSBSZWd1bGFyIFBsYXllcnMgbW9kZWxcbiIpDQp9DQpgYGANCg0KYGBge3J9DQpsaWJyYXJ5KGNhcmV0KQ0KIyBDcmVhdGUgdGhlIG1vZGVsIG1hdHJpeCBmb3IgcmVndWxhciBkYXRhIChleGNsdWRpbmcgdGhlIHJlc3BvbnNlIHZhcmlhYmxlKQ0KWF9yZWd1bGFyIDwtIG1vZGVsLm1hdHJpeCh+IC4gLSBjb252ZXJzaW9uIC0gMSwgZGF0YSA9IHJlZ3VsYXJfZGF0YSkgICMgLTEgcmVtb3ZlcyBpbnRlcmNlcHQNCiMgRmluZCBjb2x1bW5zIGNhdXNpbmcgbGluZWFyIGRlcGVuZGVuY2llcw0KbGluX2NvbWJvc19yZWd1bGFyIDwtIGZpbmRMaW5lYXJDb21ib3MoWF9yZWd1bGFyKQ0KIyBSZW1vdmUgcHJvYmxlbWF0aWMgY29sdW1ucyBmcm9tIHRoZSBkYXRhc2V0DQppZiAoIWlzLm51bGwobGluX2NvbWJvc19yZWd1bGFyJHJlbW92ZSkpIHsNCiAgY29sc190b19yZW1vdmUgPC0gY29sbmFtZXMoWF9yZWd1bGFyKVtsaW5fY29tYm9zX3JlZ3VsYXIkcmVtb3ZlXQ0KICBjYXQoIlJlbW92ZWQgZnJvbSByZWd1bGFyIGRhdGE6IiwgcGFzdGUoY29sc190b19yZW1vdmUsIGNvbGxhcHNlPSIsICIpLCAiXG4iKQ0KICByZWd1bGFyX2RhdGEgPC0gcmVndWxhcl9kYXRhWywgKGNvbHNfdG9fcmVtb3ZlKSA6PSBOVUxMLCB3aXRoID0gRkFMU0VdDQp9DQpgYGANCg0KDQpgYGB7cn0NCiMgVGhlbiBydW4gT0xTIHdpdGggc3RhcnRlciBwbGF5ZXJzDQpvbHNfc3RhcnRlciA8LSBsbShjb252ZXJzaW9uIH4gLiwgZGF0YSA9IHN0YXJ0ZXJfZGF0YSkNCmBgYA0KDQpgYGB7cn0NCiMgR2V0IEhDMC1hZGp1c3RlZCB0LXZhbHVlcyBhbmQgcC12YWx1ZXMNCnJvYnVzdF9zdGFydGVyX3Rlc3QgPC0gY29lZnRlc3Qob2xzX3N0YXJ0ZXIsIHZjb3YgPSB2Y292SEMob2xzX3N0YXJ0ZXIsIHR5cGUgPSAiSEMwIikpDQp0X3N0YXRzX3N0YXJ0ZXIgPC0gcm9idXN0X3N0YXJ0ZXJfdGVzdFssICJ0IHZhbHVlIl0NCnBfdmFsdWVzX3N0YXJ0ZXIgPC0gcm9idXN0X3N0YXJ0ZXJfdGVzdFssICJQcig+fHR8KSJdDQoNCiMgUHJpbnQgaGVhZGVyIHdpdGggYWxpZ25tZW50DQpjYXQoc3ByaW50ZigiJS0qcyAgJTEwcyAgJTEwcyAgJTRzXG4iLCBuYW1lX3dpZHRoLCAiU3RhcnRlciBQbGF5ZXJzIE9MUyBWYXJpYWJsZSIsICJ0LXZhbHVlIiwgInAtdmFsdWUiLCAic2lnIikpDQpjYXQoc3ByaW50ZigiJS0qcyAgJTEwcyAgJTEwcyAgJTRzXG4iLCBuYW1lX3dpZHRoLCAiLS0tLS0tLS0tIiwgIi0tLS0tLS0iLCAiLS0tLS0tLSIsICItLS0tIikpDQojIExvb3AgdGhyb3VnaCBhbmQgcHJpbnQgdmFsdWVzDQpmb3IgKGkgaW4gMTpsZW5ndGgodF9zdGF0c19zdGFydGVyKSkgew0KICAgIHZhcl9uYW1lIDwtIHJvd25hbWVzKHJvYnVzdF9zdGFydGVyX3Rlc3QpW2ldDQogICAgIyBUcnVuY2F0ZSBuYW1lIGlmIHRvbyBsb25nDQogICAgaWYgKG5jaGFyKHZhcl9uYW1lKSA+IG5hbWVfd2lkdGgpIHsNCiAgICAgICAgdmFyX25hbWUgPC0gcGFzdGUwKHN1YnN0cih2YXJfbmFtZSwgMSwgbmFtZV93aWR0aC0zKSwgIi4uLiIpDQogICAgfQ0KICAgIGNhdChzcHJpbnRmKCIlLSpzICAlMTAuNGYgICUxMC40ZiAgJTRzXG4iLCANCiAgICAgICAgICAgICAgICBuYW1lX3dpZHRoLCB2YXJfbmFtZSwgDQogICAgICAgICAgICAgICAgdF9zdGF0c19zdGFydGVyW2ldLCBwX3ZhbHVlc19zdGFydGVyW2ldLA0KICAgICAgICAgICAgICAgIGdldF9zdGFycyhwX3ZhbHVlc19zdGFydGVyW2ldKSkpDQp9DQpjYXQoIlxuU2lnbmlmaWNhbmNlIGNvZGVzOiAwICcqKionIDAuMDEgJyoqJyAwLjA1ICcqJyAwLjEgJy4nIDAuMTUiKQ0KYGBgDQoNCmBgYHtyfQ0KIyBDYWxjdWxhdGUgVklGcyBmb3IgdGhlIG1vZGVsIHdpdGggc3RhcnRlciBwbGF5ZXJzDQp2aWZzX3N0YXJ0ZXIgPC0gdmlmKG9sc19zdGFydGVyKQ0KIyBGaWx0ZXIgdG8gc2hvdyBvbmx5IFZJRnMgb3ZlciA1DQpoaWdoX3ZpZnNfc3RhcnRlciA8LSB2aWZzX3N0YXJ0ZXJbdmlmc19zdGFydGVyID4gNV0NCmlmKGxlbmd0aChoaWdoX3ZpZnNfc3RhcnRlcikgPiAwKSB7DQogIGNhdCgiXG5TdGFydGVyIFBsYXllcnM6IFZhcmlhYmxlcyB3aXRoIFZJRiA+IDU6XG4iKQ0KICBwcmludChoaWdoX3ZpZnNfc3RhcnRlcikNCn0gZWxzZSB7DQogIGNhdCgiXG5ObyB2YXJpYWJsZXMgd2l0aCBWSUYgPiA1IGZvdW5kIGluIHRoZSBTdGFydGVyIFBsYXllcnMgbW9kZWxcbiIpDQp9DQpgYGANCg0KYGBge3J9DQojIENyZWF0ZSB0aGUgbW9kZWwgbWF0cml4IGZvciBzdGFydGVyIGRhdGEgKGV4Y2x1ZGluZyB0aGUgcmVzcG9uc2UgdmFyaWFibGUpDQpYX3N0YXJ0ZXIgPC0gbW9kZWwubWF0cml4KH4gLiAtIGNvbnZlcnNpb24gLSAxLCBkYXRhID0gc3RhcnRlcl9kYXRhKSAgIyAtMSByZW1vdmVzIGludGVyY2VwdA0KIyBGaW5kIGNvbHVtbnMgY2F1c2luZyBsaW5lYXIgZGVwZW5kZW5jaWVzDQpsaW5fY29tYm9zX3N0YXJ0ZXIgPC0gZmluZExpbmVhckNvbWJvcyhYX3N0YXJ0ZXIpDQojIFJlbW92ZSBwcm9ibGVtYXRpYyBjb2x1bW5zIGZyb20gdGhlIGRhdGFzZXQNCmlmICghaXMubnVsbChsaW5fY29tYm9zX3N0YXJ0ZXIkcmVtb3ZlKSkgew0KICBjb2xzX3RvX3JlbW92ZSA8LSBjb2xuYW1lcyhYX3N0YXJ0ZXIpW2xpbl9jb21ib3Nfc3RhcnRlciRyZW1vdmVdDQogIGNhdCgiUmVtb3ZlZCBmcm9tIHN0YXJ0ZXIgZGF0YToiLCBwYXN0ZShjb2xzX3RvX3JlbW92ZSwgY29sbGFwc2U9IiwgIiksICJcbiIpDQogIHN0YXJ0ZXJfZGF0YSA8LSBzdGFydGVyX2RhdGFbLCAoY29sc190b19yZW1vdmUpIDo9IE5VTEwsIHdpdGggPSBGQUxTRV0NCn0NCmBgYA0KDQoNCmBgYHtyfQ0KIyBQcm9iaXQgbW9kZWwgd2l0aCByZWd1bGFyIHBsYXllcnMNCnByb2JpdF9yZWd1bGFyIDwtIGdsbShjb252ZXJzaW9uIH4gLiwgZGF0YSA9IHJlZ3VsYXJfZGF0YSwgZmFtaWx5ID0gYmlub21pYWwobGluayA9ICJwcm9iaXQiKSkNCmBgYA0KDQpgYGB7cn0NCiMgR2V0IEhDMC1hZGp1c3RlZCB6LXZhbHVlcyBhbmQgcC12YWx1ZXMgZm9yIHJlZ3VsYXIgcHJvYml0DQpyb2J1c3RfcHJvYml0X3JlZ3VsYXIgPC0gY29lZnRlc3QocHJvYml0X3JlZ3VsYXIsIHZjb3YgPSB2Y292SEMocHJvYml0X3JlZ3VsYXIsIHR5cGUgPSAiSEMwIikpDQp6X3N0YXRzX3JlZ3VsYXIgPC0gcm9idXN0X3Byb2JpdF9yZWd1bGFyWywgInogdmFsdWUiXQ0KcF92YWx1ZXNfcmVndWxhciA8LSByb2J1c3RfcHJvYml0X3JlZ3VsYXJbLCAiUHIoPnx6fCkiXQ0KDQojIFByaW50IGhlYWRlciAobm90ZSAiei12YWx1ZSIgaW5zdGVhZCBvZiAidC12YWx1ZSIpDQpjYXQoc3ByaW50ZigiXG5cbiUtKnMgICUxMHMgICUxMHMgICU0c1xuIiwgbmFtZV93aWR0aCwgIlJlZ3VsYXIgUGxheWVycyBQcm9iaXQgVmFyaWFibGUiLCAiei12YWx1ZSIsICJwLXZhbHVlIiwgInNpZyIpKQ0KY2F0KHNwcmludGYoIiUtKnMgICUxMHMgICUxMHMgICU0c1xuIiwgbmFtZV93aWR0aCwgIi0tLS0tLS0tLS0tLS0tLSIsICItLS0tLS0tIiwgIi0tLS0tLS0iLCAiLS0tLSIpKQ0KZm9yIChpIGluIDE6bGVuZ3RoKHpfc3RhdHNfcmVndWxhcikpIHsNCiAgICB2YXJfbmFtZSA8LSByb3duYW1lcyhyb2J1c3RfcHJvYml0X3JlZ3VsYXIpW2ldDQogICAgaWYgKG5jaGFyKHZhcl9uYW1lKSA+IG5hbWVfd2lkdGgpIHsNCiAgICAgICAgdmFyX25hbWUgPC0gcGFzdGUwKHN1YnN0cih2YXJfbmFtZSwgMSwgbmFtZV93aWR0aC0zKSwgIi4uLiIpDQogICAgfQ0KICAgIGNhdChzcHJpbnRmKCIlLSpzICAlMTAuNGYgICUxMC40ZiAgJTRzXG4iLCANCiAgICAgICAgICAgICAgICBuYW1lX3dpZHRoLCB2YXJfbmFtZSwgDQogICAgICAgICAgICAgICAgel9zdGF0c19yZWd1bGFyW2ldLCBwX3ZhbHVlc19yZWd1bGFyW2ldLA0KICAgICAgICAgICAgICAgIGdldF9zdGFycyhwX3ZhbHVlc19yZWd1bGFyW2ldKSkpDQp9DQpjYXQoIlxuU2lnbmlmaWNhbmNlIGNvZGVzOiAwICcqKionIDAuMDEgJyoqJyAwLjA1ICcqJyAwLjEgJy4nIDAuMTUiKQ0KYGBgDQoNCg0KYGBge3J9DQojIFByb2JpdCBtb2RlbCB3aXRoIHN0YXJ0ZXIgcGxheWVycw0KcHJvYml0X3N0YXJ0ZXIgPC0gZ2xtKGNvbnZlcnNpb24gfiAuLCBkYXRhID0gc3RhcnRlcl9kYXRhLCBmYW1pbHkgPSBiaW5vbWlhbChsaW5rID0gInByb2JpdCIpKQ0KYGBgDQoNCmBgYHtyfQ0KIyBHZXQgSEMwLWFkanVzdGVkIHotdmFsdWVzIGFuZCBwLXZhbHVlcyBmb3Igc3RhcnRlciBwcm9iaXQNCnJvYnVzdF9wcm9iaXRfc3RhcnRlciA8LSBjb2VmdGVzdChwcm9iaXRfc3RhcnRlciwgdmNvdiA9IHZjb3ZIQyhwcm9iaXRfc3RhcnRlciwgdHlwZSA9ICJIQzAiKSkNCnpfc3RhdHNfc3RhcnRlciA8LSByb2J1c3RfcHJvYml0X3N0YXJ0ZXJbLCAieiB2YWx1ZSJdDQpwX3ZhbHVlc19zdGFydGVyIDwtIHJvYnVzdF9wcm9iaXRfc3RhcnRlclssICJQcig+fHp8KSJdDQoNCiMgUHJpbnQgaGVhZGVyIChub3RlICJ6LXZhbHVlIiBpbnN0ZWFkIG9mICJ0LXZhbHVlIikNCmNhdChzcHJpbnRmKCJcblxuJS0qcyAgJTEwcyAgJTEwcyAgJTRzXG4iLCBuYW1lX3dpZHRoLCAiU3RhcnRlciBQbGF5ZXJzIFByb2JpdCBWYXJpYWJsZSIsICJ6LXZhbHVlIiwgInAtdmFsdWUiLCAic2lnIikpDQpjYXQoc3ByaW50ZigiJS0qcyAgJTEwcyAgJTEwcyAgJTRzXG4iLCBuYW1lX3dpZHRoLCAiLS0tLS0tLS0tLS0tLS0tIiwgIi0tLS0tLS0iLCAiLS0tLS0tLSIsICItLS0tIikpDQpmb3IgKGkgaW4gMTpsZW5ndGgoel9zdGF0c19zdGFydGVyKSkgew0KICAgIHZhcl9uYW1lIDwtIHJvd25hbWVzKHJvYnVzdF9wcm9iaXRfc3RhcnRlcilbaV0NCiAgICBpZiAobmNoYXIodmFyX25hbWUpID4gbmFtZV93aWR0aCkgew0KICAgICAgICB2YXJfbmFtZSA8LSBwYXN0ZTAoc3Vic3RyKHZhcl9uYW1lLCAxLCBuYW1lX3dpZHRoLTMpLCAiLi4uIikNCiAgICB9DQogICAgY2F0KHNwcmludGYoIiUtKnMgICUxMC40ZiAgJTEwLjRmICAlNHNcbiIsIA0KICAgICAgICAgICAgICAgIG5hbWVfd2lkdGgsIHZhcl9uYW1lLCANCiAgICAgICAgICAgICAgICB6X3N0YXRzX3N0YXJ0ZXJbaV0sIHBfdmFsdWVzX3N0YXJ0ZXJbaV0sDQogICAgICAgICAgICAgICAgZ2V0X3N0YXJzKHBfdmFsdWVzX3N0YXJ0ZXJbaV0pKSkNCn0NCmNhdCgiXG5TaWduaWZpY2FuY2UgY29kZXM6IDAgJyoqKicgMC4wMSAnKionIDAuMDUgJyonIDAuMSAnLicgMC4xNSIpDQpgYGANCg0KDQpgYGB7cn0NCiMgTW9kZWwgY29tcGFyaXNvbiBzdW1tYXJ5DQpjYXQoIlxuXG4tLS0gTW9kZWwgQ29tcGFyaXNvbiBTdW1tYXJ5IC0tLVxuIikNCmNhdCgiT0xTIFJlZ3VsYXIgUGxheWVycyBSLXNxdWFyZWQ6Iiwgcm91bmQoc3VtbWFyeShvbHNfcmVndWxhcikkci5zcXVhcmVkLCA0KSwgIlxuIikNCmNhdCgiT0xTIFN0YXJ0ZXIgUGxheWVycyBSLXNxdWFyZWQ6Iiwgcm91bmQoc3VtbWFyeShvbHNfc3RhcnRlcikkci5zcXVhcmVkLCA0KSwgIlxuIikNCmNhdCgiT0xTIFJlZ3VsYXIgUGxheWVycyBBZGogUi1zcXVhcmVkOiIsIHJvdW5kKHN1bW1hcnkob2xzX3JlZ3VsYXIpJGFkai5yLnNxdWFyZWQsIDQpLCAiXG4iKQ0KY2F0KCJPTFMgU3RhcnRlciBQbGF5ZXJzIEFkaiBSLXNxdWFyZWQ6Iiwgcm91bmQoc3VtbWFyeShvbHNfc3RhcnRlcikkYWRqLnIuc3F1YXJlZCwgNCksICJcblxuIikNCg0KY2F0KCJQcm9iaXQgUmVndWxhciBQbGF5ZXJzIEFJQzoiLCByb3VuZChwcm9iaXRfcmVndWxhciRhaWMsIDIpLCAiXG4iKQ0KY2F0KCJQcm9iaXQgU3RhcnRlciBQbGF5ZXJzIEFJQzoiLCByb3VuZChwcm9iaXRfc3RhcnRlciRhaWMsIDIpLCAiXG4iKQ0KY2F0KCJQcm9iaXQgUmVndWxhciBQbGF5ZXJzIE1jRmFkZGVuJ3MgUHNldWRvIFLCsjoiLCByb3VuZCgxIC0gcHJvYml0X3JlZ3VsYXIkZGV2aWFuY2UvcHJvYml0X3JlZ3VsYXIkbnVsbC5kZXZpYW5jZSwgNCksICJcbiIpDQpjYXQoIlByb2JpdCBTdGFydGVyIFBsYXllcnMgTWNGYWRkZW4ncyBQc2V1ZG8gUsKyOiIsIHJvdW5kKDEgLSBwcm9iaXRfc3RhcnRlciRkZXZpYW5jZS9wcm9iaXRfc3RhcnRlciRudWxsLmRldmlhbmNlLCA0KSwgIlxuIikNCmBgYA0KDQoNCmBgYHtyfQ0KIyBGdW5jdGlvbiB0byBnZXQgdG9wIGNvZWZmaWNpZW50cyBieSBhYnNvbHV0ZSB2YWx1ZQ0KZ2V0X3RvcF9jb2VmZmljaWVudHMgPC0gZnVuY3Rpb24obW9kZWxfcmVzdWx0cywgbiA9IDEwKSB7DQogIGNvZWZzIDwtIG1vZGVsX3Jlc3VsdHNbLCAiRXN0aW1hdGUiXQ0KICAjIFJlbW92ZSBpbnRlcmNlcHQNCiAgY29lZnMgPC0gY29lZnNbbmFtZXMoY29lZnMpICE9ICIoSW50ZXJjZXB0KSJdDQogICMgU29ydCBieSBhYnNvbHV0ZSB2YWx1ZQ0KICBzb3J0ZWRfaW5kaWNlcyA8LSBvcmRlcihhYnMoY29lZnMpLCBkZWNyZWFzaW5nID0gVFJVRSkNCiAgdG9wX2NvZWZzIDwtIGNvZWZzW3NvcnRlZF9pbmRpY2VzWzE6bWluKG4sIGxlbmd0aChzb3J0ZWRfaW5kaWNlcykpXV0NCiAgcmV0dXJuKHRvcF9jb2VmcykNCn0NCg0KIyBEaXNwbGF5IHRvcCBjb2VmZmljaWVudHMgZm9yIGVhY2ggbW9kZWwNCmNhdCgiXG5cblRvcCAxMCBJbmZsdWVudGlhbCBWYXJpYWJsZXMgYnkgQWJzb2x1dGUgQ29lZmZpY2llbnQgVmFsdWVcbiIpDQoNCg0KYGBg</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("thirddown.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
